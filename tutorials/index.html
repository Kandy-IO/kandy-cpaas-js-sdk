<!DOCTYPE >
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Kandy Tutorials</title>
    <link rel="stylesheet" href="https://unpkg.com/docute@4/dist/docute.css" />
  </head>
  <body>
    <div id="docute"></div>
    <script src="https://unpkg.com/docute@4/dist/docute.js"></script>
    <script src="//cdn.jsdelivr.net/remarkable/1.7.1/remarkable.min.js"></script>
    <script>
      const sidebar = [{
        title: "Tutorials",
        links: [
        
          {
            title: 'Get Started',
            link: 'Get Started'
          },
        
          {
            title: 'Configurations',
            link: 'Configurations'
          },
        
          {
            title: 'Authentication',
            link: 'Authentication'
          },
        
          {
            title: 'Call States',
            link: 'Call States'
          },
        
          {
            title: 'Voice and Video Calls',
            link: 'Voice and Video Calls'
          },
        
          {
            title: 'Anonymous Calls',
            link: 'Anonymous Calls'
          },
        
          {
            title: 'Chat',
            link: 'Chat'
          },
        
          {
            title: 'Chat History',
            link: 'Chat History'
          },
        
          {
            title: 'Group Chat',
            link: 'Group Chat'
          },
        
          {
            title: 'SMS Messaging',
            link: 'SMS Messaging'
          },
        
          {
            title: 'Multimedia Chat',
            link: 'Multimedia Chat'
          },
        
          {
            title: 'Address Book and Directory',
            link: 'Address Book and Directory'
          },
        
          {
            title: 'Presence',
            link: 'Presence'
          },
        
          {
            title: 'Troubleshooting and Logs',
            link: 'Troubleshooting and Logs'
          },
        
        ]
      }]

      const queryParams = new URLSearchParams(window.location.search);

      new Docute({
        target: '#docute',
        sidebar,
        plugins: [
          {
            name: 'Hide Front Matter',
            extend(api) {
              api.processMarkdown(md => md.replace(/---([^]*?)---/m, ''))
            }
          },
          {
            name: 'Convert KANDYFQDN',
            extend(api) {
              const kandyFQDN = queryParams.get('KANDYFQDN') || '$KANDYFQDN$'
              api.processMarkdown(md => md.replace(/\$KANDYFQDN\$/gm, kandyFQDN))
            }
          },
          {
            name: 'Convert KANDYTURN1',
            extend(api) {
              const kandyTURN1 = queryParams.get('KANDYTURN1') || '$KANDYTURN1$'
              api.processMarkdown(md => md.replace(/\$KANDYTURN1\$/gm, kandyTURN1))
            }
          },
          {
            name: 'Convert KANDYTURN2',
            extend(api) {
              const kandyTURN2 = queryParams.get('KANDYTURN2') || '$KANDYTURN2$'
              api.processMarkdown(md => md.replace(/\$KANDYTURN2\$/gm, kandyTURN2))
            }
          },
          {
            name: 'Convert KANDYSTUN1',
            extend(api) {
              const kandySTUN1 = queryParams.get('KANDYSTUN1') || '$KANDYSTUN1$'
              api.processMarkdown(md => md.replace(/\$KANDYSTUN1\$/gm, kandySTUN1))
            }
          },
          {
            name: 'Convert KANDYSTUN2',
            extend(api) {
              const kandySTUN2 = queryParams.get('KANDYSTUN2') || '$KANDYSTUN2$'
              api.processMarkdown(md => md.replace(/\$KANDYSTUN2\$/gm, kandySTUN2))
            }
          },
          {
            name: 'Convert KANDY',
            extend(api) {
              const kandy = queryParams.get('KANDY') || '$KANDY$'
              api.processMarkdown(md => md.replace(/\$KANDY\$/gm, kandy))
            }
          },
          {
            name: 'Convert SUBSCRIPTIONFQDN',
            extend(api) {
              const subscriptionFQDN = queryParams.get('SUBSCRIPTIONFQDN') || '$SUBSCRIPTIONFQDN$'
              api.processMarkdown(md => md.replace(/\$SUBSCRIPTIONFQDN\$/gm, subscriptionFQDN))
            }
          },
          {
            name: 'Convert WEBSOCKETFQDN',
            extend(api) {
              const webSocketFQDN = queryParams.get('WEBSOCKETFQDN') || '$WEBSOCKETFQDN$'
              api.processMarkdown(md => md.replace(/\$WEBSOCKETFQDN\$/gm, webSocketFQDN))
            }
          },
          {
            // This is required so that docute/vue don't mangle
            // the codepen form.
            name: 'Unescape HTML',
            extend(api) {
              // This hook will wrap the html generated by the markdown
              // in a div that uses vue's "v-html" directive so that the
              // html is not escaped by Vue.
              api.extendMarkdownComponent(component =>{
                const rawHtml = String(component.template)

                // Loop through every line of the markdown to find the codepen form
                // and replace it with a div with the v-html directive and set the form
                // as data for the view so that it gets rendered without being escaped.
                const modifiedHtml = rawHtml.split('\n')
                  .map(line => {
                    if (line.startsWith('<form action="https://codepen.io/pen/define"')) {
                      component.data = () => ({codepenForm: line})

                      return '<div v-html="codepenForm"></div>'
                    }

                    return line
                  })
                  .join('\n')

                component.template = modifiedHtml
              })
            }
          }
        ]
      })
    </script>
  </body>
</html>
