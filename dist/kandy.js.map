{"version":3,"sources":["webpack://Kandy/webpack/universalModuleDefinition","webpack://Kandy/webpack/bootstrap","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/array/from.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/json/stringify.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/map.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/object/assign.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/object/create.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/object/define-properties.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/object/define-property.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/object/entries.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/object/freeze.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/object/get-own-property-descriptor.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/object/get-own-property-symbols.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/object/get-prototype-of.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/object/keys.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/object/values.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/promise.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/symbol.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/symbol/for.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/core-js/symbol/iterator.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/helpers/extends.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/babel-runtime/helpers/objectWithoutProperties.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/array/from.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/json/stringify.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/map.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/object/assign.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/object/create.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/object/define-properties.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/object/define-property.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/object/entries.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/object/freeze.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/object/get-own-property-descriptor.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/object/get-own-property-symbols.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/object/get-prototype-of.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/object/keys.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/object/values.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/promise.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/symbol/for.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/symbol/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/fn/symbol/iterator.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_a-function.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_add-to-unscopables.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_an-instance.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_an-object.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_array-from-iterable.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_array-includes.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_array-methods.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_array-species-constructor.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_array-species-create.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_classof.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_cof.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_collection-strong.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_collection-to-json.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_collection.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_core.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_create-property.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_ctx.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_defined.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_descriptors.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_dom-create.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_enum-bug-keys.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_enum-keys.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_export.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_fails.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_for-of.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_global.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_has.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_hide.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_html.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_ie8-dom-define.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_invoke.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_iobject.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_is-array-iter.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_is-array.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_is-object.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_iter-call.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_iter-create.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_iter-define.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_iter-detect.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_iter-step.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_iterators.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_library.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_meta.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_microtask.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_new-promise-capability.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-assign.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-create.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-dp.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-dps.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-gopd.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-gopn-ext.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-gopn.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-gops.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-gpo.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-keys-internal.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-keys.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-pie.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-sap.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_object-to-array.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_perform.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_promise-resolve.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_property-desc.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_redefine-all.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_redefine.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_set-collection-from.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_set-collection-of.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_set-species.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_set-to-string-tag.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_shared-key.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_shared.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_species-constructor.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_string-at.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_task.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_to-absolute-index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_to-integer.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_to-iobject.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_to-length.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_to-object.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_to-primitive.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_uid.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_user-agent.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_validate-collection.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_wks-define.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_wks-ext.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/_wks.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/core.get-iterator-method.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.array.from.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.array.iterator.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.map.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.object.assign.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.object.create.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.object.define-properties.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.object.define-property.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.object.freeze.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.object.get-own-property-descriptor.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.object.get-prototype-of.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.object.keys.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.promise.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.string.iterator.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es6.symbol.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es7.map.from.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es7.map.of.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es7.map.to-json.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es7.object.entries.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es7.object.values.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es7.promise.finally.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es7.promise.try.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es7.symbol.async-iterator.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/es7.symbol.observable.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/core-js/library/modules/web.dom.iterable.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/decode-uri-component/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/eventemitter3/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/events/events.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/fetch-ponyfill/build/fetch-browser.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/inherits/inherits_browser.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/invariant/browser.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/just-curry-it/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/jwt-decode/lib/atob.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/jwt-decode/lib/base64_url_decode.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/jwt-decode/lib/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash-es/_Symbol.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash-es/_baseGetTag.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash-es/_freeGlobal.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash-es/_getPrototype.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash-es/_getRawTag.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash-es/_objectToString.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash-es/_overArg.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash-es/_root.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash-es/isObjectLike.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash-es/isPlainObject.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash/fp.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash/fp/_baseConvert.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash/fp/_mapping.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash/fp/placeholder.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/lodash/lodash.min.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/loglevel/lib/loglevel.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/process/browser.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/reduce-reducers/es/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/combineActions.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/constants.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/createAction.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/createActions.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/createCurriedAction.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/handleAction.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/handleActions.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/arrayToObject.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/camelCase.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/flattenActionMap.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/flattenReducerMap.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/flattenWhenNode.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/get.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/getLastElement.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/hasGeneratorInterface.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/identity.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/isArray.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/isEmpty.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/isFunction.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/isMap.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/isNil.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/isNull.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/isPlainObject.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/isString.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/isSymbol.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/isUndefined.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/ownKeys.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/toString.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-actions/es/utils/unflattenActionCreators.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-devtools-extension/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-logger/dist/redux-logger.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/effects.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/buffers.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/channel.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/error-utils.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/io.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/matcher.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/middleware.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/proc.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/runSaga.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/sagaHelpers/fsmIterator.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/sagaHelpers/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/sagaHelpers/takeEvery.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/sagaHelpers/takeLatest.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/sagaHelpers/takeLeading.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/sagaHelpers/throttle.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/scheduler.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/symbols.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/internal/utils.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/es/utils.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux-saga/node_modules/redux/es/redux.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux/es/applyMiddleware.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux/es/bindActionCreators.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux/es/combineReducers.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux/es/compose.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux/es/createStore.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux/es/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/redux/es/utils/warning.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/sdp-transform/lib/grammar.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/sdp-transform/lib/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/sdp-transform/lib/parser.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/sdp-transform/lib/writer.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/split-on-first/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/stampit/compose.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/symbol-observable/es/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/symbol-observable/es/ponyfill.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/timer-machine/lib/timer.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/to-camel-case/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/to-no-case/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/to-space-case/index.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/util/support/isBufferBrowser.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/util/util.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/uuid/lib/bytesToUuid.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/uuid/lib/rng-browser.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/uuid/v4.js","webpack://Kandy/(webpack)/buildin/global.js","webpack://Kandy/(webpack)/buildin/harmony-module.js","webpack://Kandy/(webpack)/buildin/module.js","webpack://Kandy//var/jenkins_home/workspace/Kandy.js_master/node_modules/webrtc-adapter/out/adapter_no_edge.js","webpack://Kandy/../fcs/src/js/sdp/codecRemover.js","webpack://Kandy/../kandy/node_modules/query-string/index.js","webpack://Kandy/../kandy/node_modules/strict-uri-encode/index.js","webpack://Kandy/../kandy/src/auth/constants.js","webpack://Kandy/../kandy/src/auth/cpaas/index.js","webpack://Kandy/../kandy/src/auth/interface/actionTypes.js","webpack://Kandy/../kandy/src/auth/interface/actions.js","webpack://Kandy/../kandy/src/auth/interface/api.js","webpack://Kandy/../kandy/src/auth/interface/eventTypes.js","webpack://Kandy/../kandy/src/auth/interface/events.js","webpack://Kandy/../kandy/src/auth/interface/index.js","webpack://Kandy/../kandy/src/auth/interface/name.js","webpack://Kandy/../kandy/src/auth/interface/reducers.js","webpack://Kandy/../kandy/src/auth/interface/selectors.js","webpack://Kandy/../kandy/src/basePlugins.js","webpack://Kandy/../kandy/src/call/constants.js","webpack://Kandy/../kandy/src/call/cpaas/index.js","webpack://Kandy/../kandy/src/call/cpaas/requests/calls.js","webpack://Kandy/../kandy/src/call/cpaas/requests/subscriptions.js","webpack://Kandy/../kandy/src/call/cpaas/sagas/index.js","webpack://Kandy/../kandy/src/call/cpaas/sagas/notifications.js","webpack://Kandy/../kandy/src/call/cpaas/sagas/subscriptions.js","webpack://Kandy/../kandy/src/call/cpaas/sagas/support.js","webpack://Kandy/../kandy/src/call/cpaas/utils/index.js","webpack://Kandy/../kandy/src/call/interfaceNew/actionTypes.js","webpack://Kandy/../kandy/src/call/interfaceNew/actions/call.js","webpack://Kandy/../kandy/src/call/interfaceNew/actions/index.js","webpack://Kandy/../kandy/src/call/interfaceNew/actions/turn.js","webpack://Kandy/../kandy/src/call/interfaceNew/api/call.js","webpack://Kandy/../kandy/src/call/interfaceNew/api/index.js","webpack://Kandy/../kandy/src/call/interfaceNew/constants.js","webpack://Kandy/../kandy/src/call/interfaceNew/eventTypes.js","webpack://Kandy/../kandy/src/call/interfaceNew/events.js","webpack://Kandy/../kandy/src/call/interfaceNew/index.js","webpack://Kandy/../kandy/src/call/interfaceNew/reducers/call.js","webpack://Kandy/../kandy/src/call/interfaceNew/reducers/index.js","webpack://Kandy/../kandy/src/call/interfaceNew/reducers/turn.js","webpack://Kandy/../kandy/src/call/interfaceNew/selectors.js","webpack://Kandy/../kandy/src/call/interfaceNew/utils.js","webpack://Kandy/../kandy/src/call/utils/normalization.js","webpack://Kandy/../kandy/src/call/utils/sdp.js","webpack://Kandy/../kandy/src/call/utils/state.js","webpack://Kandy/../kandy/src/callstack/call/dtmf.js","webpack://Kandy/../kandy/src/callstack/call/establish.js","webpack://Kandy/../kandy/src/callstack/call/midcall.js","webpack://Kandy/../kandy/src/callstack/call/negotiation.js","webpack://Kandy/../kandy/src/callstack/call/notifications.js","webpack://Kandy/../kandy/src/callstack/call/support.js","webpack://Kandy/../kandy/src/callstack/sdp/compareMedia.js","webpack://Kandy/../kandy/src/callstack/sdp/operations.js","webpack://Kandy/../kandy/src/callstack/sdp/pipeline.js","webpack://Kandy/../kandy/src/callstack/utils/bandwidth.js","webpack://Kandy/../kandy/src/callstack/utils/index.js","webpack://Kandy/../kandy/src/callstack/utils/sdp.js","webpack://Kandy/../kandy/src/callstack/webrtc/establish.js","webpack://Kandy/../kandy/src/callstack/webrtc/media.js","webpack://Kandy/../kandy/src/callstack/webrtc/midcall.js","webpack://Kandy/../kandy/src/callstack/webrtc/negotiation.js","webpack://Kandy/../kandy/src/common/effects/index.js","webpack://Kandy/../kandy/src/common/effects/waitFor.js","webpack://Kandy/../kandy/src/common/helpers/handleRequestError.js","webpack://Kandy/../kandy/src/common/helpers/index.js","webpack://Kandy/../kandy/src/common/utils.js","webpack://Kandy/../kandy/src/config/index.js","webpack://Kandy/../kandy/src/config/interface/actionTypes.js","webpack://Kandy/../kandy/src/config/interface/actions.js","webpack://Kandy/../kandy/src/config/interface/api.js","webpack://Kandy/../kandy/src/config/interface/index.js","webpack://Kandy/../kandy/src/config/interface/reducers.js","webpack://Kandy/../kandy/src/config/interface/selectors.js","webpack://Kandy/../kandy/src/connectivity/common/base.js","webpack://Kandy/../kandy/src/connectivity/common/sagas.js","webpack://Kandy/../kandy/src/connectivity/common/websocket.js","webpack://Kandy/../kandy/src/connectivity/cpaas/index.js","webpack://Kandy/../kandy/src/connectivity/interface/actionTypes.js","webpack://Kandy/../kandy/src/connectivity/interface/actions.js","webpack://Kandy/../kandy/src/connectivity/interface/api.js","webpack://Kandy/../kandy/src/connectivity/interface/effects.js","webpack://Kandy/../kandy/src/connectivity/interface/eventTypes.js","webpack://Kandy/../kandy/src/connectivity/interface/events.js","webpack://Kandy/../kandy/src/connectivity/interface/index.js","webpack://Kandy/../kandy/src/connectivity/interface/name.js","webpack://Kandy/../kandy/src/connectivity/interface/reducers.js","webpack://Kandy/../kandy/src/connectivity/interface/selectors.js","webpack://Kandy/../kandy/src/constants.js","webpack://Kandy/../kandy/src/docs/docs.js","webpack://Kandy/../kandy/src/errors/codes.js","webpack://Kandy/../kandy/src/errors/index.js","webpack://Kandy/../kandy/src/events/eventEmitter.js","webpack://Kandy/../kandy/src/events/index.js","webpack://Kandy/../kandy/src/events/interface/actionTypes.js","webpack://Kandy/../kandy/src/events/interface/actions.js","webpack://Kandy/../kandy/src/events/interface/api.js","webpack://Kandy/../kandy/src/events/interface/index.js","webpack://Kandy/../kandy/src/events/interface/reducers.js","webpack://Kandy/../kandy/src/factory.js","webpack://Kandy/../kandy/src/groups/cpaas/index.js","webpack://Kandy/../kandy/src/groups/cpaas/requests/groups.js","webpack://Kandy/../kandy/src/groups/cpaas/sagas/groups.js","webpack://Kandy/../kandy/src/groups/cpaas/sagas/index.js","webpack://Kandy/../kandy/src/groups/interface/actionTypes.js","webpack://Kandy/../kandy/src/groups/interface/actions.js","webpack://Kandy/../kandy/src/groups/interface/api.js","webpack://Kandy/../kandy/src/groups/interface/eventTypes.js","webpack://Kandy/../kandy/src/groups/interface/events.js","webpack://Kandy/../kandy/src/groups/interface/index.js","webpack://Kandy/../kandy/src/groups/interface/reducers.js","webpack://Kandy/../kandy/src/groups/interface/selectors.js","webpack://Kandy/../kandy/src/groups/utils.js","webpack://Kandy/../kandy/src/index.common.js","webpack://Kandy/../kandy/src/index.cpaas.js","webpack://Kandy/../kandy/src/logs/index.js","webpack://Kandy/../kandy/src/logs/interface/api.js","webpack://Kandy/../kandy/src/logs/logManager.js","webpack://Kandy/../kandy/src/logs/transformers.js","webpack://Kandy/../kandy/src/logs/utils.js","webpack://Kandy/../kandy/src/messaging/cpaas/index.js","webpack://Kandy/../kandy/src/messaging/cpaas/interface/actionTypes.js","webpack://Kandy/../kandy/src/messaging/cpaas/interface/actions/conversations.js","webpack://Kandy/../kandy/src/messaging/cpaas/interface/actions/index.js","webpack://Kandy/../kandy/src/messaging/cpaas/interface/actions/messages.js","webpack://Kandy/../kandy/src/messaging/cpaas/interface/api.js","webpack://Kandy/../kandy/src/messaging/cpaas/interface/eventTypes.js","webpack://Kandy/../kandy/src/messaging/cpaas/interface/events.js","webpack://Kandy/../kandy/src/messaging/cpaas/interface/index.js","webpack://Kandy/../kandy/src/messaging/cpaas/interface/mixins.js","webpack://Kandy/../kandy/src/messaging/cpaas/interface/reducers.js","webpack://Kandy/../kandy/src/messaging/cpaas/interface/selectors.js","webpack://Kandy/../kandy/src/messaging/cpaas/requests.js","webpack://Kandy/../kandy/src/messaging/cpaas/sagas/index.js","webpack://Kandy/../kandy/src/messaging/cpaas/sagas/messaging.js","webpack://Kandy/../kandy/src/messaging/cpaas/sagas/subscriptions.js","webpack://Kandy/../kandy/src/messaging/mappings.js","webpack://Kandy/../kandy/src/notifications/cpaas/index.js","webpack://Kandy/../kandy/src/notifications/cpaas/sagas.js","webpack://Kandy/../kandy/src/notifications/interface/actionTypes.js","webpack://Kandy/../kandy/src/notifications/interface/actions.js","webpack://Kandy/../kandy/src/notifications/interface/api.js","webpack://Kandy/../kandy/src/notifications/interface/eventTypes.js","webpack://Kandy/../kandy/src/notifications/interface/events.js","webpack://Kandy/../kandy/src/notifications/interface/index.js","webpack://Kandy/../kandy/src/notifications/interface/reducers.js","webpack://Kandy/../kandy/src/notifications/interface/selectors.js","webpack://Kandy/../kandy/src/presence/cpaas/constants.js","webpack://Kandy/../kandy/src/presence/cpaas/index.js","webpack://Kandy/../kandy/src/presence/cpaas/requests/presence.js","webpack://Kandy/../kandy/src/presence/cpaas/requests/subscriptions.js","webpack://Kandy/../kandy/src/presence/cpaas/sagas/index.js","webpack://Kandy/../kandy/src/presence/cpaas/sagas/presence.js","webpack://Kandy/../kandy/src/presence/cpaas/sagas/subscriptions.js","webpack://Kandy/../kandy/src/presence/interface/actionTypes.js","webpack://Kandy/../kandy/src/presence/interface/actions.js","webpack://Kandy/../kandy/src/presence/interface/api.js","webpack://Kandy/../kandy/src/presence/interface/eventTypes.js","webpack://Kandy/../kandy/src/presence/interface/events.js","webpack://Kandy/../kandy/src/presence/interface/index.js","webpack://Kandy/../kandy/src/presence/interface/reducers.js","webpack://Kandy/../kandy/src/presence/interface/selectors.js","webpack://Kandy/../kandy/src/request/effects.js","webpack://Kandy/../kandy/src/request/index.js","webpack://Kandy/../kandy/src/request/interface/actionTypes.js","webpack://Kandy/../kandy/src/request/interface/actions.js","webpack://Kandy/../kandy/src/subscription/cpaas/index.js","webpack://Kandy/../kandy/src/subscription/cpaas/requests.js","webpack://Kandy/../kandy/src/subscription/cpaas/sagas/channels.js","webpack://Kandy/../kandy/src/subscription/cpaas/sagas/index.js","webpack://Kandy/../kandy/src/subscription/interface/actionTypes.js","webpack://Kandy/../kandy/src/subscription/interface/actions.js","webpack://Kandy/../kandy/src/subscription/interface/api.js","webpack://Kandy/../kandy/src/subscription/interface/effects.js","webpack://Kandy/../kandy/src/subscription/interface/eventTypes.js","webpack://Kandy/../kandy/src/subscription/interface/events.js","webpack://Kandy/../kandy/src/subscription/interface/index.js","webpack://Kandy/../kandy/src/subscription/interface/name.js","webpack://Kandy/../kandy/src/subscription/interface/reducers.js","webpack://Kandy/../kandy/src/subscription/interface/selectors.js","webpack://Kandy/../kandy/src/users/cpaas/index.js","webpack://Kandy/../kandy/src/users/cpaas/requests/contacts.js","webpack://Kandy/../kandy/src/users/cpaas/requests/users.js","webpack://Kandy/../kandy/src/users/cpaas/sagas/contacts.js","webpack://Kandy/../kandy/src/users/cpaas/sagas/index.js","webpack://Kandy/../kandy/src/users/cpaas/sagas/users.js","webpack://Kandy/../kandy/src/users/cpaas/utils.js","webpack://Kandy/../kandy/src/users/interface/actions/actionTypes.js","webpack://Kandy/../kandy/src/users/interface/actions/contacts.js","webpack://Kandy/../kandy/src/users/interface/actions/users.js","webpack://Kandy/../kandy/src/users/interface/api/contacts.js","webpack://Kandy/../kandy/src/users/interface/api/index.js","webpack://Kandy/../kandy/src/users/interface/api/users.js","webpack://Kandy/../kandy/src/users/interface/events/contacts.js","webpack://Kandy/../kandy/src/users/interface/events/eventTypes.js","webpack://Kandy/../kandy/src/users/interface/events/users.js","webpack://Kandy/../kandy/src/users/interface/index.js","webpack://Kandy/../kandy/src/users/interface/reducers/contacts.js","webpack://Kandy/../kandy/src/users/interface/reducers/index.js","webpack://Kandy/../kandy/src/users/interface/reducers/users.js","webpack://Kandy/../kandy/src/users/interface/selectors.js","webpack://Kandy/../kandy/src/webrtc/channels/devices.js","webpack://Kandy/../kandy/src/webrtc/channels/index.js","webpack://Kandy/../kandy/src/webrtc/channels/media.js","webpack://Kandy/../kandy/src/webrtc/channels/mediaManager.js","webpack://Kandy/../kandy/src/webrtc/channels/session.js","webpack://Kandy/../kandy/src/webrtc/channels/sessionManager.js","webpack://Kandy/../kandy/src/webrtc/channels/track.js","webpack://Kandy/../kandy/src/webrtc/channels/trackManager.js","webpack://Kandy/../kandy/src/webrtc/index.js","webpack://Kandy/../kandy/src/webrtc/interface/actionTypes.js","webpack://Kandy/../kandy/src/webrtc/interface/actions/devices.js","webpack://Kandy/../kandy/src/webrtc/interface/actions/index.js","webpack://Kandy/../kandy/src/webrtc/interface/actions/media.js","webpack://Kandy/../kandy/src/webrtc/interface/actions/misc.js","webpack://Kandy/../kandy/src/webrtc/interface/actions/sessions.js","webpack://Kandy/../kandy/src/webrtc/interface/actions/tracks.js","webpack://Kandy/../kandy/src/webrtc/interface/api/index.js","webpack://Kandy/../kandy/src/webrtc/interface/api/media.js","webpack://Kandy/../kandy/src/webrtc/interface/eventTypes.js","webpack://Kandy/../kandy/src/webrtc/interface/events/devices.js","webpack://Kandy/../kandy/src/webrtc/interface/events/index.js","webpack://Kandy/../kandy/src/webrtc/interface/events/tracks.js","webpack://Kandy/../kandy/src/webrtc/interface/index.js","webpack://Kandy/../kandy/src/webrtc/interface/reducers/browser.js","webpack://Kandy/../kandy/src/webrtc/interface/reducers/devices.js","webpack://Kandy/../kandy/src/webrtc/interface/reducers/index.js","webpack://Kandy/../kandy/src/webrtc/interface/reducers/media.js","webpack://Kandy/../kandy/src/webrtc/interface/reducers/sessions.js","webpack://Kandy/../kandy/src/webrtc/interface/reducers/tracks.js","webpack://Kandy/../kandy/src/webrtc/interface/selectors.js","webpack://Kandy/../kandy/src/webrtc/sagas/index.js","webpack://Kandy/../kandy/src/webrtc/sagas/media.js","webpack://Kandy/../webrtc/src/constants.js","webpack://Kandy/../webrtc/src/interface/index.js","webpack://Kandy/../webrtc/src/managers/deviceManager.js","webpack://Kandy/../webrtc/src/managers/mediaManager.js","webpack://Kandy/../webrtc/src/managers/peerManager.js","webpack://Kandy/../webrtc/src/managers/sessionManager.js","webpack://Kandy/../webrtc/src/managers/trackManager.js","webpack://Kandy/../webrtc/src/models/media.js","webpack://Kandy/../webrtc/src/models/peer.js","webpack://Kandy/../webrtc/src/models/session.js","webpack://Kandy/../webrtc/src/models/track.js","webpack://Kandy/../webrtc/src/sdpUtils/extractors.js","webpack://Kandy/../webrtc/src/sdpUtils/handlers.js","webpack://Kandy/../webrtc/src/sdpUtils/pipeline.js","webpack://Kandy/../webrtc/src/sdpUtils/sdpSemantics.js","webpack://Kandy/../webrtc/src/sdpUtils/transceiverUtils.js","webpack://Kandy/../webrtc/src/utils.js"],"names":["e","t","exports","super_","prototype","constructor","value","enumerable","writable","configurable","r","Object","defineProperty","length","n","call","o","i","a","f","slice","push","apply","u","N","Math","Array","isArray","toString","test","l","c","s","d","p","g","prefilter","normalize","h","y","v","b","lhs","hasOwnProperty","m","rhs","filter","w","x","S","forEach","indexOf","isNaN","path","kind","index","item","F","color","join","groupCollapsed","group","log","text","concat","P","groupEnd","timestamp","duration","String","type","toFixed","logger","actionTransformer","titleFormatter","collapsed","colors","level","diff","started","startedTime","action","prevState","error","took","nextState","k","j","D","E","title","A","O","C","L","T","M","_","arguments","stateTransformer","errorTransformer","predicate","logErrors","diffPredicate","getState","dispatch","console","now","Date","getHours","getMinutes","getSeconds","getMilliseconds","performance","global","window","DeepDiff","observableDiff","applyDiff","applyChange","revertChange","isConflict","noConflict","transformer","defaults","createLogger","default","take","takeMaybe","put","putResolve","all","race","cps","fork","spawn","cancel","select","actionChannel","cancelled","flush","getContext","setContext","takeEvery","takeLatest","takeLeading","throttle","delay","runSaga","END","eventChannel","channel","multicastChannel","stdChannel","CANCEL","SAGA_LOCATION","detach","effects","utils","buffers","middleware","BUFFER_OVERFLOW","ON_OVERFLOW_THROW","ON_OVERFLOW_DROP","ON_OVERFLOW_SLIDE","ON_OVERFLOW_EXPAND","zeroBuffer","isEmpty","kTrue","noop","ringBuffer","limit","overflowAction","arr","pushIndex","popIndex","it","items","doubledLimit","Error","none","fixed","dropping","sliding","expanding","initialSize","matchers","CHANNEL_END_TYPE","isEnd","INVALID_BUFFER","UNDEFINED_INPUT_ERROR","buffer","closed","takers","process","is","checkForbiddenStates","input","notUndef","cb","splice","func","close","len","taker","subscribe","unsubscribe","chan","_ref","currentTakers","nextTakers","ensureCanMutateNextTakers","MULTICAST","MATCH","matcher","wildcard","SAGA_ACTION","getLocation","sagaStackToString","addSagaStack","formatLocation","fileName","lineNumber","instrumented","effectLocationAsString","effect","location","code","source","sagaLocationAsString","sagaMeta","name","flatMap","getter","reduce","acc","cancelledTasksAsString","sagaStack","cancelledTasks","firstSaga","otherSagas","crashedEffectLocation","errorMessage","meta","map","errorObject","errorStack","TAKE","PUT","ALL","RACE","CALL","CPS","FORK","JOIN","SELECT","ACTION_CHANNEL","CANCELLED","FLUSH","GET_CONTEXT","SET_CONTEXT","TEST_HINT","payload","IO","eff","asEffect","object","detached","patternOrChannel","multicastPattern","pattern","multicast","maybe","undef","resolve","getFnCallDesc","meth","fn","args","context","array","_fn","_fn2","string","_len","_key","_len2","_key2","_len3","_key3","_len4","_key4","_len5","tasks","_key5","task","_len6","_key6","SELF_CANCELLATION","selector","identity","_len7","_key7","prop","props","worker","_len8","_key8","takeEveryHelper","_len9","_key9","takeLatestHelper","_len10","_key10","takeLeadingHelper","ms","_len11","_key11","throttleHelper","bind","delayUtil","createAsEffectType","patterns","some","_predicate","symbol","matcherCreator","stringableFunc","sagaMiddlewareFactory","_objectWithoutProperties","excluded","target","sourceKeys","key","sourceSymbolKeys","propertyIsEnumerable","_ref2","_ref2$context","options","sagaMonitor","onError","effectMiddlewares","emitter","sagaMiddleware","_ref3","run","next","actionDispatched","result","assign","getMetaInfo","proc","_extends","getIteratorMetaInfo","iterator","isSagaIterator","CHANNEL_END","CHANNEL_END_SYMBOL","TASK_CANCEL","TASK_CANCEL_SYMBOL","forkQueue","mainTask","onAbort","completed","addTask","getTasks","getTaskNames","abort","err","cancelAll","cont","res","isErr","createTaskIterator","pc","done","ret","arg","parentContext","parentEffectId","_options","_log","logError","taskContext","crashedEffect","cancelledDueToErrorTasks","newTask","cancelMain","isRunning","taskQueue","end","isCancelled","_isRunning","_isCancelled","throw","return","digestEffect","isMainRunning","_result","_deferredEnd","_error","_isAborted","reject","joiners","runEffect","effectId","currCb","data","promise","resolvePromise","resolveIterator","runTakeEffect","runPutEffect","runAllEffect","runRaceEffect","runCallEffect","runCPSEffect","runForkEffect","runJoinEffect","runCancelEffect","runSelectEffect","runChannelEffect","runFlushEffect","runCancelledEffect","runGetContextEffect","runSetContextEffect","label","effectTriggered","effectSettled","effectRejected","effectResolved","effectCancelled","cancelPromise","then","_ref2$channel","takeCb","_ref4","_ref5","cpsCb","_ref6","taskIterator","_task","joiner","isAborted","taskToCancel","keys","completedCount","results","childCbs","checkEffectEnd","from","chCbAtKey","_response","response","_ref7","state","_ref8","match","id","_ref9","TASK","toPromise","def","RUN_SAGA_SIGNATURE","NON_GENERATOR_ERR","saga","_options$channel","root","MIDDLEWARE_TYPE_ERROR","effectMiddleware","compose","safeName","fsmIterator","undefined","qEnd","fsm","q0","updateState","qNext","_fsm$qNext","q","output","_updateState","yTake","yFork","ac","setAction","q1","q2","yCancel","setTask","q3","yCall","delayLength","yActionChannel","yDelay","setChannel","ch","q4","asap","suspend","queue","semaphore","exec","release","shift","createName","createSymbol","createGlobalSymbol","check","hasOwn","remove","once","deferred","arrayOfDeferred","createMockTask","autoInc","makeIterator","deprecate","konst","kFalse","property","number","obj","iterable","observable","ob","buf","pat","sym","Boolean","called","val","timeoutId","setTimeout","clearTimeout","running","setRunning","setResult","setError","seed","uid","kThrow","kReturn","thro","message","stack","deprecationWarning","updateIncentive","deprecated","preferred","internalErr","createSetContextWarning","ctx","wrapSagaDispatch","cloneableGenerator","generatorFunc","history","gen","clone","clonedGen","_return","_throw","exception","randomString","random","substring","split","ActionTypes","INIT","REPLACE","PROBE_UNKNOWN_ACTION","isPlainObject","proto","createStore","reducer","preloadedState","enhancer","currentReducer","currentState","currentListeners","nextListeners","isDispatching","ensureCanMutateNextListeners","listener","isSubscribed","listeners","replaceReducer","nextReducer","outerSubscribe","observer","TypeError","observeState","$$observable","warning","getUndefinedStateErrorMessage","actionType","actionDescription","getUnexpectedStateShapeWarningMessage","inputState","reducers","unexpectedKeyCache","reducerKeys","argumentName","unexpectedKeys","assertReducerShape","initialState","combineReducers","finalReducers","finalReducerKeys","shapeAssertionError","combination","warningMessage","hasChanged","_i","previousStateForKey","nextStateForKey","bindActionCreator","actionCreator","bindActionCreators","actionCreators","boundActionCreators","_defineProperty","_objectSpread","ownKeys","funcs","applyMiddleware","middlewares","store","_dispatch","middlewareAPI","chain","isCrushed","__DO_NOT_USE__ActionTypes","isObject","isFunction","to","concatAssignFunctions","dstObject","srcArray","propName","dstArray","combineProperties","srcObject","deepMergeAssign","merge","mergeAssign","mergeOne","dst","src","returnValue","srcValue","dstValue","newDst","srcs","createFactory","descriptor","Stamp","methods","deepProperties","properties","propertyDescriptors","initializers","inits","initializer","returnedValue","instance","stamp","createStamp","composeFunction","staticDeepProperties","staticProperties","staticPropertyDescriptors","composeImplementation","_compose","mergeComposable","dstDescriptor","srcComposable","srcDescriptor","composables","module","createCodecRemover","config","oldCallstack","currentSdp","params","newSdp","codecStringsToRemove","codec","media","finalRemoveList","filteredRtp","rtp","includes","relevantCodec","fmtpParams","fmtp","every","parseInt","replace","isNumber","payloads","rtcpFb","SUBSCRIPTION_STATE","FULL","PARTIAL","NONE","DISCONNECT_REASONS","GONE","LOST_CONNECTION","authCpaas","getLogger","defaultOptions","server","protocol","base","version","port","clientCorrelator","init","eventsMap","capabilities","api","getExposedState","prefix","CONNECT","CONNECTION_OCCURRED","CONNECT_FINISHED","GET_USER_DETAILS","USER_DETAILS_RECEIVED","DISCONNECT","DISCONNECT_FINISHED","RESUBSCRIPTION_FINISHED","REFRESH_TOKENS","REFRESH_TOKENS_FINISHED","UPDATE_SUBSCRIPTION","UPDATE_SUBSCRIPTION_FINISH","SET_TOKEN","connect","connectionOccured","connectFinished","getUserDetails","userDetailsReceived","disconnect","disconnectFinished","resubscribeFinished","refreshTokens","refreshTokensFinished","updateSubscription","updateSubscriptionFinished","setTokens","actionTypes","credentials","isSensitive","subscription","connection","platform","userInfo","isSSO","userDetailsResponse","firstName","user_first_name","lastName","user_last_name","photoURL","emailAddress","user_email","username","reason","attemptNum","accessToken","idToken","actions","debug","API_LOG_TAG","updateToken","updateConnection","getUserInfo","getConnection","isConnected","isPending","authentication","getServices","subscriptionStates","disconnectReasons","AUTH_CHANGE","AUTH_ERROR","AUTH_RESUB","eventTypes","authChangedEvent","discEvent","forced","resubEvent","isFailure","requestOptions","refreshToken","idTokenPayload","preferred_username","getAuthConfig","getSubscriptionInfo","getConnectionInfo","getDomain","getIdentity","getAuthScenario","getPlatform","getRequestInfo","pluginState","domain","servicesInfo","requested","received","missing","status","services","requestInfo","platforms","CPAAS","baseURL","token","headers","Accept","Authorization","UC","LINK","setPlatform","connInfo","logs","events","request","mapValuesToKeys","FCS_CALL_STATES","CALL_STATES_FCS","CALL_STATES","INITIATING","INITIATED","EARLY_MEDIA","RINGING","CONNECTED","ON_HOLD","ENDED","CALL_MEDIA_STATES","LOCAL_HOLD","REMOTE_HOLD","DUAL_HOLD","OPERATIONS","CHANGE_MEDIA","HOLD_MEDIA","UNHOLD_MEDIA","MUSIC_ON_HOLD","COMPLEX_OPERATIONS","DIRECT_TRANSFER","CONSULTATIVE_TRANSFER","COMPLEX_OPERATION_MESSAGES","DIRECT_TRANSFER_SUCCESS","CONSULTATIVE_TRANSFER_SUCCESS","JOIN_SUCCESS","DIRECT_TRANSFER_FAILURE","CONSULTATIVE_TRANSFER_FAILURE","JOIN_FAILURE","STATUS_CODES","CALL_DIRECTION","INCOMING","OUTGOING","BANDWIDTH_DEFAULTS","AUDIO","VIDEO","WEBRTC_DEVICE_KINDS","audioinput","videoinput","audiooutput","FCS_ICE_MEDIA_STATES","ICE_MEDIA_STATES","cpaasCalls","sagas","iceServers","urls","credential","sdpSemantics","serverTurnCredentials","trickleIceMode","sdpHandlers","removeH264Codecs","normalizeDestination","webRTC","pluginInterface","sanitizeSdesFromSdp","modifySdpBandwidth","deps","managers","wrappedSagas","createSession","answerSession","fetchCredentials","updateSession","updateSessionStatus","endSession","rejectSession","callInfo","requestBody","wrtcsSession","tParticipantAddress","participantAddress","offer","sdp","displayName","tParticipantName","method","url","body","sessionInfo","wrtcsSessionId","resourceURL","wrtcsAnswer","answer","wrtcsTurnCredentials","wrtcsOffer","wrtcsSessionStatus","statusVal","responseType","callSubscribe","callUnsubscribe","channelInfo","wrtcsNotificationSubscription","callbackReference","notifyURL","callbackURL","BasicError","subscriptionCodes","CPAAS_SERVICE_SUB_FAIL","subInfo","subscriptionId","registerCall","createCall","answerCallEntry","holdCall","unholdCall","addMediaEntry","removeMediaEntry","sendDTMFEntry","incomingCallNotification","callAcceptedNotification","callStatusNotification","callAudit","callOfferNotification","callAnswerNotification","endCallEntry","ignoreCallEntry","rejectCallEntry","getStatsEntry","setTurnCredentials","replaceTrackEntry","subSagas","notificationSagas","supportSagas","requests","establishSagas","midcallSagas","MAKE_CALL","makeCall","ANSWER_CALL","answerCall","CALL_HOLD","offerInactiveMedia","CALL_UNHOLD","offerFullMedia","ADD_MEDIA","addMedia","REMOVE_MEDIA","removeMedia","SEND_DTMF","sendDtmf","updateSessionRinging","callDeps","updateCallRinging","cpaasIncomingCall","notification","wrtcsSessionInvitationNotification","link","href","remoteName","originatorName","remoteNumber","originatorAddress","calleeNumber","incomingCall","incomingCallPattern","NOTIFICATION_RECEIVED","parseAcceptedNotification","wrtcsAcceptanceNotification","parseCallResponse","callAcceptedPattern","statusUpdatePattern","statusPattern","wrtcsEventNotification","eventType","parseStatusNotification","callStatusUpdateEnded","callStatusUpdateRinging","callStatusUpdateCancelled","actionTypesToDoAuditOn","CALL_ACCEPTED","MAKE_CALL_FINISH","auditCall","callStartAuditPattern","CALL_AUDIT","sendCallAudit","updateSessionResponse","parseOfferNotification","wrtcsOfferNotification","parseCallRequest","callOfferPattern","parseAnswerNotification","wrtcsAnswerNotification","callAnswerPattern","END_CALL","endCall","IGNORE_CALL","ignoreCall","REJECT_CALL","rejectCall","GET_STATS","getStats","callSubscribePattern","PLUGIN_SUBSCRIPTION_FINISHED","service","REPLACE_TRACK","replaceTrack","targetCall","getCallByWrtcsSessionId","closeCall","callActions","callCancelled","channels","getNotificationChannels","notificationChannels","subscriptions","callSubscription","sub","channelType","info","getOptions","turnInfo","servers","password","turnActions","turnChanged","getSessionInfoByCallId","validateCallState","callId","getCallById","callCodes","INVALID_PARAM","INVALID_STATE","webrtcSessionId","STATE_DESYNC","session","sessionManager","expected","isSubsetOf","set","whole","differences","originalSdp","mLine","crypto","fingerprint","callPrefix","PENDING_MAKE_CALL","SESSION_CREATED","MAKE_ANONYMOUS_CALL","CALL_INCOMING","CALL_RINGING","SESSION_PROGRESS","CALL_CANCELLED","ANSWER_CALL_FINISH","REJECT_CALL_FINISH","IGNORE_CALL_FINISH","END_CALL_FINISH","FORWARD_CALL","FORWARD_CALL_FINISH","PENDING_OPERATION","UPDATE_CALL","CALL_HOLD_FINISH","CALL_UNHOLD_FINISH","ADD_MEDIA_FINISH","REMOVE_MEDIA_FINISH","SEND_DTMF_FINISH","GET_STATS_FINISH","PENDING_CONSULTATIVE_TRANSFER","CONSULTATIVE_TRANSFER_FINISH","DIRECT_TRANSFER_FINISH","PENDING_JOIN","JOIN_FINISH","REPLACE_TRACK_FINISH","CALL_REMOTE_HOLD_FINISH","CALL_REMOTE_UNHOLD_FINISH","REMOTE_ADD_MEDIA_FINISH","REMOTE_REMOVE_MEDIA_FINISH","REMOTE_START_MOH_FINISH","REMOTE_STOP_MOH_FINISH","REMOTE_SLOW_START","turnPrefix","TURN_CHANGED","trackPrefix","TRACK_ADDED","TRACK_REMOVED","sessionCreated","pendingMakeCall","makeCallFinish","makeAnonymousCall","callIncoming","callRinging","sessionProgress","answerCallFinish","rejectCallFinish","callAccepted","ignoreCallFinish","endCallFinish","holdCallFinish","unholdCallFinish","addMediaFinish","removeMediaFinish","sendDTMF","sendDTMFFinish","getStatsFinish","forwardCall","forwardCallFinish","consultativeTransfer","pendingConsultativeTransfer","consultativeTransferFinish","directTransfer","directTransferFinish","pendingJoin","joinFinish","replaceTrackFinish","pendingOperation","remoteHoldFinish","remoteUnholdFinish","remoteAddMediaFinish","remoteRemoveMediaFinish","remoteStartMohFinish","remoteStopMohFinish","remoteSlowStart","updateCall","callActionHelper","callActionsImport","turnActionsImport","callAPI","make","destination","mediaConstraints","audio","audioOptions","video","videoOptions","screenShare","screen","screenOptions","ignore","hold","unhold","getAll","getById","tracks","tone","intertoneGap","trackId","forward","otherCallId","newCallId","states","MAKE","ANSWER","REJECT","IGNORE","HOLD","UNHOLD","START_MOH","STOP_MOH","SLOW_START","ENDPOINTS","LOCAL","REMOTE","OP_STATUS","ONGOING","PENDING","OP_TRANSITIONS","START","UPDATE","FINISH","CALL_OPERATION","CALL_STARTED","CALL_JOIN","CALL_STATE_CHANGE","CALL_ADDED_MEDIA","CALL_REMOVED_MEDIA","CALL_NEW_TRACK","CALL_TRACK_ENDED","STATS_RECEIVED","CALL_TRACK_REPLACED","webrtcActionTypes","callEventHandler","stateChangeHandler","prevCall","transition","previous","localHold","remoteHold","callOperationHandler","isLocal","localOp","remoteOp","operation","callEvents","startActionTypesAndOperations","startActionTypeAndOperation","otherCallAction","operationEvents","usedCallIds","newAction","finishActionTypesAndData","finichActionTypeAndData","isSlowStart","local","mediaId","newTrackId","oldTrack","oldTrackState","SESSION_NEW_TRACK","SESSION_TRACK_ENDED","callEnder","startTime","endTime","remoteParticipant","callReducers","newCall","displayNumber","participantName","direction","isCaller","isAnonymous","account","bandwidth","webrtcId","newState","payloadWithoutTransition","callState","callIds","endedCall","isJoinedCall","callReducer","specificCallActions","updatedCall","calls","turn","getCalls","getActiveCalls","getCallByWebrtcSessionId","getTurnInfo","addTracksToCall","localTracks","remoteTracks","endedStates","find","getOperationMeta","setOperationState","opType","opMeta","parts","validPrefixes","prefixes","validSuffixes","suffixes","pop","stateProp","current","operationData","normalizeSipUri","extractDomainFromAddress","addressString","indexOfAtSymbol","lastIndexOf","substr","separateAddressAndDomain","defaultDomainString","extractedDomain","address","extractPrependedData","inputString","prependedDataMatches","extractLeadingSpecialCharacters","potentialLeadingChars","actualLeadingChars","withoutVisualSeparators","isPhoneNumber","cleanNumber","phoneNumberMatch","processAddress","processDomain","domainString","trim","resultingAddressAndDomain","prepend","leadingChars","setMediaInactive","hasMediaFlowing","hasMusicOnHold","regex","objectSdp","sdpTransform","parse","isVideoInactive","isAudioInactive","isMusicOnHold","getMediaState","hasMedia","isLocalHold","isRemoteHold","isDualHold","playOutBand","playInBand","hasTelephoneEvent","convertTone","splitTones","remoteDesc","canSendOutBand","GENERIC_ERROR","gap","Number","track","localTrack","stream","AudioContext","createMediaStreamSource","dest","createMediaStreamDestination","newTrack","getAudioTracks","peer","addTones","targetNode","tones","oscillators","createOscillator","oscNode","createGain","gain","scheduleTone","start","dur","frequency","setValueAtTime","toneSequence","toneStart","currentTime","numTones","delayTime","stop","stringSdp","hasCodec","matches","offerSdp","sessionId","mediaIds","setupCall","stateError","webrtcInfo","sessionOptions","answerWebrtcSession","removeUnusedLocalTracks","answerSDP","forwardSession","generateOffer","INVALID_OFFER","callBandwidth","finalBandwidth","medias","webRtcAddMedia","webRtcRemoveMedia","currentCall","directTransferSession","otherCall","currentStateError","otherStateError","otherWrtcsSessionId","consultativeTransferSessions","joinSessions","currentCallRemoteName","otherCallRemoteName","currentCallRemoteAddress","otherCallRemoteAddress","newWrtcsSessionId","webRtcReplaceTrack","handleUpdateRequest","handleSlowUpdateRequest","handleUpdateResponse","handleSlowUpdateResponse","getCallAction","mediaState","mediaDiff","compareMedia","getOperation","isMediaFlowing","callAction","sameSession","isSameSdpSessionId","recreatePeer","handleOffer","remote","mediaDirections","slowOffer","answerSdp","receivedAnswer","finishAction","mediaFlowing","undesired","dir","callStatusUpdateFailed","receiveEarlyMedia","negotiation","uuidV4","setupIncomingCall","updateStatusResponse","retryAfter","reasonText","statusCode","endParams","customStatusCode","runPipeline","endpoint","delayMs","summarizeMedia","compareSummary","MEDIA_TRANSITIONS","STOP","SAME","prevSdpString","sdpString","prevSdp","prevMedia","currMedia","removed","added","changed","unchanged","prevM","currM","sectionId","changes","sending","receiving","sdpMedia","mid","ssrcGroups","willSend","willReceive","msid","ssrcs","ssrc","attribute","summary","change","wasHold","wasUnhold","wasAddMedia","wasRemoveMedia","wasStartMoh","wasStopMoh","wasNoChange","hadMediaFlowing","stoppedFlowing","sameMedia","didChange","allStopped","notSending","notReceiving","stillStopped","startedFlowing","noUnchangedSend","onlyStartChanges","onlyStartSending","onlyStartReceiving","wasntRemoved","somethingStarted","addedSending","changedSending","wasntAdded","wasChanged","onlyStopSending","onlyAudioChange","inactiveUnchanged","stopSendAudio","noChange","hasUnchanged","unchangedFlowing","changedFlowing","wasSending","wasReceiving","removedFlowing","addedFlowing","handlers","handler","write","checkBandwidthControls","bandwidthControls","finalBandwidthControls","changeDtlsRoleTo","role","changeDtlsRole","original","setup","generateBandwidthConfigs","hasSameSessionId","firstSdpSessionId","secondSdpSessionId","mediaOps","createLocal","rtcConfig","allTracks","eachMedia","screenShareContraints","screenShareMedia","errMessage","constraint","USER_MEDIA_ERROR","mediaStates","eachMediaState","localTracksToRemove","invalidTrackIds","oldTrackKind","finalMediaConstraints","newMedias","createLocalError","allNewTracks","newTracks","replaceTrackError","currentDesc","remoteDescription","sameId","localTracksIsSending","trackIdsToRemove","localTrackId","tracksToRemove","newRole","errorInfo","waitFor","WAIT_SAGA_CONTEXT","processTake","waitContext","numFinishedWaits","numTotalWaits","trace","waitSaga","timeout","waitPatterns","waitSagaContext","waitTasks","timeoutResult","handleRequestError","requestError","serviceException","policyException","formatString","variables","messageId","mergeValues","toQueryString","autoRestart","objects","leftValue","rightValue","stringifiedParams","paramParser","stringify","autoRestarting","shouldRestart","configImplementation","PREFIX","CONFIG_UPDATE","update","values","pluginName","configApi","getConfig","updateConfig","newConfigValues","getConfiguration","baseConnectivity","responsibleParty","connCheckResponsibility","CLIENT","wsConnectFlow","websocketLifecycle","serverPingFlow","clientPingFlow","connectWebsocket","WS_ATTEMPT_CONNECT","wsConnectAction","wsInfo","isReconnect","websocket","kandy","getConnectivityConfig","wsReconnectFailed","wsConnectFinished","lastContact","emitTask","wsEmitter","pingFlow","SERVER","closeWebsocketPattern","WS_DISCONNECT","closeWebsocket","wsDisconnectFinished","notificationChannel","oauthToken","access_token","wsAttemptConnect","ws","maxMissedPings","autoReconnect","timeOfLastPing","pingInterval","getPingInterval","maxIdleDuration","serverPing","expiry","RECEIVE_SERVER_PING","WS_DISCONNECT_FINISHED","pingIntervalMillis","connCheck","interval","changePingInterval","connAck","_sendWSMessage","lostConnection","warn","checkConnectivity","timeOfLastPong","shouldCheck","getCheckConnectivity","intervalInSeconds","connCheckMethods","PING_PONG","KEEP_ALIVE","message_type","shouldCheckConnectivity","delayStartTime","serverPong","RECEIVE_SERVER_PONG","timeElapsed","timeUntilNextPing","readyState","send","configs","connectionAttempt","disconnectWebsocketPattern","reconnectLimit","openWebsocket","reconnectTimeLimit","reconnectDelay","pow","reconnectTimeMultiplier","INITIAL_BUFFER_SIZE","WebSocket","validateWS","onOpen","onopen","onerror","onclose","onmessage","createWsChannel","emit","JSON","wsChannel","connectivity","defaultValues","WS_CONNECT_FINISHED","WS_RECONNECT_FAILED","WS_CLOSED","WS_ERROR","CHANGE_CONNECTIVITY_CHECKING","CHANGE_PING_INTERVAL","createWsAction","wsDisconnect","wsClosed","wsError","receiveServerPing","receiveServerPong","changeConnectivityChecking","connectivityApi","getSocketState","enableConnectivityChecking","enable","disconnectWebsocket","websocketInfo","responseAction","WS_CHANGE","connected","pinging","getConnectionState","notificationTypes","WEBSOCKET","PUSH","authCodes","INVALID_CREDENTIALS","CONNECT_FAIL_WS_ERROR","LINK_UNSUBSCRIBE_FAIL","LINK_SUBSCRIBE_FAIL","LINK_EXTEND_SUBSCRIPTION_FAIL","LINK_UPDATE_SUBSCRIPTION_FAIL","UC_SUBSCRIBE_FAIL","UC_REFRESH_TOKEN_FAIL","UC_CREATE_TOKEN_FAIL","UC_EXTEND_SUBSCRIPTION_FAIL","UC_DISCONNECT_FAIL","MISSING_SERVICE","UNKNOWN_ERROR","INIT_MEDIA_FAILED","NOT_SUPPORTED","callHistoryCodes","BAD_REQUEST","NOT_FOUND","clickToCallCodes","MISSING_ARGS","RESPONSE_ERROR","groupsCodes","MISSING_PARAMETERS","messagingCodes","CREATE_GROUP_FAIL","MARK_READ_FAIL","REMOVE_MEMBERS_FAIL","ADD_MEMBERS_FAIL","SEND_MESSAGE_FAIL","FETCH_MESSAGES_FAIL","FILE_UPLOAD_FAIL","FETCH_CONVERSATIONS_FAIL","INVALID_DESTINATION","INVALID_FILE_PARTS","SET_IS_TYPING_FAIL","mwiCodes","FETCH_MWI_FAIL","sipEventCodes","NOT_PROVISIONED","NOT_SUBSCRIBED","bridgeCodes","INVALID_INPUT","ALREADY_EXISTS","MEDIA_NOT_FOUND","WS_CONNECTION_ERROR","CPAAS_WSREQUEST_FAIL","CPAAS_WSREVOKE_FAIL","CPAAS_WSREFRESH_FAIL","CPAAS_SERVICE_UNSUB_FAIL","CPAAS_UNSUBSCRIBE_FAIL","presenceCodes","INVALID_STATUS","INVALID_ACTIVITY","usersCodes","UNKNOWN","REFRESH_CONTACTS_FAIL","DIRECTORY_REQUEST_FAIL","eventEmitter","eventMap","subscribeMap","strictMode","checkEvent","define","alias","on","off","list","setStrictMode","strict","eventsImplementation","EVENTS_ON","EVENTS_OFF","EVENTS_SUBSCRIBE","EVENTS_UNSUBSCRIBE","EVENTS_ALIAS","EVENTS_EMIT","MAP_EVENTS","mapper","event","mapEvents","emitEvent","aliasEvent","mapping","eventReducer","aliases","count","factory","isNormalProperty","get","factoryDefaults","enableReduxDevTools","allowProxy","plugins","selectors","initSagas","shared","primitives","loggerMiddleware","plugin","objValue","mixins","baseStamp","objName","rootSaga","composeMiddleware","composeWithDevTools","composeWithoutDevTools","selectState","exposedState","publicAPI","getCapabilities","getVersion","createRequest","deleteRequest","addParticipantRequest","removeParticipantRequest","leaveGroupRequest","fetchRequest","fetchRequestByGroupId","acceptInvitationRequest","rejectInvitationRequest","groupOwner","currentUser","participants","groupChatSessionInformation","participant","subject","groupId","participantInformation","isAdmin","groupSessions","groupChatSessionInformationList","groups","participantSessionStatus","createGroup","deleteGroup","addParticipant","removeParticipant","leaveGroup","fetch","acceptInvitation","rejectInvitation","handleInvitationNotification","handleParticipantStatusNotification","handleEventNotification","createFinish","participantInvites","requestParams","newGroup","deleteGroupFinish","deletedGroup","addParticipantFinish","newParticipant","removeParticipantFinish","leaveGroupFinish","fetchGroupsFinish","acceptInvitationFinish","rejectInvitationFinish","wsAction","groupChatSessionInvitationNotification","linkInfo","rel","invitation","invitationReceived","chatParticipantStatusNotification","statusNotificationReceived","chatEventNotification","eventNotificationReceived","processCreateGroup","processDeleteGroup","processAddParticipant","processRemoveParticipant","receiveInvitationNotification","receiveParticipantStatusNotification","receiveEventNotification","groupSagas","CREATE_GROUP","DELETE_GROUP","ADD_PARTICIPANT","REMOVE_PARTICIPANT","LEAVE_GROUP","FETCH_GROUPS","ACCEPT_INVITATION","REJECT_INVITATION","ADD_PARTICIPANT_FINISH","REMOVE_PARTICIPANT_FINISH","DELETE_GROUP_FINISH","FETCH_GROUPS_FINISH","CREATE_GROUP_FINISH","LEAVE_GROUP_FINISH","ACCEPT_INVITATION_FINISH","REJECT_INVITATION_FINISH","INVITATION_RECEIVED","STATUS_NOTIFICATION_RECEIVED","EVENT_NOTIFICATION_RECEIVED","fetchGroups","create","leave","actionFormatter","groupsApi","getAllGroups","getGroup","getParticipants","getInvitations","delete","GROUP_NEW","GROUP_CHANGE","GROUP_DELETE","GROUP_REFRESH","GROUP_INVITATION_RECEIVED","GROUP_ERROR","groupChangedEvent","member","invitations","invite","groupWithId","changedParticipant","remapParticipants","marshallGroup","remappedParticipant","groupNotification","image","commonIndex","pluginInstances","common","defaultPlugins","basePlugins","auth","webrtc","messaging","notifications","presence","users","getLogManager","logLevel","flatten","logActions","actionOnly","exposePayloads","enableFcsLogs","logMgr","flattenActions","updateManager","components","getLevel","logLevels","INFO","actionOptions","excludeActions","transformers","LogManager","levels","SILENT","ERROR","WARN","DEBUG","TRACE","enableGrouping","toUpperCase","setLevel","loggers","_logMgr","Logger","getName","logHandler","logItem","msg","parseLogMessage","LogItem","isVerboseEnabled","logMessage","parseActionMessage","parseMessage","getActionType","actionArgs","setupTransformers","actionPipeline","actionTransformers","removePayloads","passwordHider","isSafe","time","cpaasMessaging","features","CREATE_CONVERSATION","SEND_MESSAGE","SEND_MESSAGE_FINISH","MESSAGE_RECEIVED","INCOMING_MESSAGE_READ","SEND_MESSAGE_READ","SEND_MESSAGE_READ_FINISH","CLEAR_MESSAGES","CLEAR_MESSAGES_FINISH","DELETE_CONVERSATION","DELETE_CONVERSATION_FINISH","DELETE_MESSAGE","DELETE_MESSAGE_FINISH","FETCH_CONVERSATIONS","FETCH_CONVERSATIONS_FINISHED","UPDATE_CONVERSATION","FETCH_MESSAGES","FETCH_MESSAGES_FINISHED","RECEIVE_DELIVERY_RECEIPT","SET_IS_TYPING","SET_IS_TYPING_FINISHED","GET_IMAGE_LINKS","GET_IMAGE_LINKS_FINISH","createConversation","fetchConversations","fetchConversationsFinished","updateConversation","deleteConversation","deleteConversationFinish","setIsTyping","setIsTypingFinished","messages","isTypingList","conversations","conversation","senderAddress","messageActionsImport","convoActionsImport","messageActions","convoActions","messageReceived","sendMessageReadFinish","fetchMessages","fetchMessagesFinished","clearMessages","deleteMessage","deleteMessageFinish","getImageLinks","getImageLinksFinish","sendMessageHelper","read","messageReadHelper","deliveryReceiptReceived","deliveryStatus","sendMessage","sendMessageFinish","sender","chatTypes","ONETOONE","newConversation","incomingMessageRead","sendMessageRead","amount","rawURL","messagingApi","chatTypeAliases","recipient","description","Conversation","lastReceived","lastPull","recipients","toLowerCase","prevConv","CONVERSATIONS_NEW","CONVERSATIONS_CHANGE","MESSAGES_CHANGE","MESSAGES_ERROR","IS_TYPING_LIST_CHANGE","MESSAGING_ERROR","conversationBase","groupIndex","createMessage","part","messageContext","isGroup","Message","getMessages","getMessage","convo","isFetchingLinks","mixinMessage","markRead","deleteMessages","messageIds","subscriber","subscriberWrapper","conversationId","conversationHistory","conversationIsTyping","isTyping","typingState","messageBase","convoContext","dateInSeconds","withParts","addPart","validationResponse","validatePart","multimediaLinks","createImageLinks","validTypeFlag","sendMessageFinishHelper","errors","getMessagingConfig","getConversations","findConversation","findMember","conv","members","setIsTypingRequest","uploadFile","sendChatMessageRequest","sendGroupChatMessageRequest","deleteChatConversationRequest","deleteChatMessageRequest","chatSubscribe","chatUnsubscribe","sendSMSRequest","smsInboundSubscribe","smsInboundUnsubscribe","smsOutboundSubscribe","smsOutboundUnsubscribe","fetchConversationsRequest","fetchMessagesRequest","fetchImageLinks","_marshalData","attributes","accum","refresh","GROUP","isComposing","contenttype","lastactive","file","formData","FormData","reqInfo","placeholderData","flags","flag","append","responseData","attachment","textParts","fileParts","chatMessage","SMS","legitError","chatNotificationSubscription","outboundSMSMessageRequest","outboundSMSTextMessage","destinationAddress","deliveryReceiptSubscription","chatSession","chatSessionList","chatMessageList","FETCH_IMAGE_LINKS_FAIL","blob","registerChat","registerInboundSMS","registerOutboundSMS","sendChatMessage","receiveChatMessageNotification","sendSMS","receiveSMS","receiveDeliveryReceipt","fetchChatMessages","receiveIsTypingNotification","messagingSagas","subsSagas","chatSubscription","chatUnsubscription","smsInboundSubscription","smsInboundUnsubscription","sendChatPattern","incomingChatMessagePattern","chatMessageNotification","handleChatMessageNotification","sendSMSPattern","incomingSMSPattern","inboundSMSMessageNotification","handleIncomingSMS","deliveryReceiptPattern","handleDeliveryReceipts","fetchConversationPattern","isTypingPattern","getImageLinksPattern","sessionType","getNotificationType","chatResponse","chatType","attachmentParts","uploadResponseList","filePart","chatMediaParts","allParts","finishInfo","deleteResponse","messagingConfig","smsFrom","dateTime","messageType","existingConversation","textPart","size","deliveryInfo","deliveryInfoNotification","DeliveryStatuses","deliveryInfoList","inboundSMSMessage","senderAdress","chatSessions","remoteAddress","localAddress","sessionDetails","lastText","lastPullTime","lastMessageTime","lastMessage","messageList","responseList","URL","createObjectURL","notificationType","resourceType","getResourceType","search","smsOutboundSubscription","smsOutboundUnsubscription","smsSubscription","DeliveredToNetwork","DeliveredToTerminal","DeliveryImpossible","Unknown","sms","im","idCacheLength","pluginOptions","processNotifications","findNotificationId","getNotificationConfig","idCache","isDuplicate","PROCESS_NOTIFICATION","getNotificationsInfo","channelEnabled","notificationId","notificationReceived","processNotificationFinish","PROCESS_NOTIFICATION_FINISH","ENABLE_NOTIFICATION_CHANNEL","ENABLE_NOTIFICATION_CHANNEL_FINISH","websocketNotification","externalNotification","enableNotificationChannel","enableNotificationChannelFinish","notificationHelper","notificationApi","registerPush","deregisterPush","enableWebsocket","NOTI_CHANGE","NOTI_ERROR","NOTI_RECEIVED","enabled","newChannelState","defaultState","EXTERNAL","STATUS","OPEN","CLOSED","ACTIVITY","AVAILABLE","BUSY","LUNCH","VACATION","ON_THE_PHONE","ACTIVITIES_UNKNOWN","ACTIVITIES_OTHER","augmentedApi","newApi","statuses","activities","publish","createList","deleteList","getList","getPresenceLists","retrievePresence","addUser","removeUser","activity","note","presenceSource","person","overridingWillingnessValue","activityValue","other","user","presenceList","presenceContact","presenceListId","presenceListCollection","adhocPresenceList","presentityUserId","userId","presenceListSubscription","registerPresence","subscribePresence","unsubscribePresence","updatePresence","fetchPresence","receivePresence","subscriptionSagas","presenceSagas","presenceSubscribe","presenceUnsubscribe","SUBSCRIBE","UNSUBSCRIBE","GET","presenceNotification","handleIncomingPresence","activityMapUcToCPaaS","active","idle","away","lunch","busy","vacation","unknown","statusMapUcToCPaaS","open","updatePresenceFinish","presenceValues","getPresenceFinish","presenceSubscription","subscribePresenceFinish","unsubscribePresenceFinish","presenceReceived","presenceListResponse","newListResponse","lastIndex","UPDATE_FINISH","GET_FINISH","SUBSCRIBE_FINISH","UNSUBSCRIBE_FINISH","RECEIVED","CREATE_PRESENCE_LIST","CREATE_PRESENCE_LIST_FINISH","DELETE_PRESENCE_LIST","GET_PRESENCE_LIST","getPresence","createPresenceList","deletePresenceList","getPresenceList","createListFinish","CREATE_LIST_FINISH","presenceApi","storedUsers","getAllPresence","getSelf","getSelfPresence","SELF_CHANGE","presenceError","self","loading","userIds","contact","presenceObject","requestSaga","commonOptions","requestAction","RESPONSE","requestId","Promise","responseTypes","json","contentTypes","jsonType","vdnJsonType","plainTextType","xmlTextType","octetStream","watchRequests","REQUEST","handleRequest","makeRequest","queryParams","fetchOptions","contentType","ok","statusText","responseBody","isJson","responseClone","__testonly__","nextRequestId","generateRequestId","createSubcriptionPlugin","channelLifetime","subscriptionFlow","onConnectionLostEntry","requestWebsocket","deleteChannel","revokeWebsocket","refreshWebsocket","subscriptionInfo","connectivityInfo","req","expires","channelId","subscriptionURL","notificationChannelLifetime","extendResponse","ensureChannelOpen","openWebsocketChannel","closeChannel","channelResponse","success","channelOpened","getSubscriptionConfig","channelData","channelURL","connectionInfo","wsOpenOrError","wsState","closeAction","refreshWebsocketSaga","onConnectionLost","connectivityActionTypes","subscriptionChannel","subscribeFinished","subResponses","subscribeForServices","unsubResponses","unsubscribeServices","unsubscribeFinished","subscribedServices","getSubscribedServices","closeResponse","channelClosed","registeredServices","getRegisteredServices","notRegistered","validServices","subscriptionConfig","doPluginSubscriptions","notSubscribed","doPluginUnsubscriptions","PLUGIN_UNSUBSCRIPTION_FINISHED","resultServices","resultAction","resubTriggers","SUBSCRIBE_FINISHED","resubDelay","UNSUBSCRIBE_FINISHED","REGISTER_SUB_SERVICE","PLUGIN_SUBSCRIPTION","PLUGIN_UNSUBSCRIPTION","CHANNEL_OPENED","CHANNEL_CLOSED","registerService","reportSubscriptionFinished","reportUnsubscriptionFinished","subscriptionApi","resubscribe","getSubscriptions","subscribed","available","subscribeSaga","unsubscribeSaga","serviceSubscribePattern","serviceUnsubscribePattern","SUB_CHANGE","SUB_ERROR","subChangeEvent","pendingChange","removeSubscription","cpaasUsers","contactsEvents","usersEvents","addContactRequest","updateContactRequest","deleteContactRequest","fetchContactRequest","refreshContactsRequest","contactId","contactCollection","directorySearch","directoryId","mapSearchKey","validKeys","directoryItemList","addContact","updateContact","removeContact","fetchContact","refreshContacts","contactBody","addContactFinish","updateContactFinish","removeContactFinish","fetchContactFinish","refreshContactsFinish","contacts","localContactFromRemote","searchDirectory","fetchUser","fetchSelfInfo","contactsSagas","usersSagas","ADD_CONTACT","UPDATE_CONTACT","REMOVE_CONTACT","FETCH_CONTACT","REFRESH_CONTACTS","SEARCH_DIRECTORY","FETCH_USER","FETCH_SELF_INFO","filters","searchDirectoryFinish","directoryItem","localUserFromRemote","sortBy","order","fetchUserFinish","userName","fetchSelfInfoFinish","remoteContactFromLocal","formattedContact","attributeList","newContact","omittedKeys","contactData","primaryContact","ADD_CONTACT_FINISH","REFRESH_CONTACTS_FINISH","REMOVE_CONTACT_FINISH","UPDATE_CONTACT_FINISH","FETCH_CONTACT_FINISH","FETCH_USER_FINISH","FETCH_SELF_INFO_FINISH","SEARCH_DIRECTORY_FINISH","contactsAPI","add","objectToUse","usersAPI","contactNewEvent","CONTACTS_CHANGE","contactsChangeEvent","CONTACTS_ERROR","addContactFinishActions","CONTACTS_NEW","DIRECTORY_CHANGE","DIRECTORY_ERROR","contactsPendingReducer","contactsReducers","usersReducers","getContacts","getContact","getUsers","getUser","allUsers","watchDeviceEvents","setListeners","manager","managerChannel","checkDevices","devices","deviceActions","devicesChanged","watchManagers","watchTrackManagerEvents","watchSessionManagerEvents","watchMediaManagerEvents","watchMediaEvents","mediaChannel","mediaActions","mediaNewTrack","trackRemoved","mediaTrackRemoved","trackEnded","mediaTrackEnded","mediaStopped","mediaManagerEventsHandler","MEDIA_NEW","newMedia","getTracks","removedMedia","watchSessionEvents","sessionChannel","sessionActions","sessionNewTrack","sessionTrackRemoved","sessionTrackEnded","trackReplaced","oldTrackId","sessionTrackReplaced","onChange","sessionChange","SESSION_ADDED","sessionAdded","sessionRemoved","watchTrackEvents","trackChannel","trackData","trackManagerEventsHandler","trackAdded","trackActions","initializeStack","webRtcPlugin","details","browser","miscActions","setBrowserDetails","DEVICES_CHANGE","RENDER_TRACKS","RENDER_TRACKS_FINISH","REMOVE_TRACKS","REMOVE_TRACKS_FINISH","MUTE_TRACKS","MUTE_TRACKS_FINISH","UNMUTE_TRACKS","UNMUTE_TRACKS_FINISH","sessionPrefix","SESSION_REMOVED","SESSION_TRACK_REMOVED","SESSION_CHANGE","SESSION_TRACK_REPLACED","mediaPrefix","MEDIA_REMOVED","MEDIA_CHANGE","MEDIA_NEW_TRACK","MEDIA_TRACK_REMOVED","MEDIA_TRACK_ENDED","SET_BROWSER_DETAILS","deviceActionsImport","trackActionsImport","sessionActionsImport","mediaActionsImport","miscActionsImport","mediaActionHelper","sessionActionHelper","muteTracks","muteTracksFinish","unmuteTracks","unmuteTracksFinish","renderTracks","renderTracksFinish","removeTracks","removeTracksFinish","trackManagerHelper","trackHelper","trackIds","getBrowserDetails","mediaAPI","getDevices","getTrackById","cssSelector","DEVICES_CHANGED","TRACKS_MUTED","TRACKS_UNMUTED","deviceEvents","trackEvents","camera","microphone","speaker","sessions","mediaReducers","removeTrack","mediaReducer","specificMediaActions","removeSession","sessionReducers","newLocalTracks","sessionReducer","specificSessionActions","containers","removeContainer","container","muted","getSessions","getSessionById","getMedia","getMediaById","getMediaByCallId","localMedia","remoteMedia","mediaSagas","speakerId","filteredTracks","PEER","TRICKLE_ICE","HALF","ICE_GATHERING_STATE","NEW","GATHERING","COMPLETE","ENDPOINT","SDP_SEMANTICS","PLAN_B","UNIFIED_PLAN","MEDIA_DIR","INACTIVE","SEND_ONLY","RECV_ONLY","SEND_RECV","initialize","browserDetails","adapter","deviceManager","DeviceManager","trackManager","TrackManager","mediaManager","MediaManager","peerManager","PeerManager","SessionManager","models","Track","Media","Peer","pipeline","sdpPipeline","EventEmitter","recentDeviceChange","navigator","mediaDevices","addEventListener","enumerateDevices","device","catch","browserContraintsWorkaround","constraints","deviceId","exact","setupMedia","mediaStream","nativeTrack","wrappedTrack","addTrack","constraintsWorkaround","getUserMedia","createLocalScreen","getDisplayMedia","createRemote","findTrack","allMedia","getTrack","peers","Session","targetTrack","getStream","setStream","nativeStream","onremovetrack","has","removedTrack","cleanup","renderIn","element","removeFrom","moveTo","defaultConfig","removeBundling","iceTimeout","halfTrickleThreshold","isPassedHalfTrickleThreshold","iceCandidate","passedHalf","candidate","peerId","peerConnection","RTCPeerConnection","iceTimer","Timer","dtlsRole","onicecandidate","haveHalf","localDescription","timeFromStart","onicegatheringstatechange","gatheringState","iceGatheringState","ontrack","streams","targetStream","MediaStream","getLocalTracks","getSenders","getRemoteTracks","getReceivers","receiver","localDesc","getLocalDescription","signalingState","createOffer","removeTrickleIce","createAnswer","preventDtlsRoleChange","getRemoteDescription","setLocalDescription","sessionDesc","localRole","isStarted","setRemoteDescription","remoteRole","findTransceiver","transceivers","getTransceivers","transceiver","targetTransceiver","findReusableTransceiver","currentDirection","findIndex","addIceCandidate","handleToneChangeEvent","insertDTMF","callback","dtmf","dtmfSender","ontonechange","senders","errMsg","setTransceiversDirection","targetDirection","failures","getDtlsRole","setDtlsRole","targetRole","dtlsRoleRecord","latestRemoteDescription","setupPeerEventHandlers","recordNewDtlsRole","remoteSdpSessionId","warmup","addTracks","addTrackOrReuseTransceiverPromises","reusableTransceiver","audioTransceiverTargetDir","videoTransceiverTargetDir","getHandlers","getLocalTracksIsSendingStatus","tracksIsSending","sdpObj","directions","processOffer","previousDtlsRole","generateAnswer","processAnswer","DTMFOptions","sendOptions","targetPeer","trackToCleanup","oldPeer","newPeer","oldLocalTrack","getPeer","getLatestRemoteDesc","mediaTrack","onended","newStream","streamId","disabled","document","querySelector","renderer","createElement","style","height","width","autoplay","play","setSinkId","appendChild","rendererId","removeChild","mute","unmute","getConstraints","setConstraints","constr","getContainers","getSdpSessionId","oLine","changeMediaDirection","iceOptions","isValid","createPipeline","defaultHandlers","setHandlers","isUnifiedPlan","getSdpSemanticsList","setTransceiverDirection","setDirection","makeSafeForCSS"],"mappings":"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;AACA;AACA;AACA;AACA;AACA,uBAAuB,OAAO;AAC9B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,6BAA6B;AAC7B,0BAA0B;AAC1B,0BAA0B;AAC1B,qBAAqB;AACrB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,8EAA8E,OAAO;AACrF;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC,qBAAqB;AACrB,0BAA0B;AAC1B,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;;;;;;;AC/IA;AACA,cAAc,mBAAO,CAAC,wDAAY;AAClC,WAAW,mBAAO,CAAC,oEAAwB;AAC3C;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACRa;AACb,aAAa,mBAAO,CAAC,uDAAW;AAChC,cAAc,mBAAO,CAAC,uDAAW;AACjC,WAAW,mBAAO,CAAC,qDAAS;AAC5B,YAAY,mBAAO,CAAC,sDAAU;AAC9B,WAAW,mBAAO,CAAC,qDAAS;AAC5B,kBAAkB,mBAAO,CAAC,6DAAiB;AAC3C,YAAY,mBAAO,CAAC,uDAAW;AAC/B,iBAAiB,mBAAO,CAAC,4DAAgB;AACzC,eAAe,mBAAO,CAAC,0DAAc;AACrC,qBAAqB,mBAAO,CAAC,kEAAsB;AACnD,SAAS,mBAAO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B;AACtD;AACA,iCAAiC,SAAS,EAAE;AAC5C,CAAC,YAAY;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,SAAS,qBAAqB;AAC3D,iCAAiC,aAAa;AAC9C;AACA,GAAG,YAAY;AACf;AACA;;;;;;;;ACrBA;AACA,UAAU;AACV;;;;;;;;ACFA;;;;;;;;ACAA;;;;;;;;ACAA,WAAW,mBAAO,CAAC,oDAAQ;AAC3B,eAAe,mBAAO,CAAC,0DAAc;AACrC,UAAU,mBAAO,CAAC,oDAAQ;AAC1B,cAAc,mBAAO,CAAC,0DAAc;AACpC;AACA;AACA;AACA;AACA,cAAc,mBAAO,CAAC,sDAAU;AAChC,iDAAiD;AACjD,CAAC;AACD;AACA,qBAAqB;AACrB;AACA,SAAS;AACT,GAAG,EAAE;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACpDA,aAAa,mBAAO,CAAC,uDAAW;AAChC,gBAAgB,mBAAO,CAAC,qDAAS;AACjC;AACA;AACA;AACA,aAAa,mBAAO,CAAC,oDAAQ;;AAE7B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,uCAAuC,sBAAsB,EAAE;AAC/D;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;;;;;;;;ACpEa;AACb;AACA,gBAAgB,mBAAO,CAAC,2DAAe;;AAEvC;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA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CA;AACA;;;;;;;;ACJA,WAAW,mBAAO,CAAC,qDAAS;AAC5B,aAAa,mBAAO,CAAC,uDAAW;AAChC;AACA,kDAAkD;;AAElD;AACA,qEAAqE;AACrE,CAAC;AACD;AACA,QAAQ,mBAAO,CAAC,wDAAY;AAC5B;AACA,CAAC;;;;;;;;ACXD;AACA,eAAe,mBAAO,CAAC,0DAAc;AACrC,gBAAgB,mBAAO,CAAC,2DAAe;AACvC,cAAc,mBAAO,CAAC,oDAAQ;AAC9B;AACA;AACA;AACA;AACA;;;;;;;;ACRA,gBAAgB,mBAAO,CAAC,2DAAe;AACvC,cAAc,mBAAO,CAAC,wDAAY;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AChBA,UAAU,mBAAO,CAAC,oDAAQ;AAC1B,aAAa,mBAAO,CAAC,uDAAW;AAChC,WAAW,mBAAO,CAAC,qDAAS;AAC5B,UAAU,mBAAO,CAAC,2DAAe;AACjC,aAAa,mBAAO,CAAC,uDAAW;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,mBAAO,CAAC,oDAAQ;AACtB;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACnFA,gBAAgB,mBAAO,CAAC,2DAAe;AACvC;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACLA;AACA,cAAc,mBAAO,CAAC,wDAAY;AAClC,cAAc,mBAAO,CAAC,wDAAY;AAClC;AA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CT,OAAO;AACP;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,mBAAmB,kCAAkC;AACrD,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,eAAe,uCAAuC;AACtD;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH,kBAAkB,yBAAyB,KAAK;AAChD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,wBAAwB;AACxB,gBAAgB;AAChB,oBAAoB;AACpB,wBAAwB;AACxB,gBAAgB;AAChB,oBAAoB;AACpB;AACA,uBAAuB,mBAAO,CAAC,6DAAiB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0DAA0D,oBAAoB;AAC9E,mBAAO,CAAC,kEAAsB;AAC9B,mBAAO,CAAC,4DAAgB;AACxB,UAAU,mBAAO,CAAC,qDAAS;;AAE3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,gDAAgD,mBAAO,CAAC,4DAAgB;AACxE;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,CAAC;;;;;;;;;AC7RY;AACb,UAAU,mBAAO,CAAC,0DAAc;;AAEhC;AACA,mBAAO,CAAC,4DAAgB;AACxB,6BAA6B;AAC7B,cAAc;AACd;AACA,CAAC;AACD;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA,UAAU;AACV,CAAC;;;;;;;;;AChBY;AACb;AACA,aAAa,mBAAO,CAAC,uDAAW;AAChC,UAAU,mBAAO,CAAC,oDAAQ;AAC1B,kBAAkB,mBAAO,CAAC,4DAAgB;AAC1C,cAAc,mBAAO,CAAC,uDAAW;AACjC,eAAe,mBAAO,CAAC,yDAAa;AACpC,WAAW,mBAAO,CAAC,qDAAS;AAC5B,aAAa,mBAAO,CAAC,sDAAU;AAC/B,aAAa,mBAAO,CAAC,uDAAW;AAChC,qBAAqB,mBAAO,CAAC,kEAAsB;AACnD,UAAU,mBAAO,CAAC,oDAAQ;AAC1B,UAAU,mBAAO,CAAC,oDAAQ;AAC1B,aAAa,mBAAO,CAAC,wDAAY;AACjC,gBAAgB,mBAAO,CAAC,2DAAe;AACvC,eAAe,mBAAO,CAAC,0DAAc;AACrC,cAAc,mBAAO,CAAC,yDAAa;AACnC,eAAe,mBAAO,CAAC,0DAAc;AACrC,eAAe,mBAAO,CAAC,0DAAc;AACrC,eAAe,mBAAO,CAAC,0DAAc;AACrC,gBAAgB,mBAAO,CAAC,2DAAe;AACvC,kBAAkB,mBAAO,CAAC,6DAAiB;AAC3C,iBAAiB,mBAAO,CAAC,8DAAkB;AAC3C,cAAc,mBAAO,CAAC,8DAAkB;AACxC,cAAc,mBAAO,CAAC,gEAAoB;AAC1C,YAAY,mBAAO,CAAC,4DAAgB;AACpC,YAAY,mBAAO,CAAC,4DAAgB;AACpC,UAAU,mBAAO,CAAC,0DAAc;AAChC,YAAY,mBAAO,CAAC,4DAAgB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAsB;AACtB,sBAAsB,uBAAuB,WAAW,IAAI;AAC5D,GAAG;AACH,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;AACD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;AACA,KAAK;AACL;AACA,sBAAsB,mCAAmC;AACzD,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,gCAAgC;AAChG;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,EAAE,mBAAO,CAAC,4DAAgB;AAC1B,EAAE,mBAAO,CAAC,2DAAe;AACzB;;AAEA,sBAAsB,mBAAO,CAAC,wDAAY;AAC1C;AACA;;AAEA;AACA;AACA;AACA;;AAEA,0DAA0D,kBAAkB;;AAE5E;AACA;AACA;AACA,oBAAoB,uBAAuB;;AAE3C,oDAAoD,6BAA6B;;AAEjF;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH,0BAA0B,eAAe,EAAE;AAC3C,0BAA0B,gBAAgB;AAC1C,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA,8CAA8C,YAAY,EAAE;;AAE5D;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,OAAO,QAAQ,iCAAiC;AACpG,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,oCAAoC,mBAAO,CAAC,qDAAS;AACrD;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACrPA;AACA,mBAAO,CAAC,oEAAwB;;;;;;;;ACDhC;AACA,mBAAO,CAAC,kEAAsB;;;;;;;;ACD9B;AACA,cAAc,mBAAO,CAAC,uDAAW;;AAEjC,uCAAuC,SAAS,mBAAO,CAAC,mEAAuB,UAAU;;;;;;;;ACHzF;AACA,cAAc,mBAAO,CAAC,uDAAW;AACjC,eAAe,mBAAO,CAAC,gEAAoB;;AAE3C;AACA;AACA;AACA;AACA,CAAC;;;;;;;;ACRD;AACA,cAAc,mBAAO,CAAC,uDAAW;AACjC,cAAc,mBAAO,CAAC,gEAAoB;;AAE1C;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;ACRD;AACa;AACb,cAAc,mBAAO,CAAC,uDAAW;AACjC,WAAW,mBAAO,CAAC,qDAAS;AAC5B,aAAa,mBAAO,CAAC,uDAAW;AAChC,yBAAyB,mBAAO,CAAC,oEAAwB;AACzD,qBAAqB,mBAAO,CAAC,gEAAoB;;AAEjD,2CAA2C;AAC3C;AACA;AACA;AACA;AACA,8DAA8D,UAAU,EAAE;AAC1E,KAAK;AACL;AACA,8DAA8D,SAAS,EAAE;AACzE,KAAK;AACL;AACA,CAAC,EAAE;;;;;;;;;ACnBU;AACb;AACA,cAAc,mBAAO,CAAC,uDAAW;AACjC,2BAA2B,mBAAO,CAAC,uEAA2B;AAC9D,cAAc,mBAAO,CAAC,wDAAY;;AAElC,+BAA+B;AAC/B;AACA;AACA;AACA;AACA,CAAC,EAAE;;;;;;;;ACXH,mBAAO,CAAC,2DAAe;;;;;;;;ACAvB,mBAAO,CAAC,2DAAe;;;;;;;;ACAvB,mBAAO,CAAC,kEAAsB;AAC9B,aAAa,mBAAO,CAAC,uDAAW;AAChC,WAAW,mBAAO,CAAC,qDAAS;AAC5B,gBAAgB,mBAAO,CAAC,0DAAc;AACtC,oBAAoB,mBAAO,CAAC,oDAAQ;;AAEpC;AACA;AACA;AACA;AACA;;AAEA,eAAe,yBAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AClBa;AACb,uBAAuB,EAAE;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA,iBAAiB,mBAAmB;AACpC;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA,gBAAgB,oBAAoB;AACpC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;;;;;;;;AC7Fa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,EAAE;AACb,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,aAAa;AACxB,WAAW,gBAAgB;AAC3B,WAAW,SAAS;AACpB,WAAW,EAAE;AACb,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,aAAa;AACxB,WAAW,gBAAgB;AAC3B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,yDAAyD,OAAO;AAChE;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yCAAyC,SAAS;AAClD;AACA;;AAEA;AACA,GAAG;AACH;AACA;;AAEA,eAAe,YAAY;AAC3B;;AAEA;AACA,2DAA2D;AAC3D,+DAA+D;AAC/D,mEAAmE;AACnE,uEAAuE;AACvE;AACA,0DAA0D,SAAS;AACnE;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,WAAW,SAAS;AACpB,WAAW,EAAE;AACb,aAAa,aAAa;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,WAAW,SAAS;AACpB,WAAW,EAAE;AACb,aAAa,aAAa;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,WAAW,SAAS;AACpB,WAAW,EAAE;AACb,WAAW,QAAQ;AACnB,aAAa,aAAa;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,2DAA2D,YAAY;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,aAAa,aAAa;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI,IAA6B;AACjC;AACA;;;;;;;;;AC/UA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,cAAc;AACd;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA,iCAAiC,QAAQ;AACzC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;AACA,sCAAsC,QAAQ;AAC9C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;;AAEA;AACA,QAAQ,yBAAyB;AACjC;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;;;;;;;;AC/bA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,8CAA8C,mBAAmB;AACjE;AACA;;AAEA;AACA;AACA,wCAAwC,oBAAoB;AAC5D;AACA;;AAEA;AACA;AACA,8CAA8C,4BAA4B;AAC1E;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA,6DAA6D;AAC7D,eAAe;AACf;AACA,eAAe;AACf,oFAAoF;AACpF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe;AACf;AACA,eAAe;AACf;AACA,eAAe;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,oCAAoC,uBAAuB;AAC3D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA,6CAA6C,0BAA0B;AACvE;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,qCAAqC,0BAA0B,eAAe;AAC9E;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,aAAa;;AAEb;AACA,WAAW;AACX;AACA;AACA,OAAO;;;AAGP;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,MAAM,IAA0C;AAChD,IAAI,mCAAO;AACX;AACA,KAAK;AAAA,oGAAC;AACN,GAAG,MAAM,EAIN;AACH,CAAC;;;;;;;;;ACjfD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACtBA;AACA;AACA;AACA;AACA;AACA;;AAEa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAM,IAAqC;AAC3C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,0CAA0C,yBAAyB,EAAE;AACrE;AACA;AACA;;AAEA,0BAA0B;AAC1B;AACA;AACA;;AAEA;;;;;;;;AChDA;;AAEA;AACA;AACA;AACA;AACA,sBAAsB;AACtB,sBAAsB;AACtB,sBAAsB;;AAEtB;AACA;AACA;AACA;AACA,wBAAwB;;AAExB;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,gBAAgB;AAChB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACvCA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;;;;;;;ACrCA,WAAW,mBAAO,CAAC,2CAAQ;;AAE3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;;;;;;;;AChCa;;AAEb,wBAAwB,mBAAO,CAAC,wDAAqB;;AAErD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;;;;;;;;ACzBA;AAAA;AAA8B;;AAE9B;AACA,aAAa,gDAAI;;AAEF,qEAAM,EAAC;;;;;;;;;ACLtB;AAAA;AAAA;AAAA;AAAkC;AACM;AACU;;AAElD;AACA;AACA;;AAEA;AACA,qBAAqB,kDAAM,GAAG,kDAAM;;AAEpC;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,6DAAS;AACf,MAAM,kEAAc;AACpB;;AAEe,yEAAU,EAAC;;;;;;;;;AC3B1B;AAAA;AACA;;AAEe,yEAAU,EAAC;;;;;;;;;;ACH1B;AAAA;AAAoC;;AAEpC;AACA,mBAAmB,2DAAO;;AAEX,2EAAY,EAAC;;;;;;;;;ACL5B;AAAA;AAAkC;;AAElC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qBAAqB,kDAAM,GAAG,kDAAM;;AAEpC;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEe,wEAAS,EAAC;;;;;;;;;AC7CzB;AAAA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEe,6EAAc,EAAC;;;;;;;;;ACrB9B;AAAA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEe,sEAAO,EAAC;;;;;;;;;ACdvB;AAAA;AAA0C;;AAE1C;AACA;;AAEA;AACA,WAAW,sDAAU;;AAEN,mEAAI,EAAC;;;;;;;;;ACRpB;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,QAAQ;AACrB;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe,2EAAY,EAAC;;;;;;;;;AC5B5B;AAAA;AAAA;AAAA;AAA0C;AACI;AACD;;AAE7C;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,gEAAY,WAAW,8DAAU;AACxC;AACA;AACA,cAAc,gEAAY;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe,4EAAa,EAAC;;;;;;;;AC7D7B,QAAQ,mBAAO,CAAC,yCAAc;AAC9B,iBAAiB,mBAAO,CAAC,8CAAmB;;;;;;;;ACD5C,cAAc,mBAAO,CAAC,0CAAY;AAClC,qBAAqB,mBAAO,CAAC,6CAAe;;AAE5C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB,aAAa,SAAS;AACtB;AACA;AACA;AACA,sBAAsB,yCAAyC;AAC/D,mBAAmB,yCAAyC;AAC5D;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB,aAAa,SAAS;AACtB;AACA;AACA;AACA,sBAAsB,mBAAmB;AACzC,mBAAmB,gBAAgB;AACnC;;AAEA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,aAAa,SAAS;AACtB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;;AAE1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,aAAa,OAAO;AACpB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,aAAa,OAAO;AACpB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,aAAa,OAAO;AACpB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,aAAa;AAC1B,eAAe,OAAO;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,eAAe,SAAS;AACxB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uCAAuC;;AAEvC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB,aAAa,OAAO;AACpB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB,aAAa,SAAS;AACtB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB,aAAa,SAAS;AACtB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;;AAEA;;;;;;;;ACxjBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,aAAa;AAC7B,oBAAoB,aAAa;AACjC,kBAAkB,aAAa;AAC/B,sBAAsB,aAAa;AACnC,kBAAkB,aAAa;AAC/B,sBAAsB,aAAa;AACnC,iBAAiB,aAAa;AAC9B,oBAAoB,aAAa;AACjC,eAAe,aAAa;AAC5B,mBAAmB,aAAa;AAChC,cAAc,aAAa;AAC3B,mBAAmB,aAAa;AAChC,cAAc,aAAa;AAC3B,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACrWA;AACA;AACA;AACA,UAAU;AACV;AACA;;;;;;;;ACLA;AACA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AEA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA,qEAAqE;AACrE,WAAW;AACX;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA,eAAe;AACf;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,CAAC;;;;;;;;ACzPD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC;;AAErC;AACA;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;AACA,4BAA4B,UAAU;;;;;;;;;ACvLtC;AAAgB;AAChB,iEAAiE,aAAa;AAC9E;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,0FAA0F,eAAe;AACzG;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,CAAC,E;;;;;;;;AC5BD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkC;AACU;AACJ;AACF;AACE;AACA;AACY;;AAEpD;AACA,SAAS,+DAAQ,UAAU,iEAAU,UAAU,+DAAQ;AACvD;;AAEA;AACA,MAAM,8DAAO;AACb;AACA;;AAEA;AACA;;AAEe;AACf,6EAA6E,aAAa;AAC1F;AACA;;AAEA,EAAE,gDAAS;AACX,4CAA4C,uDAAQ,OAAO,gEAAqB;AAChF;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;AChCA;AAAA;AAAA;AAAO;AACA,iC;;;;;;;;ACDP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkC;AACU;AACJ;AACJ;AAC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rF;AAAA;AAAA;AAAA,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9N;;AAEhC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,YAAY;AACvB,aAAa,SAAS;AACtB;AACe;AACf,wEAAwE,aAAa;AACrF;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,kBAAkB,gDAAO;;AAEzB,wBAAwB;AACxB;AACA,OAAO;AACP;AACA;AACA,C;;;;;;;;AC/CA;AAAA;AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;AACe;AACf;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;AC9CA;AAAA;AAAA;AAAA;AAAA;AAA4C;AACQ;AACd;;AAEtC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,+CAA+C,wDAAW;;AAE1D;AACA;AACA;;AAEA,OAAO,uEAAa;AACpB,mEAAmE;AACnE;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2CAA2C,OAAO,wDAAW,OAAO;;AAEpE;AACA;AACA;;AAEA;AACA,mCAAmC,aAAa;AAChD,+HAA+H,wDAAW;AAC1I;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA;AACe;AACf;AACA;AACA,iBAAiB,wBAAwB;AACzC;;AAEA,QAAQ,IAAqC;AAC7C;AACA,QAAQ,8DAAO;AACf;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAM,IAAqC;AAC3C;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,QAAQ,IAAqC;AAC7C;AACA;AACA,QAAQ,8DAAO;AACf;AACA;;AAEA;AACA;AACA,oBAAoB,8BAA8B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;ACjIA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA,WAAW,YAAY;AACvB,aAAa,SAAS;AACtB;AACA;AACA;;AAEe;AACf,kEAAkE,aAAa;AAC/E;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH,C;;;;;;;;AC/BA;AAAA;AAAA;AAAA;AAAA;AAAoD;AACP;;AAE7C;AACA;AACA;AACA;AACA;AACA;AACO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA;AACA,aAAa,IAAI;AACjB;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA,eAAe,MAAM;AACrB;AACA;AACA,EAAiB;AACjB;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,IAAI;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,SAAS,uEAAa;AACtB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA,mBAAmB,sBAAsB;AACzC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB,eAAe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAc,yBAAyB;AACvC;;AAEA;AACA;AACA,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA,mBAAmB,aAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA,KAAK,OAAO,yDAAY;AACxB;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,YAAY,yBAAyB;;AAErC;AACA;AACA;AACA;AACA;AACA,GAAG,QAAQ,yDAAY;AACvB,C;;;;;;;;ACvPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACQ;AACM;AACN;AAChB;AACM;;AAEtC;AACA;AACA;AACA;AACA;;AAEA,IAAI,KAAqC;AACzC,EAAE,8DAAO;AACT;;;;;;;;;;ACfA;AAAA;AAAA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa;AACb;AACe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,C;;;;;;;ACpBA;AACA;AACA;AACA;AACA,GAAG;AACH,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,OAAO,eAAe;AACtB,OAAO,sBAAsB;AAC7B,OAAO,cAAc;AACrB,OAAO,gBAAgB;AACvB,OAAO,gBAAgB;AACvB,OAAO,oBAAoB;AAC3B,OAAO,kBAAkB;AACzB,UAAU;AACV,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK,kCAAkC,UAAU;AACjD,+BAA+B;AAC/B;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,KAAK,+BAA+B,eAAe,WAAW;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK,0BAA0B,aAAa;AAC5C,2BAA2B,WAAW;AACtC;AACA;AACA;AACA;AACA,qBAAqB;AACrB,sCAAsC;AACtC,yBAAyB;AACzB,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA,gCAAgC;AAChC,gCAAgC,EAAE;AAClC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC;;;;;;;;ACjXD,aAAa,mBAAO,CAAC,gDAAU;AAC/B,aAAa,mBAAO,CAAC,gDAAU;;AAE/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACVA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,+CAA+C;;AAE/C;;AAEA;AACA;AACA;AACA;;AAEA,cAAc,mBAAO,CAAC,iDAAW;AACjC;;AAEA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;AACA,kBAAkB,kBAAkB;AACpC,uCAAuC;AACvC;;AAEA,mBAAmB,kCAAkC;AACrD;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH,wBAAwB;AACxB;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA,sBAAsB,6BAA6B;AACnD;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,8EAA8E;AAC9E,GAAG;AACH;;AAEA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;;;;;;;AC3HA,cAAc,mBAAO,CAAC,iDAAW;;AAEjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,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xB,CAAP;AACD;;AAGD;;;;;;;;;;;;;;;;AAgBA;;;;;;;AAOA;;;;;AAKApd,QAAQ,SAAR,IAAqBod,OAArB;AACAkN,OAAOtqB,OAAP,GAAiBA,QAAQ,SAAR,CAAjB;AACA,mC;;;;;;;;ACxPA;AAAA;AAAA;AACqC;;AAErC;;AAEA;AACA;AACA,CAAC;AACD;AACA,CAAC;AACD;AACA,CAAC,UAAU,IAA6B;AACxC;AACA,CAAC,MAAM,EAEN;;AAED,aAAa,4DAAQ;AACN,qEAAM,EAAC;;;;;;;;;;AClBtB;AAAA;AAAe;AACf;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;;;;;;;;AChBA;AACA;AACA;AACA,mBAAmB,mBAAO,CAAC,qCAAQ;AACnC,mBAAmB,mBAAO,CAAC,iCAAM;;AAEjC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;;;;;;;;AC3LA,YAAY,mBAAO,CAAC,2CAAe;;AAEnC;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;;AAEA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;ACnBA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;;AAEA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;ACjEA,YAAY,mBAAO,CAAC,wCAAY;;AAEhC;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;;AAEA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;ACpBA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,uBAAuB,SAAS;AAChC;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4CAA4C,KAAK;;AAEjD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA,mCAAmC,OAAO;AAC1C;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;AAGA;AACA;AACA,yDAAyD;AACzD;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA,WAAW;AACX;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mBAAmB,mBAAO,CAAC,oDAAoB;;AAE/C;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA,WAAW,SAAS;AACpB;AACA,mBAAmB,mBAAO,CAAC,iDAAU;;AAErC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,mBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAmB,sBAAsB;AACzC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,kCAAkC;AAC7D,2BAA2B,mDAAmD;AAC9E;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AC9rBA;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;ACvBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,iCAAiC;;AAEjC;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;;AAEA;AACA,sBAAsB,QAAQ;AAC9B;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;ACjCA,UAAU,mBAAO,CAAC,4CAAW;AAC7B,kBAAkB,mBAAO,CAAC,4CAAmB;;AAE7C;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,oBAAoB,SAAS;AAC7B;AACA;AACA;;AAEA;AACA;;AAEA;;;;;;;;AC5BA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;ACrBA,mFAAa,GAAG,IAAsD,EAAE,mBAAmB,KAAK,UAAgO,CAAC,aAAa,0BAA0B,mBAAmB,kBAAkB,gBAAgB,UAAU,UAAU,0CAA0C,gBAAgB,OAAC,OAAO,oBAAoB,8CAA8C,kCAAkC,YAAY,YAAY,mCAAmC,iBAAiB,eAAe,sBAAsB,oBAAoB,kDAAkD,WAAW,YAAY,SAAS,SAAS,KAAK;;AAE5zB,CAAC,GAAG;AACJ;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB;AACpB,0BAA0B;AAC1B;AACA;AACA;AACA,yDAAyD;AACzD,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL,iDAAiD;AACjD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,kBAAkB,OAAO;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,CAAC,GAAG;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,iCAAiC,sBAAsB;;AAEvD,CAAC,qIAAqI;AACtI,CAAC,EAAE,yBAAyB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,CAAC,EAAE,kIAAkI;;AAErI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,eAAe;AACf,4BAA4B;AAC5B;;AAEA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,eAAe;AACf,4BAA4B;AAC5B;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ,sBAAsB;AAC3C;AACA;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW;AACX;AACA,+DAA+D;AAC/D;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,WAAW;AACX;AACA,SAAS;;AAET;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,eAAe;AACf;AACA,WAAW;AACX;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,oCAAoC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,YAAY;AACvE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,eAAe;AACf,aAAa;AACb;AACA,gDAAgD;AAChD;AACA;AACA,yDAAyD,oBAAoB;AAC7E,yDAAyD;AACzD;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,iBAAiB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL,GAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA,CAAC,EAAE,qBAAqB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC,mCAAmC;AACnC;AACA;AACA,aAAa;AACb,WAAW;AACX,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,gCAAgC;AAC3D;AACA;AACA,+BAA+B,wBAAwB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA,eAAe;AACf,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA,iBAAiB;AACjB,eAAe;AACf;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,iCAAiC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,8BAA8B;AAC9B,oCAAoC,EAAE;AACtC,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,gEAAgE;AAC7E,aAAa;AACb;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,cAAc;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,cAAc;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC;AACpC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,0DAA0D;AAC1D;AACA;AACA;AACA,KAAK;AACL,4DAA4D;AAC5D;AACA;AACA;AACA,KAAK,OAAO;AACZ;AACA;AACA;;AAEA;AACA;AACA;;AAEA,CAAC,GAAG,EAAE,GAAG;AACT,CAAC;;;;;;;;;;;;;;;kBC3yGuBuqB,kB;;AA3BxB;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;AAyBe,SAASA,kBAAT,CAA4BC,MAA5B,EAAoC;AAC/C,QAAG,CAACA,MAAJ,EAAW;AACPA,iBAAS,EAAT;AACH;AACD;AACAA,aAASA,OAAOtb,GAAP,CAAW;AAAA,eAAS,OAAO5L,IAAP,KAAgB,QAAhB,GAA2B,EAAE+K,MAAM/K,IAAR,EAA3B,GAA4CA,IAArD;AAAA,KAAX,CAAT;;AAEA,WAAO,YAAoB;AACvB;AACA;AACA;AACA;AACA;AACA,YAAImnB,eAAe,IAAnB;AACA,YAAIC,mBAAJ;;AAPuB,0CAARC,MAAQ;AAARA,kBAAQ;AAAA;;AAQvB,YAAIA,OAAO,CAAP,EAAUD,UAAd,EAA0B;AACtBA,yBAAaC,OAAO,CAAP,EAAUD,UAAvB;AACH,SAFD,MAEO,IAAIC,OAAOhqB,MA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;AACA,eAAOqa,eAAeE,OAAO,CAAP,EAAUnV,IAAV,CAAeoV,MAAf,CAAf,GAAwCA,MAA/C;AACH,KA7GD;AA8GH,C;;;;;;;;AChJY;AACb,wBAAwB,mBAAO,CAAC,kDAAmB;AACnD,wBAAwB,mBAAO,CAAC,kDAAsB;AACtD,qBAAqB,mBAAO,CAAC,4CAAgB;;AAE7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;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","file":"kandy.cpaas.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Kandy\"] = factory();\n\telse\n\t\troot[\"Kandy\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"../kandy/src/index.cpaas.js\");\n","module.exports = { \"default\": require(\"core-js/library/fn/array/from\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/json/stringify\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/map\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/assign\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/create\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/define-properties\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/define-property\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/entries\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/freeze\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/get-own-property-descriptor\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/get-own-property-symbols\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/get-prototype-of\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/keys\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/object/values\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/promise\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/symbol\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/symbol/for\"), __esModule: true };","module.exports = { \"default\": require(\"core-js/library/fn/symbol/iterator\"), __esModule: true };","\"use strict\";\n\nexports.__esModule = true;\n\nvar _assign = require(\"../core-js/object/assign\");\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _assign2.default || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};","\"use strict\";\n\nexports.__esModule = true;\n\nexports.default = function (obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n};","require('../../modules/es6.string.iterator');\nrequire('../../modules/es6.array.from');\nmodule.exports = require('../../modules/_core').Array.from;\n","var core = require('../../modules/_core');\nvar $JSON = core.JSON || (core.JSON = { stringify: JSON.stringify });\nmodule.exports = function stringify(it) { // eslint-disable-line no-unused-vars\n  return $JSON.stringify.apply($JSON, arguments);\n};\n","require('../modules/es6.object.to-string');\nrequire('../modules/es6.string.iterator');\nrequire('../modules/web.dom.iterable');\nrequire('../modules/es6.map');\nrequire('../modules/es7.map.to-json');\nrequire('../modules/es7.map.of');\nrequire('../modules/es7.map.from');\nmodule.exports = require('../modules/_core').Map;\n","require('../../modules/es6.object.assign');\nmodule.exports = require('../../modules/_core').Object.assign;\n","require('../../modules/es6.object.create');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function create(P, D) {\n  return $Object.create(P, D);\n};\n","require('../../modules/es6.object.define-properties');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function defineProperties(T, D) {\n  return $Object.defineProperties(T, D);\n};\n","require('../../modules/es6.object.define-property');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function defineProperty(it, key, desc) {\n  return $Object.defineProperty(it, key, desc);\n};\n","require('../../modules/es7.object.entries');\nmodule.exports = require('../../modules/_core').Object.entries;\n","require('../../modules/es6.object.freeze');\nmodule.exports = require('../../modules/_core').Object.freeze;\n","require('../../modules/es6.object.get-own-property-descriptor');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function getOwnPropertyDescriptor(it, key) {\n  return $Object.getOwnPropertyDescriptor(it, key);\n};\n","require('../../modules/es6.symbol');\nmodule.exports = require('../../modules/_core').Object.getOwnPropertySymbols;\n","require('../../modules/es6.object.get-prototype-of');\nmodule.exports = require('../../modules/_core').Object.getPrototypeOf;\n","require('../../modules/es6.object.keys');\nmodule.exports = require('../../modules/_core').Object.keys;\n","require('../../modules/es7.object.values');\nmodule.exports = require('../../modules/_core').Object.values;\n","require('../modules/es6.object.to-string');\nrequire('../modules/es6.string.iterator');\nrequire('../modules/web.dom.iterable');\nrequire('../modules/es6.promise');\nrequire('../modules/es7.promise.finally');\nrequire('../modules/es7.promise.try');\nmodule.exports = require('../modules/_core').Promise;\n","require('../../modules/es6.symbol');\nmodule.exports = require('../../modules/_core').Symbol['for'];\n","require('../../modules/es6.symbol');\nrequire('../../modules/es6.object.to-string');\nrequire('../../modules/es7.symbol.async-iterator');\nrequire('../../modules/es7.symbol.observable');\nmodule.exports = require('../../modules/_core').Symbol;\n","require('../../modules/es6.string.iterator');\nrequire('../../modules/web.dom.iterable');\nmodule.exports = require('../../modules/_wks-ext').f('iterator');\n","module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n","module.exports = function () { /* empty */ };\n","module.exports = function (it, Constructor, name, forbiddenField) {\n  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {\n    throw TypeError(name + ': incorrect invocation!');\n  } return it;\n};\n","var isObject = require('./_is-object');\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n","var forOf = require('./_for-of');\n\nmodule.exports = function (iter, ITERATOR) {\n  var result = [];\n  forOf(iter, false, result.push, result, ITERATOR);\n  return result;\n};\n","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n","// 0 -> Array#forEach\n// 1 -> Array#map\n// 2 -> Array#filter\n// 3 -> Array#some\n// 4 -> Array#every\n// 5 -> Array#find\n// 6 -> Array#findIndex\nvar ctx = require('./_ctx');\nvar IObject = require('./_iobject');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar asc = require('./_array-species-create');\nmodule.exports = function (TYPE, $create) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  var create = $create || asc;\n  return function ($this, callbackfn, that) {\n    var O = toObject($this);\n    var self = IObject(O);\n    var f = ctx(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var val, res;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      val = self[index];\n      res = f(val, index, O);\n      if (TYPE) {\n        if (IS_MAP) result[index] = res;   // map\n        else if (res) switch (TYPE) {\n          case 3: return true;             // some\n          case 5: return val;              // find\n          case 6: return index;            // findIndex\n          case 2: result.push(val);        // filter\n        } else if (IS_EVERY) return false; // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;\n  };\n};\n","var isObject = require('./_is-object');\nvar isArray = require('./_is-array');\nvar SPECIES = require('./_wks')('species');\n\nmodule.exports = function (original) {\n  var C;\n  if (isArray(original)) {\n    C = original.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n","// 9.4.2.3 ArraySpeciesCreate(originalArray, length)\nvar speciesConstructor = require('./_array-species-constructor');\n\nmodule.exports = function (original, length) {\n  return new (speciesConstructor(original))(length);\n};\n","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./_cof');\nvar TAG = require('./_wks')('toStringTag');\n// ES3 wrong here\nvar ARG = cof(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (e) { /* empty */ }\n};\n\nmodule.exports = function (it) {\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","'use strict';\nvar dP = require('./_object-dp').f;\nvar create = require('./_object-create');\nvar redefineAll = require('./_redefine-all');\nvar ctx = require('./_ctx');\nvar anInstance = require('./_an-instance');\nvar forOf = require('./_for-of');\nvar $iterDefine = require('./_iter-define');\nvar step = require('./_iter-step');\nvar setSpecies = require('./_set-species');\nvar DESCRIPTORS = require('./_descriptors');\nvar fastKey = require('./_meta').fastKey;\nvar validate = require('./_validate-collection');\nvar SIZE = DESCRIPTORS ? '_s' : 'size';\n\nvar getEntry = function (that, key) {\n  // fast case\n  var index = fastKey(key);\n  var entry;\n  if (index !== 'F') return that._i[index];\n  // frozen object case\n  for (entry = that._f; entry; entry = entry.n) {\n    if (entry.k == key) return entry;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {\n    var C = wrapper(function (that, iterable) {\n      anInstance(that, C, NAME, '_i');\n      that._t = NAME;         // collection type\n      that._i = create(null); // index\n      that._f = undefined;    // first entry\n      that._l = undefined;    // last entry\n      that[SIZE] = 0;         // size\n      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);\n    });\n    redefineAll(C.prototype, {\n      // 23.1.3.1 Map.prototype.clear()\n      // 23.2.3.2 Set.prototype.clear()\n      clear: function clear() {\n        for (var that = validate(this, NAME), data = that._i, entry = that._f; entry; entry = entry.n) {\n          entry.r = true;\n          if (entry.p) entry.p = entry.p.n = undefined;\n          delete data[entry.i];\n        }\n        that._f = that._l = undefined;\n        that[SIZE] = 0;\n      },\n      // 23.1.3.3 Map.prototype.delete(key)\n      // 23.2.3.4 Set.prototype.delete(value)\n      'delete': function (key) {\n        var that = validate(this, NAME);\n        var entry = getEntry(that, key);\n        if (entry) {\n          var next = entry.n;\n          var prev = entry.p;\n          delete that._i[entry.i];\n          entry.r = true;\n          if (prev) prev.n = next;\n          if (next) next.p = prev;\n          if (that._f == entry) that._f = next;\n          if (that._l == entry) that._l = prev;\n          that[SIZE]--;\n        } return !!entry;\n      },\n      // 23.2.3.6 Set.prototype.forEach(callbackfn, thisArg = undefined)\n      // 23.1.3.5 Map.prototype.forEach(callbackfn, thisArg = undefined)\n      forEach: function forEach(callbackfn /* , that = undefined */) {\n        validate(this, NAME);\n        var f = ctx(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3);\n        var entry;\n        while (entry = entry ? entry.n : this._f) {\n          f(entry.v, entry.k, this);\n          // revert to the last existing entry\n          while (entry && entry.r) entry = entry.p;\n        }\n      },\n      // 23.1.3.7 Map.prototype.has(key)\n      // 23.2.3.7 Set.prototype.has(value)\n      has: function has(key) {\n        return !!getEntry(validate(this, NAME), key);\n      }\n    });\n    if (DESCRIPTORS) dP(C.prototype, 'size', {\n      get: function () {\n        return validate(this, NAME)[SIZE];\n      }\n    });\n    return C;\n  },\n  def: function (that, key, value) {\n    var entry = getEntry(that, key);\n    var prev, index;\n    // change existing entry\n    if (entry) {\n      entry.v = value;\n    // create new entry\n    } else {\n      that._l = entry = {\n        i: index = fastKey(key, true), // <- index\n        k: key,                        // <- key\n        v: value,                      // <- value\n        p: prev = that._l,             // <- previous entry\n        n: undefined,                  // <- next entry\n        r: false                       // <- removed\n      };\n      if (!that._f) that._f = entry;\n      if (prev) prev.n = entry;\n      that[SIZE]++;\n      // add to index\n      if (index !== 'F') that._i[index] = entry;\n    } return that;\n  },\n  getEntry: getEntry,\n  setStrong: function (C, NAME, IS_MAP) {\n    // add .keys, .values, .entries, [@@iterator]\n    // 23.1.3.4, 23.1.3.8, 23.1.3.11, 23.1.3.12, 23.2.3.5, 23.2.3.8, 23.2.3.10, 23.2.3.11\n    $iterDefine(C, NAME, function (iterated, kind) {\n      this._t = validate(iterated, NAME); // target\n      this._k = kind;                     // kind\n      this._l = undefined;                // previous\n    }, function () {\n      var that = this;\n      var kind = that._k;\n      var entry = that._l;\n      // revert to the last existing entry\n      while (entry && entry.r) entry = entry.p;\n      // get next entry\n      if (!that._t || !(that._l = entry = entry ? entry.n : that._t._f)) {\n        // or finish the iteration\n        that._t = undefined;\n        return step(1);\n      }\n      // return step by kind\n      if (kind == 'keys') return step(0, entry.k);\n      if (kind == 'values') return step(0, entry.v);\n      return step(0, [entry.k, entry.v]);\n    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);\n\n    // add [@@species], 23.1.2.2, 23.2.2.2\n    setSpecies(NAME);\n  }\n};\n","// https://github.com/DavidBruant/Map-Set.prototype.toJSON\nvar classof = require('./_classof');\nvar from = require('./_array-from-iterable');\nmodule.exports = function (NAME) {\n  return function toJSON() {\n    if (classof(this) != NAME) throw TypeError(NAME + \"#toJSON isn't generic\");\n    return from(this);\n  };\n};\n","'use strict';\nvar global = require('./_global');\nvar $export = require('./_export');\nvar meta = require('./_meta');\nvar fails = require('./_fails');\nvar hide = require('./_hide');\nvar redefineAll = require('./_redefine-all');\nvar forOf = require('./_for-of');\nvar anInstance = require('./_an-instance');\nvar isObject = require('./_is-object');\nvar setToStringTag = require('./_set-to-string-tag');\nvar dP = require('./_object-dp').f;\nvar each = require('./_array-methods')(0);\nvar DESCRIPTORS = require('./_descriptors');\n\nmodule.exports = function (NAME, wrapper, methods, common, IS_MAP, IS_WEAK) {\n  var Base = global[NAME];\n  var C = Base;\n  var ADDER = IS_MAP ? 'set' : 'add';\n  var proto = C && C.prototype;\n  var O = {};\n  if (!DESCRIPTORS || typeof C != 'function' || !(IS_WEAK || proto.forEach && !fails(function () {\n    new C().entries().next();\n  }))) {\n    // create collection constructor\n    C = common.getConstructor(wrapper, NAME, IS_MAP, ADDER);\n    redefineAll(C.prototype, methods);\n    meta.NEED = true;\n  } else {\n    C = wrapper(function (target, iterable) {\n      anInstance(target, C, NAME, '_c');\n      target._c = new Base();\n      if (iterable != undefined) forOf(iterable, IS_MAP, target[ADDER], target);\n    });\n    each('add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON'.split(','), function (KEY) {\n      var IS_ADDER = KEY == 'add' || KEY == 'set';\n      if (KEY in proto && !(IS_WEAK && KEY == 'clear')) hide(C.prototype, KEY, function (a, b) {\n        anInstance(this, C, KEY);\n        if (!IS_ADDER && IS_WEAK && !isObject(a)) return KEY == 'get' ? undefined : false;\n        var result = this._c[KEY](a === 0 ? 0 : a, b);\n        return IS_ADDER ? this : result;\n      });\n    });\n    IS_WEAK || dP(C.prototype, 'size', {\n      get: function () {\n        return this._c.size;\n      }\n    });\n  }\n\n  setToStringTag(C, NAME);\n\n  O[NAME] = C;\n  $export($export.G + $export.W + $export.F, O);\n\n  if (!IS_WEAK) common.setStrong(C, NAME, IS_MAP);\n\n  return C;\n};\n","var core = module.exports = { version: '2.6.8' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n","'use strict';\nvar $defineProperty = require('./_object-dp');\nvar createDesc = require('./_property-desc');\n\nmodule.exports = function (object, index, value) {\n  if (index in object) $defineProperty.f(object, index, createDesc(0, value));\n  else object[index] = value;\n};\n","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n","var isObject = require('./_is-object');\nvar document = require('./_global').document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n","// all enumerable object keys, includes symbols\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nmodule.exports = function (it) {\n  var result = getKeys(it);\n  var getSymbols = gOPS.f;\n  if (getSymbols) {\n    var symbols = getSymbols(it);\n    var isEnum = pIE.f;\n    var i = 0;\n    var key;\n    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);\n  } return result;\n};\n","var global = require('./_global');\nvar core = require('./_core');\nvar ctx = require('./_ctx');\nvar hide = require('./_hide');\nvar has = require('./_has');\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var IS_WRAP = type & $export.W;\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE];\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE];\n  var key, own, out;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    if (own && has(exports, key)) continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function (C) {\n      var F = function (a, b, c) {\n        if (this instanceof C) {\n          switch (arguments.length) {\n            case 0: return new C();\n            case 1: return new C(a);\n            case 2: return new C(a, b);\n          } return new C(a, b, c);\n        } return C.apply(this, arguments);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%\n    if (IS_PROTO) {\n      (exports.virtual || (exports.virtual = {}))[key] = out;\n      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%\n      if (type & $export.R && expProto && !expProto[key]) hide(expProto, key, out);\n    }\n  }\n};\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n","var ctx = require('./_ctx');\nvar call = require('./_iter-call');\nvar isArrayIter = require('./_is-array-iter');\nvar anObject = require('./_an-object');\nvar toLength = require('./_to-length');\nvar getIterFn = require('./core.get-iterator-method');\nvar BREAK = {};\nvar RETURN = {};\nvar exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {\n  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);\n  var f = ctx(fn, that, entries ? 2 : 1);\n  var index = 0;\n  var length, step, iterator, result;\n  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');\n  // fast case for arrays with default iterator\n  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {\n    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n    if (result === BREAK || result === RETURN) return result;\n  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {\n    result = call(iterator, f, step.value, entries);\n    if (result === BREAK || result === RETURN) return result;\n  }\n};\nexports.BREAK = BREAK;\nexports.RETURN = RETURN;\n","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","var dP = require('./_object-dp');\nvar createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var document = require('./_global').document;\nmodule.exports = document && document.documentElement;\n","module.exports = !require('./_descriptors') && !require('./_fails')(function () {\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n","// fast apply, http://jsperf.lnkit.com/fast-apply/5\nmodule.exports = function (fn, args, that) {\n  var un = that === undefined;\n  switch (args.length) {\n    case 0: return un ? fn()\n                      : fn.call(that);\n    case 1: return un ? fn(args[0])\n                      : fn.call(that, args[0]);\n    case 2: return un ? fn(args[0], args[1])\n                      : fn.call(that, args[0], args[1]);\n    case 3: return un ? fn(args[0], args[1], args[2])\n                      : fn.call(that, args[0], args[1], args[2]);\n    case 4: return un ? fn(args[0], args[1], args[2], args[3])\n                      : fn.call(that, args[0], args[1], args[2], args[3]);\n  } return fn.apply(that, args);\n};\n","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n","// check on default Array iterator\nvar Iterators = require('./_iterators');\nvar ITERATOR = require('./_wks')('iterator');\nvar ArrayProto = Array.prototype;\n\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","// call something on iterator step with safe closing on error\nvar anObject = require('./_an-object');\nmodule.exports = function (iterator, fn, value, entries) {\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch (e) {\n    var ret = iterator['return'];\n    if (ret !== undefined) anObject(ret.call(iterator));\n    throw e;\n  }\n};\n","'use strict';\nvar create = require('./_object-create');\nvar descriptor = require('./_property-desc');\nvar setToStringTag = require('./_set-to-string-tag');\nvar IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });\n\nmodule.exports = function (Constructor, NAME, next) {\n  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n","'use strict';\nvar LIBRARY = require('./_library');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar $iterCreate = require('./_iter-create');\nvar setToStringTag = require('./_set-to-string-tag');\nvar getPrototypeOf = require('./_object-gpo');\nvar ITERATOR = require('./_wks')('iterator');\nvar BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`\nvar FF_ITERATOR = '@@iterator';\nvar KEYS = 'keys';\nvar VALUES = 'values';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function (kind) {\n    if (!BUGGY && kind in proto) return proto[kind];\n    switch (kind) {\n      case KEYS: return function keys() { return new Constructor(this, kind); };\n      case VALUES: return function values() { return new Constructor(this, kind); };\n    } return function entries() { return new Constructor(this, kind); };\n  };\n  var TAG = NAME + ' Iterator';\n  var DEF_VALUES = DEFAULT == VALUES;\n  var VALUES_BUG = false;\n  var proto = Base.prototype;\n  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];\n  var $default = $native || getMethod(DEFAULT);\n  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;\n  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;\n  var methods, key, IteratorPrototype;\n  // Fix native\n  if ($anyNative) {\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));\n    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if (!LIBRARY && typeof IteratorPrototype[ITERATOR] != 'function') hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEF_VALUES && $native && $native.name !== VALUES) {\n    VALUES_BUG = true;\n    $default = function values() { return $native.call(this); };\n  }\n  // Define iterator\n  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG] = returnThis;\n  if (DEFAULT) {\n    methods = {\n      values: DEF_VALUES ? $default : getMethod(VALUES),\n      keys: IS_SET ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if (FORCED) for (key in methods) {\n      if (!(key in proto)) redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n","var ITERATOR = require('./_wks')('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function () { SAFE_CLOSING = true; };\n  // eslint-disable-next-line no-throw-literal\n  Array.from(riter, function () { throw 2; });\n} catch (e) { /* empty */ }\n\nmodule.exports = function (exec, skipClosing) {\n  if (!skipClosing && !SAFE_CLOSING) return false;\n  var safe = false;\n  try {\n    var arr = [7];\n    var iter = arr[ITERATOR]();\n    iter.next = function () { return { done: safe = true }; };\n    arr[ITERATOR] = function () { return iter; };\n    exec(arr);\n  } catch (e) { /* empty */ }\n  return safe;\n};\n","module.exports = function (done, value) {\n  return { value: value, done: !!done };\n};\n","module.exports = {};\n","module.exports = true;\n","var META = require('./_uid')('meta');\nvar isObject = require('./_is-object');\nvar has = require('./_has');\nvar setDesc = require('./_object-dp').f;\nvar id = 0;\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\nvar FREEZE = !require('./_fails')(function () {\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function (it) {\n  setDesc(it, META, { value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  } });\n};\nvar fastKey = function (it, create) {\n  // return primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function (it, create) {\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY: META,\n  NEED: false,\n  fastKey: fastKey,\n  getWeak: getWeak,\n  onFreeze: onFreeze\n};\n","var global = require('./_global');\nvar macrotask = require('./_task').set;\nvar Observer = global.MutationObserver || global.WebKitMutationObserver;\nvar process = global.process;\nvar Promise = global.Promise;\nvar isNode = require('./_cof')(process) == 'process';\n\nmodule.exports = function () {\n  var head, last, notify;\n\n  var flush = function () {\n    var parent, fn;\n    if (isNode && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (e) {\n        if (head) notify();\n        else last = undefined;\n        throw e;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // Node.js\n  if (isNode) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339\n  } else if (Observer && !(global.navigator && global.navigator.standalone)) {\n    var toggle = true;\n    var node = document.createTextNode('');\n    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    var promise = Promise.resolve(undefined);\n    notify = function () {\n      promise.then(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    notify = function () {\n      // strange IE + webpack dev server bug - use .call(global)\n      macrotask.call(global, flush);\n    };\n  }\n\n  return function (fn) {\n    var task = { fn: fn, next: undefined };\n    if (last) last.next = task;\n    if (!head) {\n      head = task;\n      notify();\n    } last = task;\n  };\n};\n","'use strict';\n// 25.4.1.5 NewPromiseCapability(C)\nvar aFunction = require('./_a-function');\n\nfunction PromiseCapability(C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject = aFunction(reject);\n}\n\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n","'use strict';\n// 19.1.2.1 Object.assign(target, source, ...)\nvar DESCRIPTORS = require('./_descriptors');\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nvar toObject = require('./_to-object');\nvar IObject = require('./_iobject');\nvar $assign = Object.assign;\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = !$assign || require('./_fails')(function () {\n  var A = {};\n  var B = {};\n  // eslint-disable-next-line no-undef\n  var S = Symbol();\n  var K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function (k) { B[k] = k; });\n  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;\n}) ? function assign(target, source) { // eslint-disable-line no-unused-vars\n  var T = toObject(target);\n  var aLen = arguments.length;\n  var index = 1;\n  var getSymbols = gOPS.f;\n  var isEnum = pIE.f;\n  while (aLen > index) {\n    var S = IObject(arguments[index++]);\n    var keys = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S);\n    var length = keys.length;\n    var j = 0;\n    var key;\n    while (length > j) {\n      key = keys[j++];\n      if (!DESCRIPTORS || isEnum.call(S, key)) T[key] = S[key];\n    }\n  } return T;\n} : $assign;\n","// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject = require('./_an-object');\nvar dPs = require('./_object-dps');\nvar enumBugKeys = require('./_enum-bug-keys');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar Empty = function () { /* empty */ };\nvar PROTOTYPE = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = require('./_dom-create')('iframe');\n  var i = enumBugKeys.length;\n  var lt = '<';\n  var gt = '>';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  require('./_html').appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n","var anObject = require('./_an-object');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar toPrimitive = require('./_to-primitive');\nvar dP = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var dP = require('./_object-dp');\nvar anObject = require('./_an-object');\nvar getKeys = require('./_object-keys');\n\nmodule.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = getKeys(Properties);\n  var length = keys.length;\n  var i = 0;\n  var P;\n  while (length > i) dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n","var pIE = require('./_object-pie');\nvar createDesc = require('./_property-desc');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar has = require('./_has');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nexports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return gOPD(O, P);\n  } catch (e) { /* empty */ }\n  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);\n};\n","// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = require('./_to-iobject');\nvar gOPN = require('./_object-gopn').f;\nvar toString = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return gOPN(it);\n  } catch (e) {\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n};\n","// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys = require('./_object-keys-internal');\nvar hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return $keys(O, hiddenKeys);\n};\n","exports.f = Object.getOwnPropertySymbols;\n","// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has = require('./_has');\nvar toObject = require('./_to-object');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};\n","var has = require('./_has');\nvar toIObject = require('./_to-iobject');\nvar arrayIndexOf = require('./_array-includes')(false);\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function (object, names) {\n  var O = toIObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys = require('./_object-keys-internal');\nvar enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O) {\n  return $keys(O, enumBugKeys);\n};\n","exports.f = {}.propertyIsEnumerable;\n","// most Object methods by ES6 should accept primitives\nvar $export = require('./_export');\nvar core = require('./_core');\nvar fails = require('./_fails');\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n","var DESCRIPTORS = require('./_descriptors');\nvar getKeys = require('./_object-keys');\nvar toIObject = require('./_to-iobject');\nvar isEnum = require('./_object-pie').f;\nmodule.exports = function (isEntries) {\n  return function (it) {\n    var O = toIObject(it);\n    var keys = getKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || isEnum.call(O, key)) {\n        result.push(isEntries ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n","module.exports = function (exec) {\n  try {\n    return { e: false, v: exec() };\n  } catch (e) {\n    return { e: true, v: e };\n  }\n};\n","var anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar newPromiseCapability = require('./_new-promise-capability');\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var hide = require('./_hide');\nmodule.exports = function (target, src, safe) {\n  for (var key in src) {\n    if (safe && target[key]) target[key] = src[key];\n    else hide(target, key, src[key]);\n  } return target;\n};\n","module.exports = require('./_hide');\n","'use strict';\n// https://tc39.github.io/proposal-setmap-offrom/\nvar $export = require('./_export');\nvar aFunction = require('./_a-function');\nvar ctx = require('./_ctx');\nvar forOf = require('./_for-of');\n\nmodule.exports = function (COLLECTION) {\n  $export($export.S, COLLECTION, { from: function from(source /* , mapFn, thisArg */) {\n    var mapFn = arguments[1];\n    var mapping, A, n, cb;\n    aFunction(this);\n    mapping = mapFn !== undefined;\n    if (mapping) aFunction(mapFn);\n    if (source == undefined) return new this();\n    A = [];\n    if (mapping) {\n      n = 0;\n      cb = ctx(mapFn, arguments[2], 2);\n      forOf(source, false, function (nextItem) {\n        A.push(cb(nextItem, n++));\n      });\n    } else {\n      forOf(source, false, A.push, A);\n    }\n    return new this(A);\n  } });\n};\n","'use strict';\n// https://tc39.github.io/proposal-setmap-offrom/\nvar $export = require('./_export');\n\nmodule.exports = function (COLLECTION) {\n  $export($export.S, COLLECTION, { of: function of() {\n    var length = arguments.length;\n    var A = new Array(length);\n    while (length--) A[length] = arguments[length];\n    return new this(A);\n  } });\n};\n","'use strict';\nvar global = require('./_global');\nvar core = require('./_core');\nvar dP = require('./_object-dp');\nvar DESCRIPTORS = require('./_descriptors');\nvar SPECIES = require('./_wks')('species');\n\nmodule.exports = function (KEY) {\n  var C = typeof core[KEY] == 'function' ? core[KEY] : global[KEY];\n  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {\n    configurable: true,\n    get: function () { return this; }\n  });\n};\n","var def = require('./_object-dp').f;\nvar has = require('./_has');\nvar TAG = require('./_wks')('toStringTag');\n\nmodule.exports = function (it, tag, stat) {\n  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });\n};\n","var shared = require('./_shared')('keys');\nvar uid = require('./_uid');\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n","var core = require('./_core');\nvar global = require('./_global');\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: core.version,\n  mode: require('./_library') ? 'pure' : 'global',\n  copyright: ' 2019 Denis Pushkarev (zloirock.ru)'\n});\n","// 7.3.20 SpeciesConstructor(O, defaultConstructor)\nvar anObject = require('./_an-object');\nvar aFunction = require('./_a-function');\nvar SPECIES = require('./_wks')('species');\nmodule.exports = function (O, D) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);\n};\n","var toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function (TO_STRING) {\n  return function (that, pos) {\n    var s = String(defined(that));\n    var i = toInteger(pos);\n    var l = s.length;\n    var a, b;\n    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n","var ctx = require('./_ctx');\nvar invoke = require('./_invoke');\nvar html = require('./_html');\nvar cel = require('./_dom-create');\nvar global = require('./_global');\nvar process = global.process;\nvar setTask = global.setImmediate;\nvar clearTask = global.clearImmediate;\nvar MessageChannel = global.MessageChannel;\nvar Dispatch = global.Dispatch;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar defer, channel, port;\nvar run = function () {\n  var id = +this;\n  // eslint-disable-next-line no-prototype-builtins\n  if (queue.hasOwnProperty(id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listener = function (event) {\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!setTask || !clearTask) {\n  setTask = function setImmediate(fn) {\n    var args = [];\n    var i = 1;\n    while (arguments.length > i) args.push(arguments[i++]);\n    queue[++counter] = function () {\n      // eslint-disable-next-line no-new-func\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (require('./_cof')(process) == 'process') {\n    defer = function (id) {\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if (MessageChannel) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {\n    defer = function (id) {\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in cel('script')) {\n    defer = function (id) {\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set: setTask,\n  clear: clearTask\n};\n","var toInteger = require('./_to-integer');\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n","// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject');\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer');\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return Object(defined(it));\n};\n","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n","var global = require('./_global');\nvar navigator = global.navigator;\n\nmodule.exports = navigator && navigator.userAgent || '';\n","var isObject = require('./_is-object');\nmodule.exports = function (it, TYPE) {\n  if (!isObject(it) || it._t !== TYPE) throw TypeError('Incompatible receiver, ' + TYPE + ' required!');\n  return it;\n};\n","var global = require('./_global');\nvar core = require('./_core');\nvar LIBRARY = require('./_library');\nvar wksExt = require('./_wks-ext');\nvar defineProperty = require('./_object-dp').f;\nmodule.exports = function (name) {\n  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });\n};\n","exports.f = require('./_wks');\n","var store = require('./_shared')('wks');\nvar uid = require('./_uid');\nvar Symbol = require('./_global').Symbol;\nvar USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function (name) {\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n","var classof = require('./_classof');\nvar ITERATOR = require('./_wks')('iterator');\nvar Iterators = require('./_iterators');\nmodule.exports = require('./_core').getIteratorMethod = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n","'use strict';\nvar ctx = require('./_ctx');\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar call = require('./_iter-call');\nvar isArrayIter = require('./_is-array-iter');\nvar toLength = require('./_to-length');\nvar createProperty = require('./_create-property');\nvar getIterFn = require('./core.get-iterator-method');\n\n$export($export.S + $export.F * !require('./_iter-detect')(function (iter) { Array.from(iter); }), 'Array', {\n  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)\n  from: function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n    var O = toObject(arrayLike);\n    var C = typeof this == 'function' ? this : Array;\n    var aLen = arguments.length;\n    var mapfn = aLen > 1 ? arguments[1] : undefined;\n    var mapping = mapfn !== undefined;\n    var index = 0;\n    var iterFn = getIterFn(O);\n    var length, result, step, iterator;\n    if (mapping) mapfn = ctx(mapfn, aLen > 2 ? arguments[2] : undefined, 2);\n    // if object isn't iterable or it's array with default iterator - use simple case\n    if (iterFn != undefined && !(C == Array && isArrayIter(iterFn))) {\n      for (iterator = iterFn.call(O), result = new C(); !(step = iterator.next()).done; index++) {\n        createProperty(result, index, mapping ? call(iterator, mapfn, [step.value, index], true) : step.value);\n      }\n    } else {\n      length = toLength(O.length);\n      for (result = new C(length); length > index; index++) {\n        createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);\n      }\n    }\n    result.length = index;\n    return result;\n  }\n});\n","'use strict';\nvar addToUnscopables = require('./_add-to-unscopables');\nvar step = require('./_iter-step');\nvar Iterators = require('./_iterators');\nvar toIObject = require('./_to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var kind = this._k;\n  var index = this._i++;\n  if (!O || index >= O.length) {\n    this._t = undefined;\n    return step(1);\n  }\n  if (kind == 'keys') return step(0, index);\n  if (kind == 'values') return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n","'use strict';\nvar strong = require('./_collection-strong');\nvar validate = require('./_validate-collection');\nvar MAP = 'Map';\n\n// 23.1 Map Objects\nmodule.exports = require('./_collection')(MAP, function (get) {\n  return function Map() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.1.3.6 Map.prototype.get(key)\n  get: function get(key) {\n    var entry = strong.getEntry(validate(this, MAP), key);\n    return entry && entry.v;\n  },\n  // 23.1.3.9 Map.prototype.set(key, value)\n  set: function set(key, value) {\n    return strong.def(validate(this, MAP), key === 0 ? 0 : key, value);\n  }\n}, strong, true);\n","// 19.1.3.1 Object.assign(target, source)\nvar $export = require('./_export');\n\n$export($export.S + $export.F, 'Object', { assign: require('./_object-assign') });\n","var $export = require('./_export');\n// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\n$export($export.S, 'Object', { create: require('./_object-create') });\n","var $export = require('./_export');\n// 19.1.2.3 / 15.2.3.7 Object.defineProperties(O, Properties)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperties: require('./_object-dps') });\n","var $export = require('./_export');\n// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperty: require('./_object-dp').f });\n","// 19.1.2.5 Object.freeze(O)\nvar isObject = require('./_is-object');\nvar meta = require('./_meta').onFreeze;\n\nrequire('./_object-sap')('freeze', function ($freeze) {\n  return function freeze(it) {\n    return $freeze && isObject(it) ? $freeze(meta(it)) : it;\n  };\n});\n","// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject = require('./_to-iobject');\nvar $getOwnPropertyDescriptor = require('./_object-gopd').f;\n\nrequire('./_object-sap')('getOwnPropertyDescriptor', function () {\n  return function getOwnPropertyDescriptor(it, key) {\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});\n","// 19.1.2.9 Object.getPrototypeOf(O)\nvar toObject = require('./_to-object');\nvar $getPrototypeOf = require('./_object-gpo');\n\nrequire('./_object-sap')('getPrototypeOf', function () {\n  return function getPrototypeOf(it) {\n    return $getPrototypeOf(toObject(it));\n  };\n});\n","// 19.1.2.14 Object.keys(O)\nvar toObject = require('./_to-object');\nvar $keys = require('./_object-keys');\n\nrequire('./_object-sap')('keys', function () {\n  return function keys(it) {\n    return $keys(toObject(it));\n  };\n});\n","'use strict';\nvar LIBRARY = require('./_library');\nvar global = require('./_global');\nvar ctx = require('./_ctx');\nvar classof = require('./_classof');\nvar $export = require('./_export');\nvar isObject = require('./_is-object');\nvar aFunction = require('./_a-function');\nvar anInstance = require('./_an-instance');\nvar forOf = require('./_for-of');\nvar speciesConstructor = require('./_species-constructor');\nvar task = require('./_task').set;\nvar microtask = require('./_microtask')();\nvar newPromiseCapabilityModule = require('./_new-promise-capability');\nvar perform = require('./_perform');\nvar userAgent = require('./_user-agent');\nvar promiseResolve = require('./_promise-resolve');\nvar PROMISE = 'Promise';\nvar TypeError = global.TypeError;\nvar process = global.process;\nvar versions = process && process.versions;\nvar v8 = versions && versions.v8 || '';\nvar $Promise = global[PROMISE];\nvar isNode = classof(process) == 'process';\nvar empty = function () { /* empty */ };\nvar Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;\nvar newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;\n\nvar USE_NATIVE = !!function () {\n  try {\n    // correct subclassing with @@species support\n    var promise = $Promise.resolve(1);\n    var FakePromise = (promise.constructor = {})[require('./_wks')('species')] = function (exec) {\n      exec(empty, empty);\n    };\n    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n    return (isNode || typeof PromiseRejectionEvent == 'function')\n      && promise.then(empty) instanceof FakePromise\n      // v8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n      // we can't detect it synchronously, so just check versions\n      && v8.indexOf('6.6') !== 0\n      && userAgent.indexOf('Chrome/66') === -1;\n  } catch (e) { /* empty */ }\n}();\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar notify = function (promise, isReject) {\n  if (promise._n) return;\n  promise._n = true;\n  var chain = promise._c;\n  microtask(function () {\n    var value = promise._v;\n    var ok = promise._s == 1;\n    var i = 0;\n    var run = function (reaction) {\n      var handler = ok ? reaction.ok : reaction.fail;\n      var resolve = reaction.resolve;\n      var reject = reaction.reject;\n      var domain = reaction.domain;\n      var result, then, exited;\n      try {\n        if (handler) {\n          if (!ok) {\n            if (promise._h == 2) onHandleUnhandled(promise);\n            promise._h = 1;\n          }\n          if (handler === true) result = value;\n          else {\n            if (domain) domain.enter();\n            result = handler(value); // may throw\n            if (domain) {\n              domain.exit();\n              exited = true;\n            }\n          }\n          if (result === reaction.promise) {\n            reject(TypeError('Promise-chain cycle'));\n          } else if (then = isThenable(result)) {\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch (e) {\n        if (domain && !exited) domain.exit();\n        reject(e);\n      }\n    };\n    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach\n    promise._c = [];\n    promise._n = false;\n    if (isReject && !promise._h) onUnhandled(promise);\n  });\n};\nvar onUnhandled = function (promise) {\n  task.call(global, function () {\n    var value = promise._v;\n    var unhandled = isUnhandled(promise);\n    var result, handler, console;\n    if (unhandled) {\n      result = perform(function () {\n        if (isNode) {\n          process.emit('unhandledRejection', value, promise);\n        } else if (handler = global.onunhandledrejection) {\n          handler({ promise: promise, reason: value });\n        } else if ((console = global.console) && console.error) {\n          console.error('Unhandled promise rejection', value);\n        }\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      promise._h = isNode || isUnhandled(promise) ? 2 : 1;\n    } promise._a = undefined;\n    if (unhandled && result.e) throw result.v;\n  });\n};\nvar isUnhandled = function (promise) {\n  return promise._h !== 1 && (promise._a || promise._c).length === 0;\n};\nvar onHandleUnhandled = function (promise) {\n  task.call(global, function () {\n    var handler;\n    if (isNode) {\n      process.emit('rejectionHandled', promise);\n    } else if (handler = global.onrejectionhandled) {\n      handler({ promise: promise, reason: promise._v });\n    }\n  });\n};\nvar $reject = function (value) {\n  var promise = this;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  promise._v = value;\n  promise._s = 2;\n  if (!promise._a) promise._a = promise._c.slice();\n  notify(promise, true);\n};\nvar $resolve = function (value) {\n  var promise = this;\n  var then;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  try {\n    if (promise === value) throw TypeError(\"Promise can't be resolved itself\");\n    if (then = isThenable(value)) {\n      microtask(function () {\n        var wrapper = { _w: promise, _d: false }; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch (e) {\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      promise._v = value;\n      promise._s = 1;\n      notify(promise, false);\n    }\n  } catch (e) {\n    $reject.call({ _w: promise, _d: false }, e); // wrap\n  }\n};\n\n// constructor polyfill\nif (!USE_NATIVE) {\n  // 25.4.3.1 Promise(executor)\n  $Promise = function Promise(executor) {\n    anInstance(this, $Promise, PROMISE, '_h');\n    aFunction(executor);\n    Internal.call(this);\n    try {\n      executor(ctx($resolve, this, 1), ctx($reject, this, 1));\n    } catch (err) {\n      $reject.call(this, err);\n    }\n  };\n  // eslint-disable-next-line no-unused-vars\n  Internal = function Promise(executor) {\n    this._c = [];             // <- awaiting reactions\n    this._a = undefined;      // <- checked in isUnhandled reactions\n    this._s = 0;              // <- state\n    this._d = false;          // <- done\n    this._v = undefined;      // <- value\n    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled\n    this._n = false;          // <- notify\n  };\n  Internal.prototype = require('./_redefine-all')($Promise.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected) {\n      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));\n      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      reaction.domain = isNode ? process.domain : undefined;\n      this._c.push(reaction);\n      if (this._a) this._a.push(reaction);\n      if (this._s) notify(this, false);\n      return reaction.promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    this.promise = promise;\n    this.resolve = ctx($resolve, promise, 1);\n    this.reject = ctx($reject, promise, 1);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === $Promise || C === Wrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });\nrequire('./_set-to-string-tag')($Promise, PROMISE);\nrequire('./_set-species')(PROMISE);\nWrapper = require('./_core')[PROMISE];\n\n// statics\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    var $$reject = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x) {\n    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && require('./_iter-detect')(function (iter) {\n  $Promise.all(iter)['catch'](empty);\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var values = [];\n      var index = 0;\n      var remaining = 1;\n      forOf(iterable, false, function (promise) {\n        var $index = index++;\n        var alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        C.resolve(promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[$index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      forOf(iterable, false, function (promise) {\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  }\n});\n","'use strict';\nvar $at = require('./_string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./_iter-define')(String, 'String', function (iterated) {\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var index = this._i;\n  var point;\n  if (index >= O.length) return { value: undefined, done: true };\n  point = $at(O, index);\n  this._i += point.length;\n  return { value: point, done: false };\n});\n","'use strict';\n// ECMAScript 6 symbols shim\nvar global = require('./_global');\nvar has = require('./_has');\nvar DESCRIPTORS = require('./_descriptors');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar META = require('./_meta').KEY;\nvar $fails = require('./_fails');\nvar shared = require('./_shared');\nvar setToStringTag = require('./_set-to-string-tag');\nvar uid = require('./_uid');\nvar wks = require('./_wks');\nvar wksExt = require('./_wks-ext');\nvar wksDefine = require('./_wks-define');\nvar enumKeys = require('./_enum-keys');\nvar isArray = require('./_is-array');\nvar anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar toObject = require('./_to-object');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar createDesc = require('./_property-desc');\nvar _create = require('./_object-create');\nvar gOPNExt = require('./_object-gopn-ext');\nvar $GOPD = require('./_object-gopd');\nvar $GOPS = require('./_object-gops');\nvar $DP = require('./_object-dp');\nvar $keys = require('./_object-keys');\nvar gOPD = $GOPD.f;\nvar dP = $DP.f;\nvar gOPN = gOPNExt.f;\nvar $Symbol = global.Symbol;\nvar $JSON = global.JSON;\nvar _stringify = $JSON && $JSON.stringify;\nvar PROTOTYPE = 'prototype';\nvar HIDDEN = wks('_hidden');\nvar TO_PRIMITIVE = wks('toPrimitive');\nvar isEnum = {}.propertyIsEnumerable;\nvar SymbolRegistry = shared('symbol-registry');\nvar AllSymbols = shared('symbols');\nvar OPSymbols = shared('op-symbols');\nvar ObjectProto = Object[PROTOTYPE];\nvar USE_NATIVE = typeof $Symbol == 'function' && !!$GOPS.f;\nvar QObject = global.QObject;\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function () {\n  return _create(dP({}, 'a', {\n    get: function () { return dP(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (it, key, D) {\n  var protoDesc = gOPD(ObjectProto, key);\n  if (protoDesc) delete ObjectProto[key];\n  dP(it, key, D);\n  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);\n} : dP;\n\nvar wrap = function (tag) {\n  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n  sym._k = tag;\n  return sym;\n};\n\nvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  return it instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D) {\n  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if (has(AllSymbols, key)) {\n    if (!D.enumerable) {\n      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;\n      D = _create(D, { enumerable: createDesc(0, false) });\n    } return setSymbolDesc(it, key, D);\n  } return dP(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P) {\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P));\n  var i = 0;\n  var l = keys.length;\n  var key;\n  while (l > i) $defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P) {\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key) {\n  var E = isEnum.call(this, key = toPrimitive(key, true));\n  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {\n  it = toIObject(it);\n  key = toPrimitive(key, true);\n  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;\n  var D = gOPD(it, key);\n  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it) {\n  var names = gOPN(toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);\n  } return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it) {\n  var IS_OP = it === ObjectProto;\n  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);\n  } return result;\n};\n\n// 19.4.1.1 Symbol([description])\nif (!USE_NATIVE) {\n  $Symbol = function Symbol() {\n    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');\n    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n    var $set = function (value) {\n      if (this === ObjectProto) $set.call(OPSymbols, value);\n      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    };\n    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });\n    return wrap(tag);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString() {\n    return this._k;\n  });\n\n  $GOPD.f = $getOwnPropertyDescriptor;\n  $DP.f = $defineProperty;\n  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;\n  require('./_object-pie').f = $propertyIsEnumerable;\n  $GOPS.f = $getOwnPropertySymbols;\n\n  if (DESCRIPTORS && !require('./_library')) {\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n\n  wksExt.f = function (name) {\n    return wrap(wks(name));\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });\n\nfor (var es6Symbols = (\n  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);\n\nfor (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);\n\n$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function (key) {\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(sym) {\n    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');\n    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;\n  },\n  useSetter: function () { setter = true; },\n  useSimple: function () { setter = false; }\n});\n\n$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives\n// https://bugs.chromium.org/p/v8/issues/detail?id=3443\nvar FAILS_ON_PRIMITIVES = $fails(function () { $GOPS.f(1); });\n\n$export($export.S + $export.F * FAILS_ON_PRIMITIVES, 'Object', {\n  getOwnPropertySymbols: function getOwnPropertySymbols(it) {\n    return $GOPS.f(toObject(it));\n  }\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';\n})), 'JSON', {\n  stringify: function stringify(it) {\n    var args = [it];\n    var i = 1;\n    var replacer, $replacer;\n    while (arguments.length > i) args.push(arguments[i++]);\n    $replacer = replacer = args[1];\n    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n    if (!isArray(replacer)) replacer = function (key, value) {\n      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);\n      if (!isSymbol(value)) return value;\n    };\n    args[1] = replacer;\n    return _stringify.apply($JSON, args);\n  }\n});\n\n// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);\n","// https://tc39.github.io/proposal-setmap-offrom/#sec-map.from\nrequire('./_set-collection-from')('Map');\n","// https://tc39.github.io/proposal-setmap-offrom/#sec-map.of\nrequire('./_set-collection-of')('Map');\n","// https://github.com/DavidBruant/Map-Set.prototype.toJSON\nvar $export = require('./_export');\n\n$export($export.P + $export.R, 'Map', { toJSON: require('./_collection-to-json')('Map') });\n","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $entries = require('./_object-to-array')(true);\n\n$export($export.S, 'Object', {\n  entries: function entries(it) {\n    return $entries(it);\n  }\n});\n","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $values = require('./_object-to-array')(false);\n\n$export($export.S, 'Object', {\n  values: function values(it) {\n    return $values(it);\n  }\n});\n","// https://github.com/tc39/proposal-promise-finally\n'use strict';\nvar $export = require('./_export');\nvar core = require('./_core');\nvar global = require('./_global');\nvar speciesConstructor = require('./_species-constructor');\nvar promiseResolve = require('./_promise-resolve');\n\n$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {\n  var C = speciesConstructor(this, core.Promise || global.Promise);\n  var isFunction = typeof onFinally == 'function';\n  return this.then(\n    isFunction ? function (x) {\n      return promiseResolve(C, onFinally()).then(function () { return x; });\n    } : onFinally,\n    isFunction ? function (e) {\n      return promiseResolve(C, onFinally()).then(function () { throw e; });\n    } : onFinally\n  );\n} });\n","'use strict';\n// https://github.com/tc39/proposal-promise-try\nvar $export = require('./_export');\nvar newPromiseCapability = require('./_new-promise-capability');\nvar perform = require('./_perform');\n\n$export($export.S, 'Promise', { 'try': function (callbackfn) {\n  var promiseCapability = newPromiseCapability.f(this);\n  var result = perform(callbackfn);\n  (result.e ? promiseCapability.reject : promiseCapability.resolve)(result.v);\n  return promiseCapability.promise;\n} });\n","require('./_wks-define')('asyncIterator');\n","require('./_wks-define')('observable');\n","require('./es6.array.iterator');\nvar global = require('./_global');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar TO_STRING_TAG = require('./_wks')('toStringTag');\n\nvar DOMIterables = ('CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,' +\n  'DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,' +\n  'MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,' +\n  'SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,' +\n  'TextTrackList,TouchList').split(',');\n\nfor (var i = 0; i < DOMIterables.length; i++) {\n  var NAME = DOMIterables[i];\n  var Collection = global[NAME];\n  var proto = Collection && Collection.prototype;\n  if (proto && !proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);\n  Iterators[NAME] = Iterators.Array;\n}\n","'use strict';\nvar token = '%[a-f0-9]{2}';\nvar singleMatcher = new RegExp(token, 'gi');\nvar multiMatcher = new RegExp('(' + token + ')+', 'gi');\n\nfunction decodeComponents(components, split) {\n\ttry {\n\t\t// Try to decode the entire string first\n\t\treturn decodeURIComponent(components.join(''));\n\t} catch (err) {\n\t\t// Do nothing\n\t}\n\n\tif (components.length === 1) {\n\t\treturn components;\n\t}\n\n\tsplit = split || 1;\n\n\t// Split the array in 2 parts\n\tvar left = components.slice(0, split);\n\tvar right = components.slice(split);\n\n\treturn Array.prototype.concat.call([], decodeComponents(left), decodeComponents(right));\n}\n\nfunction decode(input) {\n\ttry {\n\t\treturn decodeURIComponent(input);\n\t} catch (err) {\n\t\tvar tokens = input.match(singleMatcher);\n\n\t\tfor (var i = 1; i < tokens.length; i++) {\n\t\t\tinput = decodeComponents(tokens, i).join('');\n\n\t\t\ttokens = input.match(singleMatcher);\n\t\t}\n\n\t\treturn input;\n\t}\n}\n\nfunction customDecodeURIComponent(input) {\n\t// Keep track of all the replacements and prefill the map with the `BOM`\n\tvar replaceMap = {\n\t\t'%FE%FF': '\\uFFFD\\uFFFD',\n\t\t'%FF%FE': '\\uFFFD\\uFFFD'\n\t};\n\n\tvar match = multiMatcher.exec(input);\n\twhile (match) {\n\t\ttry {\n\t\t\t// Decode as big chunks as possible\n\t\t\treplaceMap[match[0]] = decodeURIComponent(match[0]);\n\t\t} catch (err) {\n\t\t\tvar result = decode(match[0]);\n\n\t\t\tif (result !== match[0]) {\n\t\t\t\treplaceMap[match[0]] = result;\n\t\t\t}\n\t\t}\n\n\t\tmatch = multiMatcher.exec(input);\n\t}\n\n\t// Add `%C2` at the end of the map to make sure it does not replace the combinator before everything else\n\treplaceMap['%C2'] = '\\uFFFD';\n\n\tvar entries = Object.keys(replaceMap);\n\n\tfor (var i = 0; i < entries.length; i++) {\n\t\t// Replace all decoded components\n\t\tvar key = entries[i];\n\t\tinput = input.replace(new RegExp(key, 'g'), replaceMap[key]);\n\t}\n\n\treturn input;\n}\n\nmodule.exports = function (encodedURI) {\n\tif (typeof encodedURI !== 'string') {\n\t\tthrow new TypeError('Expected `encodedURI` to be of type `string`, got `' + typeof encodedURI + '`');\n\t}\n\n\ttry {\n\t\tencodedURI = encodedURI.replace(/\\+/g, ' ');\n\n\t\t// Try the built in decoder first\n\t\treturn decodeURIComponent(encodedURI);\n\t} catch (err) {\n\t\t// Fallback to a more advanced decoder\n\t\treturn customDecodeURIComponent(encodedURI);\n\t}\n};\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = $getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  var args = [];\n  for (var i = 0; i < arguments.length; i++) args.push(arguments[i]);\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    ReflectApply(this.listener, this.target, args);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","(function (self) {\n  'use strict';\n\n  function fetchPonyfill(options) {\n    var Promise = options && options.Promise || self.Promise;\n    var XMLHttpRequest = options && options.XMLHttpRequest || self.XMLHttpRequest;\n    var global = self;\n\n    return (function () {\n      var self = Object.create(global, {\n        fetch: {\n          value: undefined,\n          writable: true\n        }\n      });\n\n      (function(self) {\n        'use strict';\n\n        if (self.fetch) {\n          return\n        }\n\n        var support = {\n          searchParams: 'URLSearchParams' in self,\n          iterable: 'Symbol' in self && 'iterator' in Symbol,\n          blob: 'FileReader' in self && 'Blob' in self && (function() {\n            try {\n              new Blob()\n              return true\n            } catch(e) {\n              return false\n            }\n          })(),\n          formData: 'FormData' in self,\n          arrayBuffer: 'ArrayBuffer' in self\n        }\n\n        if (support.arrayBuffer) {\n          var viewClasses = [\n            '[object Int8Array]',\n            '[object Uint8Array]',\n            '[object Uint8ClampedArray]',\n            '[object Int16Array]',\n            '[object Uint16Array]',\n            '[object Int32Array]',\n            '[object Uint32Array]',\n            '[object Float32Array]',\n            '[object Float64Array]'\n          ]\n\n          var isDataView = function(obj) {\n            return obj && DataView.prototype.isPrototypeOf(obj)\n          }\n\n          var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n            return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n          }\n        }\n\n        function normalizeName(name) {\n          if (typeof name !== 'string') {\n            name = String(name)\n          }\n          if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n            throw new TypeError('Invalid character in header field name')\n          }\n          return name.toLowerCase()\n        }\n\n        function normalizeValue(value) {\n          if (typeof value !== 'string') {\n            value = String(value)\n          }\n          return value\n        }\n\n        // Build a destructive iterator for the value list\n        function iteratorFor(items) {\n          var iterator = {\n            next: function() {\n              var value = items.shift()\n              return {done: value === undefined, value: value}\n            }\n          }\n\n          if (support.iterable) {\n            iterator[Symbol.iterator] = function() {\n              return iterator\n            }\n          }\n\n          return iterator\n        }\n\n        function Headers(headers) {\n          this.map = {}\n\n          if (headers instanceof Headers) {\n            headers.forEach(function(value, name) {\n              this.append(name, value)\n            }, this)\n          } else if (Array.isArray(headers)) {\n            headers.forEach(function(header) {\n              this.append(header[0], header[1])\n            }, this)\n          } else if (headers) {\n            Object.getOwnPropertyNames(headers).forEach(function(name) {\n              this.append(name, headers[name])\n            }, this)\n          }\n        }\n\n        Headers.prototype.append = function(name, value) {\n          name = normalizeName(name)\n          value = normalizeValue(value)\n          var oldValue = this.map[name]\n          this.map[name] = oldValue ? oldValue+','+value : value\n        }\n\n        Headers.prototype['delete'] = function(name) {\n          delete this.map[normalizeName(name)]\n        }\n\n        Headers.prototype.get = function(name) {\n          name = normalizeName(name)\n          return this.has(name) ? this.map[name] : null\n        }\n\n        Headers.prototype.has = function(name) {\n          return this.map.hasOwnProperty(normalizeName(name))\n        }\n\n        Headers.prototype.set = function(name, value) {\n          this.map[normalizeName(name)] = normalizeValue(value)\n        }\n\n        Headers.prototype.forEach = function(callback, thisArg) {\n          for (var name in this.map) {\n            if (this.map.hasOwnProperty(name)) {\n              callback.call(thisArg, this.map[name], name, this)\n            }\n          }\n        }\n\n        Headers.prototype.keys = function() {\n          var items = []\n          this.forEach(function(value, name) { items.push(name) })\n          return iteratorFor(items)\n        }\n\n        Headers.prototype.values = function() {\n          var items = []\n          this.forEach(function(value) { items.push(value) })\n          return iteratorFor(items)\n        }\n\n        Headers.prototype.entries = function() {\n          var items = []\n          this.forEach(function(value, name) { items.push([name, value]) })\n          return iteratorFor(items)\n        }\n\n        if (support.iterable) {\n          Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n        }\n\n        function consumed(body) {\n          if (body.bodyUsed) {\n            return Promise.reject(new TypeError('Already read'))\n          }\n          body.bodyUsed = true\n        }\n\n        function fileReaderReady(reader) {\n          return new Promise(function(resolve, reject) {\n            reader.onload = function() {\n              resolve(reader.result)\n            }\n            reader.onerror = function() {\n              reject(reader.error)\n            }\n          })\n        }\n\n        function readBlobAsArrayBuffer(blob) {\n          var reader = new FileReader()\n          var promise = fileReaderReady(reader)\n          reader.readAsArrayBuffer(blob)\n          return promise\n        }\n\n        function readBlobAsText(blob) {\n          var reader = new FileReader()\n          var promise = fileReaderReady(reader)\n          reader.readAsText(blob)\n          return promise\n        }\n\n        function readArrayBufferAsText(buf) {\n          var view = new Uint8Array(buf)\n          var chars = new Array(view.length)\n\n          for (var i = 0; i < view.length; i++) {\n            chars[i] = String.fromCharCode(view[i])\n          }\n          return chars.join('')\n        }\n\n        function bufferClone(buf) {\n          if (buf.slice) {\n            return buf.slice(0)\n          } else {\n            var view = new Uint8Array(buf.byteLength)\n            view.set(new Uint8Array(buf))\n            return view.buffer\n          }\n        }\n\n        function Body() {\n          this.bodyUsed = false\n\n          this._initBody = function(body) {\n            this._bodyInit = body\n            if (!body) {\n              this._bodyText = ''\n            } else if (typeof body === 'string') {\n              this._bodyText = body\n            } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n              this._bodyBlob = body\n            } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n              this._bodyFormData = body\n            } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n              this._bodyText = body.toString()\n            } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n              this._bodyArrayBuffer = bufferClone(body.buffer)\n              // IE 10-11 can't handle a DataView body.\n              this._bodyInit = new Blob([this._bodyArrayBuffer])\n            } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n              this._bodyArrayBuffer = bufferClone(body)\n            } else {\n              throw new Error('unsupported BodyInit type')\n            }\n\n            if (!this.headers.get('content-type')) {\n              if (typeof body === 'string') {\n                this.headers.set('content-type', 'text/plain;charset=UTF-8')\n              } else if (this._bodyBlob && this._bodyBlob.type) {\n                this.headers.set('content-type', this._bodyBlob.type)\n              } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n                this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n              }\n            }\n          }\n\n          if (support.blob) {\n            this.blob = function() {\n              var rejected = consumed(this)\n              if (rejected) {\n                return rejected\n              }\n\n              if (this._bodyBlob) {\n                return Promise.resolve(this._bodyBlob)\n              } else if (this._bodyArrayBuffer) {\n                return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n              } else if (this._bodyFormData) {\n                throw new Error('could not read FormData body as blob')\n              } else {\n                return Promise.resolve(new Blob([this._bodyText]))\n              }\n            }\n\n            this.arrayBuffer = function() {\n              if (this._bodyArrayBuffer) {\n                return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n              } else {\n                return this.blob().then(readBlobAsArrayBuffer)\n              }\n            }\n          }\n\n          this.text = function() {\n            var rejected = consumed(this)\n            if (rejected) {\n              return rejected\n            }\n\n            if (this._bodyBlob) {\n              return readBlobAsText(this._bodyBlob)\n            } else if (this._bodyArrayBuffer) {\n              return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n            } else if (this._bodyFormData) {\n              throw new Error('could not read FormData body as text')\n            } else {\n              return Promise.resolve(this._bodyText)\n            }\n          }\n\n          if (support.formData) {\n            this.formData = function() {\n              return this.text().then(decode)\n            }\n          }\n\n          this.json = function() {\n            return this.text().then(JSON.parse)\n          }\n\n          return this\n        }\n\n        // HTTP methods whose capitalization should be normalized\n        var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n        function normalizeMethod(method) {\n          var upcased = method.toUpperCase()\n          return (methods.indexOf(upcased) > -1) ? upcased : method\n        }\n\n        function Request(input, options) {\n          options = options || {}\n          var body = options.body\n\n          if (input instanceof Request) {\n            if (input.bodyUsed) {\n              throw new TypeError('Already read')\n            }\n            this.url = input.url\n            this.credentials = input.credentials\n            if (!options.headers) {\n              this.headers = new Headers(input.headers)\n            }\n            this.method = input.method\n            this.mode = input.mode\n            if (!body && input._bodyInit != null) {\n              body = input._bodyInit\n              input.bodyUsed = true\n            }\n          } else {\n            this.url = String(input)\n          }\n\n          this.credentials = options.credentials || this.credentials || 'omit'\n          if (options.headers || !this.headers) {\n            this.headers = new Headers(options.headers)\n          }\n          this.method = normalizeMethod(options.method || this.method || 'GET')\n          this.mode = options.mode || this.mode || null\n          this.referrer = null\n\n          if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n            throw new TypeError('Body not allowed for GET or HEAD requests')\n          }\n          this._initBody(body)\n        }\n\n        Request.prototype.clone = function() {\n          return new Request(this, { body: this._bodyInit })\n        }\n\n        function decode(body) {\n          var form = new FormData()\n          body.trim().split('&').forEach(function(bytes) {\n            if (bytes) {\n              var split = bytes.split('=')\n              var name = split.shift().replace(/\\+/g, ' ')\n              var value = split.join('=').replace(/\\+/g, ' ')\n              form.append(decodeURIComponent(name), decodeURIComponent(value))\n            }\n          })\n          return form\n        }\n\n        function parseHeaders(rawHeaders) {\n          var headers = new Headers()\n          rawHeaders.split(/\\r?\\n/).forEach(function(line) {\n            var parts = line.split(':')\n            var key = parts.shift().trim()\n            if (key) {\n              var value = parts.join(':').trim()\n              headers.append(key, value)\n            }\n          })\n          return headers\n        }\n\n        Body.call(Request.prototype)\n\n        function Response(bodyInit, options) {\n          if (!options) {\n            options = {}\n          }\n\n          this.type = 'default'\n          this.status = 'status' in options ? options.status : 200\n          this.ok = this.status >= 200 && this.status < 300\n          this.statusText = 'statusText' in options ? options.statusText : 'OK'\n          this.headers = new Headers(options.headers)\n          this.url = options.url || ''\n          this._initBody(bodyInit)\n        }\n\n        Body.call(Response.prototype)\n\n        Response.prototype.clone = function() {\n          return new Response(this._bodyInit, {\n            status: this.status,\n            statusText: this.statusText,\n            headers: new Headers(this.headers),\n            url: this.url\n          })\n        }\n\n        Response.error = function() {\n          var response = new Response(null, {status: 0, statusText: ''})\n          response.type = 'error'\n          return response\n        }\n\n        var redirectStatuses = [301, 302, 303, 307, 308]\n\n        Response.redirect = function(url, status) {\n          if (redirectStatuses.indexOf(status) === -1) {\n            throw new RangeError('Invalid status code')\n          }\n\n          return new Response(null, {status: status, headers: {location: url}})\n        }\n\n        self.Headers = Headers\n        self.Request = Request\n        self.Response = Response\n\n        self.fetch = function(input, init) {\n          return new Promise(function(resolve, reject) {\n            var request = new Request(input, init)\n            var xhr = new XMLHttpRequest()\n\n            xhr.onload = function() {\n              var options = {\n                status: xhr.status,\n                statusText: xhr.statusText,\n                headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n              }\n              options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n              var body = 'response' in xhr ? xhr.response : xhr.responseText\n              resolve(new Response(body, options))\n            }\n\n            xhr.onerror = function() {\n              reject(new TypeError('Network request failed'))\n            }\n\n            xhr.ontimeout = function() {\n              reject(new TypeError('Network request failed'))\n            }\n\n            xhr.open(request.method, request.url, true)\n\n            if (request.credentials === 'include') {\n              xhr.withCredentials = true\n            }\n\n            if ('responseType' in xhr && support.blob) {\n              xhr.responseType = 'blob'\n            }\n\n            request.headers.forEach(function(value, name) {\n              xhr.setRequestHeader(name, value)\n            })\n\n            xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n          })\n        }\n        self.fetch.polyfill = true\n      })(typeof self !== 'undefined' ? self : this);\n\n\n      return {\n        fetch: self.fetch,\n        Headers: self.Headers,\n        Request: self.Request,\n        Response: self.Response\n      };\n    }());\n  }\n\n  if (typeof define === 'function' && define.amd) {\n    define(function () {\n      return fetchPonyfill;\n    });\n  } else if (typeof exports === 'object') {\n    module.exports = fetchPonyfill;\n  } else {\n    self.fetchPonyfill = fetchPonyfill;\n  }\n}(typeof self === 'undefined' ? this : self));\n\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\n\nvar invariant = function(condition, format, a, b, c, d, e, f) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n\n  if (!condition) {\n    var error;\n    if (format === undefined) {\n      error = new Error(\n        'Minified exception occurred; use the non-minified dev environment ' +\n        'for the full error message and additional helpful warnings.'\n      );\n    } else {\n      var args = [a, b, c, d, e, f];\n      var argIndex = 0;\n      error = new Error(\n        format.replace(/%s/g, function() { return args[argIndex++]; })\n      );\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1; // we don't care about invariant's own frame\n    throw error;\n  }\n};\n\nmodule.exports = invariant;\n","module.exports = curry;\n\n/*\n  function add(a, b, c) {\n    return a + b + c;\n  }\n  curry(add)(1)(2)(3); // 6\n  curry(add)(1)(2)(2); // 5\n  curry(add)(2)(4, 3); // 9\n\n  function add(...args) {\n    return args.reduce((sum, n) => sum + n, 0)\n  }\n  var curryAdd4 = curry(add, 4)\n  curryAdd4(1)(2, 3)(4); // 10\n\n  function converter(ratio, input) {\n    return (input*ratio).toFixed(1);\n  }\n  const curriedConverter = curry(converter)\n  const milesToKm = curriedConverter(1.62);\n  milesToKm(35); // 56.7\n  milesToKm(10); // 16.2\n*/\n\nfunction curry(fn, arity) {\n  return function curried() {\n    if (arity == null) {\n      arity = fn.length;\n    }\n    var args = [].slice.call(arguments);\n    if (args.length >= arity) {\n      return fn.apply(this, args);\n    } else {\n      return function() {\n        return curried.apply(this, args.concat([].slice.call(arguments)));\n      };\n    }\n  };\n}\n","/**\n * The code was extracted from:\n * https://github.com/davidchambers/Base64.js\n */\n\nvar chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\nfunction InvalidCharacterError(message) {\n  this.message = message;\n}\n\nInvalidCharacterError.prototype = new Error();\nInvalidCharacterError.prototype.name = 'InvalidCharacterError';\n\nfunction polyfill (input) {\n  var str = String(input).replace(/=+$/, '');\n  if (str.length % 4 == 1) {\n    throw new InvalidCharacterError(\"'atob' failed: The string to be decoded is not correctly encoded.\");\n  }\n  for (\n    // initialize result and counters\n    var bc = 0, bs, buffer, idx = 0, output = '';\n    // get next character\n    buffer = str.charAt(idx++);\n    // character found in table? initialize bit storage and add its ascii value;\n    ~buffer && (bs = bc % 4 ? bs * 64 + buffer : buffer,\n      // and if not first of each 4 characters,\n      // convert the first 8 bits to one ascii character\n      bc++ % 4) ? output += String.fromCharCode(255 & bs >> (-2 * bc & 6)) : 0\n  ) {\n    // try to find character in table (0-63, not found => -1)\n    buffer = chars.indexOf(buffer);\n  }\n  return output;\n}\n\n\nmodule.exports = typeof window !== 'undefined' && window.atob && window.atob.bind(window) || polyfill;\n","var atob = require('./atob');\n\nfunction b64DecodeUnicode(str) {\n  return decodeURIComponent(atob(str).replace(/(.)/g, function (m, p) {\n    var code = p.charCodeAt(0).toString(16).toUpperCase();\n    if (code.length < 2) {\n      code = '0' + code;\n    }\n    return '%' + code;\n  }));\n}\n\nmodule.exports = function(str) {\n  var output = str.replace(/-/g, \"+\").replace(/_/g, \"/\");\n  switch (output.length % 4) {\n    case 0:\n      break;\n    case 2:\n      output += \"==\";\n      break;\n    case 3:\n      output += \"=\";\n      break;\n    default:\n      throw \"Illegal base64url string!\";\n  }\n\n  try{\n    return b64DecodeUnicode(output);\n  } catch (err) {\n    return atob(output);\n  }\n};\n","'use strict';\n\nvar base64_url_decode = require('./base64_url_decode');\n\nfunction InvalidTokenError(message) {\n  this.message = message;\n}\n\nInvalidTokenError.prototype = new Error();\nInvalidTokenError.prototype.name = 'InvalidTokenError';\n\nmodule.exports = function (token,options) {\n  if (typeof token !== 'string') {\n    throw new InvalidTokenError('Invalid token specified');\n  }\n\n  options = options || {};\n  var pos = options.header === true ? 0 : 1;\n  try {\n    return JSON.parse(base64_url_decode(token.split('.')[pos]));\n  } catch (e) {\n    throw new InvalidTokenError('Invalid token specified: ' + e.message);\n  }\n};\n\nmodule.exports.InvalidTokenError = InvalidTokenError;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import overArg from './_overArg.js';\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nexport default getPrototype;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport getPrototype from './_getPrototype.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nexport default isPlainObject;\n","var _ = require('./lodash.min').runInContext();\nmodule.exports = require('./fp/_baseConvert')(_, _);\n","var mapping = require('./_mapping'),\n    fallbackHolder = require('./placeholder');\n\n/** Built-in value reference. */\nvar push = Array.prototype.push;\n\n/**\n * Creates a function, with an arity of `n`, that invokes `func` with the\n * arguments it receives.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} n The arity of the new function.\n * @returns {Function} Returns the new function.\n */\nfunction baseArity(func, n) {\n  return n == 2\n    ? function(a, b) { return func.apply(undefined, arguments); }\n    : function(a) { return func.apply(undefined, arguments); };\n}\n\n/**\n * Creates a function that invokes `func`, with up to `n` arguments, ignoring\n * any additional arguments.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @param {number} n The arity cap.\n * @returns {Function} Returns the new function.\n */\nfunction baseAry(func, n) {\n  return n == 2\n    ? function(a, b) { return func(a, b); }\n    : function(a) { return func(a); };\n}\n\n/**\n * Creates a clone of `array`.\n *\n * @private\n * @param {Array} array The array to clone.\n * @returns {Array} Returns the cloned array.\n */\nfunction cloneArray(array) {\n  var length = array ? array.length : 0,\n      result = Array(length);\n\n  while (length--) {\n    result[length] = array[length];\n  }\n  return result;\n}\n\n/**\n * Creates a function that clones a given object using the assignment `func`.\n *\n * @private\n * @param {Function} func The assignment function.\n * @returns {Function} Returns the new cloner function.\n */\nfunction createCloner(func) {\n  return function(object) {\n    return func({}, object);\n  };\n}\n\n/**\n * A specialized version of `_.spread` which flattens the spread array into\n * the arguments of the invoked `func`.\n *\n * @private\n * @param {Function} func The function to spread arguments over.\n * @param {number} start The start position of the spread.\n * @returns {Function} Returns the new function.\n */\nfunction flatSpread(func, start) {\n  return function() {\n    var length = arguments.length,\n        lastIndex = length - 1,\n        args = Array(length);\n\n    while (length--) {\n      args[length] = arguments[length];\n    }\n    var array = args[start],\n        otherArgs = args.slice(0, start);\n\n    if (array) {\n      push.apply(otherArgs, array);\n    }\n    if (start != lastIndex) {\n      push.apply(otherArgs, args.slice(start + 1));\n    }\n    return func.apply(this, otherArgs);\n  };\n}\n\n/**\n * Creates a function that wraps `func` and uses `cloner` to clone the first\n * argument it receives.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} cloner The function to clone arguments.\n * @returns {Function} Returns the new immutable function.\n */\nfunction wrapImmutable(func, cloner) {\n  return function() {\n    var length = arguments.length;\n    if (!length) {\n      return;\n    }\n    var args = Array(length);\n    while (length--) {\n      args[length] = arguments[length];\n    }\n    var result = args[0] = cloner.apply(undefined, args);\n    func.apply(undefined, args);\n    return result;\n  };\n}\n\n/**\n * The base implementation of `convert` which accepts a `util` object of methods\n * required to perform conversions.\n *\n * @param {Object} util The util object.\n * @param {string} name The name of the function to convert.\n * @param {Function} func The function to convert.\n * @param {Object} [options] The options object.\n * @param {boolean} [options.cap=true] Specify capping iteratee arguments.\n * @param {boolean} [options.curry=true] Specify currying.\n * @param {boolean} [options.fixed=true] Specify fixed arity.\n * @param {boolean} [options.immutable=true] Specify immutable operations.\n * @param {boolean} [options.rearg=true] Specify rearranging arguments.\n * @returns {Function|Object} Returns the converted function or object.\n */\nfunction baseConvert(util, name, func, options) {\n  var isLib = typeof name == 'function',\n      isObj = name === Object(name);\n\n  if (isObj) {\n    options = func;\n    func = name;\n    name = undefined;\n  }\n  if (func == null) {\n    throw new TypeError;\n  }\n  options || (options = {});\n\n  var config = {\n    'cap': 'cap' in options ? options.cap : true,\n    'curry': 'curry' in options ? options.curry : true,\n    'fixed': 'fixed' in options ? options.fixed : true,\n    'immutable': 'immutable' in options ? options.immutable : true,\n    'rearg': 'rearg' in options ? options.rearg : true\n  };\n\n  var defaultHolder = isLib ? func : fallbackHolder,\n      forceCurry = ('curry' in options) && options.curry,\n      forceFixed = ('fixed' in options) && options.fixed,\n      forceRearg = ('rearg' in options) && options.rearg,\n      pristine = isLib ? func.runInContext() : undefined;\n\n  var helpers = isLib ? func : {\n    'ary': util.ary,\n    'assign': util.assign,\n    'clone': util.clone,\n    'curry': util.curry,\n    'forEach': util.forEach,\n    'isArray': util.isArray,\n    'isError': util.isError,\n    'isFunction': util.isFunction,\n    'isWeakMap': util.isWeakMap,\n    'iteratee': util.iteratee,\n    'keys': util.keys,\n    'rearg': util.rearg,\n    'toInteger': util.toInteger,\n    'toPath': util.toPath\n  };\n\n  var ary = helpers.ary,\n      assign = helpers.assign,\n      clone = helpers.clone,\n      curry = helpers.curry,\n      each = helpers.forEach,\n      isArray = helpers.isArray,\n      isError = helpers.isError,\n      isFunction = helpers.isFunction,\n      isWeakMap = helpers.isWeakMap,\n      keys = helpers.keys,\n      rearg = helpers.rearg,\n      toInteger = helpers.toInteger,\n      toPath = helpers.toPath;\n\n  var aryMethodKeys = keys(mapping.aryMethod);\n\n  var wrappers = {\n    'castArray': function(castArray) {\n      return function() {\n        var value = arguments[0];\n        return isArray(value)\n          ? castArray(cloneArray(value))\n          : castArray.apply(undefined, arguments);\n      };\n    },\n    'iteratee': function(iteratee) {\n      return function() {\n        var func = arguments[0],\n            arity = arguments[1],\n            result = iteratee(func, arity),\n            length = result.length;\n\n        if (config.cap && typeof arity == 'number') {\n          arity = arity > 2 ? (arity - 2) : 1;\n          return (length && length <= arity) ? result : baseAry(result, arity);\n        }\n        return result;\n      };\n    },\n    'mixin': function(mixin) {\n      return function(source) {\n        var func = this;\n        if (!isFunction(func)) {\n          return mixin(func, Object(source));\n        }\n        var pairs = [];\n        each(keys(source), function(key) {\n          if (isFunction(source[key])) {\n            pairs.push([key, func.prototype[key]]);\n          }\n        });\n\n        mixin(func, Object(source));\n\n        each(pairs, function(pair) {\n          var value = pair[1];\n          if (isFunction(value)) {\n            func.prototype[pair[0]] = value;\n          } else {\n            delete func.prototype[pair[0]];\n          }\n        });\n        return func;\n      };\n    },\n    'nthArg': function(nthArg) {\n      return function(n) {\n        var arity = n < 0 ? 1 : (toInteger(n) + 1);\n        return curry(nthArg(n), arity);\n      };\n    },\n    'rearg': function(rearg) {\n      return function(func, indexes) {\n        var arity = indexes ? indexes.length : 0;\n        return curry(rearg(func, indexes), arity);\n      };\n    },\n    'runInContext': function(runInContext) {\n      return function(context) {\n        return baseConvert(util, runInContext(context), options);\n      };\n    }\n  };\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Casts `func` to a function with an arity capped iteratee if needed.\n   *\n   * @private\n   * @param {string} name The name of the function to inspect.\n   * @param {Function} func The function to inspect.\n   * @returns {Function} Returns the cast function.\n   */\n  function castCap(name, func) {\n    if (config.cap) {\n      var indexes = mapping.iterateeRearg[name];\n      if (indexes) {\n        return iterateeRearg(func, indexes);\n      }\n      var n = !isLib && mapping.iterateeAry[name];\n      if (n) {\n        return iterateeAry(func, n);\n      }\n    }\n    return func;\n  }\n\n  /**\n   * Casts `func` to a curried function if needed.\n   *\n   * @private\n   * @param {string} name The name of the function to inspect.\n   * @param {Function} func The function to inspect.\n   * @param {number} n The arity of `func`.\n   * @returns {Function} Returns the cast function.\n   */\n  function castCurry(name, func, n) {\n    return (forceCurry || (config.curry && n > 1))\n      ? curry(func, n)\n      : func;\n  }\n\n  /**\n   * Casts `func` to a fixed arity function if needed.\n   *\n   * @private\n   * @param {string} name The name of the function to inspect.\n   * @param {Function} func The function to inspect.\n   * @param {number} n The arity cap.\n   * @returns {Function} Returns the cast function.\n   */\n  function castFixed(name, func, n) {\n    if (config.fixed && (forceFixed || !mapping.skipFixed[name])) {\n      var data = mapping.methodSpread[name],\n          start = data && data.start;\n\n      return start  === undefined ? ary(func, n) : flatSpread(func, start);\n    }\n    return func;\n  }\n\n  /**\n   * Casts `func` to an rearged function if needed.\n   *\n   * @private\n   * @param {string} name The name of the function to inspect.\n   * @param {Function} func The function to inspect.\n   * @param {number} n The arity of `func`.\n   * @returns {Function} Returns the cast function.\n   */\n  function castRearg(name, func, n) {\n    return (config.rearg && n > 1 && (forceRearg || !mapping.skipRearg[name]))\n      ? rearg(func, mapping.methodRearg[name] || mapping.aryRearg[n])\n      : func;\n  }\n\n  /**\n   * Creates a clone of `object` by `path`.\n   *\n   * @private\n   * @param {Object} object The object to clone.\n   * @param {Array|string} path The path to clone by.\n   * @returns {Object} Returns the cloned object.\n   */\n  function cloneByPath(object, path) {\n    path = toPath(path);\n\n    var index = -1,\n        length = path.length,\n        lastIndex = length - 1,\n        result = clone(Object(object)),\n        nested = result;\n\n    while (nested != null && ++index < length) {\n      var key = path[index],\n          value = nested[key];\n\n      if (value != null &&\n          !(isFunction(value) || isError(value) || isWeakMap(value))) {\n        nested[key] = clone(index == lastIndex ? value : Object(value));\n      }\n      nested = nested[key];\n    }\n    return result;\n  }\n\n  /**\n   * Converts `lodash` to an immutable auto-curried iteratee-first data-last\n   * version with conversion `options` applied.\n   *\n   * @param {Object} [options] The options object. See `baseConvert` for more details.\n   * @returns {Function} Returns the converted `lodash`.\n   */\n  function convertLib(options) {\n    return _.runInContext.convert(options)(undefined);\n  }\n\n  /**\n   * Create a converter function for `func` of `name`.\n   *\n   * @param {string} name The name of the function to convert.\n   * @param {Function} func The function to convert.\n   * @returns {Function} Returns the new converter function.\n   */\n  function createConverter(name, func) {\n    var realName = mapping.aliasToReal[name] || name,\n        methodName = mapping.remap[realName] || realName,\n        oldOptions = options;\n\n    return function(options) {\n      var newUtil = isLib ? pristine : helpers,\n          newFunc = isLib ? pristine[methodName] : func,\n          newOptions = assign(assign({}, oldOptions), options);\n\n      return baseConvert(newUtil, realName, newFunc, newOptions);\n    };\n  }\n\n  /**\n   * Creates a function that wraps `func` to invoke its iteratee, with up to `n`\n   * arguments, ignoring any additional arguments.\n   *\n   * @private\n   * @param {Function} func The function to cap iteratee arguments for.\n   * @param {number} n The arity cap.\n   * @returns {Function} Returns the new function.\n   */\n  function iterateeAry(func, n) {\n    return overArg(func, function(func) {\n      return typeof func == 'function' ? baseAry(func, n) : func;\n    });\n  }\n\n  /**\n   * Creates a function that wraps `func` to invoke its iteratee with arguments\n   * arranged according to the specified `indexes` where the argument value at\n   * the first index is provided as the first argument, the argument value at\n   * the second index is provided as the second argument, and so on.\n   *\n   * @private\n   * @param {Function} func The function to rearrange iteratee arguments for.\n   * @param {number[]} indexes The arranged argument indexes.\n   * @returns {Function} Returns the new function.\n   */\n  function iterateeRearg(func, indexes) {\n    return overArg(func, function(func) {\n      var n = indexes.length;\n      return baseArity(rearg(baseAry(func, n), indexes), n);\n    });\n  }\n\n  /**\n   * Creates a function that invokes `func` with its first argument transformed.\n   *\n   * @private\n   * @param {Function} func The function to wrap.\n   * @param {Function} transform The argument transform.\n   * @returns {Function} Returns the new function.\n   */\n  function overArg(func, transform) {\n    return function() {\n      var length = arguments.length;\n      if (!length) {\n        return func();\n      }\n      var args = Array(length);\n      while (length--) {\n        args[length] = arguments[length];\n      }\n      var index = config.rearg ? 0 : (length - 1);\n      args[index] = transform(args[index]);\n      return func.apply(undefined, args);\n    };\n  }\n\n  /**\n   * Creates a function that wraps `func` and applys the conversions\n   * rules by `name`.\n   *\n   * @private\n   * @param {string} name The name of the function to wrap.\n   * @param {Function} func The function to wrap.\n   * @returns {Function} Returns the converted function.\n   */\n  function wrap(name, func, placeholder) {\n    var result,\n        realName = mapping.aliasToReal[name] || name,\n        wrapped = func,\n        wrapper = wrappers[realName];\n\n    if (wrapper) {\n      wrapped = wrapper(func);\n    }\n    else if (config.immutable) {\n      if (mapping.mutate.array[realName]) {\n        wrapped = wrapImmutable(func, cloneArray);\n      }\n      else if (mapping.mutate.object[realName]) {\n        wrapped = wrapImmutable(func, createCloner(func));\n      }\n      else if (mapping.mutate.set[realName]) {\n        wrapped = wrapImmutable(func, cloneByPath);\n      }\n    }\n    each(aryMethodKeys, function(aryKey) {\n      each(mapping.aryMethod[aryKey], function(otherName) {\n        if (realName == otherName) {\n          var data = mapping.methodSpread[realName],\n              afterRearg = data && data.afterRearg;\n\n          result = afterRearg\n            ? castFixed(realName, castRearg(realName, wrapped, aryKey), aryKey)\n            : castRearg(realName, castFixed(realName, wrapped, aryKey), aryKey);\n\n          result = castCap(realName, result);\n          result = castCurry(realName, result, aryKey);\n          return false;\n        }\n      });\n      return !result;\n    });\n\n    result || (result = wrapped);\n    if (result == func) {\n      result = forceCurry ? curry(result, 1) : function() {\n        return func.apply(this, arguments);\n      };\n    }\n    result.convert = createConverter(realName, func);\n    result.placeholder = func.placeholder = placeholder;\n\n    return result;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  if (!isObj) {\n    return wrap(name, func, defaultHolder);\n  }\n  var _ = func;\n\n  // Convert methods by ary cap.\n  var pairs = [];\n  each(aryMethodKeys, function(aryKey) {\n    each(mapping.aryMethod[aryKey], function(key) {\n      var func = _[mapping.remap[key] || key];\n      if (func) {\n        pairs.push([key, wrap(key, func, _)]);\n      }\n    });\n  });\n\n  // Convert remaining methods.\n  each(keys(_), function(key) {\n    var func = _[key];\n    if (typeof func == 'function') {\n      var length = pairs.length;\n      while (length--) {\n        if (pairs[length][0] == key) {\n          return;\n        }\n      }\n      func.convert = createConverter(key, func);\n      pairs.push([key, func]);\n    }\n  });\n\n  // Assign to `_` leaving `_.prototype` unchanged to allow chaining.\n  each(pairs, function(pair) {\n    _[pair[0]] = pair[1];\n  });\n\n  _.convert = convertLib;\n  _.placeholder = _;\n\n  // Assign aliases.\n  each(keys(_), function(key) {\n    each(mapping.realToAlias[key] || [], function(alias) {\n      _[alias] = _[key];\n    });\n  });\n\n  return _;\n}\n\nmodule.exports = baseConvert;\n","/** Used to map aliases to their real names. */\nexports.aliasToReal = {\n\n  // Lodash aliases.\n  'each': 'forEach',\n  'eachRight': 'forEachRight',\n  'entries': 'toPairs',\n  'entriesIn': 'toPairsIn',\n  'extend': 'assignIn',\n  'extendAll': 'assignInAll',\n  'extendAllWith': 'assignInAllWith',\n  'extendWith': 'assignInWith',\n  'first': 'head',\n\n  // Methods that are curried variants of others.\n  'conforms': 'conformsTo',\n  'matches': 'isMatch',\n  'property': 'get',\n\n  // Ramda aliases.\n  '__': 'placeholder',\n  'F': 'stubFalse',\n  'T': 'stubTrue',\n  'all': 'every',\n  'allPass': 'overEvery',\n  'always': 'constant',\n  'any': 'some',\n  'anyPass': 'overSome',\n  'apply': 'spread',\n  'assoc': 'set',\n  'assocPath': 'set',\n  'complement': 'negate',\n  'compose': 'flowRight',\n  'contains': 'includes',\n  'dissoc': 'unset',\n  'dissocPath': 'unset',\n  'dropLast': 'dropRight',\n  'dropLastWhile': 'dropRightWhile',\n  'equals': 'isEqual',\n  'identical': 'eq',\n  'indexBy': 'keyBy',\n  'init': 'initial',\n  'invertObj': 'invert',\n  'juxt': 'over',\n  'omitAll': 'omit',\n  'nAry': 'ary',\n  'path': 'get',\n  'pathEq': 'matchesProperty',\n  'pathOr': 'getOr',\n  'paths': 'at',\n  'pickAll': 'pick',\n  'pipe': 'flow',\n  'pluck': 'map',\n  'prop': 'get',\n  'propEq': 'matchesProperty',\n  'propOr': 'getOr',\n  'props': 'at',\n  'symmetricDifference': 'xor',\n  'symmetricDifferenceBy': 'xorBy',\n  'symmetricDifferenceWith': 'xorWith',\n  'takeLast': 'takeRight',\n  'takeLastWhile': 'takeRightWhile',\n  'unapply': 'rest',\n  'unnest': 'flatten',\n  'useWith': 'overArgs',\n  'where': 'conformsTo',\n  'whereEq': 'isMatch',\n  'zipObj': 'zipObject'\n};\n\n/** Used to map ary to method names. */\nexports.aryMethod = {\n  '1': [\n    'assignAll', 'assignInAll', 'attempt', 'castArray', 'ceil', 'create',\n    'curry', 'curryRight', 'defaultsAll', 'defaultsDeepAll', 'floor', 'flow',\n    'flowRight', 'fromPairs', 'invert', 'iteratee', 'memoize', 'method', 'mergeAll',\n    'methodOf', 'mixin', 'nthArg', 'over', 'overEvery', 'overSome','rest', 'reverse',\n    'round', 'runInContext', 'spread', 'template', 'trim', 'trimEnd', 'trimStart',\n    'uniqueId', 'words', 'zipAll'\n  ],\n  '2': [\n    'add', 'after', 'ary', 'assign', 'assignAllWith', 'assignIn', 'assignInAllWith',\n    'at', 'before', 'bind', 'bindAll', 'bindKey', 'chunk', 'cloneDeepWith',\n    'cloneWith', 'concat', 'conformsTo', 'countBy', 'curryN', 'curryRightN',\n    'debounce', 'defaults', 'defaultsDeep', 'defaultTo', 'delay', 'difference',\n    'divide', 'drop', 'dropRight', 'dropRightWhile', 'dropWhile', 'endsWith', 'eq',\n    'every', 'filter', 'find', 'findIndex', 'findKey', 'findLast', 'findLastIndex',\n    'findLastKey', 'flatMap', 'flatMapDeep', 'flattenDepth', 'forEach',\n    'forEachRight', 'forIn', 'forInRight', 'forOwn', 'forOwnRight', 'get',\n    'groupBy', 'gt', 'gte', 'has', 'hasIn', 'includes', 'indexOf', 'intersection',\n    'invertBy', 'invoke', 'invokeMap', 'isEqual', 'isMatch', 'join', 'keyBy',\n    'lastIndexOf', 'lt', 'lte', 'map', 'mapKeys', 'mapValues', 'matchesProperty',\n    'maxBy', 'meanBy', 'merge', 'mergeAllWith', 'minBy', 'multiply', 'nth', 'omit',\n    'omitBy', 'overArgs', 'pad', 'padEnd', 'padStart', 'parseInt', 'partial',\n    'partialRight', 'partition', 'pick', 'pickBy', 'propertyOf', 'pull', 'pullAll',\n    'pullAt', 'random', 'range', 'rangeRight', 'rearg', 'reject', 'remove',\n    'repeat', 'restFrom', 'result', 'sampleSize', 'some', 'sortBy', 'sortedIndex',\n    'sortedIndexOf', 'sortedLastIndex', 'sortedLastIndexOf', 'sortedUniqBy',\n    'split', 'spreadFrom', 'startsWith', 'subtract', 'sumBy', 'take', 'takeRight',\n    'takeRightWhile', 'takeWhile', 'tap', 'throttle', 'thru', 'times', 'trimChars',\n    'trimCharsEnd', 'trimCharsStart', 'truncate', 'union', 'uniqBy', 'uniqWith',\n    'unset', 'unzipWith', 'without', 'wrap', 'xor', 'zip', 'zipObject',\n    'zipObjectDeep'\n  ],\n  '3': [\n    'assignInWith', 'assignWith', 'clamp', 'differenceBy', 'differenceWith',\n    'findFrom', 'findIndexFrom', 'findLastFrom', 'findLastIndexFrom', 'getOr',\n    'includesFrom', 'indexOfFrom', 'inRange', 'intersectionBy', 'intersectionWith',\n    'invokeArgs', 'invokeArgsMap', 'isEqualWith', 'isMatchWith', 'flatMapDepth',\n    'lastIndexOfFrom', 'mergeWith', 'orderBy', 'padChars', 'padCharsEnd',\n    'padCharsStart', 'pullAllBy', 'pullAllWith', 'rangeStep', 'rangeStepRight',\n    'reduce', 'reduceRight', 'replace', 'set', 'slice', 'sortedIndexBy',\n    'sortedLastIndexBy', 'transform', 'unionBy', 'unionWith', 'update', 'xorBy',\n    'xorWith', 'zipWith'\n  ],\n  '4': [\n    'fill', 'setWith', 'updateWith'\n  ]\n};\n\n/** Used to map ary to rearg configs. */\nexports.aryRearg = {\n  '2': [1, 0],\n  '3': [2, 0, 1],\n  '4': [3, 2, 0, 1]\n};\n\n/** Used to map method names to their iteratee ary. */\nexports.iterateeAry = {\n  'dropRightWhile': 1,\n  'dropWhile': 1,\n  'every': 1,\n  'filter': 1,\n  'find': 1,\n  'findFrom': 1,\n  'findIndex': 1,\n  'findIndexFrom': 1,\n  'findKey': 1,\n  'findLast': 1,\n  'findLastFrom': 1,\n  'findLastIndex': 1,\n  'findLastIndexFrom': 1,\n  'findLastKey': 1,\n  'flatMap': 1,\n  'flatMapDeep': 1,\n  'flatMapDepth': 1,\n  'forEach': 1,\n  'forEachRight': 1,\n  'forIn': 1,\n  'forInRight': 1,\n  'forOwn': 1,\n  'forOwnRight': 1,\n  'map': 1,\n  'mapKeys': 1,\n  'mapValues': 1,\n  'partition': 1,\n  'reduce': 2,\n  'reduceRight': 2,\n  'reject': 1,\n  'remove': 1,\n  'some': 1,\n  'takeRightWhile': 1,\n  'takeWhile': 1,\n  'times': 1,\n  'transform': 2\n};\n\n/** Used to map method names to iteratee rearg configs. */\nexports.iterateeRearg = {\n  'mapKeys': [1],\n  'reduceRight': [1, 0]\n};\n\n/** Used to map method names to rearg configs. */\nexports.methodRearg = {\n  'assignInAllWith': [1, 0],\n  'assignInWith': [1, 2, 0],\n  'assignAllWith': [1, 0],\n  'assignWith': [1, 2, 0],\n  'differenceBy': [1, 2, 0],\n  'differenceWith': [1, 2, 0],\n  'getOr': [2, 1, 0],\n  'intersectionBy': [1, 2, 0],\n  'intersectionWith': [1, 2, 0],\n  'isEqualWith': [1, 2, 0],\n  'isMatchWith': [2, 1, 0],\n  'mergeAllWith': [1, 0],\n  'mergeWith': [1, 2, 0],\n  'padChars': [2, 1, 0],\n  'padCharsEnd': [2, 1, 0],\n  'padCharsStart': [2, 1, 0],\n  'pullAllBy': [2, 1, 0],\n  'pullAllWith': [2, 1, 0],\n  'rangeStep': [1, 2, 0],\n  'rangeStepRight': [1, 2, 0],\n  'setWith': [3, 1, 2, 0],\n  'sortedIndexBy': [2, 1, 0],\n  'sortedLastIndexBy': [2, 1, 0],\n  'unionBy': [1, 2, 0],\n  'unionWith': [1, 2, 0],\n  'updateWith': [3, 1, 2, 0],\n  'xorBy': [1, 2, 0],\n  'xorWith': [1, 2, 0],\n  'zipWith': [1, 2, 0]\n};\n\n/** Used to map method names to spread configs. */\nexports.methodSpread = {\n  'assignAll': { 'start': 0 },\n  'assignAllWith': { 'start': 0 },\n  'assignInAll': { 'start': 0 },\n  'assignInAllWith': { 'start': 0 },\n  'defaultsAll': { 'start': 0 },\n  'defaultsDeepAll': { 'start': 0 },\n  'invokeArgs': { 'start': 2 },\n  'invokeArgsMap': { 'start': 2 },\n  'mergeAll': { 'start': 0 },\n  'mergeAllWith': { 'start': 0 },\n  'partial': { 'start': 1 },\n  'partialRight': { 'start': 1 },\n  'without': { 'start': 1 },\n  'zipAll': { 'start': 0 }\n};\n\n/** Used to identify methods which mutate arrays or objects. */\nexports.mutate = {\n  'array': {\n    'fill': true,\n    'pull': true,\n    'pullAll': true,\n    'pullAllBy': true,\n    'pullAllWith': true,\n    'pullAt': true,\n    'remove': true,\n    'reverse': true\n  },\n  'object': {\n    'assign': true,\n    'assignAll': true,\n    'assignAllWith': true,\n    'assignIn': true,\n    'assignInAll': true,\n    'assignInAllWith': true,\n    'assignInWith': true,\n    'assignWith': true,\n    'defaults': true,\n    'defaultsAll': true,\n    'defaultsDeep': true,\n    'defaultsDeepAll': true,\n    'merge': true,\n    'mergeAll': true,\n    'mergeAllWith': true,\n    'mergeWith': true,\n  },\n  'set': {\n    'set': true,\n    'setWith': true,\n    'unset': true,\n    'update': true,\n    'updateWith': true\n  }\n};\n\n/** Used to map real names to their aliases. */\nexports.realToAlias = (function() {\n  var hasOwnProperty = Object.prototype.hasOwnProperty,\n      object = exports.aliasToReal,\n      result = {};\n\n  for (var key in object) {\n    var value = object[key];\n    if (hasOwnProperty.call(result, value)) {\n      result[value].push(key);\n    } else {\n      result[value] = [key];\n    }\n  }\n  return result;\n}());\n\n/** Used to map method names to other names. */\nexports.remap = {\n  'assignAll': 'assign',\n  'assignAllWith': 'assignWith',\n  'assignInAll': 'assignIn',\n  'assignInAllWith': 'assignInWith',\n  'curryN': 'curry',\n  'curryRightN': 'curryRight',\n  'defaultsAll': 'defaults',\n  'defaultsDeepAll': 'defaultsDeep',\n  'findFrom': 'find',\n  'findIndexFrom': 'findIndex',\n  'findLastFrom': 'findLast',\n  'findLastIndexFrom': 'findLastIndex',\n  'getOr': 'get',\n  'includesFrom': 'includes',\n  'indexOfFrom': 'indexOf',\n  'invokeArgs': 'invoke',\n  'invokeArgsMap': 'invokeMap',\n  'lastIndexOfFrom': 'lastIndexOf',\n  'mergeAll': 'merge',\n  'mergeAllWith': 'mergeWith',\n  'padChars': 'pad',\n  'padCharsEnd': 'padEnd',\n  'padCharsStart': 'padStart',\n  'propertyOf': 'get',\n  'rangeStep': 'range',\n  'rangeStepRight': 'rangeRight',\n  'restFrom': 'rest',\n  'spreadFrom': 'spread',\n  'trimChars': 'trim',\n  'trimCharsEnd': 'trimEnd',\n  'trimCharsStart': 'trimStart',\n  'zipAll': 'zip'\n};\n\n/** Used to track methods that skip fixing their arity. */\nexports.skipFixed = {\n  'castArray': true,\n  'flow': true,\n  'flowRight': true,\n  'iteratee': true,\n  'mixin': true,\n  'rearg': true,\n  'runInContext': true\n};\n\n/** Used to track methods that skip rearranging arguments. */\nexports.skipRearg = {\n  'add': true,\n  'assign': true,\n  'assignIn': true,\n  'bind': true,\n  'bindKey': true,\n  'concat': true,\n  'difference': true,\n  'divide': true,\n  'eq': true,\n  'gt': true,\n  'gte': true,\n  'isEqual': true,\n  'lt': true,\n  'lte': true,\n  'matchesProperty': true,\n  'merge': true,\n  'multiply': true,\n  'overArgs': true,\n  'partial': true,\n  'partialRight': true,\n  'propertyOf': true,\n  'random': true,\n  'range': true,\n  'rangeRight': true,\n  'subtract': true,\n  'zip': true,\n  'zipObject': true,\n  'zipObjectDeep': true\n};\n","/**\n * The default argument placeholder value for methods.\n *\n * @type {Object}\n */\nmodule.exports = {};\n","/**\n * @license\n * Lodash lodash.com/license | Underscore.js 1.8.3 underscorejs.org/LICENSE\n */\n;(function(){function n(n,t,r){switch(r.length){case 0:return n.call(t);case 1:return n.call(t,r[0]);case 2:return n.call(t,r[0],r[1]);case 3:return n.call(t,r[0],r[1],r[2])}return n.apply(t,r)}function t(n,t,r,e){for(var u=-1,i=null==n?0:n.length;++u<i;){var o=n[u];t(e,o,r(o),n)}return e}function r(n,t){for(var r=-1,e=null==n?0:n.length;++r<e&&false!==t(n[r],r,n););return n}function e(n,t){for(var r=null==n?0:n.length;r--&&false!==t(n[r],r,n););return n}function u(n,t){for(var r=-1,e=null==n?0:n.length;++r<e;)if(!t(n[r],r,n))return false;\nreturn true}function i(n,t){for(var r=-1,e=null==n?0:n.length,u=0,i=[];++r<e;){var o=n[r];t(o,r,n)&&(i[u++]=o)}return i}function o(n,t){return!(null==n||!n.length)&&-1<v(n,t,0)}function f(n,t,r){for(var e=-1,u=null==n?0:n.length;++e<u;)if(r(t,n[e]))return true;return false}function c(n,t){for(var r=-1,e=null==n?0:n.length,u=Array(e);++r<e;)u[r]=t(n[r],r,n);return u}function a(n,t){for(var r=-1,e=t.length,u=n.length;++r<e;)n[u+r]=t[r];return n}function l(n,t,r,e){var u=-1,i=null==n?0:n.length;for(e&&i&&(r=n[++u]);++u<i;)r=t(r,n[u],u,n);\nreturn r}function s(n,t,r,e){var u=null==n?0:n.length;for(e&&u&&(r=n[--u]);u--;)r=t(r,n[u],u,n);return r}function h(n,t){for(var r=-1,e=null==n?0:n.length;++r<e;)if(t(n[r],r,n))return true;return false}function p(n,t,r){var e;return r(n,function(n,r,u){if(t(n,r,u))return e=r,false}),e}function _(n,t,r,e){var u=n.length;for(r+=e?1:-1;e?r--:++r<u;)if(t(n[r],r,n))return r;return-1}function v(n,t,r){if(t===t)n:{--r;for(var e=n.length;++r<e;)if(n[r]===t){n=r;break n}n=-1}else n=_(n,d,r);return n}function g(n,t,r,e){\n--r;for(var u=n.length;++r<u;)if(e(n[r],t))return r;return-1}function d(n){return n!==n}function y(n,t){var r=null==n?0:n.length;return r?m(n,t)/r:F}function b(n){return function(t){return null==t?T:t[n]}}function x(n){return function(t){return null==n?T:n[t]}}function j(n,t,r,e,u){return u(n,function(n,u,i){r=e?(e=false,n):t(r,n,u,i)}),r}function w(n,t){var r=n.length;for(n.sort(t);r--;)n[r]=n[r].c;return n}function m(n,t){for(var r,e=-1,u=n.length;++e<u;){var i=t(n[e]);i!==T&&(r=r===T?i:r+i)}return r;\n}function A(n,t){for(var r=-1,e=Array(n);++r<n;)e[r]=t(r);return e}function k(n,t){return c(t,function(t){return[t,n[t]]})}function E(n){return function(t){return n(t)}}function S(n,t){return c(t,function(t){return n[t]})}function O(n,t){return n.has(t)}function I(n,t){for(var r=-1,e=n.length;++r<e&&-1<v(t,n[r],0););return r}function R(n,t){for(var r=n.length;r--&&-1<v(t,n[r],0););return r}function z(n){return\"\\\\\"+Ln[n]}function W(n){var t=-1,r=Array(n.size);return n.forEach(function(n,e){r[++t]=[e,n];\n}),r}function U(n,t){return function(r){return n(t(r))}}function B(n,t){for(var r=-1,e=n.length,u=0,i=[];++r<e;){var o=n[r];o!==t&&\"__lodash_placeholder__\"!==o||(n[r]=\"__lodash_placeholder__\",i[u++]=r)}return i}function L(n){var t=-1,r=Array(n.size);return n.forEach(function(n){r[++t]=n}),r}function C(n){var t=-1,r=Array(n.size);return n.forEach(function(n){r[++t]=[n,n]}),r}function D(n){if(Rn.test(n)){for(var t=On.lastIndex=0;On.test(n);)++t;n=t}else n=Qn(n);return n}function M(n){return Rn.test(n)?n.match(On)||[]:n.split(\"\");\n}var T,$=1/0,F=NaN,N=[[\"ary\",128],[\"bind\",1],[\"bindKey\",2],[\"curry\",8],[\"curryRight\",16],[\"flip\",512],[\"partial\",32],[\"partialRight\",64],[\"rearg\",256]],P=/\\b__p\\+='';/g,Z=/\\b(__p\\+=)''\\+/g,q=/(__e\\(.*?\\)|\\b__t\\))\\+'';/g,V=/&(?:amp|lt|gt|quot|#39);/g,K=/[&<>\"']/g,G=RegExp(V.source),H=RegExp(K.source),J=/<%-([\\s\\S]+?)%>/g,Y=/<%([\\s\\S]+?)%>/g,Q=/<%=([\\s\\S]+?)%>/g,X=/\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,nn=/^\\w*$/,tn=/[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g,rn=/[\\\\^$.*+?()[\\]{}|]/g,en=RegExp(rn.source),un=/^\\s+|\\s+$/g,on=/^\\s+/,fn=/\\s+$/,cn=/\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/,an=/\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,ln=/,? & /,sn=/[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g,hn=/\\\\(\\\\)?/g,pn=/\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g,_n=/\\w*$/,vn=/^[-+]0x[0-9a-f]+$/i,gn=/^0b[01]+$/i,dn=/^\\[object .+?Constructor\\]$/,yn=/^0o[0-7]+$/i,bn=/^(?:0|[1-9]\\d*)$/,xn=/[\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f]/g,jn=/($^)/,wn=/['\\n\\r\\u2028\\u2029\\\\]/g,mn=\"[\\\\ufe0e\\\\ufe0f]?(?:[\\\\u0300-\\\\u036f\\\\ufe20-\\\\ufe2f\\\\u20d0-\\\\u20ff]|\\\\ud83c[\\\\udffb-\\\\udfff])?(?:\\\\u200d(?:[^\\\\ud800-\\\\udfff]|(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}|[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff])[\\\\ufe0e\\\\ufe0f]?(?:[\\\\u0300-\\\\u036f\\\\ufe20-\\\\ufe2f\\\\u20d0-\\\\u20ff]|\\\\ud83c[\\\\udffb-\\\\udfff])?)*\",An=\"(?:[\\\\u2700-\\\\u27bf]|(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}|[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff])\"+mn,kn=\"(?:[^\\\\ud800-\\\\udfff][\\\\u0300-\\\\u036f\\\\ufe20-\\\\ufe2f\\\\u20d0-\\\\u20ff]?|[\\\\u0300-\\\\u036f\\\\ufe20-\\\\ufe2f\\\\u20d0-\\\\u20ff]|(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}|[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]|[\\\\ud800-\\\\udfff])\",En=RegExp(\"['\\u2019]\",\"g\"),Sn=RegExp(\"[\\\\u0300-\\\\u036f\\\\ufe20-\\\\ufe2f\\\\u20d0-\\\\u20ff]\",\"g\"),On=RegExp(\"\\\\ud83c[\\\\udffb-\\\\udfff](?=\\\\ud83c[\\\\udffb-\\\\udfff])|\"+kn+mn,\"g\"),In=RegExp([\"[A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde]?[a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff]+(?:['\\u2019](?:d|ll|m|re|s|t|ve))?(?=[\\\\xac\\\\xb1\\\\xd7\\\\xf7\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf\\\\u2000-\\\\u206f \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000]|[A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde]|$)|(?:[A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde]|[^\\\\ud800-\\\\udfff\\\\xac\\\\xb1\\\\xd7\\\\xf7\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf\\\\u2000-\\\\u206f \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000\\\\d+\\\\u2700-\\\\u27bfa-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xffA-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde])+(?:['\\u2019](?:D|LL|M|RE|S|T|VE))?(?=[\\\\xac\\\\xb1\\\\xd7\\\\xf7\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf\\\\u2000-\\\\u206f \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000]|[A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde](?:[a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff]|[^\\\\ud800-\\\\udfff\\\\xac\\\\xb1\\\\xd7\\\\xf7\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf\\\\u2000-\\\\u206f \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000\\\\d+\\\\u2700-\\\\u27bfa-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xffA-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde])|$)|[A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde]?(?:[a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff]|[^\\\\ud800-\\\\udfff\\\\xac\\\\xb1\\\\xd7\\\\xf7\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf\\\\u2000-\\\\u206f \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000\\\\d+\\\\u2700-\\\\u27bfa-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xffA-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde])+(?:['\\u2019](?:d|ll|m|re|s|t|ve))?|[A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde]+(?:['\\u2019](?:D|LL|M|RE|S|T|VE))?|\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])|\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])|\\\\d+\",An].join(\"|\"),\"g\"),Rn=RegExp(\"[\\\\u200d\\\\ud800-\\\\udfff\\\\u0300-\\\\u036f\\\\ufe20-\\\\ufe2f\\\\u20d0-\\\\u20ff\\\\ufe0e\\\\ufe0f]\"),zn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Wn=\"Array Buffer DataView Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Map Math Object Promise RegExp Set String Symbol TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap _ clearTimeout isFinite parseInt setTimeout\".split(\" \"),Un={};\nUn[\"[object Float32Array]\"]=Un[\"[object Float64Array]\"]=Un[\"[object Int8Array]\"]=Un[\"[object Int16Array]\"]=Un[\"[object Int32Array]\"]=Un[\"[object Uint8Array]\"]=Un[\"[object Uint8ClampedArray]\"]=Un[\"[object Uint16Array]\"]=Un[\"[object Uint32Array]\"]=true,Un[\"[object Arguments]\"]=Un[\"[object Array]\"]=Un[\"[object ArrayBuffer]\"]=Un[\"[object Boolean]\"]=Un[\"[object DataView]\"]=Un[\"[object Date]\"]=Un[\"[object Error]\"]=Un[\"[object Function]\"]=Un[\"[object Map]\"]=Un[\"[object Number]\"]=Un[\"[object Object]\"]=Un[\"[object RegExp]\"]=Un[\"[object Set]\"]=Un[\"[object String]\"]=Un[\"[object WeakMap]\"]=false;\nvar Bn={};Bn[\"[object Arguments]\"]=Bn[\"[object Array]\"]=Bn[\"[object ArrayBuffer]\"]=Bn[\"[object DataView]\"]=Bn[\"[object Boolean]\"]=Bn[\"[object Date]\"]=Bn[\"[object Float32Array]\"]=Bn[\"[object Float64Array]\"]=Bn[\"[object Int8Array]\"]=Bn[\"[object Int16Array]\"]=Bn[\"[object Int32Array]\"]=Bn[\"[object Map]\"]=Bn[\"[object Number]\"]=Bn[\"[object Object]\"]=Bn[\"[object RegExp]\"]=Bn[\"[object Set]\"]=Bn[\"[object String]\"]=Bn[\"[object Symbol]\"]=Bn[\"[object Uint8Array]\"]=Bn[\"[object Uint8ClampedArray]\"]=Bn[\"[object Uint16Array]\"]=Bn[\"[object Uint32Array]\"]=true,\nBn[\"[object Error]\"]=Bn[\"[object Function]\"]=Bn[\"[object WeakMap]\"]=false;var Ln={\"\\\\\":\"\\\\\",\"'\":\"'\",\"\\n\":\"n\",\"\\r\":\"r\",\"\\u2028\":\"u2028\",\"\\u2029\":\"u2029\"},Cn=parseFloat,Dn=parseInt,Mn=typeof global==\"object\"&&global&&global.Object===Object&&global,Tn=typeof self==\"object\"&&self&&self.Object===Object&&self,$n=Mn||Tn||Function(\"return this\")(),Fn=typeof exports==\"object\"&&exports&&!exports.nodeType&&exports,Nn=Fn&&typeof module==\"object\"&&module&&!module.nodeType&&module,Pn=Nn&&Nn.exports===Fn,Zn=Pn&&Mn.process,qn=function(){\ntry{var n=Nn&&Nn.require&&Nn.require(\"util\").types;return n?n:Zn&&Zn.binding&&Zn.binding(\"util\")}catch(n){}}(),Vn=qn&&qn.isArrayBuffer,Kn=qn&&qn.isDate,Gn=qn&&qn.isMap,Hn=qn&&qn.isRegExp,Jn=qn&&qn.isSet,Yn=qn&&qn.isTypedArray,Qn=b(\"length\"),Xn=x({\"\\xc0\":\"A\",\"\\xc1\":\"A\",\"\\xc2\":\"A\",\"\\xc3\":\"A\",\"\\xc4\":\"A\",\"\\xc5\":\"A\",\"\\xe0\":\"a\",\"\\xe1\":\"a\",\"\\xe2\":\"a\",\"\\xe3\":\"a\",\"\\xe4\":\"a\",\"\\xe5\":\"a\",\"\\xc7\":\"C\",\"\\xe7\":\"c\",\"\\xd0\":\"D\",\"\\xf0\":\"d\",\"\\xc8\":\"E\",\"\\xc9\":\"E\",\"\\xca\":\"E\",\"\\xcb\":\"E\",\"\\xe8\":\"e\",\"\\xe9\":\"e\",\"\\xea\":\"e\",\"\\xeb\":\"e\",\n\"\\xcc\":\"I\",\"\\xcd\":\"I\",\"\\xce\":\"I\",\"\\xcf\":\"I\",\"\\xec\":\"i\",\"\\xed\":\"i\",\"\\xee\":\"i\",\"\\xef\":\"i\",\"\\xd1\":\"N\",\"\\xf1\":\"n\",\"\\xd2\":\"O\",\"\\xd3\":\"O\",\"\\xd4\":\"O\",\"\\xd5\":\"O\",\"\\xd6\":\"O\",\"\\xd8\":\"O\",\"\\xf2\":\"o\",\"\\xf3\":\"o\",\"\\xf4\":\"o\",\"\\xf5\":\"o\",\"\\xf6\":\"o\",\"\\xf8\":\"o\",\"\\xd9\":\"U\",\"\\xda\":\"U\",\"\\xdb\":\"U\",\"\\xdc\":\"U\",\"\\xf9\":\"u\",\"\\xfa\":\"u\",\"\\xfb\":\"u\",\"\\xfc\":\"u\",\"\\xdd\":\"Y\",\"\\xfd\":\"y\",\"\\xff\":\"y\",\"\\xc6\":\"Ae\",\"\\xe6\":\"ae\",\"\\xde\":\"Th\",\"\\xfe\":\"th\",\"\\xdf\":\"ss\",\"\\u0100\":\"A\",\"\\u0102\":\"A\",\"\\u0104\":\"A\",\"\\u0101\":\"a\",\"\\u0103\":\"a\",\"\\u0105\":\"a\",\n\"\\u0106\":\"C\",\"\\u0108\":\"C\",\"\\u010a\":\"C\",\"\\u010c\":\"C\",\"\\u0107\":\"c\",\"\\u0109\":\"c\",\"\\u010b\":\"c\",\"\\u010d\":\"c\",\"\\u010e\":\"D\",\"\\u0110\":\"D\",\"\\u010f\":\"d\",\"\\u0111\":\"d\",\"\\u0112\":\"E\",\"\\u0114\":\"E\",\"\\u0116\":\"E\",\"\\u0118\":\"E\",\"\\u011a\":\"E\",\"\\u0113\":\"e\",\"\\u0115\":\"e\",\"\\u0117\":\"e\",\"\\u0119\":\"e\",\"\\u011b\":\"e\",\"\\u011c\":\"G\",\"\\u011e\":\"G\",\"\\u0120\":\"G\",\"\\u0122\":\"G\",\"\\u011d\":\"g\",\"\\u011f\":\"g\",\"\\u0121\":\"g\",\"\\u0123\":\"g\",\"\\u0124\":\"H\",\"\\u0126\":\"H\",\"\\u0125\":\"h\",\"\\u0127\":\"h\",\"\\u0128\":\"I\",\"\\u012a\":\"I\",\"\\u012c\":\"I\",\"\\u012e\":\"I\",\"\\u0130\":\"I\",\n\"\\u0129\":\"i\",\"\\u012b\":\"i\",\"\\u012d\":\"i\",\"\\u012f\":\"i\",\"\\u0131\":\"i\",\"\\u0134\":\"J\",\"\\u0135\":\"j\",\"\\u0136\":\"K\",\"\\u0137\":\"k\",\"\\u0138\":\"k\",\"\\u0139\":\"L\",\"\\u013b\":\"L\",\"\\u013d\":\"L\",\"\\u013f\":\"L\",\"\\u0141\":\"L\",\"\\u013a\":\"l\",\"\\u013c\":\"l\",\"\\u013e\":\"l\",\"\\u0140\":\"l\",\"\\u0142\":\"l\",\"\\u0143\":\"N\",\"\\u0145\":\"N\",\"\\u0147\":\"N\",\"\\u014a\":\"N\",\"\\u0144\":\"n\",\"\\u0146\":\"n\",\"\\u0148\":\"n\",\"\\u014b\":\"n\",\"\\u014c\":\"O\",\"\\u014e\":\"O\",\"\\u0150\":\"O\",\"\\u014d\":\"o\",\"\\u014f\":\"o\",\"\\u0151\":\"o\",\"\\u0154\":\"R\",\"\\u0156\":\"R\",\"\\u0158\":\"R\",\"\\u0155\":\"r\",\"\\u0157\":\"r\",\n\"\\u0159\":\"r\",\"\\u015a\":\"S\",\"\\u015c\":\"S\",\"\\u015e\":\"S\",\"\\u0160\":\"S\",\"\\u015b\":\"s\",\"\\u015d\":\"s\",\"\\u015f\":\"s\",\"\\u0161\":\"s\",\"\\u0162\":\"T\",\"\\u0164\":\"T\",\"\\u0166\":\"T\",\"\\u0163\":\"t\",\"\\u0165\":\"t\",\"\\u0167\":\"t\",\"\\u0168\":\"U\",\"\\u016a\":\"U\",\"\\u016c\":\"U\",\"\\u016e\":\"U\",\"\\u0170\":\"U\",\"\\u0172\":\"U\",\"\\u0169\":\"u\",\"\\u016b\":\"u\",\"\\u016d\":\"u\",\"\\u016f\":\"u\",\"\\u0171\":\"u\",\"\\u0173\":\"u\",\"\\u0174\":\"W\",\"\\u0175\":\"w\",\"\\u0176\":\"Y\",\"\\u0177\":\"y\",\"\\u0178\":\"Y\",\"\\u0179\":\"Z\",\"\\u017b\":\"Z\",\"\\u017d\":\"Z\",\"\\u017a\":\"z\",\"\\u017c\":\"z\",\"\\u017e\":\"z\",\"\\u0132\":\"IJ\",\n\"\\u0133\":\"ij\",\"\\u0152\":\"Oe\",\"\\u0153\":\"oe\",\"\\u0149\":\"'n\",\"\\u017f\":\"s\"}),nt=x({\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\"}),tt=x({\"&amp;\":\"&\",\"&lt;\":\"<\",\"&gt;\":\">\",\"&quot;\":'\"',\"&#39;\":\"'\"}),rt=function x(mn){function An(n){if(yu(n)&&!ff(n)&&!(n instanceof Ln)){if(n instanceof On)return n;if(oi.call(n,\"__wrapped__\"))return Fe(n)}return new On(n)}function kn(){}function On(n,t){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=T}function Ln(n){\nthis.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=false,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Mn(n){var t=-1,r=null==n?0:n.length;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}function Tn(n){var t=-1,r=null==n?0:n.length;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}function Fn(n){var t=-1,r=null==n?0:n.length;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}function Nn(n){var t=-1,r=null==n?0:n.length;for(this.__data__=new Fn;++t<r;)this.add(n[t]);\n}function Zn(n){this.size=(this.__data__=new Tn(n)).size}function qn(n,t){var r,e=ff(n),u=!e&&of(n),i=!e&&!u&&af(n),o=!e&&!u&&!i&&_f(n),u=(e=e||u||i||o)?A(n.length,ni):[],f=u.length;for(r in n)!t&&!oi.call(n,r)||e&&(\"length\"==r||i&&(\"offset\"==r||\"parent\"==r)||o&&(\"buffer\"==r||\"byteLength\"==r||\"byteOffset\"==r)||Se(r,f))||u.push(r);return u}function Qn(n){var t=n.length;return t?n[ir(0,t-1)]:T}function et(n,t){return De(Lr(n),pt(t,0,n.length))}function ut(n){return De(Lr(n))}function it(n,t,r){(r===T||lu(n[t],r))&&(r!==T||t in n)||st(n,t,r);\n}function ot(n,t,r){var e=n[t];oi.call(n,t)&&lu(e,r)&&(r!==T||t in n)||st(n,t,r)}function ft(n,t){for(var r=n.length;r--;)if(lu(n[r][0],t))return r;return-1}function ct(n,t,r,e){return uo(n,function(n,u,i){t(e,n,r(n),i)}),e}function at(n,t){return n&&Cr(t,Wu(t),n)}function lt(n,t){return n&&Cr(t,Uu(t),n)}function st(n,t,r){\"__proto__\"==t&&Ai?Ai(n,t,{configurable:true,enumerable:true,value:r,writable:true}):n[t]=r}function ht(n,t){for(var r=-1,e=t.length,u=Ku(e),i=null==n;++r<e;)u[r]=i?T:Ru(n,t[r]);return u;\n}function pt(n,t,r){return n===n&&(r!==T&&(n=n<=r?n:r),t!==T&&(n=n>=t?n:t)),n}function _t(n,t,e,u,i,o){var f,c=1&t,a=2&t,l=4&t;if(e&&(f=i?e(n,u,i,o):e(n)),f!==T)return f;if(!du(n))return n;if(u=ff(n)){if(f=me(n),!c)return Lr(n,f)}else{var s=vo(n),h=\"[object Function]\"==s||\"[object GeneratorFunction]\"==s;if(af(n))return Ir(n,c);if(\"[object Object]\"==s||\"[object Arguments]\"==s||h&&!i){if(f=a||h?{}:Ae(n),!c)return a?Mr(n,lt(f,n)):Dr(n,at(f,n))}else{if(!Bn[s])return i?n:{};f=ke(n,s,c)}}if(o||(o=new Zn),\ni=o.get(n))return i;if(o.set(n,f),pf(n))return n.forEach(function(r){f.add(_t(r,t,e,r,n,o))}),f;if(sf(n))return n.forEach(function(r,u){f.set(u,_t(r,t,e,u,n,o))}),f;var a=l?a?ve:_e:a?Uu:Wu,p=u?T:a(n);return r(p||n,function(r,u){p&&(u=r,r=n[u]),ot(f,u,_t(r,t,e,u,n,o))}),f}function vt(n){var t=Wu(n);return function(r){return gt(r,n,t)}}function gt(n,t,r){var e=r.length;if(null==n)return!e;for(n=Qu(n);e--;){var u=r[e],i=t[u],o=n[u];if(o===T&&!(u in n)||!i(o))return false}return true}function dt(n,t,r){if(typeof n!=\"function\")throw new ti(\"Expected a function\");\nreturn bo(function(){n.apply(T,r)},t)}function yt(n,t,r,e){var u=-1,i=o,a=true,l=n.length,s=[],h=t.length;if(!l)return s;r&&(t=c(t,E(r))),e?(i=f,a=false):200<=t.length&&(i=O,a=false,t=new Nn(t));n:for(;++u<l;){var p=n[u],_=null==r?p:r(p),p=e||0!==p?p:0;if(a&&_===_){for(var v=h;v--;)if(t[v]===_)continue n;s.push(p)}else i(t,_,e)||s.push(p)}return s}function bt(n,t){var r=true;return uo(n,function(n,e,u){return r=!!t(n,e,u)}),r}function xt(n,t,r){for(var e=-1,u=n.length;++e<u;){var i=n[e],o=t(i);if(null!=o&&(f===T?o===o&&!wu(o):r(o,f)))var f=o,c=i;\n}return c}function jt(n,t){var r=[];return uo(n,function(n,e,u){t(n,e,u)&&r.push(n)}),r}function wt(n,t,r,e,u){var i=-1,o=n.length;for(r||(r=Ee),u||(u=[]);++i<o;){var f=n[i];0<t&&r(f)?1<t?wt(f,t-1,r,e,u):a(u,f):e||(u[u.length]=f)}return u}function mt(n,t){return n&&oo(n,t,Wu)}function At(n,t){return n&&fo(n,t,Wu)}function kt(n,t){return i(t,function(t){return _u(n[t])})}function Et(n,t){t=Sr(t,n);for(var r=0,e=t.length;null!=n&&r<e;)n=n[Me(t[r++])];return r&&r==e?n:T}function St(n,t,r){return t=t(n),\nff(n)?t:a(t,r(n))}function Ot(n){if(null==n)return n===T?\"[object Undefined]\":\"[object Null]\";if(mi&&mi in Qu(n)){var t=oi.call(n,mi),r=n[mi];try{n[mi]=T;var e=true}catch(n){}var u=ai.call(n);e&&(t?n[mi]=r:delete n[mi]),n=u}else n=ai.call(n);return n}function It(n,t){return n>t}function Rt(n,t){return null!=n&&oi.call(n,t)}function zt(n,t){return null!=n&&t in Qu(n)}function Wt(n,t,r){for(var e=r?f:o,u=n[0].length,i=n.length,a=i,l=Ku(i),s=1/0,h=[];a--;){var p=n[a];a&&t&&(p=c(p,E(t))),s=Ci(p.length,s),\nl[a]=!r&&(t||120<=u&&120<=p.length)?new Nn(a&&p):T}var p=n[0],_=-1,v=l[0];n:for(;++_<u&&h.length<s;){var g=p[_],d=t?t(g):g,g=r||0!==g?g:0;if(v?!O(v,d):!e(h,d,r)){for(a=i;--a;){var y=l[a];if(y?!O(y,d):!e(n[a],d,r))continue n}v&&v.push(d),h.push(g)}}return h}function Ut(n,t,r,e){return mt(n,function(n,u,i){t(e,r(n),u,i)}),e}function Bt(t,r,e){return r=Sr(r,t),t=2>r.length?t:Et(t,hr(r,0,-1)),r=null==t?t:t[Me(Ve(r))],null==r?T:n(r,t,e)}function Lt(n){return yu(n)&&\"[object Arguments]\"==Ot(n)}function Ct(n){\nreturn yu(n)&&\"[object ArrayBuffer]\"==Ot(n)}function Dt(n){return yu(n)&&\"[object Date]\"==Ot(n)}function Mt(n,t,r,e,u){if(n===t)return true;if(null==n||null==t||!yu(n)&&!yu(t))return n!==n&&t!==t;n:{var i=ff(n),o=ff(t),f=i?\"[object Array]\":vo(n),c=o?\"[object Array]\":vo(t),f=\"[object Arguments]\"==f?\"[object Object]\":f,c=\"[object Arguments]\"==c?\"[object Object]\":c,a=\"[object Object]\"==f,o=\"[object Object]\"==c;if((c=f==c)&&af(n)){if(!af(t)){t=false;break n}i=true,a=false}if(c&&!a)u||(u=new Zn),t=i||_f(n)?se(n,t,r,e,Mt,u):he(n,t,f,r,e,Mt,u);else{\nif(!(1&r)&&(i=a&&oi.call(n,\"__wrapped__\"),f=o&&oi.call(t,\"__wrapped__\"),i||f)){n=i?n.value():n,t=f?t.value():t,u||(u=new Zn),t=Mt(n,t,r,e,u);break n}if(c)t:if(u||(u=new Zn),i=1&r,f=_e(n),o=f.length,c=_e(t).length,o==c||i){for(a=o;a--;){var l=f[a];if(!(i?l in t:oi.call(t,l))){t=false;break t}}if((c=u.get(n))&&u.get(t))t=c==t;else{c=true,u.set(n,t),u.set(t,n);for(var s=i;++a<o;){var l=f[a],h=n[l],p=t[l];if(e)var _=i?e(p,h,l,t,n,u):e(h,p,l,n,t,u);if(_===T?h!==p&&!Mt(h,p,r,e,u):!_){c=false;break}s||(s=\"constructor\"==l);\n}c&&!s&&(r=n.constructor,e=t.constructor,r!=e&&\"constructor\"in n&&\"constructor\"in t&&!(typeof r==\"function\"&&r instanceof r&&typeof e==\"function\"&&e instanceof e)&&(c=false)),u.delete(n),u.delete(t),t=c}}else t=false;else t=false}}return t}function Tt(n){return yu(n)&&\"[object Map]\"==vo(n)}function $t(n,t,r,e){var u=r.length,i=u,o=!e;if(null==n)return!i;for(n=Qu(n);u--;){var f=r[u];if(o&&f[2]?f[1]!==n[f[0]]:!(f[0]in n))return false}for(;++u<i;){var f=r[u],c=f[0],a=n[c],l=f[1];if(o&&f[2]){if(a===T&&!(c in n))return false;\n}else{if(f=new Zn,e)var s=e(a,l,c,n,t,f);if(s===T?!Mt(l,a,3,e,f):!s)return false}}return true}function Ft(n){return!(!du(n)||ci&&ci in n)&&(_u(n)?hi:dn).test(Te(n))}function Nt(n){return yu(n)&&\"[object RegExp]\"==Ot(n)}function Pt(n){return yu(n)&&\"[object Set]\"==vo(n)}function Zt(n){return yu(n)&&gu(n.length)&&!!Un[Ot(n)]}function qt(n){return typeof n==\"function\"?n:null==n?$u:typeof n==\"object\"?ff(n)?Jt(n[0],n[1]):Ht(n):Zu(n)}function Vt(n){if(!ze(n))return Bi(n);var t,r=[];for(t in Qu(n))oi.call(n,t)&&\"constructor\"!=t&&r.push(t);\nreturn r}function Kt(n,t){return n<t}function Gt(n,t){var r=-1,e=su(n)?Ku(n.length):[];return uo(n,function(n,u,i){e[++r]=t(n,u,i)}),e}function Ht(n){var t=xe(n);return 1==t.length&&t[0][2]?We(t[0][0],t[0][1]):function(r){return r===n||$t(r,n,t)}}function Jt(n,t){return Ie(n)&&t===t&&!du(t)?We(Me(n),t):function(r){var e=Ru(r,n);return e===T&&e===t?zu(r,n):Mt(t,e,3)}}function Yt(n,t,r,e,u){n!==t&&oo(t,function(i,o){if(du(i)){u||(u=new Zn);var f=u,c=Be(n,o),a=Be(t,o),l=f.get(a);if(!l){var l=e?e(c,a,o+\"\",n,t,f):T,s=l===T;\nif(s){var h=ff(a),p=!h&&af(a),_=!h&&!p&&_f(a),l=a;h||p||_?ff(c)?l=c:hu(c)?l=Lr(c):p?(s=false,l=Ir(a,true)):_?(s=false,l=zr(a,true)):l=[]:xu(a)||of(a)?(l=c,of(c)?l=Ou(c):du(c)&&!_u(c)||(l=Ae(a))):s=false}s&&(f.set(a,l),Yt(l,a,r,e,f),f.delete(a))}it(n,o,l)}else f=e?e(Be(n,o),i,o+\"\",n,t,u):T,f===T&&(f=i),it(n,o,f)},Uu)}function Qt(n,t){var r=n.length;if(r)return t+=0>t?r:0,Se(t,r)?n[t]:T}function Xt(n,t,r){var e=-1;return t=c(t.length?t:[$u],E(ye())),n=Gt(n,function(n,r,u){return{a:c(t,function(t){return t(n)}),\nb:++e,c:n}}),w(n,function(n,t){var e;n:{e=-1;for(var u=n.a,i=t.a,o=u.length,f=r.length;++e<o;){var c=Wr(u[e],i[e]);if(c){if(e>=f){e=c;break n}e=c*(\"desc\"==r[e]?-1:1);break n}}e=n.b-t.b}return e})}function nr(n,t){return tr(n,t,function(t,r){return zu(n,r)})}function tr(n,t,r){for(var e=-1,u=t.length,i={};++e<u;){var o=t[e],f=Et(n,o);r(f,o)&&lr(i,Sr(o,n),f)}return i}function rr(n){return function(t){return Et(t,n)}}function er(n,t,r,e){var u=e?g:v,i=-1,o=t.length,f=n;for(n===t&&(t=Lr(t)),r&&(f=c(n,E(r)));++i<o;)for(var a=0,l=t[i],l=r?r(l):l;-1<(a=u(f,l,a,e));)f!==n&&xi.call(f,a,1),\nxi.call(n,a,1);return n}function ur(n,t){for(var r=n?t.length:0,e=r-1;r--;){var u=t[r];if(r==e||u!==i){var i=u;Se(u)?xi.call(n,u,1):xr(n,u)}}return n}function ir(n,t){return n+Ii(Ti()*(t-n+1))}function or(n,t){var r=\"\";if(!n||1>t||9007199254740991<t)return r;do t%2&&(r+=n),(t=Ii(t/2))&&(n+=n);while(t);return r}function fr(n,t){return xo(Ue(n,t,$u),n+\"\")}function cr(n){return Qn(Lu(n))}function ar(n,t){var r=Lu(n);return De(r,pt(t,0,r.length))}function lr(n,t,r,e){if(!du(n))return n;t=Sr(t,n);for(var u=-1,i=t.length,o=i-1,f=n;null!=f&&++u<i;){\nvar c=Me(t[u]),a=r;if(u!=o){var l=f[c],a=e?e(l,c,f):T;a===T&&(a=du(l)?l:Se(t[u+1])?[]:{})}ot(f,c,a),f=f[c]}return n}function sr(n){return De(Lu(n))}function hr(n,t,r){var e=-1,u=n.length;for(0>t&&(t=-t>u?0:u+t),r=r>u?u:r,0>r&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0,r=Ku(u);++e<u;)r[e]=n[e+t];return r}function pr(n,t){var r;return uo(n,function(n,e,u){return r=t(n,e,u),!r}),!!r}function _r(n,t,r){var e=0,u=null==n?e:n.length;if(typeof t==\"number\"&&t===t&&2147483647>=u){for(;e<u;){var i=e+u>>>1,o=n[i];null!==o&&!wu(o)&&(r?o<=t:o<t)?e=i+1:u=i;\n}return u}return vr(n,t,$u,r)}function vr(n,t,r,e){t=r(t);for(var u=0,i=null==n?0:n.length,o=t!==t,f=null===t,c=wu(t),a=t===T;u<i;){var l=Ii((u+i)/2),s=r(n[l]),h=s!==T,p=null===s,_=s===s,v=wu(s);(o?e||_:a?_&&(e||h):f?_&&h&&(e||!p):c?_&&h&&!p&&(e||!v):p||v?0:e?s<=t:s<t)?u=l+1:i=l}return Ci(i,4294967294)}function gr(n,t){for(var r=-1,e=n.length,u=0,i=[];++r<e;){var o=n[r],f=t?t(o):o;if(!r||!lu(f,c)){var c=f;i[u++]=0===o?0:o}}return i}function dr(n){return typeof n==\"number\"?n:wu(n)?F:+n}function yr(n){\nif(typeof n==\"string\")return n;if(ff(n))return c(n,yr)+\"\";if(wu(n))return ro?ro.call(n):\"\";var t=n+\"\";return\"0\"==t&&1/n==-$?\"-0\":t}function br(n,t,r){var e=-1,u=o,i=n.length,c=true,a=[],l=a;if(r)c=false,u=f;else if(200<=i){if(u=t?null:so(n))return L(u);c=false,u=O,l=new Nn}else l=t?[]:a;n:for(;++e<i;){var s=n[e],h=t?t(s):s,s=r||0!==s?s:0;if(c&&h===h){for(var p=l.length;p--;)if(l[p]===h)continue n;t&&l.push(h),a.push(s)}else u(l,h,r)||(l!==a&&l.push(h),a.push(s))}return a}function xr(n,t){return t=Sr(t,n),\nn=2>t.length?n:Et(n,hr(t,0,-1)),null==n||delete n[Me(Ve(t))]}function jr(n,t,r,e){for(var u=n.length,i=e?u:-1;(e?i--:++i<u)&&t(n[i],i,n););return r?hr(n,e?0:i,e?i+1:u):hr(n,e?i+1:0,e?u:i)}function wr(n,t){var r=n;return r instanceof Ln&&(r=r.value()),l(t,function(n,t){return t.func.apply(t.thisArg,a([n],t.args))},r)}function mr(n,t,r){var e=n.length;if(2>e)return e?br(n[0]):[];for(var u=-1,i=Ku(e);++u<e;)for(var o=n[u],f=-1;++f<e;)f!=u&&(i[u]=yt(i[u]||o,n[f],t,r));return br(wt(i,1),t,r)}function Ar(n,t,r){\nfor(var e=-1,u=n.length,i=t.length,o={};++e<u;)r(o,n[e],e<i?t[e]:T);return o}function kr(n){return hu(n)?n:[]}function Er(n){return typeof n==\"function\"?n:$u}function Sr(n,t){return ff(n)?n:Ie(n,t)?[n]:jo(Iu(n))}function Or(n,t,r){var e=n.length;return r=r===T?e:r,!t&&r>=e?n:hr(n,t,r)}function Ir(n,t){if(t)return n.slice();var r=n.length,r=gi?gi(r):new n.constructor(r);return n.copy(r),r}function Rr(n){var t=new n.constructor(n.byteLength);return new vi(t).set(new vi(n)),t}function zr(n,t){return new n.constructor(t?Rr(n.buffer):n.buffer,n.byteOffset,n.length);\n}function Wr(n,t){if(n!==t){var r=n!==T,e=null===n,u=n===n,i=wu(n),o=t!==T,f=null===t,c=t===t,a=wu(t);if(!f&&!a&&!i&&n>t||i&&o&&c&&!f&&!a||e&&o&&c||!r&&c||!u)return 1;if(!e&&!i&&!a&&n<t||a&&r&&u&&!e&&!i||f&&r&&u||!o&&u||!c)return-1}return 0}function Ur(n,t,r,e){var u=-1,i=n.length,o=r.length,f=-1,c=t.length,a=Li(i-o,0),l=Ku(c+a);for(e=!e;++f<c;)l[f]=t[f];for(;++u<o;)(e||u<i)&&(l[r[u]]=n[u]);for(;a--;)l[f++]=n[u++];return l}function Br(n,t,r,e){var u=-1,i=n.length,o=-1,f=r.length,c=-1,a=t.length,l=Li(i-f,0),s=Ku(l+a);\nfor(e=!e;++u<l;)s[u]=n[u];for(l=u;++c<a;)s[l+c]=t[c];for(;++o<f;)(e||u<i)&&(s[l+r[o]]=n[u++]);return s}function Lr(n,t){var r=-1,e=n.length;for(t||(t=Ku(e));++r<e;)t[r]=n[r];return t}function Cr(n,t,r,e){var u=!r;r||(r={});for(var i=-1,o=t.length;++i<o;){var f=t[i],c=e?e(r[f],n[f],f,r,n):T;c===T&&(c=n[f]),u?st(r,f,c):ot(r,f,c)}return r}function Dr(n,t){return Cr(n,po(n),t)}function Mr(n,t){return Cr(n,_o(n),t)}function Tr(n,r){return function(e,u){var i=ff(e)?t:ct,o=r?r():{};return i(e,n,ye(u,2),o);\n}}function $r(n){return fr(function(t,r){var e=-1,u=r.length,i=1<u?r[u-1]:T,o=2<u?r[2]:T,i=3<n.length&&typeof i==\"function\"?(u--,i):T;for(o&&Oe(r[0],r[1],o)&&(i=3>u?T:i,u=1),t=Qu(t);++e<u;)(o=r[e])&&n(t,o,e,i);return t})}function Fr(n,t){return function(r,e){if(null==r)return r;if(!su(r))return n(r,e);for(var u=r.length,i=t?u:-1,o=Qu(r);(t?i--:++i<u)&&false!==e(o[i],i,o););return r}}function Nr(n){return function(t,r,e){var u=-1,i=Qu(t);e=e(t);for(var o=e.length;o--;){var f=e[n?o:++u];if(false===r(i[f],f,i))break;\n}return t}}function Pr(n,t,r){function e(){return(this&&this!==$n&&this instanceof e?i:n).apply(u?r:this,arguments)}var u=1&t,i=Vr(n);return e}function Zr(n){return function(t){t=Iu(t);var r=Rn.test(t)?M(t):T,e=r?r[0]:t.charAt(0);return t=r?Or(r,1).join(\"\"):t.slice(1),e[n]()+t}}function qr(n){return function(t){return l(Mu(Du(t).replace(En,\"\")),n,\"\")}}function Vr(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:\nreturn new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=eo(n.prototype),t=n.apply(r,t);return du(t)?t:r}}function Kr(t,r,e){function u(){for(var o=arguments.length,f=Ku(o),c=o,a=de(u);c--;)f[c]=arguments[c];return c=3>o&&f[0]!==a&&f[o-1]!==a?[]:B(f,a),o-=c.length,o<e?ue(t,r,Jr,u.placeholder,T,f,c,T,T,e-o):n(this&&this!==$n&&this instanceof u?i:t,this,f);\n}var i=Vr(t);return u}function Gr(n){return function(t,r,e){var u=Qu(t);if(!su(t)){var i=ye(r,3);t=Wu(t),r=function(n){return i(u[n],n,u)}}return r=n(t,r,e),-1<r?u[i?t[r]:r]:T}}function Hr(n){return pe(function(t){var r=t.length,e=r,u=On.prototype.thru;for(n&&t.reverse();e--;){var i=t[e];if(typeof i!=\"function\")throw new ti(\"Expected a function\");if(u&&!o&&\"wrapper\"==ge(i))var o=new On([],true)}for(e=o?e:r;++e<r;)var i=t[e],u=ge(i),f=\"wrapper\"==u?ho(i):T,o=f&&Re(f[0])&&424==f[1]&&!f[4].length&&1==f[9]?o[ge(f[0])].apply(o,f[3]):1==i.length&&Re(i)?o[u]():o.thru(i);\nreturn function(){var n=arguments,e=n[0];if(o&&1==n.length&&ff(e))return o.plant(e).value();for(var u=0,n=r?t[u].apply(this,n):e;++u<r;)n=t[u].call(this,n);return n}})}function Jr(n,t,r,e,u,i,o,f,c,a){function l(){for(var d=arguments.length,y=Ku(d),b=d;b--;)y[b]=arguments[b];if(_){var x,j=de(l),b=y.length;for(x=0;b--;)y[b]===j&&++x}if(e&&(y=Ur(y,e,u,_)),i&&(y=Br(y,i,o,_)),d-=x,_&&d<a)return j=B(y,j),ue(n,t,Jr,l.placeholder,r,y,j,f,c,a-d);if(j=h?r:this,b=p?j[n]:n,d=y.length,f){x=y.length;for(var w=Ci(f.length,x),m=Lr(y);w--;){\nvar A=f[w];y[w]=Se(A,x)?m[A]:T}}else v&&1<d&&y.reverse();return s&&c<d&&(y.length=c),this&&this!==$n&&this instanceof l&&(b=g||Vr(b)),b.apply(j,y)}var s=128&t,h=1&t,p=2&t,_=24&t,v=512&t,g=p?T:Vr(n);return l}function Yr(n,t){return function(r,e){return Ut(r,n,t(e),{})}}function Qr(n,t){return function(r,e){var u;if(r===T&&e===T)return t;if(r!==T&&(u=r),e!==T){if(u===T)return e;typeof r==\"string\"||typeof e==\"string\"?(r=yr(r),e=yr(e)):(r=dr(r),e=dr(e)),u=n(r,e)}return u}}function Xr(t){return pe(function(r){\nreturn r=c(r,E(ye())),fr(function(e){var u=this;return t(r,function(t){return n(t,u,e)})})})}function ne(n,t){t=t===T?\" \":yr(t);var r=t.length;return 2>r?r?or(t,n):t:(r=or(t,Oi(n/D(t))),Rn.test(t)?Or(M(r),0,n).join(\"\"):r.slice(0,n))}function te(t,r,e,u){function i(){for(var r=-1,c=arguments.length,a=-1,l=u.length,s=Ku(l+c),h=this&&this!==$n&&this instanceof i?f:t;++a<l;)s[a]=u[a];for(;c--;)s[a++]=arguments[++r];return n(h,o?e:this,s)}var o=1&r,f=Vr(t);return i}function re(n){return function(t,r,e){\ne&&typeof e!=\"number\"&&Oe(t,r,e)&&(r=e=T),t=Au(t),r===T?(r=t,t=0):r=Au(r),e=e===T?t<r?1:-1:Au(e);var u=-1;r=Li(Oi((r-t)/(e||1)),0);for(var i=Ku(r);r--;)i[n?r:++u]=t,t+=e;return i}}function ee(n){return function(t,r){return typeof t==\"string\"&&typeof r==\"string\"||(t=Su(t),r=Su(r)),n(t,r)}}function ue(n,t,r,e,u,i,o,f,c,a){var l=8&t,s=l?o:T;o=l?T:o;var h=l?i:T;return i=l?T:i,t=(t|(l?32:64))&~(l?64:32),4&t||(t&=-4),u=[n,t,u,h,s,i,o,f,c,a],r=r.apply(T,u),Re(n)&&yo(r,u),r.placeholder=e,Le(r,n,t)}function ie(n){\nvar t=Yu[n];return function(n,r){if(n=Su(n),r=null==r?0:Ci(ku(r),292)){var e=(Iu(n)+\"e\").split(\"e\"),e=t(e[0]+\"e\"+(+e[1]+r)),e=(Iu(e)+\"e\").split(\"e\");return+(e[0]+\"e\"+(+e[1]-r))}return t(n)}}function oe(n){return function(t){var r=vo(t);return\"[object Map]\"==r?W(t):\"[object Set]\"==r?C(t):k(t,n(t))}}function fe(n,t,r,e,u,i,o,f){var c=2&t;if(!c&&typeof n!=\"function\")throw new ti(\"Expected a function\");var a=e?e.length:0;if(a||(t&=-97,e=u=T),o=o===T?o:Li(ku(o),0),f=f===T?f:ku(f),a-=u?u.length:0,64&t){\nvar l=e,s=u;e=u=T}var h=c?T:ho(n);return i=[n,t,r,e,u,l,s,i,o,f],h&&(r=i[1],n=h[1],t=r|n,e=128==n&&8==r||128==n&&256==r&&i[7].length<=h[8]||384==n&&h[7].length<=h[8]&&8==r,131>t||e)&&(1&n&&(i[2]=h[2],t|=1&r?0:4),(r=h[3])&&(e=i[3],i[3]=e?Ur(e,r,h[4]):r,i[4]=e?B(i[3],\"__lodash_placeholder__\"):h[4]),(r=h[5])&&(e=i[5],i[5]=e?Br(e,r,h[6]):r,i[6]=e?B(i[5],\"__lodash_placeholder__\"):h[6]),(r=h[7])&&(i[7]=r),128&n&&(i[8]=null==i[8]?h[8]:Ci(i[8],h[8])),null==i[9]&&(i[9]=h[9]),i[0]=h[0],i[1]=t),n=i[0],t=i[1],\nr=i[2],e=i[3],u=i[4],f=i[9]=i[9]===T?c?0:n.length:Li(i[9]-a,0),!f&&24&t&&(t&=-25),c=t&&1!=t?8==t||16==t?Kr(n,t,f):32!=t&&33!=t||u.length?Jr.apply(T,i):te(n,t,r,e):Pr(n,t,r),Le((h?co:yo)(c,i),n,t)}function ce(n,t,r,e){return n===T||lu(n,ei[r])&&!oi.call(e,r)?t:n}function ae(n,t,r,e,u,i){return du(n)&&du(t)&&(i.set(t,n),Yt(n,t,T,ae,i),i.delete(t)),n}function le(n){return xu(n)?T:n}function se(n,t,r,e,u,i){var o=1&r,f=n.length,c=t.length;if(f!=c&&!(o&&c>f))return false;if((c=i.get(n))&&i.get(t))return c==t;\nvar c=-1,a=true,l=2&r?new Nn:T;for(i.set(n,t),i.set(t,n);++c<f;){var s=n[c],p=t[c];if(e)var _=o?e(p,s,c,t,n,i):e(s,p,c,n,t,i);if(_!==T){if(_)continue;a=false;break}if(l){if(!h(t,function(n,t){if(!O(l,t)&&(s===n||u(s,n,r,e,i)))return l.push(t)})){a=false;break}}else if(s!==p&&!u(s,p,r,e,i)){a=false;break}}return i.delete(n),i.delete(t),a}function he(n,t,r,e,u,i,o){switch(r){case\"[object DataView]\":if(n.byteLength!=t.byteLength||n.byteOffset!=t.byteOffset)break;n=n.buffer,t=t.buffer;case\"[object ArrayBuffer]\":\nif(n.byteLength!=t.byteLength||!i(new vi(n),new vi(t)))break;return true;case\"[object Boolean]\":case\"[object Date]\":case\"[object Number]\":return lu(+n,+t);case\"[object Error]\":return n.name==t.name&&n.message==t.message;case\"[object RegExp]\":case\"[object String]\":return n==t+\"\";case\"[object Map]\":var f=W;case\"[object Set]\":if(f||(f=L),n.size!=t.size&&!(1&e))break;return(r=o.get(n))?r==t:(e|=2,o.set(n,t),t=se(f(n),f(t),e,u,i,o),o.delete(n),t);case\"[object Symbol]\":if(to)return to.call(n)==to.call(t)}\nreturn false}function pe(n){return xo(Ue(n,T,Ze),n+\"\")}function _e(n){return St(n,Wu,po)}function ve(n){return St(n,Uu,_o)}function ge(n){for(var t=n.name+\"\",r=Gi[t],e=oi.call(Gi,t)?r.length:0;e--;){var u=r[e],i=u.func;if(null==i||i==n)return u.name}return t}function de(n){return(oi.call(An,\"placeholder\")?An:n).placeholder}function ye(){var n=An.iteratee||Fu,n=n===Fu?qt:n;return arguments.length?n(arguments[0],arguments[1]):n}function be(n,t){var r=n.__data__,e=typeof t;return(\"string\"==e||\"number\"==e||\"symbol\"==e||\"boolean\"==e?\"__proto__\"!==t:null===t)?r[typeof t==\"string\"?\"string\":\"hash\"]:r.map;\n}function xe(n){for(var t=Wu(n),r=t.length;r--;){var e=t[r],u=n[e];t[r]=[e,u,u===u&&!du(u)]}return t}function je(n,t){var r=null==n?T:n[t];return Ft(r)?r:T}function we(n,t,r){t=Sr(t,n);for(var e=-1,u=t.length,i=false;++e<u;){var o=Me(t[e]);if(!(i=null!=n&&r(n,o)))break;n=n[o]}return i||++e!=u?i:(u=null==n?0:n.length,!!u&&gu(u)&&Se(o,u)&&(ff(n)||of(n)))}function me(n){var t=n.length,r=new n.constructor(t);return t&&\"string\"==typeof n[0]&&oi.call(n,\"index\")&&(r.index=n.index,r.input=n.input),r}function Ae(n){\nreturn typeof n.constructor!=\"function\"||ze(n)?{}:eo(di(n))}function ke(n,t,r){var e=n.constructor;switch(t){case\"[object ArrayBuffer]\":return Rr(n);case\"[object Boolean]\":case\"[object Date]\":return new e(+n);case\"[object DataView]\":return t=r?Rr(n.buffer):n.buffer,new n.constructor(t,n.byteOffset,n.byteLength);case\"[object Float32Array]\":case\"[object Float64Array]\":case\"[object Int8Array]\":case\"[object Int16Array]\":case\"[object Int32Array]\":case\"[object Uint8Array]\":case\"[object Uint8ClampedArray]\":\ncase\"[object Uint16Array]\":case\"[object Uint32Array]\":return zr(n,r);case\"[object Map]\":return new e;case\"[object Number]\":case\"[object String]\":return new e(n);case\"[object RegExp]\":return t=new n.constructor(n.source,_n.exec(n)),t.lastIndex=n.lastIndex,t;case\"[object Set]\":return new e;case\"[object Symbol]\":return to?Qu(to.call(n)):{}}}function Ee(n){return ff(n)||of(n)||!!(ji&&n&&n[ji])}function Se(n,t){var r=typeof n;return t=null==t?9007199254740991:t,!!t&&(\"number\"==r||\"symbol\"!=r&&bn.test(n))&&-1<n&&0==n%1&&n<t;\n}function Oe(n,t,r){if(!du(r))return false;var e=typeof t;return!!(\"number\"==e?su(r)&&Se(t,r.length):\"string\"==e&&t in r)&&lu(r[t],n)}function Ie(n,t){if(ff(n))return false;var r=typeof n;return!(\"number\"!=r&&\"symbol\"!=r&&\"boolean\"!=r&&null!=n&&!wu(n))||(nn.test(n)||!X.test(n)||null!=t&&n in Qu(t))}function Re(n){var t=ge(n),r=An[t];return typeof r==\"function\"&&t in Ln.prototype&&(n===r||(t=ho(r),!!t&&n===t[0]))}function ze(n){var t=n&&n.constructor;return n===(typeof t==\"function\"&&t.prototype||ei)}function We(n,t){\nreturn function(r){return null!=r&&(r[n]===t&&(t!==T||n in Qu(r)))}}function Ue(t,r,e){return r=Li(r===T?t.length-1:r,0),function(){for(var u=arguments,i=-1,o=Li(u.length-r,0),f=Ku(o);++i<o;)f[i]=u[r+i];for(i=-1,o=Ku(r+1);++i<r;)o[i]=u[i];return o[r]=e(f),n(t,this,o)}}function Be(n,t){if(\"__proto__\"!=t)return n[t]}function Le(n,t,r){var e=t+\"\";t=xo;var u,i=$e;return u=(u=e.match(an))?u[1].split(ln):[],r=i(u,r),(i=r.length)&&(u=i-1,r[u]=(1<i?\"& \":\"\")+r[u],r=r.join(2<i?\", \":\" \"),e=e.replace(cn,\"{\\n/* [wrapped with \"+r+\"] */\\n\")),\nt(n,e)}function Ce(n){var t=0,r=0;return function(){var e=Di(),u=16-(e-r);if(r=e,0<u){if(800<=++t)return arguments[0]}else t=0;return n.apply(T,arguments)}}function De(n,t){var r=-1,e=n.length,u=e-1;for(t=t===T?e:t;++r<t;){var e=ir(r,u),i=n[e];n[e]=n[r],n[r]=i}return n.length=t,n}function Me(n){if(typeof n==\"string\"||wu(n))return n;var t=n+\"\";return\"0\"==t&&1/n==-$?\"-0\":t}function Te(n){if(null!=n){try{return ii.call(n)}catch(n){}return n+\"\"}return\"\"}function $e(n,t){return r(N,function(r){var e=\"_.\"+r[0];\nt&r[1]&&!o(n,e)&&n.push(e)}),n.sort()}function Fe(n){if(n instanceof Ln)return n.clone();var t=new On(n.__wrapped__,n.__chain__);return t.__actions__=Lr(n.__actions__),t.__index__=n.__index__,t.__values__=n.__values__,t}function Ne(n,t,r){var e=null==n?0:n.length;return e?(r=null==r?0:ku(r),0>r&&(r=Li(e+r,0)),_(n,ye(t,3),r)):-1}function Pe(n,t,r){var e=null==n?0:n.length;if(!e)return-1;var u=e-1;return r!==T&&(u=ku(r),u=0>r?Li(e+u,0):Ci(u,e-1)),_(n,ye(t,3),u,true)}function Ze(n){return(null==n?0:n.length)?wt(n,1):[];\n}function qe(n){return n&&n.length?n[0]:T}function Ve(n){var t=null==n?0:n.length;return t?n[t-1]:T}function Ke(n,t){return n&&n.length&&t&&t.length?er(n,t):n}function Ge(n){return null==n?n:$i.call(n)}function He(n){if(!n||!n.length)return[];var t=0;return n=i(n,function(n){if(hu(n))return t=Li(n.length,t),true}),A(t,function(t){return c(n,b(t))})}function Je(t,r){if(!t||!t.length)return[];var e=He(t);return null==r?e:c(e,function(t){return n(r,T,t)})}function Ye(n){return n=An(n),n.__chain__=true,n;\n}function Qe(n,t){return t(n)}function Xe(){return this}function nu(n,t){return(ff(n)?r:uo)(n,ye(t,3))}function tu(n,t){return(ff(n)?e:io)(n,ye(t,3))}function ru(n,t){return(ff(n)?c:Gt)(n,ye(t,3))}function eu(n,t,r){return t=r?T:t,t=n&&null==t?n.length:t,fe(n,128,T,T,T,T,t)}function uu(n,t){var r;if(typeof t!=\"function\")throw new ti(\"Expected a function\");return n=ku(n),function(){return 0<--n&&(r=t.apply(this,arguments)),1>=n&&(t=T),r}}function iu(n,t,r){return t=r?T:t,n=fe(n,8,T,T,T,T,T,t),n.placeholder=iu.placeholder,\nn}function ou(n,t,r){return t=r?T:t,n=fe(n,16,T,T,T,T,T,t),n.placeholder=ou.placeholder,n}function fu(n,t,r){function e(t){var r=c,e=a;return c=a=T,_=t,s=n.apply(e,r)}function u(n){var r=n-p;return n-=_,p===T||r>=t||0>r||g&&n>=l}function i(){var n=Go();if(u(n))return o(n);var r,e=bo;r=n-_,n=t-(n-p),r=g?Ci(n,l-r):n,h=e(i,r)}function o(n){return h=T,d&&c?e(n):(c=a=T,s)}function f(){var n=Go(),r=u(n);if(c=arguments,a=this,p=n,r){if(h===T)return _=n=p,h=bo(i,t),v?e(n):s;if(g)return h=bo(i,t),e(p)}return h===T&&(h=bo(i,t)),\ns}var c,a,l,s,h,p,_=0,v=false,g=false,d=true;if(typeof n!=\"function\")throw new ti(\"Expected a function\");return t=Su(t)||0,du(r)&&(v=!!r.leading,l=(g=\"maxWait\"in r)?Li(Su(r.maxWait)||0,t):l,d=\"trailing\"in r?!!r.trailing:d),f.cancel=function(){h!==T&&lo(h),_=0,c=p=a=h=T},f.flush=function(){return h===T?s:o(Go())},f}function cu(n,t){if(typeof n!=\"function\"||null!=t&&typeof t!=\"function\")throw new ti(\"Expected a function\");var r=function(){var e=arguments,u=t?t.apply(this,e):e[0],i=r.cache;return i.has(u)?i.get(u):(e=n.apply(this,e),\nr.cache=i.set(u,e)||i,e)};return r.cache=new(cu.Cache||Fn),r}function au(n){if(typeof n!=\"function\")throw new ti(\"Expected a function\");return function(){var t=arguments;switch(t.length){case 0:return!n.call(this);case 1:return!n.call(this,t[0]);case 2:return!n.call(this,t[0],t[1]);case 3:return!n.call(this,t[0],t[1],t[2])}return!n.apply(this,t)}}function lu(n,t){return n===t||n!==n&&t!==t}function su(n){return null!=n&&gu(n.length)&&!_u(n)}function hu(n){return yu(n)&&su(n)}function pu(n){if(!yu(n))return false;\nvar t=Ot(n);return\"[object Error]\"==t||\"[object DOMException]\"==t||typeof n.message==\"string\"&&typeof n.name==\"string\"&&!xu(n)}function _u(n){return!!du(n)&&(n=Ot(n),\"[object Function]\"==n||\"[object GeneratorFunction]\"==n||\"[object AsyncFunction]\"==n||\"[object Proxy]\"==n)}function vu(n){return typeof n==\"number\"&&n==ku(n)}function gu(n){return typeof n==\"number\"&&-1<n&&0==n%1&&9007199254740991>=n}function du(n){var t=typeof n;return null!=n&&(\"object\"==t||\"function\"==t)}function yu(n){return null!=n&&typeof n==\"object\";\n}function bu(n){return typeof n==\"number\"||yu(n)&&\"[object Number]\"==Ot(n)}function xu(n){return!(!yu(n)||\"[object Object]\"!=Ot(n))&&(n=di(n),null===n||(n=oi.call(n,\"constructor\")&&n.constructor,typeof n==\"function\"&&n instanceof n&&ii.call(n)==li))}function ju(n){return typeof n==\"string\"||!ff(n)&&yu(n)&&\"[object String]\"==Ot(n)}function wu(n){return typeof n==\"symbol\"||yu(n)&&\"[object Symbol]\"==Ot(n)}function mu(n){if(!n)return[];if(su(n))return ju(n)?M(n):Lr(n);if(wi&&n[wi]){n=n[wi]();for(var t,r=[];!(t=n.next()).done;)r.push(t.value);\nreturn r}return t=vo(n),(\"[object Map]\"==t?W:\"[object Set]\"==t?L:Lu)(n)}function Au(n){return n?(n=Su(n),n===$||n===-$?1.7976931348623157e308*(0>n?-1:1):n===n?n:0):0===n?n:0}function ku(n){n=Au(n);var t=n%1;return n===n?t?n-t:n:0}function Eu(n){return n?pt(ku(n),0,4294967295):0}function Su(n){if(typeof n==\"number\")return n;if(wu(n))return F;if(du(n)&&(n=typeof n.valueOf==\"function\"?n.valueOf():n,n=du(n)?n+\"\":n),typeof n!=\"string\")return 0===n?n:+n;n=n.replace(un,\"\");var t=gn.test(n);return t||yn.test(n)?Dn(n.slice(2),t?2:8):vn.test(n)?F:+n;\n}function Ou(n){return Cr(n,Uu(n))}function Iu(n){return null==n?\"\":yr(n)}function Ru(n,t,r){return n=null==n?T:Et(n,t),n===T?r:n}function zu(n,t){return null!=n&&we(n,t,zt)}function Wu(n){return su(n)?qn(n):Vt(n)}function Uu(n){if(su(n))n=qn(n,true);else if(du(n)){var t,r=ze(n),e=[];for(t in n)(\"constructor\"!=t||!r&&oi.call(n,t))&&e.push(t);n=e}else{if(t=[],null!=n)for(r in Qu(n))t.push(r);n=t}return n}function Bu(n,t){if(null==n)return{};var r=c(ve(n),function(n){return[n]});return t=ye(t),tr(n,r,function(n,r){\nreturn t(n,r[0])})}function Lu(n){return null==n?[]:S(n,Wu(n))}function Cu(n){return $f(Iu(n).toLowerCase())}function Du(n){return(n=Iu(n))&&n.replace(xn,Xn).replace(Sn,\"\")}function Mu(n,t,r){return n=Iu(n),t=r?T:t,t===T?zn.test(n)?n.match(In)||[]:n.match(sn)||[]:n.match(t)||[]}function Tu(n){return function(){return n}}function $u(n){return n}function Fu(n){return qt(typeof n==\"function\"?n:_t(n,1))}function Nu(n,t,e){var u=Wu(t),i=kt(t,u);null!=e||du(t)&&(i.length||!u.length)||(e=t,t=n,n=this,i=kt(t,Wu(t)));\nvar o=!(du(e)&&\"chain\"in e&&!e.chain),f=_u(n);return r(i,function(r){var e=t[r];n[r]=e,f&&(n.prototype[r]=function(){var t=this.__chain__;if(o||t){var r=n(this.__wrapped__);return(r.__actions__=Lr(this.__actions__)).push({func:e,args:arguments,thisArg:n}),r.__chain__=t,r}return e.apply(n,a([this.value()],arguments))})}),n}function Pu(){}function Zu(n){return Ie(n)?b(Me(n)):rr(n)}function qu(){return[]}function Vu(){return false}mn=null==mn?$n:rt.defaults($n.Object(),mn,rt.pick($n,Wn));var Ku=mn.Array,Gu=mn.Date,Hu=mn.Error,Ju=mn.Function,Yu=mn.Math,Qu=mn.Object,Xu=mn.RegExp,ni=mn.String,ti=mn.TypeError,ri=Ku.prototype,ei=Qu.prototype,ui=mn[\"__core-js_shared__\"],ii=Ju.prototype.toString,oi=ei.hasOwnProperty,fi=0,ci=function(){\nvar n=/[^.]+$/.exec(ui&&ui.keys&&ui.keys.IE_PROTO||\"\");return n?\"Symbol(src)_1.\"+n:\"\"}(),ai=ei.toString,li=ii.call(Qu),si=$n._,hi=Xu(\"^\"+ii.call(oi).replace(rn,\"\\\\$&\").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g,\"$1.*?\")+\"$\"),pi=Pn?mn.Buffer:T,_i=mn.Symbol,vi=mn.Uint8Array,gi=pi?pi.allocUnsafe:T,di=U(Qu.getPrototypeOf,Qu),yi=Qu.create,bi=ei.propertyIsEnumerable,xi=ri.splice,ji=_i?_i.isConcatSpreadable:T,wi=_i?_i.iterator:T,mi=_i?_i.toStringTag:T,Ai=function(){try{var n=je(Qu,\"defineProperty\");\nreturn n({},\"\",{}),n}catch(n){}}(),ki=mn.clearTimeout!==$n.clearTimeout&&mn.clearTimeout,Ei=Gu&&Gu.now!==$n.Date.now&&Gu.now,Si=mn.setTimeout!==$n.setTimeout&&mn.setTimeout,Oi=Yu.ceil,Ii=Yu.floor,Ri=Qu.getOwnPropertySymbols,zi=pi?pi.isBuffer:T,Wi=mn.isFinite,Ui=ri.join,Bi=U(Qu.keys,Qu),Li=Yu.max,Ci=Yu.min,Di=Gu.now,Mi=mn.parseInt,Ti=Yu.random,$i=ri.reverse,Fi=je(mn,\"DataView\"),Ni=je(mn,\"Map\"),Pi=je(mn,\"Promise\"),Zi=je(mn,\"Set\"),qi=je(mn,\"WeakMap\"),Vi=je(Qu,\"create\"),Ki=qi&&new qi,Gi={},Hi=Te(Fi),Ji=Te(Ni),Yi=Te(Pi),Qi=Te(Zi),Xi=Te(qi),no=_i?_i.prototype:T,to=no?no.valueOf:T,ro=no?no.toString:T,eo=function(){\nfunction n(){}return function(t){return du(t)?yi?yi(t):(n.prototype=t,t=new n,n.prototype=T,t):{}}}();An.templateSettings={escape:J,evaluate:Y,interpolate:Q,variable:\"\",imports:{_:An}},An.prototype=kn.prototype,An.prototype.constructor=An,On.prototype=eo(kn.prototype),On.prototype.constructor=On,Ln.prototype=eo(kn.prototype),Ln.prototype.constructor=Ln,Mn.prototype.clear=function(){this.__data__=Vi?Vi(null):{},this.size=0},Mn.prototype.delete=function(n){return n=this.has(n)&&delete this.__data__[n],\nthis.size-=n?1:0,n},Mn.prototype.get=function(n){var t=this.__data__;return Vi?(n=t[n],\"__lodash_hash_undefined__\"===n?T:n):oi.call(t,n)?t[n]:T},Mn.prototype.has=function(n){var t=this.__data__;return Vi?t[n]!==T:oi.call(t,n)},Mn.prototype.set=function(n,t){var r=this.__data__;return this.size+=this.has(n)?0:1,r[n]=Vi&&t===T?\"__lodash_hash_undefined__\":t,this},Tn.prototype.clear=function(){this.__data__=[],this.size=0},Tn.prototype.delete=function(n){var t=this.__data__;return n=ft(t,n),!(0>n)&&(n==t.length-1?t.pop():xi.call(t,n,1),\n--this.size,true)},Tn.prototype.get=function(n){var t=this.__data__;return n=ft(t,n),0>n?T:t[n][1]},Tn.prototype.has=function(n){return-1<ft(this.__data__,n)},Tn.prototype.set=function(n,t){var r=this.__data__,e=ft(r,n);return 0>e?(++this.size,r.push([n,t])):r[e][1]=t,this},Fn.prototype.clear=function(){this.size=0,this.__data__={hash:new Mn,map:new(Ni||Tn),string:new Mn}},Fn.prototype.delete=function(n){return n=be(this,n).delete(n),this.size-=n?1:0,n},Fn.prototype.get=function(n){return be(this,n).get(n);\n},Fn.prototype.has=function(n){return be(this,n).has(n)},Fn.prototype.set=function(n,t){var r=be(this,n),e=r.size;return r.set(n,t),this.size+=r.size==e?0:1,this},Nn.prototype.add=Nn.prototype.push=function(n){return this.__data__.set(n,\"__lodash_hash_undefined__\"),this},Nn.prototype.has=function(n){return this.__data__.has(n)},Zn.prototype.clear=function(){this.__data__=new Tn,this.size=0},Zn.prototype.delete=function(n){var t=this.__data__;return n=t.delete(n),this.size=t.size,n},Zn.prototype.get=function(n){\nreturn this.__data__.get(n)},Zn.prototype.has=function(n){return this.__data__.has(n)},Zn.prototype.set=function(n,t){var r=this.__data__;if(r instanceof Tn){var e=r.__data__;if(!Ni||199>e.length)return e.push([n,t]),this.size=++r.size,this;r=this.__data__=new Fn(e)}return r.set(n,t),this.size=r.size,this};var uo=Fr(mt),io=Fr(At,true),oo=Nr(),fo=Nr(true),co=Ki?function(n,t){return Ki.set(n,t),n}:$u,ao=Ai?function(n,t){return Ai(n,\"toString\",{configurable:true,enumerable:false,value:Tu(t),writable:true})}:$u,lo=ki||function(n){\nreturn $n.clearTimeout(n)},so=Zi&&1/L(new Zi([,-0]))[1]==$?function(n){return new Zi(n)}:Pu,ho=Ki?function(n){return Ki.get(n)}:Pu,po=Ri?function(n){return null==n?[]:(n=Qu(n),i(Ri(n),function(t){return bi.call(n,t)}))}:qu,_o=Ri?function(n){for(var t=[];n;)a(t,po(n)),n=di(n);return t}:qu,vo=Ot;(Fi&&\"[object DataView]\"!=vo(new Fi(new ArrayBuffer(1)))||Ni&&\"[object Map]\"!=vo(new Ni)||Pi&&\"[object Promise]\"!=vo(Pi.resolve())||Zi&&\"[object Set]\"!=vo(new Zi)||qi&&\"[object WeakMap]\"!=vo(new qi))&&(vo=function(n){\nvar t=Ot(n);if(n=(n=\"[object Object]\"==t?n.constructor:T)?Te(n):\"\")switch(n){case Hi:return\"[object DataView]\";case Ji:return\"[object Map]\";case Yi:return\"[object Promise]\";case Qi:return\"[object Set]\";case Xi:return\"[object WeakMap]\"}return t});var go=ui?_u:Vu,yo=Ce(co),bo=Si||function(n,t){return $n.setTimeout(n,t)},xo=Ce(ao),jo=function(n){n=cu(n,function(n){return 500===t.size&&t.clear(),n});var t=n.cache;return n}(function(n){var t=[];return 46===n.charCodeAt(0)&&t.push(\"\"),n.replace(tn,function(n,r,e,u){\nt.push(e?u.replace(hn,\"$1\"):r||n)}),t}),wo=fr(function(n,t){return hu(n)?yt(n,wt(t,1,hu,true)):[]}),mo=fr(function(n,t){var r=Ve(t);return hu(r)&&(r=T),hu(n)?yt(n,wt(t,1,hu,true),ye(r,2)):[]}),Ao=fr(function(n,t){var r=Ve(t);return hu(r)&&(r=T),hu(n)?yt(n,wt(t,1,hu,true),T,r):[]}),ko=fr(function(n){var t=c(n,kr);return t.length&&t[0]===n[0]?Wt(t):[]}),Eo=fr(function(n){var t=Ve(n),r=c(n,kr);return t===Ve(r)?t=T:r.pop(),r.length&&r[0]===n[0]?Wt(r,ye(t,2)):[]}),So=fr(function(n){var t=Ve(n),r=c(n,kr);return(t=typeof t==\"function\"?t:T)&&r.pop(),\nr.length&&r[0]===n[0]?Wt(r,T,t):[]}),Oo=fr(Ke),Io=pe(function(n,t){var r=null==n?0:n.length,e=ht(n,t);return ur(n,c(t,function(n){return Se(n,r)?+n:n}).sort(Wr)),e}),Ro=fr(function(n){return br(wt(n,1,hu,true))}),zo=fr(function(n){var t=Ve(n);return hu(t)&&(t=T),br(wt(n,1,hu,true),ye(t,2))}),Wo=fr(function(n){var t=Ve(n),t=typeof t==\"function\"?t:T;return br(wt(n,1,hu,true),T,t)}),Uo=fr(function(n,t){return hu(n)?yt(n,t):[]}),Bo=fr(function(n){return mr(i(n,hu))}),Lo=fr(function(n){var t=Ve(n);return hu(t)&&(t=T),\nmr(i(n,hu),ye(t,2))}),Co=fr(function(n){var t=Ve(n),t=typeof t==\"function\"?t:T;return mr(i(n,hu),T,t)}),Do=fr(He),Mo=fr(function(n){var t=n.length,t=1<t?n[t-1]:T,t=typeof t==\"function\"?(n.pop(),t):T;return Je(n,t)}),To=pe(function(n){var t=n.length,r=t?n[0]:0,e=this.__wrapped__,u=function(t){return ht(t,n)};return!(1<t||this.__actions__.length)&&e instanceof Ln&&Se(r)?(e=e.slice(r,+r+(t?1:0)),e.__actions__.push({func:Qe,args:[u],thisArg:T}),new On(e,this.__chain__).thru(function(n){return t&&!n.length&&n.push(T),\nn})):this.thru(u)}),$o=Tr(function(n,t,r){oi.call(n,r)?++n[r]:st(n,r,1)}),Fo=Gr(Ne),No=Gr(Pe),Po=Tr(function(n,t,r){oi.call(n,r)?n[r].push(t):st(n,r,[t])}),Zo=fr(function(t,r,e){var u=-1,i=typeof r==\"function\",o=su(t)?Ku(t.length):[];return uo(t,function(t){o[++u]=i?n(r,t,e):Bt(t,r,e)}),o}),qo=Tr(function(n,t,r){st(n,r,t)}),Vo=Tr(function(n,t,r){n[r?0:1].push(t)},function(){return[[],[]]}),Ko=fr(function(n,t){if(null==n)return[];var r=t.length;return 1<r&&Oe(n,t[0],t[1])?t=[]:2<r&&Oe(t[0],t[1],t[2])&&(t=[t[0]]),\nXt(n,wt(t,1),[])}),Go=Ei||function(){return $n.Date.now()},Ho=fr(function(n,t,r){var e=1;if(r.length)var u=B(r,de(Ho)),e=32|e;return fe(n,e,t,r,u)}),Jo=fr(function(n,t,r){var e=3;if(r.length)var u=B(r,de(Jo)),e=32|e;return fe(t,e,n,r,u)}),Yo=fr(function(n,t){return dt(n,1,t)}),Qo=fr(function(n,t,r){return dt(n,Su(t)||0,r)});cu.Cache=Fn;var Xo=fr(function(t,r){r=1==r.length&&ff(r[0])?c(r[0],E(ye())):c(wt(r,1),E(ye()));var e=r.length;return fr(function(u){for(var i=-1,o=Ci(u.length,e);++i<o;)u[i]=r[i].call(this,u[i]);\nreturn n(t,this,u)})}),nf=fr(function(n,t){return fe(n,32,T,t,B(t,de(nf)))}),tf=fr(function(n,t){return fe(n,64,T,t,B(t,de(tf)))}),rf=pe(function(n,t){return fe(n,256,T,T,T,t)}),ef=ee(It),uf=ee(function(n,t){return n>=t}),of=Lt(function(){return arguments}())?Lt:function(n){return yu(n)&&oi.call(n,\"callee\")&&!bi.call(n,\"callee\")},ff=Ku.isArray,cf=Vn?E(Vn):Ct,af=zi||Vu,lf=Kn?E(Kn):Dt,sf=Gn?E(Gn):Tt,hf=Hn?E(Hn):Nt,pf=Jn?E(Jn):Pt,_f=Yn?E(Yn):Zt,vf=ee(Kt),gf=ee(function(n,t){return n<=t}),df=$r(function(n,t){\nif(ze(t)||su(t))Cr(t,Wu(t),n);else for(var r in t)oi.call(t,r)&&ot(n,r,t[r])}),yf=$r(function(n,t){Cr(t,Uu(t),n)}),bf=$r(function(n,t,r,e){Cr(t,Uu(t),n,e)}),xf=$r(function(n,t,r,e){Cr(t,Wu(t),n,e)}),jf=pe(ht),wf=fr(function(n,t){n=Qu(n);var r=-1,e=t.length,u=2<e?t[2]:T;for(u&&Oe(t[0],t[1],u)&&(e=1);++r<e;)for(var u=t[r],i=Uu(u),o=-1,f=i.length;++o<f;){var c=i[o],a=n[c];(a===T||lu(a,ei[c])&&!oi.call(n,c))&&(n[c]=u[c])}return n}),mf=fr(function(t){return t.push(T,ae),n(Of,T,t)}),Af=Yr(function(n,t,r){\nnull!=t&&typeof t.toString!=\"function\"&&(t=ai.call(t)),n[t]=r},Tu($u)),kf=Yr(function(n,t,r){null!=t&&typeof t.toString!=\"function\"&&(t=ai.call(t)),oi.call(n,t)?n[t].push(r):n[t]=[r]},ye),Ef=fr(Bt),Sf=$r(function(n,t,r){Yt(n,t,r)}),Of=$r(function(n,t,r,e){Yt(n,t,r,e)}),If=pe(function(n,t){var r={};if(null==n)return r;var e=false;t=c(t,function(t){return t=Sr(t,n),e||(e=1<t.length),t}),Cr(n,ve(n),r),e&&(r=_t(r,7,le));for(var u=t.length;u--;)xr(r,t[u]);return r}),Rf=pe(function(n,t){return null==n?{}:nr(n,t);\n}),zf=oe(Wu),Wf=oe(Uu),Uf=qr(function(n,t,r){return t=t.toLowerCase(),n+(r?Cu(t):t)}),Bf=qr(function(n,t,r){return n+(r?\"-\":\"\")+t.toLowerCase()}),Lf=qr(function(n,t,r){return n+(r?\" \":\"\")+t.toLowerCase()}),Cf=Zr(\"toLowerCase\"),Df=qr(function(n,t,r){return n+(r?\"_\":\"\")+t.toLowerCase()}),Mf=qr(function(n,t,r){return n+(r?\" \":\"\")+$f(t)}),Tf=qr(function(n,t,r){return n+(r?\" \":\"\")+t.toUpperCase()}),$f=Zr(\"toUpperCase\"),Ff=fr(function(t,r){try{return n(t,T,r)}catch(n){return pu(n)?n:new Hu(n)}}),Nf=pe(function(n,t){\nreturn r(t,function(t){t=Me(t),st(n,t,Ho(n[t],n))}),n}),Pf=Hr(),Zf=Hr(true),qf=fr(function(n,t){return function(r){return Bt(r,n,t)}}),Vf=fr(function(n,t){return function(r){return Bt(n,r,t)}}),Kf=Xr(c),Gf=Xr(u),Hf=Xr(h),Jf=re(),Yf=re(true),Qf=Qr(function(n,t){return n+t},0),Xf=ie(\"ceil\"),nc=Qr(function(n,t){return n/t},1),tc=ie(\"floor\"),rc=Qr(function(n,t){return n*t},1),ec=ie(\"round\"),uc=Qr(function(n,t){return n-t},0);return An.after=function(n,t){if(typeof t!=\"function\")throw new ti(\"Expected a function\");\nreturn n=ku(n),function(){if(1>--n)return t.apply(this,arguments)}},An.ary=eu,An.assign=df,An.assignIn=yf,An.assignInWith=bf,An.assignWith=xf,An.at=jf,An.before=uu,An.bind=Ho,An.bindAll=Nf,An.bindKey=Jo,An.castArray=function(){if(!arguments.length)return[];var n=arguments[0];return ff(n)?n:[n]},An.chain=Ye,An.chunk=function(n,t,r){if(t=(r?Oe(n,t,r):t===T)?1:Li(ku(t),0),r=null==n?0:n.length,!r||1>t)return[];for(var e=0,u=0,i=Ku(Oi(r/t));e<r;)i[u++]=hr(n,e,e+=t);return i},An.compact=function(n){for(var t=-1,r=null==n?0:n.length,e=0,u=[];++t<r;){\nvar i=n[t];i&&(u[e++]=i)}return u},An.concat=function(){var n=arguments.length;if(!n)return[];for(var t=Ku(n-1),r=arguments[0];n--;)t[n-1]=arguments[n];return a(ff(r)?Lr(r):[r],wt(t,1))},An.cond=function(t){var r=null==t?0:t.length,e=ye();return t=r?c(t,function(n){if(\"function\"!=typeof n[1])throw new ti(\"Expected a function\");return[e(n[0]),n[1]]}):[],fr(function(e){for(var u=-1;++u<r;){var i=t[u];if(n(i[0],this,e))return n(i[1],this,e)}})},An.conforms=function(n){return vt(_t(n,1))},An.constant=Tu,\nAn.countBy=$o,An.create=function(n,t){var r=eo(n);return null==t?r:at(r,t)},An.curry=iu,An.curryRight=ou,An.debounce=fu,An.defaults=wf,An.defaultsDeep=mf,An.defer=Yo,An.delay=Qo,An.difference=wo,An.differenceBy=mo,An.differenceWith=Ao,An.drop=function(n,t,r){var e=null==n?0:n.length;return e?(t=r||t===T?1:ku(t),hr(n,0>t?0:t,e)):[]},An.dropRight=function(n,t,r){var e=null==n?0:n.length;return e?(t=r||t===T?1:ku(t),t=e-t,hr(n,0,0>t?0:t)):[]},An.dropRightWhile=function(n,t){return n&&n.length?jr(n,ye(t,3),true,true):[];\n},An.dropWhile=function(n,t){return n&&n.length?jr(n,ye(t,3),true):[]},An.fill=function(n,t,r,e){var u=null==n?0:n.length;if(!u)return[];for(r&&typeof r!=\"number\"&&Oe(n,t,r)&&(r=0,e=u),u=n.length,r=ku(r),0>r&&(r=-r>u?0:u+r),e=e===T||e>u?u:ku(e),0>e&&(e+=u),e=r>e?0:Eu(e);r<e;)n[r++]=t;return n},An.filter=function(n,t){return(ff(n)?i:jt)(n,ye(t,3))},An.flatMap=function(n,t){return wt(ru(n,t),1)},An.flatMapDeep=function(n,t){return wt(ru(n,t),$)},An.flatMapDepth=function(n,t,r){return r=r===T?1:ku(r),\nwt(ru(n,t),r)},An.flatten=Ze,An.flattenDeep=function(n){return(null==n?0:n.length)?wt(n,$):[]},An.flattenDepth=function(n,t){return null!=n&&n.length?(t=t===T?1:ku(t),wt(n,t)):[]},An.flip=function(n){return fe(n,512)},An.flow=Pf,An.flowRight=Zf,An.fromPairs=function(n){for(var t=-1,r=null==n?0:n.length,e={};++t<r;){var u=n[t];e[u[0]]=u[1]}return e},An.functions=function(n){return null==n?[]:kt(n,Wu(n))},An.functionsIn=function(n){return null==n?[]:kt(n,Uu(n))},An.groupBy=Po,An.initial=function(n){\nreturn(null==n?0:n.length)?hr(n,0,-1):[]},An.intersection=ko,An.intersectionBy=Eo,An.intersectionWith=So,An.invert=Af,An.invertBy=kf,An.invokeMap=Zo,An.iteratee=Fu,An.keyBy=qo,An.keys=Wu,An.keysIn=Uu,An.map=ru,An.mapKeys=function(n,t){var r={};return t=ye(t,3),mt(n,function(n,e,u){st(r,t(n,e,u),n)}),r},An.mapValues=function(n,t){var r={};return t=ye(t,3),mt(n,function(n,e,u){st(r,e,t(n,e,u))}),r},An.matches=function(n){return Ht(_t(n,1))},An.matchesProperty=function(n,t){return Jt(n,_t(t,1))},An.memoize=cu,\nAn.merge=Sf,An.mergeWith=Of,An.method=qf,An.methodOf=Vf,An.mixin=Nu,An.negate=au,An.nthArg=function(n){return n=ku(n),fr(function(t){return Qt(t,n)})},An.omit=If,An.omitBy=function(n,t){return Bu(n,au(ye(t)))},An.once=function(n){return uu(2,n)},An.orderBy=function(n,t,r,e){return null==n?[]:(ff(t)||(t=null==t?[]:[t]),r=e?T:r,ff(r)||(r=null==r?[]:[r]),Xt(n,t,r))},An.over=Kf,An.overArgs=Xo,An.overEvery=Gf,An.overSome=Hf,An.partial=nf,An.partialRight=tf,An.partition=Vo,An.pick=Rf,An.pickBy=Bu,An.property=Zu,\nAn.propertyOf=function(n){return function(t){return null==n?T:Et(n,t)}},An.pull=Oo,An.pullAll=Ke,An.pullAllBy=function(n,t,r){return n&&n.length&&t&&t.length?er(n,t,ye(r,2)):n},An.pullAllWith=function(n,t,r){return n&&n.length&&t&&t.length?er(n,t,T,r):n},An.pullAt=Io,An.range=Jf,An.rangeRight=Yf,An.rearg=rf,An.reject=function(n,t){return(ff(n)?i:jt)(n,au(ye(t,3)))},An.remove=function(n,t){var r=[];if(!n||!n.length)return r;var e=-1,u=[],i=n.length;for(t=ye(t,3);++e<i;){var o=n[e];t(o,e,n)&&(r.push(o),\nu.push(e))}return ur(n,u),r},An.rest=function(n,t){if(typeof n!=\"function\")throw new ti(\"Expected a function\");return t=t===T?t:ku(t),fr(n,t)},An.reverse=Ge,An.sampleSize=function(n,t,r){return t=(r?Oe(n,t,r):t===T)?1:ku(t),(ff(n)?et:ar)(n,t)},An.set=function(n,t,r){return null==n?n:lr(n,t,r)},An.setWith=function(n,t,r,e){return e=typeof e==\"function\"?e:T,null==n?n:lr(n,t,r,e)},An.shuffle=function(n){return(ff(n)?ut:sr)(n)},An.slice=function(n,t,r){var e=null==n?0:n.length;return e?(r&&typeof r!=\"number\"&&Oe(n,t,r)?(t=0,\nr=e):(t=null==t?0:ku(t),r=r===T?e:ku(r)),hr(n,t,r)):[]},An.sortBy=Ko,An.sortedUniq=function(n){return n&&n.length?gr(n):[]},An.sortedUniqBy=function(n,t){return n&&n.length?gr(n,ye(t,2)):[]},An.split=function(n,t,r){return r&&typeof r!=\"number\"&&Oe(n,t,r)&&(t=r=T),r=r===T?4294967295:r>>>0,r?(n=Iu(n))&&(typeof t==\"string\"||null!=t&&!hf(t))&&(t=yr(t),!t&&Rn.test(n))?Or(M(n),0,r):n.split(t,r):[]},An.spread=function(t,r){if(typeof t!=\"function\")throw new ti(\"Expected a function\");return r=null==r?0:Li(ku(r),0),\nfr(function(e){var u=e[r];return e=Or(e,0,r),u&&a(e,u),n(t,this,e)})},An.tail=function(n){var t=null==n?0:n.length;return t?hr(n,1,t):[]},An.take=function(n,t,r){return n&&n.length?(t=r||t===T?1:ku(t),hr(n,0,0>t?0:t)):[]},An.takeRight=function(n,t,r){var e=null==n?0:n.length;return e?(t=r||t===T?1:ku(t),t=e-t,hr(n,0>t?0:t,e)):[]},An.takeRightWhile=function(n,t){return n&&n.length?jr(n,ye(t,3),false,true):[]},An.takeWhile=function(n,t){return n&&n.length?jr(n,ye(t,3)):[]},An.tap=function(n,t){return t(n),\nn},An.throttle=function(n,t,r){var e=true,u=true;if(typeof n!=\"function\")throw new ti(\"Expected a function\");return du(r)&&(e=\"leading\"in r?!!r.leading:e,u=\"trailing\"in r?!!r.trailing:u),fu(n,t,{leading:e,maxWait:t,trailing:u})},An.thru=Qe,An.toArray=mu,An.toPairs=zf,An.toPairsIn=Wf,An.toPath=function(n){return ff(n)?c(n,Me):wu(n)?[n]:Lr(jo(Iu(n)))},An.toPlainObject=Ou,An.transform=function(n,t,e){var u=ff(n),i=u||af(n)||_f(n);if(t=ye(t,4),null==e){var o=n&&n.constructor;e=i?u?new o:[]:du(n)&&_u(o)?eo(di(n)):{};\n}return(i?r:mt)(n,function(n,r,u){return t(e,n,r,u)}),e},An.unary=function(n){return eu(n,1)},An.union=Ro,An.unionBy=zo,An.unionWith=Wo,An.uniq=function(n){return n&&n.length?br(n):[]},An.uniqBy=function(n,t){return n&&n.length?br(n,ye(t,2)):[]},An.uniqWith=function(n,t){return t=typeof t==\"function\"?t:T,n&&n.length?br(n,T,t):[]},An.unset=function(n,t){return null==n||xr(n,t)},An.unzip=He,An.unzipWith=Je,An.update=function(n,t,r){return null!=n&&(r=Er(r),n=lr(n,t,r(Et(n,t)),void 0)),n},An.updateWith=function(n,t,r,e){\nreturn e=typeof e==\"function\"?e:T,null!=n&&(r=Er(r),n=lr(n,t,r(Et(n,t)),e)),n},An.values=Lu,An.valuesIn=function(n){return null==n?[]:S(n,Uu(n))},An.without=Uo,An.words=Mu,An.wrap=function(n,t){return nf(Er(t),n)},An.xor=Bo,An.xorBy=Lo,An.xorWith=Co,An.zip=Do,An.zipObject=function(n,t){return Ar(n||[],t||[],ot)},An.zipObjectDeep=function(n,t){return Ar(n||[],t||[],lr)},An.zipWith=Mo,An.entries=zf,An.entriesIn=Wf,An.extend=yf,An.extendWith=bf,Nu(An,An),An.add=Qf,An.attempt=Ff,An.camelCase=Uf,An.capitalize=Cu,\nAn.ceil=Xf,An.clamp=function(n,t,r){return r===T&&(r=t,t=T),r!==T&&(r=Su(r),r=r===r?r:0),t!==T&&(t=Su(t),t=t===t?t:0),pt(Su(n),t,r)},An.clone=function(n){return _t(n,4)},An.cloneDeep=function(n){return _t(n,5)},An.cloneDeepWith=function(n,t){return t=typeof t==\"function\"?t:T,_t(n,5,t)},An.cloneWith=function(n,t){return t=typeof t==\"function\"?t:T,_t(n,4,t)},An.conformsTo=function(n,t){return null==t||gt(n,t,Wu(t))},An.deburr=Du,An.defaultTo=function(n,t){return null==n||n!==n?t:n},An.divide=nc,An.endsWith=function(n,t,r){\nn=Iu(n),t=yr(t);var e=n.length,e=r=r===T?e:pt(ku(r),0,e);return r-=t.length,0<=r&&n.slice(r,e)==t},An.eq=lu,An.escape=function(n){return(n=Iu(n))&&H.test(n)?n.replace(K,nt):n},An.escapeRegExp=function(n){return(n=Iu(n))&&en.test(n)?n.replace(rn,\"\\\\$&\"):n},An.every=function(n,t,r){var e=ff(n)?u:bt;return r&&Oe(n,t,r)&&(t=T),e(n,ye(t,3))},An.find=Fo,An.findIndex=Ne,An.findKey=function(n,t){return p(n,ye(t,3),mt)},An.findLast=No,An.findLastIndex=Pe,An.findLastKey=function(n,t){return p(n,ye(t,3),At);\n},An.floor=tc,An.forEach=nu,An.forEachRight=tu,An.forIn=function(n,t){return null==n?n:oo(n,ye(t,3),Uu)},An.forInRight=function(n,t){return null==n?n:fo(n,ye(t,3),Uu)},An.forOwn=function(n,t){return n&&mt(n,ye(t,3))},An.forOwnRight=function(n,t){return n&&At(n,ye(t,3))},An.get=Ru,An.gt=ef,An.gte=uf,An.has=function(n,t){return null!=n&&we(n,t,Rt)},An.hasIn=zu,An.head=qe,An.identity=$u,An.includes=function(n,t,r,e){return n=su(n)?n:Lu(n),r=r&&!e?ku(r):0,e=n.length,0>r&&(r=Li(e+r,0)),ju(n)?r<=e&&-1<n.indexOf(t,r):!!e&&-1<v(n,t,r);\n},An.indexOf=function(n,t,r){var e=null==n?0:n.length;return e?(r=null==r?0:ku(r),0>r&&(r=Li(e+r,0)),v(n,t,r)):-1},An.inRange=function(n,t,r){return t=Au(t),r===T?(r=t,t=0):r=Au(r),n=Su(n),n>=Ci(t,r)&&n<Li(t,r)},An.invoke=Ef,An.isArguments=of,An.isArray=ff,An.isArrayBuffer=cf,An.isArrayLike=su,An.isArrayLikeObject=hu,An.isBoolean=function(n){return true===n||false===n||yu(n)&&\"[object Boolean]\"==Ot(n)},An.isBuffer=af,An.isDate=lf,An.isElement=function(n){return yu(n)&&1===n.nodeType&&!xu(n)},An.isEmpty=function(n){\nif(null==n)return true;if(su(n)&&(ff(n)||typeof n==\"string\"||typeof n.splice==\"function\"||af(n)||_f(n)||of(n)))return!n.length;var t=vo(n);if(\"[object Map]\"==t||\"[object Set]\"==t)return!n.size;if(ze(n))return!Vt(n).length;for(var r in n)if(oi.call(n,r))return false;return true},An.isEqual=function(n,t){return Mt(n,t)},An.isEqualWith=function(n,t,r){var e=(r=typeof r==\"function\"?r:T)?r(n,t):T;return e===T?Mt(n,t,T,r):!!e},An.isError=pu,An.isFinite=function(n){return typeof n==\"number\"&&Wi(n)},An.isFunction=_u,\nAn.isInteger=vu,An.isLength=gu,An.isMap=sf,An.isMatch=function(n,t){return n===t||$t(n,t,xe(t))},An.isMatchWith=function(n,t,r){return r=typeof r==\"function\"?r:T,$t(n,t,xe(t),r)},An.isNaN=function(n){return bu(n)&&n!=+n},An.isNative=function(n){if(go(n))throw new Hu(\"Unsupported core-js use. Try https://npms.io/search?q=ponyfill.\");return Ft(n)},An.isNil=function(n){return null==n},An.isNull=function(n){return null===n},An.isNumber=bu,An.isObject=du,An.isObjectLike=yu,An.isPlainObject=xu,An.isRegExp=hf,\nAn.isSafeInteger=function(n){return vu(n)&&-9007199254740991<=n&&9007199254740991>=n},An.isSet=pf,An.isString=ju,An.isSymbol=wu,An.isTypedArray=_f,An.isUndefined=function(n){return n===T},An.isWeakMap=function(n){return yu(n)&&\"[object WeakMap]\"==vo(n)},An.isWeakSet=function(n){return yu(n)&&\"[object WeakSet]\"==Ot(n)},An.join=function(n,t){return null==n?\"\":Ui.call(n,t)},An.kebabCase=Bf,An.last=Ve,An.lastIndexOf=function(n,t,r){var e=null==n?0:n.length;if(!e)return-1;var u=e;if(r!==T&&(u=ku(r),u=0>u?Li(e+u,0):Ci(u,e-1)),\nt===t)n:{for(r=u+1;r--;)if(n[r]===t){n=r;break n}n=r}else n=_(n,d,u,true);return n},An.lowerCase=Lf,An.lowerFirst=Cf,An.lt=vf,An.lte=gf,An.max=function(n){return n&&n.length?xt(n,$u,It):T},An.maxBy=function(n,t){return n&&n.length?xt(n,ye(t,2),It):T},An.mean=function(n){return y(n,$u)},An.meanBy=function(n,t){return y(n,ye(t,2))},An.min=function(n){return n&&n.length?xt(n,$u,Kt):T},An.minBy=function(n,t){return n&&n.length?xt(n,ye(t,2),Kt):T},An.stubArray=qu,An.stubFalse=Vu,An.stubObject=function(){\nreturn{}},An.stubString=function(){return\"\"},An.stubTrue=function(){return true},An.multiply=rc,An.nth=function(n,t){return n&&n.length?Qt(n,ku(t)):T},An.noConflict=function(){return $n._===this&&($n._=si),this},An.noop=Pu,An.now=Go,An.pad=function(n,t,r){n=Iu(n);var e=(t=ku(t))?D(n):0;return!t||e>=t?n:(t=(t-e)/2,ne(Ii(t),r)+n+ne(Oi(t),r))},An.padEnd=function(n,t,r){n=Iu(n);var e=(t=ku(t))?D(n):0;return t&&e<t?n+ne(t-e,r):n},An.padStart=function(n,t,r){n=Iu(n);var e=(t=ku(t))?D(n):0;return t&&e<t?ne(t-e,r)+n:n;\n},An.parseInt=function(n,t,r){return r||null==t?t=0:t&&(t=+t),Mi(Iu(n).replace(on,\"\"),t||0)},An.random=function(n,t,r){if(r&&typeof r!=\"boolean\"&&Oe(n,t,r)&&(t=r=T),r===T&&(typeof t==\"boolean\"?(r=t,t=T):typeof n==\"boolean\"&&(r=n,n=T)),n===T&&t===T?(n=0,t=1):(n=Au(n),t===T?(t=n,n=0):t=Au(t)),n>t){var e=n;n=t,t=e}return r||n%1||t%1?(r=Ti(),Ci(n+r*(t-n+Cn(\"1e-\"+((r+\"\").length-1))),t)):ir(n,t)},An.reduce=function(n,t,r){var e=ff(n)?l:j,u=3>arguments.length;return e(n,ye(t,4),r,u,uo)},An.reduceRight=function(n,t,r){\nvar e=ff(n)?s:j,u=3>arguments.length;return e(n,ye(t,4),r,u,io)},An.repeat=function(n,t,r){return t=(r?Oe(n,t,r):t===T)?1:ku(t),or(Iu(n),t)},An.replace=function(){var n=arguments,t=Iu(n[0]);return 3>n.length?t:t.replace(n[1],n[2])},An.result=function(n,t,r){t=Sr(t,n);var e=-1,u=t.length;for(u||(u=1,n=T);++e<u;){var i=null==n?T:n[Me(t[e])];i===T&&(e=u,i=r),n=_u(i)?i.call(n):i}return n},An.round=ec,An.runInContext=x,An.sample=function(n){return(ff(n)?Qn:cr)(n)},An.size=function(n){if(null==n)return 0;\nif(su(n))return ju(n)?D(n):n.length;var t=vo(n);return\"[object Map]\"==t||\"[object Set]\"==t?n.size:Vt(n).length},An.snakeCase=Df,An.some=function(n,t,r){var e=ff(n)?h:pr;return r&&Oe(n,t,r)&&(t=T),e(n,ye(t,3))},An.sortedIndex=function(n,t){return _r(n,t)},An.sortedIndexBy=function(n,t,r){return vr(n,t,ye(r,2))},An.sortedIndexOf=function(n,t){var r=null==n?0:n.length;if(r){var e=_r(n,t);if(e<r&&lu(n[e],t))return e}return-1},An.sortedLastIndex=function(n,t){return _r(n,t,true)},An.sortedLastIndexBy=function(n,t,r){\nreturn vr(n,t,ye(r,2),true)},An.sortedLastIndexOf=function(n,t){if(null==n?0:n.length){var r=_r(n,t,true)-1;if(lu(n[r],t))return r}return-1},An.startCase=Mf,An.startsWith=function(n,t,r){return n=Iu(n),r=null==r?0:pt(ku(r),0,n.length),t=yr(t),n.slice(r,r+t.length)==t},An.subtract=uc,An.sum=function(n){return n&&n.length?m(n,$u):0},An.sumBy=function(n,t){return n&&n.length?m(n,ye(t,2)):0},An.template=function(n,t,r){var e=An.templateSettings;r&&Oe(n,t,r)&&(t=T),n=Iu(n),t=bf({},t,e,ce),r=bf({},t.imports,e.imports,ce);\nvar u,i,o=Wu(r),f=S(r,o),c=0;r=t.interpolate||jn;var a=\"__p+='\";r=Xu((t.escape||jn).source+\"|\"+r.source+\"|\"+(r===Q?pn:jn).source+\"|\"+(t.evaluate||jn).source+\"|$\",\"g\");var l=\"sourceURL\"in t?\"//# sourceURL=\"+t.sourceURL+\"\\n\":\"\";if(n.replace(r,function(t,r,e,o,f,l){return e||(e=o),a+=n.slice(c,l).replace(wn,z),r&&(u=true,a+=\"'+__e(\"+r+\")+'\"),f&&(i=true,a+=\"';\"+f+\";\\n__p+='\"),e&&(a+=\"'+((__t=(\"+e+\"))==null?'':__t)+'\"),c=l+t.length,t}),a+=\"';\",(t=t.variable)||(a=\"with(obj){\"+a+\"}\"),a=(i?a.replace(P,\"\"):a).replace(Z,\"$1\").replace(q,\"$1;\"),\na=\"function(\"+(t||\"obj\")+\"){\"+(t?\"\":\"obj||(obj={});\")+\"var __t,__p=''\"+(u?\",__e=_.escape\":\"\")+(i?\",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}\":\";\")+a+\"return __p}\",t=Ff(function(){return Ju(o,l+\"return \"+a).apply(T,f)}),t.source=a,pu(t))throw t;return t},An.times=function(n,t){if(n=ku(n),1>n||9007199254740991<n)return[];var r=4294967295,e=Ci(n,4294967295);for(t=ye(t),n-=4294967295,e=A(e,t);++r<n;)t(r);return e},An.toFinite=Au,An.toInteger=ku,An.toLength=Eu,An.toLower=function(n){\nreturn Iu(n).toLowerCase()},An.toNumber=Su,An.toSafeInteger=function(n){return n?pt(ku(n),-9007199254740991,9007199254740991):0===n?n:0},An.toString=Iu,An.toUpper=function(n){return Iu(n).toUpperCase()},An.trim=function(n,t,r){return(n=Iu(n))&&(r||t===T)?n.replace(un,\"\"):n&&(t=yr(t))?(n=M(n),r=M(t),t=I(n,r),r=R(n,r)+1,Or(n,t,r).join(\"\")):n},An.trimEnd=function(n,t,r){return(n=Iu(n))&&(r||t===T)?n.replace(fn,\"\"):n&&(t=yr(t))?(n=M(n),t=R(n,M(t))+1,Or(n,0,t).join(\"\")):n},An.trimStart=function(n,t,r){\nreturn(n=Iu(n))&&(r||t===T)?n.replace(on,\"\"):n&&(t=yr(t))?(n=M(n),t=I(n,M(t)),Or(n,t).join(\"\")):n},An.truncate=function(n,t){var r=30,e=\"...\";if(du(t))var u=\"separator\"in t?t.separator:u,r=\"length\"in t?ku(t.length):r,e=\"omission\"in t?yr(t.omission):e;n=Iu(n);var i=n.length;if(Rn.test(n))var o=M(n),i=o.length;if(r>=i)return n;if(i=r-D(e),1>i)return e;if(r=o?Or(o,0,i).join(\"\"):n.slice(0,i),u===T)return r+e;if(o&&(i+=r.length-i),hf(u)){if(n.slice(i).search(u)){var f=r;for(u.global||(u=Xu(u.source,Iu(_n.exec(u))+\"g\")),\nu.lastIndex=0;o=u.exec(f);)var c=o.index;r=r.slice(0,c===T?i:c)}}else n.indexOf(yr(u),i)!=i&&(u=r.lastIndexOf(u),-1<u&&(r=r.slice(0,u)));return r+e},An.unescape=function(n){return(n=Iu(n))&&G.test(n)?n.replace(V,tt):n},An.uniqueId=function(n){var t=++fi;return Iu(n)+t},An.upperCase=Tf,An.upperFirst=$f,An.each=nu,An.eachRight=tu,An.first=qe,Nu(An,function(){var n={};return mt(An,function(t,r){oi.call(An.prototype,r)||(n[r]=t)}),n}(),{chain:false}),An.VERSION=\"4.17.11\",r(\"bind bindKey curry curryRight partial partialRight\".split(\" \"),function(n){\nAn[n].placeholder=An}),r([\"drop\",\"take\"],function(n,t){Ln.prototype[n]=function(r){r=r===T?1:Li(ku(r),0);var e=this.__filtered__&&!t?new Ln(this):this.clone();return e.__filtered__?e.__takeCount__=Ci(r,e.__takeCount__):e.__views__.push({size:Ci(r,4294967295),type:n+(0>e.__dir__?\"Right\":\"\")}),e},Ln.prototype[n+\"Right\"]=function(t){return this.reverse()[n](t).reverse()}}),r([\"filter\",\"map\",\"takeWhile\"],function(n,t){var r=t+1,e=1==r||3==r;Ln.prototype[n]=function(n){var t=this.clone();return t.__iteratees__.push({\niteratee:ye(n,3),type:r}),t.__filtered__=t.__filtered__||e,t}}),r([\"head\",\"last\"],function(n,t){var r=\"take\"+(t?\"Right\":\"\");Ln.prototype[n]=function(){return this[r](1).value()[0]}}),r([\"initial\",\"tail\"],function(n,t){var r=\"drop\"+(t?\"\":\"Right\");Ln.prototype[n]=function(){return this.__filtered__?new Ln(this):this[r](1)}}),Ln.prototype.compact=function(){return this.filter($u)},Ln.prototype.find=function(n){return this.filter(n).head()},Ln.prototype.findLast=function(n){return this.reverse().find(n);\n},Ln.prototype.invokeMap=fr(function(n,t){return typeof n==\"function\"?new Ln(this):this.map(function(r){return Bt(r,n,t)})}),Ln.prototype.reject=function(n){return this.filter(au(ye(n)))},Ln.prototype.slice=function(n,t){n=ku(n);var r=this;return r.__filtered__&&(0<n||0>t)?new Ln(r):(0>n?r=r.takeRight(-n):n&&(r=r.drop(n)),t!==T&&(t=ku(t),r=0>t?r.dropRight(-t):r.take(t-n)),r)},Ln.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},Ln.prototype.toArray=function(){return this.take(4294967295);\n},mt(Ln.prototype,function(n,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),e=/^(?:head|last)$/.test(t),u=An[e?\"take\"+(\"last\"==t?\"Right\":\"\"):t],i=e||/^find/.test(t);u&&(An.prototype[t]=function(){var t=this.__wrapped__,o=e?[1]:arguments,f=t instanceof Ln,c=o[0],l=f||ff(t),s=function(n){return n=u.apply(An,a([n],o)),e&&h?n[0]:n};l&&r&&typeof c==\"function\"&&1!=c.length&&(f=l=false);var h=this.__chain__,p=!!this.__actions__.length,c=i&&!h,f=f&&!p;return!i&&l?(t=f?t:new Ln(this),t=n.apply(t,o),t.__actions__.push({\nfunc:Qe,args:[s],thisArg:T}),new On(t,h)):c&&f?n.apply(this,o):(t=this.thru(s),c?e?t.value()[0]:t.value():t)})}),r(\"pop push shift sort splice unshift\".split(\" \"),function(n){var t=ri[n],r=/^(?:push|sort|unshift)$/.test(n)?\"tap\":\"thru\",e=/^(?:pop|shift)$/.test(n);An.prototype[n]=function(){var n=arguments;if(e&&!this.__chain__){var u=this.value();return t.apply(ff(u)?u:[],n)}return this[r](function(r){return t.apply(ff(r)?r:[],n)})}}),mt(Ln.prototype,function(n,t){var r=An[t];if(r){var e=r.name+\"\";\n(Gi[e]||(Gi[e]=[])).push({name:t,func:r})}}),Gi[Jr(T,2).name]=[{name:\"wrapper\",func:T}],Ln.prototype.clone=function(){var n=new Ln(this.__wrapped__);return n.__actions__=Lr(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=Lr(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=Lr(this.__views__),n},Ln.prototype.reverse=function(){if(this.__filtered__){var n=new Ln(this);n.__dir__=-1,n.__filtered__=true}else n=this.clone(),n.__dir__*=-1;return n;\n},Ln.prototype.value=function(){var n,t=this.__wrapped__.value(),r=this.__dir__,e=ff(t),u=0>r,i=e?t.length:0;n=0;for(var o=i,f=this.__views__,c=-1,a=f.length;++c<a;){var l=f[c],s=l.size;switch(l.type){case\"drop\":n+=s;break;case\"dropRight\":o-=s;break;case\"take\":o=Ci(o,n+s);break;case\"takeRight\":n=Li(n,o-s)}}if(n={start:n,end:o},o=n.start,f=n.end,n=f-o,o=u?f:o-1,f=this.__iteratees__,c=f.length,a=0,l=Ci(n,this.__takeCount__),!e||!u&&i==n&&l==n)return wr(t,this.__actions__);e=[];n:for(;n--&&a<l;){for(o+=r,\nu=-1,i=t[o];++u<c;){var h=f[u],s=h.type,h=(0,h.iteratee)(i);if(2==s)i=h;else if(!h){if(1==s)continue n;break n}}e[a++]=i}return e},An.prototype.at=To,An.prototype.chain=function(){return Ye(this)},An.prototype.commit=function(){return new On(this.value(),this.__chain__)},An.prototype.next=function(){this.__values__===T&&(this.__values__=mu(this.value()));var n=this.__index__>=this.__values__.length;return{done:n,value:n?T:this.__values__[this.__index__++]}},An.prototype.plant=function(n){for(var t,r=this;r instanceof kn;){\nvar e=Fe(r);e.__index__=0,e.__values__=T,t?u.__wrapped__=e:t=e;var u=e,r=r.__wrapped__}return u.__wrapped__=n,t},An.prototype.reverse=function(){var n=this.__wrapped__;return n instanceof Ln?(this.__actions__.length&&(n=new Ln(this)),n=n.reverse(),n.__actions__.push({func:Qe,args:[Ge],thisArg:T}),new On(n,this.__chain__)):this.thru(Ge)},An.prototype.toJSON=An.prototype.valueOf=An.prototype.value=function(){return wr(this.__wrapped__,this.__actions__)},An.prototype.first=An.prototype.head,wi&&(An.prototype[wi]=Xe),\nAn}();typeof define==\"function\"&&typeof define.amd==\"object\"&&define.amd?($n._=rt, define(function(){return rt})):Nn?((Nn.exports=rt)._=rt,Fn._=rt):$n._=rt}).call(this);","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods(level, loggerName) {\n        /*jshint validthis:true */\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, loggerName);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this, level, loggerName);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, level, loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, defaultLevel, factory) {\n      var self = this;\n      var currentLevel;\n      var storageKey = \"loglevel\";\n      if (name) {\n        storageKey += \":\" + name;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var location = cookie.indexOf(\n                      encodeURIComponent(storageKey) + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          return currentLevel;\n      };\n\n      self.setLevel = function (level, persist) {\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              currentLevel = level;\n              if (persist !== false) {  // defaults to true\n                  persistLevelIfPossible(level);\n              }\n              replaceLoggingMethods.call(self, level, name);\n              if (typeof console === undefinedType && level < self.levels.SILENT) {\n                  return \"No console available for logging\";\n              }\n          } else {\n              throw \"log.setLevel() called with invalid level: \" + level;\n          }\n      };\n\n      self.setDefaultLevel = function (level) {\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      // Initialize with the right level\n      var initialLevel = getPersistedLevel();\n      if (initialLevel == null) {\n          initialLevel = defaultLevel == null ? \"WARN\" : defaultLevel;\n      }\n      self.setLevel(initialLevel, false);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    var defaultLogger = new Logger();\n\n    var _loggersByName = {};\n    defaultLogger.getLogger = function getLogger(name) {\n        if (typeof name !== \"string\" || name === \"\") {\n          throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n          logger = _loggersByName[name] = new Logger(\n            name, defaultLogger.getLevel(), defaultLogger.methodFactory);\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    return defaultLogger;\n}));\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","export default (function () {\n  for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  var initialState = typeof args[args.length - 1] !== 'function' && args.pop();\n  var reducers = args;\n\n  if (typeof initialState === 'undefined') {\n    throw new TypeError('The initial state may not be undefined. If you do not want to set a value for this reducer, you can use null instead of undefined.');\n  }\n\n  return function (prevState, value) {\n    for (var _len2 = arguments.length, args = Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n      args[_key2 - 2] = arguments[_key2];\n    }\n\n    var prevStateIsUndefined = typeof prevState === 'undefined';\n    var valueIsUndefined = typeof value === 'undefined';\n\n    if (prevStateIsUndefined && valueIsUndefined && initialState) {\n      return initialState;\n    }\n\n    return reducers.reduce(function (newState, reducer) {\n      return reducer.apply(undefined, [newState, value].concat(args));\n    }, prevStateIsUndefined && !valueIsUndefined && initialState ? initialState : prevState);\n  };\n});","import invariant from 'invariant';\nimport isFunction from './utils/isFunction';\nimport isSymbol from './utils/isSymbol';\nimport isEmpty from './utils/isEmpty';\nimport toString from './utils/toString';\nimport isString from './utils/isString';\nimport { ACTION_TYPE_DELIMITER } from './constants';\n\nfunction isValidActionType(type) {\n  return isString(type) || isFunction(type) || isSymbol(type);\n}\n\nfunction isValidActionTypes(types) {\n  if (isEmpty(types)) {\n    return false;\n  }\n\n  return types.every(isValidActionType);\n}\n\nexport default function combineActions() {\n  for (var _len = arguments.length, actionsTypes = new Array(_len), _key = 0; _key < _len; _key++) {\n    actionsTypes[_key] = arguments[_key];\n  }\n\n  invariant(isValidActionTypes(actionsTypes), 'Expected action types to be strings, symbols, or action creators');\n  var combinedActionType = actionsTypes.map(toString).join(ACTION_TYPE_DELIMITER);\n  return {\n    toString: function toString() {\n      return combinedActionType;\n    }\n  };\n}","export var DEFAULT_NAMESPACE = '/';\nexport var ACTION_TYPE_DELIMITER = '||';","import invariant from 'invariant';\nimport isFunction from './utils/isFunction';\nimport identity from './utils/identity';\nimport isNull from './utils/isNull';\nexport default function createAction(type, payloadCreator, metaCreator) {\n  if (payloadCreator === void 0) {\n    payloadCreator = identity;\n  }\n\n  invariant(isFunction(payloadCreator) || isNull(payloadCreator), 'Expected payloadCreator to be a function, undefined or null');\n  var finalPayloadCreator = isNull(payloadCreator) || payloadCreator === identity ? identity : function (head) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    return head instanceof Error ? head : payloadCreator.apply(void 0, [head].concat(args));\n  };\n  var hasMeta = isFunction(metaCreator);\n  var typeString = type.toString();\n\n  var actionCreator = function actionCreator() {\n    var payload = finalPayloadCreator.apply(void 0, arguments);\n    var action = {\n      type: type\n    };\n\n    if (payload instanceof Error) {\n      action.error = true;\n    }\n\n    if (payload !== undefined) {\n      action.payload = payload;\n    }\n\n    if (hasMeta) {\n      action.meta = metaCreator.apply(void 0, arguments);\n    }\n\n    return action;\n  };\n\n  actionCreator.toString = function () {\n    return typeString;\n  };\n\n  return actionCreator;\n}","function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport invariant from 'invariant';\nimport isPlainObject from './utils/isPlainObject';\nimport isFunction from './utils/isFunction';\nimport identity from './utils/identity';\nimport isArray from './utils/isArray';\nimport isString from './utils/isString';\nimport isNil from './utils/isNil';\nimport getLastElement from './utils/getLastElement';\nimport camelCase from './utils/camelCase';\nimport arrayToObject from './utils/arrayToObject';\nimport flattenActionMap from './utils/flattenActionMap';\nimport unflattenActionCreators from './utils/unflattenActionCreators';\nimport createAction from './createAction';\nimport { DEFAULT_NAMESPACE } from './constants';\nexport default function createActions(actionMap) {\n  for (var _len = arguments.length, identityActions = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    identityActions[_key - 1] = arguments[_key];\n  }\n\n  var options = isPlainObject(getLastElement(identityActions)) ? identityActions.pop() : {};\n  invariant(identityActions.every(isString) && (isString(actionMap) || isPlainObject(actionMap)), 'Expected optional object followed by string action types');\n\n  if (isString(actionMap)) {\n    return actionCreatorsFromIdentityActions([actionMap].concat(identityActions), options);\n  }\n\n  return _objectSpread({}, actionCreatorsFromActionMap(actionMap, options), actionCreatorsFromIdentityActions(identityActions, options));\n}\n\nfunction actionCreatorsFromActionMap(actionMap, options) {\n  var flatActionMap = flattenActionMap(actionMap, options);\n  var flatActionCreators = actionMapToActionCreators(flatActionMap);\n  return unflattenActionCreators(flatActionCreators, options);\n}\n\nfunction actionMapToActionCreators(actionMap, _temp) {\n  var _ref = _temp === void 0 ? {} : _temp,\n      prefix = _ref.prefix,\n      _ref$namespace = _ref.namespace,\n      namespace = _ref$namespace === void 0 ? DEFAULT_NAMESPACE : _ref$namespace;\n\n  function isValidActionMapValue(actionMapValue) {\n    if (isFunction(actionMapValue) || isNil(actionMapValue)) {\n      return true;\n    }\n\n    if (isArray(actionMapValue)) {\n      var _actionMapValue$ = actionMapValue[0],\n          payload = _actionMapValue$ === void 0 ? identity : _actionMapValue$,\n          meta = actionMapValue[1];\n      return isFunction(payload) && isFunction(meta);\n    }\n\n    return false;\n  }\n\n  return arrayToObject(Object.keys(actionMap), function (partialActionCreators, type) {\n    var _objectSpread2;\n\n    var actionMapValue = actionMap[type];\n    invariant(isValidActionMapValue(actionMapValue), 'Expected function, undefined, null, or array with payload and meta ' + (\"functions for \" + type));\n    var prefixedType = prefix ? \"\" + prefix + namespace + type : type;\n    var actionCreator = isArray(actionMapValue) ? createAction.apply(void 0, [prefixedType].concat(actionMapValue)) : createAction(prefixedType, actionMapValue);\n    return _objectSpread({}, partialActionCreators, (_objectSpread2 = {}, _objectSpread2[type] = actionCreator, _objectSpread2));\n  });\n}\n\nfunction actionCreatorsFromIdentityActions(identityActions, options) {\n  var actionMap = arrayToObject(identityActions, function (partialActionMap, type) {\n    var _objectSpread3;\n\n    return _objectSpread({}, partialActionMap, (_objectSpread3 = {}, _objectSpread3[type] = identity, _objectSpread3));\n  });\n  var actionCreators = actionMapToActionCreators(actionMap, options);\n  return arrayToObject(Object.keys(actionCreators), function (partialActionCreators, type) {\n    var _objectSpread4;\n\n    return _objectSpread({}, partialActionCreators, (_objectSpread4 = {}, _objectSpread4[camelCase(type)] = actionCreators[type], _objectSpread4));\n  });\n}","import curry from 'just-curry-it';\nimport createAction from './createAction';\nexport default (function (type, payloadCreator) {\n  return curry(createAction(type, payloadCreator), payloadCreator.length);\n});","import invariant from 'invariant';\nimport isFunction from './utils/isFunction';\nimport isPlainObject from './utils/isPlainObject';\nimport identity from './utils/identity';\nimport isNil from './utils/isNil';\nimport isUndefined from './utils/isUndefined';\nimport toString from './utils/toString';\nimport { ACTION_TYPE_DELIMITER } from './constants';\nexport default function handleAction(type, reducer, defaultState) {\n  if (reducer === void 0) {\n    reducer = identity;\n  }\n\n  var types = toString(type).split(ACTION_TYPE_DELIMITER);\n  invariant(!isUndefined(defaultState), \"defaultState for reducer handling \" + types.join(', ') + \" should be defined\");\n  invariant(isFunction(reducer) || isPlainObject(reducer), 'Expected reducer to be a function or object with next and throw reducers');\n\n  var _ref = isFunction(reducer) ? [reducer, reducer] : [reducer.next, reducer.throw].map(function (aReducer) {\n    return isNil(aReducer) ? identity : aReducer;\n  }),\n      nextReducer = _ref[0],\n      throwReducer = _ref[1];\n\n  return function (state, action) {\n    if (state === void 0) {\n      state = defaultState;\n    }\n\n    var actionType = action.type;\n\n    if (!actionType || types.indexOf(toString(actionType)) === -1) {\n      return state;\n    }\n\n    return (action.error === true ? throwReducer : nextReducer)(state, action);\n  };\n}","import reduceReducers from 'reduce-reducers';\nimport invariant from 'invariant';\nimport isPlainObject from './utils/isPlainObject';\nimport isMap from './utils/isMap';\nimport ownKeys from './utils/ownKeys';\nimport flattenReducerMap from './utils/flattenReducerMap';\nimport handleAction from './handleAction';\nimport get from './utils/get';\nexport default function handleActions(handlers, defaultState, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  invariant(isPlainObject(handlers) || isMap(handlers), 'Expected handlers to be a plain object.');\n  var flattenedReducerMap = flattenReducerMap(handlers, options);\n  var reducers = ownKeys(flattenedReducerMap).map(function (type) {\n    return handleAction(type, get(type, flattenedReducerMap), defaultState);\n  });\n  var reducer = reduceReducers.apply(void 0, reducers.concat([defaultState]));\n  return function (state, action) {\n    if (state === void 0) {\n      state = defaultState;\n    }\n\n    return reducer(state, action);\n  };\n}","import combineActions from './combineActions';\nimport createAction from './createAction';\nimport createActions from './createActions';\nimport createCurriedAction from './createCurriedAction';\nimport handleAction from './handleAction';\nimport handleActions from './handleActions';\nexport { combineActions, createAction, createActions, createCurriedAction, handleAction, handleActions };","export default (function (array, callback) {\n  return array.reduce(function (partialObject, element) {\n    return callback(partialObject, element);\n  }, {});\n});","import camelCase from 'to-camel-case';\nvar namespacer = '/';\nexport default (function (type) {\n  return type.indexOf(namespacer) === -1 ? camelCase(type) : type.split(namespacer).map(camelCase).join(namespacer);\n});","import isPlainObject from './isPlainObject';\nimport flattenWhenNode from './flattenWhenNode';\nexport default flattenWhenNode(isPlainObject);","import isPlainObject from './isPlainObject';\nimport isMap from './isMap';\nimport hasGeneratorInterface from './hasGeneratorInterface';\nimport flattenWhenNode from './flattenWhenNode';\nexport default flattenWhenNode(function (node) {\n  return (isPlainObject(node) || isMap(node)) && !hasGeneratorInterface(node);\n});","import { DEFAULT_NAMESPACE, ACTION_TYPE_DELIMITER } from '../constants';\nimport ownKeys from './ownKeys';\nimport get from './get';\nexport default (function (predicate) {\n  return function flatten(map, _temp, partialFlatMap, partialFlatActionType) {\n    var _ref = _temp === void 0 ? {} : _temp,\n        _ref$namespace = _ref.namespace,\n        namespace = _ref$namespace === void 0 ? DEFAULT_NAMESPACE : _ref$namespace,\n        prefix = _ref.prefix;\n\n    if (partialFlatMap === void 0) {\n      partialFlatMap = {};\n    }\n\n    if (partialFlatActionType === void 0) {\n      partialFlatActionType = '';\n    }\n\n    function connectNamespace(type) {\n      var _ref2;\n\n      if (!partialFlatActionType) return type;\n      var types = type.toString().split(ACTION_TYPE_DELIMITER);\n      var partials = partialFlatActionType.split(ACTION_TYPE_DELIMITER);\n      return (_ref2 = []).concat.apply(_ref2, partials.map(function (p) {\n        return types.map(function (t) {\n          return \"\" + p + namespace + t;\n        });\n      })).join(ACTION_TYPE_DELIMITER);\n    }\n\n    function connectPrefix(type) {\n      if (partialFlatActionType || !prefix || prefix && new RegExp(\"^\" + prefix + namespace).test(type)) {\n        return type;\n      }\n\n      return \"\" + prefix + namespace + type;\n    }\n\n    ownKeys(map).forEach(function (type) {\n      var nextNamespace = connectPrefix(connectNamespace(type));\n      var mapValue = get(type, map);\n\n      if (predicate(mapValue)) {\n        flatten(mapValue, {\n          namespace: namespace,\n          prefix: prefix\n        }, partialFlatMap, nextNamespace);\n      } else {\n        partialFlatMap[nextNamespace] = mapValue;\n      }\n    });\n    return partialFlatMap;\n  };\n});","import isMap from './isMap';\nexport default function get(key, x) {\n  return isMap(x) ? x.get(key) : x[key];\n}","export default (function (array) {\n  return array[array.length - 1];\n});","import ownKeys from './ownKeys';\nexport default function hasGeneratorInterface(handler) {\n  var keys = ownKeys(handler);\n  var hasOnlyInterfaceNames = keys.every(function (ownKey) {\n    return ownKey === 'next' || ownKey === 'throw';\n  });\n  return keys.length && keys.length <= 2 && hasOnlyInterfaceNames;\n}","export default (function (value) {\n  return value;\n});","export default (function (value) {\n  return Array.isArray(value);\n});","export default (function (value) {\n  return value.length === 0;\n});","export default (function (value) {\n  return typeof value === 'function';\n});","export default (function (value) {\n  return typeof Map !== 'undefined' && value instanceof Map;\n});","export default (function (value) {\n  return value === null || value === undefined;\n});","export default (function (value) {\n  return value === null;\n});","export default (function (value) {\n  if (typeof value !== 'object' || value === null) return false;\n  var proto = value;\n\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(value) === proto;\n});","export default (function (value) {\n  return typeof value === 'string';\n});","export default (function (value) {\n  return typeof value === 'symbol' || typeof value === 'object' && Object.prototype.toString.call(value) === '[object Symbol]';\n});","export default (function (value) {\n  return value === undefined;\n});","import isMap from './isMap';\nexport default function ownKeys(object) {\n  if (isMap(object)) {\n    // We are using loose transforms in babel. Here we are trying to convert an\n    // interable to an array. Loose mode expects everything to already be an\n    // array. The problem is that our eslint rules encourage us to prefer\n    // spread over Array.from.\n    //\n    // Instead of disabling loose mode we simply disable the warning.\n    // eslint-disable-next-line unicorn/prefer-spread\n    return Array.from(object.keys());\n  }\n\n  if (typeof Reflect !== 'undefined' && typeof Reflect.ownKeys === 'function') {\n    return Reflect.ownKeys(object);\n  }\n\n  var keys = Object.getOwnPropertyNames(object);\n\n  if (typeof Object.getOwnPropertySymbols === 'function') {\n    keys = keys.concat(Object.getOwnPropertySymbols(object));\n  }\n\n  return keys;\n}","export default (function (value) {\n  return value.toString();\n});","import { DEFAULT_NAMESPACE } from '../constants';\nimport isEmpty from './isEmpty';\nimport camelCase from './camelCase';\nexport default function unflattenActionCreators(flatActionCreators, _temp) {\n  var _ref = _temp === void 0 ? {} : _temp,\n      _ref$namespace = _ref.namespace,\n      namespace = _ref$namespace === void 0 ? DEFAULT_NAMESPACE : _ref$namespace,\n      prefix = _ref.prefix;\n\n  function unflatten(flatActionType, partialNestedActionCreators, partialFlatActionTypePath) {\n    var nextNamespace = camelCase(partialFlatActionTypePath.shift());\n\n    if (isEmpty(partialFlatActionTypePath)) {\n      partialNestedActionCreators[nextNamespace] = flatActionCreators[flatActionType];\n    } else {\n      if (!partialNestedActionCreators[nextNamespace]) {\n        partialNestedActionCreators[nextNamespace] = {};\n      }\n\n      unflatten(flatActionType, partialNestedActionCreators[nextNamespace], partialFlatActionTypePath);\n    }\n  }\n\n  var nestedActionCreators = {};\n  Object.getOwnPropertyNames(flatActionCreators).forEach(function (type) {\n    var unprefixedType = prefix ? type.replace(\"\" + prefix + namespace, '') : type;\n    return unflatten(type, nestedActionCreators, unprefixedType.split(namespace));\n  });\n  return nestedActionCreators;\n}","\"use strict\";\n\nvar compose = require('redux').compose;\n\nexports.__esModule = true;\nexports.composeWithDevTools = (\n  typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ ?\n    window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ :\n    function() {\n      if (arguments.length === 0) return undefined;\n      if (typeof arguments[0] === 'object') return compose;\n      return compose.apply(null, arguments);\n    }\n);\n\nexports.devToolsEnhancer = (\n  typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION__ ?\n    window.__REDUX_DEVTOOLS_EXTENSION__ :\n    function() { return function(noop) { return noop; } }\n);\n","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?t(exports):\"function\"==typeof define&&define.amd?define([\"exports\"],t):t(e.reduxLogger=e.reduxLogger||{})}(this,function(e){\"use strict\";function t(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function r(e,t){Object.defineProperty(this,\"kind\",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,\"path\",{value:t,enumerable:!0})}function n(e,t,r){n.super_.call(this,\"E\",e),Object.defineProperty(this,\"lhs\",{value:t,enumerable:!0}),Object.defineProperty(this,\"rhs\",{value:r,enumerable:!0})}function o(e,t){o.super_.call(this,\"N\",e),Object.defineProperty(this,\"rhs\",{value:t,enumerable:!0})}function i(e,t){i.super_.call(this,\"D\",e),Object.defineProperty(this,\"lhs\",{value:t,enumerable:!0})}function a(e,t,r){a.super_.call(this,\"A\",e),Object.defineProperty(this,\"index\",{value:t,enumerable:!0}),Object.defineProperty(this,\"item\",{value:r,enumerable:!0})}function f(e,t,r){var n=e.slice((r||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,n),e}function u(e){var t=\"undefined\"==typeof e?\"undefined\":N(e);return\"object\"!==t?t:e===Math?\"math\":null===e?\"null\":Array.isArray(e)?\"array\":\"[object Date]\"===Object.prototype.toString.call(e)?\"date\":\"function\"==typeof e.toString&&/^\\/.*\\//.test(e.toString())?\"regexp\":\"object\"}function l(e,t,r,c,s,d,p){s=s||[],p=p||[];var g=s.slice(0);if(\"undefined\"!=typeof d){if(c){if(\"function\"==typeof c&&c(g,d))return;if(\"object\"===(\"undefined\"==typeof c?\"undefined\":N(c))){if(c.prefilter&&c.prefilter(g,d))return;if(c.normalize){var h=c.normalize(g,d,e,t);h&&(e=h[0],t=h[1])}}}g.push(d)}\"regexp\"===u(e)&&\"regexp\"===u(t)&&(e=e.toString(),t=t.toString());var y=\"undefined\"==typeof e?\"undefined\":N(e),v=\"undefined\"==typeof t?\"undefined\":N(t),b=\"undefined\"!==y||p&&p[p.length-1].lhs&&p[p.length-1].lhs.hasOwnProperty(d),m=\"undefined\"!==v||p&&p[p.length-1].rhs&&p[p.length-1].rhs.hasOwnProperty(d);if(!b&&m)r(new o(g,t));else if(!m&&b)r(new i(g,e));else if(u(e)!==u(t))r(new n(g,e,t));else if(\"date\"===u(e)&&e-t!==0)r(new n(g,e,t));else if(\"object\"===y&&null!==e&&null!==t)if(p.filter(function(t){return t.lhs===e}).length)e!==t&&r(new n(g,e,t));else{if(p.push({lhs:e,rhs:t}),Array.isArray(e)){var w;e.length;for(w=0;w<e.length;w++)w>=t.length?r(new a(g,w,new i(void 0,e[w]))):l(e[w],t[w],r,c,g,w,p);for(;w<t.length;)r(new a(g,w,new o(void 0,t[w++])))}else{var x=Object.keys(e),S=Object.keys(t);x.forEach(function(n,o){var i=S.indexOf(n);i>=0?(l(e[n],t[n],r,c,g,n,p),S=f(S,i)):l(e[n],void 0,r,c,g,n,p)}),S.forEach(function(e){l(void 0,t[e],r,c,g,e,p)})}p.length=p.length-1}else e!==t&&(\"number\"===y&&isNaN(e)&&isNaN(t)||r(new n(g,e,t)))}function c(e,t,r,n){return n=n||[],l(e,t,function(e){e&&n.push(e)},r),n.length?n:void 0}function s(e,t,r){if(r.path&&r.path.length){var n,o=e[t],i=r.path.length-1;for(n=0;n<i;n++)o=o[r.path[n]];switch(r.kind){case\"A\":s(o[r.path[n]],r.index,r.item);break;case\"D\":delete o[r.path[n]];break;case\"E\":case\"N\":o[r.path[n]]=r.rhs}}else switch(r.kind){case\"A\":s(e[t],r.index,r.item);break;case\"D\":e=f(e,t);break;case\"E\":case\"N\":e[t]=r.rhs}return e}function d(e,t,r){if(e&&t&&r&&r.kind){for(var n=e,o=-1,i=r.path?r.path.length-1:0;++o<i;)\"undefined\"==typeof n[r.path[o]]&&(n[r.path[o]]=\"number\"==typeof r.path[o]?[]:{}),n=n[r.path[o]];switch(r.kind){case\"A\":s(r.path?n[r.path[o]]:n,r.index,r.item);break;case\"D\":delete n[r.path[o]];break;case\"E\":case\"N\":n[r.path[o]]=r.rhs}}}function p(e,t,r){if(r.path&&r.path.length){var n,o=e[t],i=r.path.length-1;for(n=0;n<i;n++)o=o[r.path[n]];switch(r.kind){case\"A\":p(o[r.path[n]],r.index,r.item);break;case\"D\":o[r.path[n]]=r.lhs;break;case\"E\":o[r.path[n]]=r.lhs;break;case\"N\":delete o[r.path[n]]}}else switch(r.kind){case\"A\":p(e[t],r.index,r.item);break;case\"D\":e[t]=r.lhs;break;case\"E\":e[t]=r.lhs;break;case\"N\":e=f(e,t)}return e}function g(e,t,r){if(e&&t&&r&&r.kind){var n,o,i=e;for(o=r.path.length-1,n=0;n<o;n++)\"undefined\"==typeof i[r.path[n]]&&(i[r.path[n]]={}),i=i[r.path[n]];switch(r.kind){case\"A\":p(i[r.path[n]],r.index,r.item);break;case\"D\":i[r.path[n]]=r.lhs;break;case\"E\":i[r.path[n]]=r.lhs;break;case\"N\":delete i[r.path[n]]}}}function h(e,t,r){if(e&&t){var n=function(n){r&&!r(e,t,n)||d(e,t,n)};l(e,t,n)}}function y(e){return\"color: \"+F[e].color+\"; font-weight: bold\"}function v(e){var t=e.kind,r=e.path,n=e.lhs,o=e.rhs,i=e.index,a=e.item;switch(t){case\"E\":return[r.join(\".\"),n,\"\",o];case\"N\":return[r.join(\".\"),o];case\"D\":return[r.join(\".\")];case\"A\":return[r.join(\".\")+\"[\"+i+\"]\",a];default:return[]}}function b(e,t,r,n){var o=c(e,t);try{n?r.groupCollapsed(\"diff\"):r.group(\"diff\")}catch(e){r.log(\"diff\")}o?o.forEach(function(e){var t=e.kind,n=v(e);r.log.apply(r,[\"%c \"+F[t].text,y(t)].concat(P(n)))}):r.log(\" no diff \");try{r.groupEnd()}catch(e){r.log(\" diff end  \")}}function m(e,t,r,n){switch(\"undefined\"==typeof e?\"undefined\":N(e)){case\"object\":return\"function\"==typeof e[n]?e[n].apply(e,P(r)):e[n];case\"function\":return e(t);default:return e}}function w(e){var t=e.timestamp,r=e.duration;return function(e,n,o){var i=[\"action\"];return i.push(\"%c\"+String(e.type)),t&&i.push(\"%c@ \"+n),r&&i.push(\"%c(in \"+o.toFixed(2)+\" ms)\"),i.join(\" \")}}function x(e,t){var r=t.logger,n=t.actionTransformer,o=t.titleFormatter,i=void 0===o?w(t):o,a=t.collapsed,f=t.colors,u=t.level,l=t.diff,c=\"undefined\"==typeof t.titleFormatter;e.forEach(function(o,s){var d=o.started,p=o.startedTime,g=o.action,h=o.prevState,y=o.error,v=o.took,w=o.nextState,x=e[s+1];x&&(w=x.prevState,v=x.started-d);var S=n(g),k=\"function\"==typeof a?a(function(){return w},g,o):a,j=D(p),E=f.title?\"color: \"+f.title(S)+\";\":\"\",A=[\"color: gray; font-weight: lighter;\"];A.push(E),t.timestamp&&A.push(\"color: gray; font-weight: lighter;\"),t.duration&&A.push(\"color: gray; font-weight: lighter;\");var O=i(S,j,v);try{k?f.title&&c?r.groupCollapsed.apply(r,[\"%c \"+O].concat(A)):r.groupCollapsed(O):f.title&&c?r.group.apply(r,[\"%c \"+O].concat(A)):r.group(O)}catch(e){r.log(O)}var N=m(u,S,[h],\"prevState\"),P=m(u,S,[S],\"action\"),C=m(u,S,[y,h],\"error\"),F=m(u,S,[w],\"nextState\");if(N)if(f.prevState){var L=\"color: \"+f.prevState(h)+\"; font-weight: bold\";r[N](\"%c prev state\",L,h)}else r[N](\"prev state\",h);if(P)if(f.action){var T=\"color: \"+f.action(S)+\"; font-weight: bold\";r[P](\"%c action    \",T,S)}else r[P](\"action    \",S);if(y&&C)if(f.error){var M=\"color: \"+f.error(y,h)+\"; font-weight: bold;\";r[C](\"%c error     \",M,y)}else r[C](\"error     \",y);if(F)if(f.nextState){var _=\"color: \"+f.nextState(w)+\"; font-weight: bold\";r[F](\"%c next state\",_,w)}else r[F](\"next state\",w);l&&b(h,w,r,k);try{r.groupEnd()}catch(e){r.log(\" log end \")}})}function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},L,e),r=t.logger,n=t.stateTransformer,o=t.errorTransformer,i=t.predicate,a=t.logErrors,f=t.diffPredicate;if(\"undefined\"==typeof r)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return console.error(\"[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\\n// Logger with default options\\nimport { logger } from 'redux-logger'\\nconst store = createStore(\\n  reducer,\\n  applyMiddleware(logger)\\n)\\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\\nimport createLogger from 'redux-logger'\\nconst logger = createLogger({\\n  // ...options\\n});\\nconst store = createStore(\\n  reducer,\\n  applyMiddleware(logger)\\n)\\n\"),function(){return function(e){return function(t){return e(t)}}};var u=[];return function(e){var r=e.getState;return function(e){return function(l){if(\"function\"==typeof i&&!i(r,l))return e(l);var c={};u.push(c),c.started=O.now(),c.startedTime=new Date,c.prevState=n(r()),c.action=l;var s=void 0;if(a)try{s=e(l)}catch(e){c.error=o(e)}else s=e(l);c.took=O.now()-c.started,c.nextState=n(r());var d=t.diff&&\"function\"==typeof f?f(r,l):t.diff;if(x(u,Object.assign({},t,{diff:d})),u.length=0,c.error)throw c.error;return s}}}}var k,j,E=function(e,t){return new Array(t+1).join(e)},A=function(e,t){return E(\"0\",t-e.toString().length)+e},D=function(e){return A(e.getHours(),2)+\":\"+A(e.getMinutes(),2)+\":\"+A(e.getSeconds(),2)+\".\"+A(e.getMilliseconds(),3)},O=\"undefined\"!=typeof performance&&null!==performance&&\"function\"==typeof performance.now?performance:Date,N=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},P=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},C=[];k=\"object\"===(\"undefined\"==typeof global?\"undefined\":N(global))&&global?global:\"undefined\"!=typeof window?window:{},j=k.DeepDiff,j&&C.push(function(){\"undefined\"!=typeof j&&k.DeepDiff===c&&(k.DeepDiff=j,j=void 0)}),t(n,r),t(o,r),t(i,r),t(a,r),Object.defineProperties(c,{diff:{value:c,enumerable:!0},observableDiff:{value:l,enumerable:!0},applyDiff:{value:h,enumerable:!0},applyChange:{value:d,enumerable:!0},revertChange:{value:g,enumerable:!0},isConflict:{value:function(){return\"undefined\"!=typeof j},enumerable:!0},noConflict:{value:function(){return C&&(C.forEach(function(e){e()}),C=null),c},enumerable:!0}});var F={E:{color:\"#2196F3\",text:\"CHANGED:\"},N:{color:\"#4CAF50\",text:\"ADDED:\"},D:{color:\"#F44336\",text:\"DELETED:\"},A:{color:\"#2196F3\",text:\"ARRAY:\"}},L={level:\"log\",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return\"inherit\"},prevState:function(){return\"#9E9E9E\"},action:function(){return\"#03A9F4\"},nextState:function(){return\"#4CAF50\"},error:function(){return\"#F20404\"}},diff:!1,diffPredicate:void 0,transformer:void 0},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,r=e.getState;return\"function\"==typeof t||\"function\"==typeof r?S()({dispatch:t,getState:r}):void console.error(\"\\n[redux-logger v3] BREAKING CHANGE\\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\\n[redux-logger v3] Change\\n[redux-logger v3] import createLogger from 'redux-logger'\\n[redux-logger v3] to\\n[redux-logger v3] import { createLogger } from 'redux-logger'\\n\")};e.defaults=L,e.createLogger=S,e.logger=T,e.default=T,Object.defineProperty(e,\"__esModule\",{value:!0})});\n","export { take, takeMaybe, put, putResolve, all, race, call, apply, cps, fork, spawn, join, cancel, select, actionChannel, cancelled, flush, getContext, setContext, takeEvery, takeLatest, takeLeading, throttle, delay } from './internal/io';","import middleware from './internal/middleware';\nexport default middleware;\nexport { runSaga } from './internal/runSaga';\nexport { END, eventChannel, channel, multicastChannel, stdChannel } from './internal/channel';\nexport { CANCEL, SAGA_LOCATION } from './internal/symbols';\nexport { detach } from './internal/io';\nimport * as effects from './effects';\nimport * as utils from './utils';\nimport * as buffers from './internal/buffers';\nexport { effects, utils, buffers };","import { kTrue, noop } from './utils';\nvar BUFFER_OVERFLOW = \"Channel's Buffer overflow!\";\nvar ON_OVERFLOW_THROW = 1;\nvar ON_OVERFLOW_DROP = 2;\nvar ON_OVERFLOW_SLIDE = 3;\nvar ON_OVERFLOW_EXPAND = 4;\nvar zeroBuffer = {\n  isEmpty: kTrue,\n  put: noop,\n  take: noop\n};\n\nfunction ringBuffer(limit, overflowAction) {\n  if (limit === void 0) {\n    limit = 10;\n  }\n\n  var arr = new Array(limit);\n  var length = 0;\n  var pushIndex = 0;\n  var popIndex = 0;\n\n  var push = function push(it) {\n    arr[pushIndex] = it;\n    pushIndex = (pushIndex + 1) % limit;\n    length++;\n  };\n\n  var take = function take() {\n    if (length != 0) {\n      var it = arr[popIndex];\n      arr[popIndex] = null;\n      length--;\n      popIndex = (popIndex + 1) % limit;\n      return it;\n    }\n  };\n\n  var flush = function flush() {\n    var items = [];\n\n    while (length) {\n      items.push(take());\n    }\n\n    return items;\n  };\n\n  return {\n    isEmpty: function isEmpty() {\n      return length == 0;\n    },\n    put: function put(it) {\n      if (length < limit) {\n        push(it);\n      } else {\n        var doubledLimit;\n\n        switch (overflowAction) {\n          case ON_OVERFLOW_THROW:\n            throw new Error(BUFFER_OVERFLOW);\n\n          case ON_OVERFLOW_SLIDE:\n            arr[pushIndex] = it;\n            pushIndex = (pushIndex + 1) % limit;\n            popIndex = pushIndex;\n            break;\n\n          case ON_OVERFLOW_EXPAND:\n            doubledLimit = 2 * limit;\n            arr = flush();\n            length = arr.length;\n            pushIndex = arr.length;\n            popIndex = 0;\n            arr.length = doubledLimit;\n            limit = doubledLimit;\n            push(it);\n            break;\n\n          default: // DROP\n\n        }\n      }\n    },\n    take: take,\n    flush: flush\n  };\n}\n\nexport var none = function none() {\n  return zeroBuffer;\n};\nexport var fixed = function fixed(limit) {\n  return ringBuffer(limit, ON_OVERFLOW_THROW);\n};\nexport var dropping = function dropping(limit) {\n  return ringBuffer(limit, ON_OVERFLOW_DROP);\n};\nexport var sliding = function sliding(limit) {\n  return ringBuffer(limit, ON_OVERFLOW_SLIDE);\n};\nexport var expanding = function expanding(initialSize) {\n  return ringBuffer(initialSize, ON_OVERFLOW_EXPAND);\n};","import { CHANNEL_END_TYPE, MATCH, MULTICAST, SAGA_ACTION } from './symbols';\nimport { is, check, remove, once, internalErr } from './utils';\nimport * as buffers from './buffers';\nimport { asap } from './scheduler';\nimport * as matchers from './matcher';\nexport var END = {\n  type: CHANNEL_END_TYPE\n};\nexport var isEnd = function isEnd(a) {\n  return a && a.type === CHANNEL_END_TYPE;\n};\nvar INVALID_BUFFER = 'invalid buffer passed to channel factory function';\nvar UNDEFINED_INPUT_ERROR = \"Saga or channel was provided with an undefined action\\nHints:\\n  - check that your Action Creator returns a non-undefined value\\n  - if the Saga was started using runSaga, check that your subscribe source provides the action to its listeners\";\nexport function channel(buffer) {\n  if (buffer === void 0) {\n    buffer = buffers.expanding();\n  }\n\n  var closed = false;\n  var takers = [];\n\n  if (process.env.NODE_ENV === 'development') {\n    check(buffer, is.buffer, INVALID_BUFFER);\n  }\n\n  function checkForbiddenStates() {\n    if (closed && takers.length) {\n      throw internalErr('Cannot have a closed channel with pending takers');\n    }\n\n    if (takers.length && !buffer.isEmpty()) {\n      throw internalErr('Cannot have pending takers with non empty buffer');\n    }\n  }\n\n  function put(input) {\n    checkForbiddenStates();\n\n    if (process.env.NODE_ENV === 'development') {\n      check(input, is.notUndef, UNDEFINED_INPUT_ERROR);\n    }\n\n    if (closed) {\n      return;\n    }\n\n    if (!takers.length) {\n      return buffer.put(input);\n    }\n\n    var cb = takers[0];\n    takers.splice(0, 1);\n    cb(input);\n  }\n\n  function take(cb) {\n    checkForbiddenStates();\n\n    if (process.env.NODE_ENV === 'development') {\n      check(cb, is.func, \"channel.take's callback must be a function\");\n    }\n\n    if (closed && buffer.isEmpty()) {\n      cb(END);\n    } else if (!buffer.isEmpty()) {\n      cb(buffer.take());\n    } else {\n      takers.push(cb);\n\n      cb.cancel = function () {\n        return remove(takers, cb);\n      };\n    }\n  }\n\n  function flush(cb) {\n    checkForbiddenStates(); // TODO: check if some new state should be forbidden now\n\n    if (process.env.NODE_ENV === 'development') {\n      check(cb, is.func, \"channel.flush' callback must be a function\");\n    }\n\n    if (closed && buffer.isEmpty()) {\n      cb(END);\n      return;\n    }\n\n    cb(buffer.flush());\n  }\n\n  function close() {\n    checkForbiddenStates();\n\n    if (!closed) {\n      closed = true;\n\n      if (takers.length) {\n        var arr = takers;\n        takers = [];\n\n        for (var i = 0, len = arr.length; i < len; i++) {\n          var taker = arr[i];\n          taker(END);\n        }\n      }\n    }\n  }\n\n  return {\n    take: take,\n    put: put,\n    flush: flush,\n    close: close\n  };\n}\nexport function eventChannel(subscribe, buffer) {\n  if (buffer === void 0) {\n    buffer = buffers.none();\n  }\n\n  var closed = false;\n  var unsubscribe;\n  var chan = channel(buffer);\n\n  var close = function close() {\n    if (is.func(unsubscribe)) {\n      unsubscribe();\n    }\n\n    chan.close();\n  };\n\n  unsubscribe = subscribe(function (input) {\n    if (isEnd(input)) {\n      close();\n      closed = true;\n      return;\n    }\n\n    chan.put(input);\n  });\n\n  if (!is.func(unsubscribe)) {\n    throw new Error('in eventChannel: subscribe should return a function to unsubscribe');\n  }\n\n  unsubscribe = once(unsubscribe);\n\n  if (closed) {\n    unsubscribe();\n  }\n\n  return {\n    take: chan.take,\n    flush: chan.flush,\n    close: close\n  };\n}\nexport function multicastChannel() {\n  var _ref;\n\n  var closed = false;\n  var currentTakers = [];\n  var nextTakers = currentTakers;\n\n  var ensureCanMutateNextTakers = function ensureCanMutateNextTakers() {\n    if (nextTakers !== currentTakers) {\n      return;\n    }\n\n    nextTakers = currentTakers.slice();\n  }; // TODO: check if its possible to extract closing function and reuse it in both unicasts and multicasts\n\n\n  var close = function close() {\n    closed = true;\n    var takers = currentTakers = nextTakers;\n\n    for (var i = 0; i < takers.length; i++) {\n      var taker = takers[i];\n      taker(END);\n    }\n\n    nextTakers = [];\n  };\n\n  return _ref = {}, _ref[MULTICAST] = true, _ref.put = function put(input) {\n    // TODO: should I check forbidden state here? 1 of them is even impossible\n    // as we do not possibility of buffer here\n    if (process.env.NODE_ENV === 'development') {\n      check(input, is.notUndef, UNDEFINED_INPUT_ERROR);\n    }\n\n    if (closed) {\n      return;\n    }\n\n    if (isEnd(input)) {\n      close();\n      return;\n    }\n\n    var takers = currentTakers = nextTakers;\n\n    for (var i = 0; i < takers.length; i++) {\n      var taker = takers[i];\n\n      if (taker[MATCH](input)) {\n        taker.cancel();\n        taker(input);\n      }\n    }\n  }, _ref.take = function take(cb, matcher) {\n    if (matcher === void 0) {\n      matcher = matchers.wildcard;\n    }\n\n    if (closed) {\n      cb(END);\n      return;\n    }\n\n    cb[MATCH] = matcher;\n    ensureCanMutateNextTakers();\n    nextTakers.push(cb);\n    cb.cancel = once(function () {\n      ensureCanMutateNextTakers();\n      remove(nextTakers, cb);\n    });\n  }, _ref.close = close, _ref;\n}\nexport function stdChannel() {\n  var chan = multicastChannel();\n  var put = chan.put;\n\n  chan.put = function (input) {\n    if (input[SAGA_ACTION]) {\n      put(input);\n      return;\n    }\n\n    asap(function () {\n      return put(input);\n    });\n  };\n\n  return chan;\n}","import { SAGA_LOCATION } from './symbols';\n\nfunction formatLocation(fileName, lineNumber) {\n  return fileName + \"?\" + lineNumber;\n}\n\nexport function getLocation(instrumented) {\n  return instrumented[SAGA_LOCATION];\n}\n\nfunction effectLocationAsString(effect) {\n  var location = getLocation(effect);\n\n  if (location) {\n    var code = location.code,\n        fileName = location.fileName,\n        lineNumber = location.lineNumber;\n    var source = code + \"  \" + formatLocation(fileName, lineNumber);\n    return source;\n  }\n\n  return '';\n}\n\nfunction sagaLocationAsString(sagaMeta) {\n  var name = sagaMeta.name,\n      location = sagaMeta.location;\n\n  if (location) {\n    return name + \"  \" + formatLocation(location.fileName, location.lineNumber);\n  }\n\n  return name;\n}\n\nvar flatMap = function flatMap(arr, getter) {\n  if (getter === void 0) {\n    getter = function getter(f) {\n      return f;\n    };\n  }\n\n  return arr.reduce(function (acc, i) {\n    return acc.concat(getter(i));\n  }, []);\n};\n\nfunction cancelledTasksAsString(sagaStack) {\n  var cancelledTasks = flatMap(sagaStack, function (i) {\n    return i.cancelledTasks;\n  });\n\n  if (!cancelledTasks.length) {\n    return '';\n  }\n\n  return ['Tasks cancelled due to error:'].concat(cancelledTasks).join('\\n');\n}\n/**\n    @param {saga, effect}[] sagaStack\n    @returns {string}\n\n    @example\n    The above error occurred in task errorInPutSaga {pathToFile}\n    when executing effect put({type: 'REDUCER_ACTION_ERROR_IN_PUT'}) {pathToFile}\n        created by fetchSaga {pathToFile}\n        created by rootSaga {pathToFile}\n*/\n\n\nexport function sagaStackToString(sagaStack) {\n  var firstSaga = sagaStack[0],\n      otherSagas = sagaStack.slice(1);\n  var crashedEffectLocation = firstSaga.effect ? effectLocationAsString(firstSaga.effect) : null;\n  var errorMessage = \"The above error occurred in task \" + sagaLocationAsString(firstSaga.meta) + (crashedEffectLocation ? \" \\n when executing effect \" + crashedEffectLocation : '');\n  return [errorMessage].concat(otherSagas.map(function (s) {\n    return \"    created by \" + sagaLocationAsString(s.meta);\n  }), [cancelledTasksAsString(sagaStack)]).join('\\n');\n}\nexport function addSagaStack(errorObject, errorStack) {\n  if (typeof errorObject === 'object') {\n    if (typeof errorObject.sagaStack === 'undefined') {\n      // property is used as a stack of descriptors for failed sagas\n      // after formatting to string it will be re-written\n      // to pass sagaStack as a string in user land\n      Object.defineProperty(errorObject, 'sagaStack', {\n        value: [],\n        writable: true,\n        enumerable: false\n      });\n    }\n\n    errorObject.sagaStack.push(errorStack);\n  }\n}","import { IO, SELF_CANCELLATION } from './symbols';\nimport { delay as delayUtil, is, identity, check, createSetContextWarning } from './utils';\nimport { takeEveryHelper, takeLatestHelper, takeLeadingHelper, throttleHelper } from './sagaHelpers';\nvar TAKE = 'TAKE';\nvar PUT = 'PUT';\nvar ALL = 'ALL';\nvar RACE = 'RACE';\nvar CALL = 'CALL';\nvar CPS = 'CPS';\nvar FORK = 'FORK';\nvar JOIN = 'JOIN';\nvar CANCEL = 'CANCEL';\nvar SELECT = 'SELECT';\nvar ACTION_CHANNEL = 'ACTION_CHANNEL';\nvar CANCELLED = 'CANCELLED';\nvar FLUSH = 'FLUSH';\nvar GET_CONTEXT = 'GET_CONTEXT';\nvar SET_CONTEXT = 'SET_CONTEXT';\nvar TEST_HINT = '\\n(HINT: if you are getting this errors in tests, consider using createMockTask from redux-saga/utils)';\n\nvar effect = function effect(type, payload) {\n  var _ref;\n\n  return _ref = {}, _ref[IO] = true, _ref[type] = payload, _ref;\n};\n\nexport var detach = function detach(eff) {\n  if (process.env.NODE_ENV === 'development') {\n    check(asEffect.fork(eff), is.object, 'detach(eff): argument must be a fork effect');\n  }\n\n  eff[FORK].detached = true;\n  return eff;\n};\nexport function take(patternOrChannel, multicastPattern) {\n  if (patternOrChannel === void 0) {\n    patternOrChannel = '*';\n  }\n\n  if (process.env.NODE_ENV === 'development' && arguments.length) {\n    check(arguments[0], is.notUndef, 'take(patternOrChannel): patternOrChannel is undefined');\n  }\n\n  if (is.pattern(patternOrChannel)) {\n    return effect(TAKE, {\n      pattern: patternOrChannel\n    });\n  }\n\n  if (is.multicast(patternOrChannel) && is.notUndef(multicastPattern) && is.pattern(multicastPattern)) {\n    return effect(TAKE, {\n      channel: patternOrChannel,\n      pattern: multicastPattern\n    });\n  }\n\n  if (is.channel(patternOrChannel)) {\n    return effect(TAKE, {\n      channel: patternOrChannel\n    });\n  }\n\n  throw new Error(\"take(patternOrChannel): argument \" + patternOrChannel + \" is not valid channel or a valid pattern\");\n}\n\nvar takeMaybe = function takeMaybe() {\n  var eff = take.apply(void 0, arguments);\n  eff[TAKE].maybe = true;\n  return eff;\n};\n\nexport { takeMaybe };\nexport function put(channel, action) {\n  if (process.env.NODE_ENV === 'development') {\n    if (arguments.length > 1) {\n      check(channel, is.notUndef, 'put(channel, action): argument channel is undefined');\n      check(channel, is.channel, \"put(channel, action): argument \" + channel + \" is not a valid channel\");\n      check(action, is.notUndef, 'put(channel, action): argument action is undefined');\n    } else {\n      check(channel, is.notUndef, 'put(action): argument action is undefined');\n    }\n  }\n\n  if (is.undef(action)) {\n    action = channel;\n    channel = null;\n  }\n\n  return effect(PUT, {\n    channel: channel,\n    action: action\n  });\n}\n\nvar putResolve = function putResolve() {\n  var eff = put.apply(void 0, arguments);\n  eff[PUT].resolve = true;\n  return eff;\n};\n\nexport { putResolve };\nexport function all(effects) {\n  return effect(ALL, effects);\n}\nexport function race(effects) {\n  return effect(RACE, effects);\n}\n\nfunction getFnCallDesc(meth, fn, args) {\n  if (process.env.NODE_ENV === 'development') {\n    check(fn, is.notUndef, meth + \": argument fn is undefined\");\n  }\n\n  var context = null;\n\n  if (is.array(fn)) {\n    var _fn = fn;\n    context = _fn[0];\n    fn = _fn[1];\n  } else if (fn.fn) {\n    var _fn2 = fn;\n    context = _fn2.context;\n    fn = _fn2.fn;\n  }\n\n  if (context && is.string(fn) && is.func(context[fn])) {\n    fn = context[fn];\n  }\n\n  if (process.env.NODE_ENV === 'development') {\n    check(fn, is.func, meth + \": argument \" + fn + \" is not a function\");\n  }\n\n  return {\n    context: context,\n    fn: fn,\n    args: args\n  };\n}\n\nexport function call(fn) {\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n\n  return effect(CALL, getFnCallDesc('call', fn, args));\n}\nexport function apply(context, fn, args) {\n  if (args === void 0) {\n    args = [];\n  }\n\n  return effect(CALL, getFnCallDesc('apply', {\n    context: context,\n    fn: fn\n  }, args));\n}\nexport function cps(fn) {\n  for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n    args[_key2 - 1] = arguments[_key2];\n  }\n\n  return effect(CPS, getFnCallDesc('cps', fn, args));\n}\nexport function fork(fn) {\n  for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n    args[_key3 - 1] = arguments[_key3];\n  }\n\n  return effect(FORK, getFnCallDesc('fork', fn, args));\n}\nexport function spawn(fn) {\n  for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n    args[_key4 - 1] = arguments[_key4];\n  }\n\n  return detach(fork.apply(void 0, [fn].concat(args)));\n}\nexport function join() {\n  for (var _len5 = arguments.length, tasks = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n    tasks[_key5] = arguments[_key5];\n  }\n\n  if (tasks.length > 1) {\n    return all(tasks.map(function (t) {\n      return join(t);\n    }));\n  }\n\n  var task = tasks[0];\n\n  if (process.env.NODE_ENV === 'development') {\n    check(task, is.notUndef, 'join(task): argument task is undefined');\n    check(task, is.task, \"join(task): argument \" + task + \" is not a valid Task object \" + TEST_HINT);\n  }\n\n  return effect(JOIN, task);\n}\nexport function cancel() {\n  for (var _len6 = arguments.length, tasks = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {\n    tasks[_key6] = arguments[_key6];\n  }\n\n  if (tasks.length > 1) {\n    return all(tasks.map(function (t) {\n      return cancel(t);\n    }));\n  }\n\n  var task = tasks[0];\n\n  if (process.env.NODE_ENV === 'development' && tasks.length === 1) {\n    check(task, is.notUndef, 'cancel(task): argument task is undefined');\n    check(task, is.task, \"cancel(task): argument \" + task + \" is not a valid Task object \" + TEST_HINT);\n  }\n\n  return effect(CANCEL, task || SELF_CANCELLATION);\n}\nexport function select(selector) {\n  if (selector === void 0) {\n    selector = identity;\n  }\n\n  for (var _len7 = arguments.length, args = new Array(_len7 > 1 ? _len7 - 1 : 0), _key7 = 1; _key7 < _len7; _key7++) {\n    args[_key7 - 1] = arguments[_key7];\n  }\n\n  if (process.env.NODE_ENV === 'development' && arguments.length) {\n    check(arguments[0], is.notUndef, 'select(selector, [...]): argument selector is undefined');\n    check(selector, is.func, \"select(selector, [...]): argument \" + selector + \" is not a function\");\n  }\n\n  return effect(SELECT, {\n    selector: selector,\n    args: args\n  });\n}\n/**\n  channel(pattern, [buffer])    => creates a proxy channel for store actions\n**/\n\nexport function actionChannel(pattern, buffer) {\n  if (process.env.NODE_ENV === 'development') {\n    check(pattern, is.notUndef, 'actionChannel(pattern,...): argument pattern is undefined');\n\n    if (arguments.length > 1) {\n      check(buffer, is.notUndef, 'actionChannel(pattern, buffer): argument buffer is undefined');\n      check(buffer, is.buffer, \"actionChannel(pattern, buffer): argument \" + buffer + \" is not a valid buffer\");\n    }\n  }\n\n  return effect(ACTION_CHANNEL, {\n    pattern: pattern,\n    buffer: buffer\n  });\n}\nexport function cancelled() {\n  return effect(CANCELLED, {});\n}\nexport function flush(channel) {\n  if (process.env.NODE_ENV === 'development') {\n    check(channel, is.channel, \"flush(channel): argument \" + channel + \" is not valid channel\");\n  }\n\n  return effect(FLUSH, channel);\n}\nexport function getContext(prop) {\n  if (process.env.NODE_ENV === 'development') {\n    check(prop, is.string, \"getContext(prop): argument \" + prop + \" is not a string\");\n  }\n\n  return effect(GET_CONTEXT, prop);\n}\nexport function setContext(props) {\n  if (process.env.NODE_ENV === 'development') {\n    check(props, is.object, createSetContextWarning(null, props));\n  }\n\n  return effect(SET_CONTEXT, props);\n}\nexport function takeEvery(patternOrChannel, worker) {\n  for (var _len8 = arguments.length, args = new Array(_len8 > 2 ? _len8 - 2 : 0), _key8 = 2; _key8 < _len8; _key8++) {\n    args[_key8 - 2] = arguments[_key8];\n  }\n\n  return fork.apply(void 0, [takeEveryHelper, patternOrChannel, worker].concat(args));\n}\nexport function takeLatest(patternOrChannel, worker) {\n  for (var _len9 = arguments.length, args = new Array(_len9 > 2 ? _len9 - 2 : 0), _key9 = 2; _key9 < _len9; _key9++) {\n    args[_key9 - 2] = arguments[_key9];\n  }\n\n  return fork.apply(void 0, [takeLatestHelper, patternOrChannel, worker].concat(args));\n}\nexport function takeLeading(patternOrChannel, worker) {\n  for (var _len10 = arguments.length, args = new Array(_len10 > 2 ? _len10 - 2 : 0), _key10 = 2; _key10 < _len10; _key10++) {\n    args[_key10 - 2] = arguments[_key10];\n  }\n\n  return fork.apply(void 0, [takeLeadingHelper, patternOrChannel, worker].concat(args));\n}\nexport function throttle(ms, pattern, worker) {\n  for (var _len11 = arguments.length, args = new Array(_len11 > 3 ? _len11 - 3 : 0), _key11 = 3; _key11 < _len11; _key11++) {\n    args[_key11 - 3] = arguments[_key11];\n  }\n\n  return fork.apply(void 0, [throttleHelper, ms, pattern, worker].concat(args));\n}\nexport var delay =\n/*#__PURE__*/\ncall.bind(null, delayUtil);\n\nvar createAsEffectType = function createAsEffectType(type) {\n  return function (effect) {\n    return effect && effect[IO] && effect[type];\n  };\n};\n\nexport var asEffect = {\n  take:\n  /*#__PURE__*/\n  createAsEffectType(TAKE),\n  put:\n  /*#__PURE__*/\n  createAsEffectType(PUT),\n  all:\n  /*#__PURE__*/\n  createAsEffectType(ALL),\n  race:\n  /*#__PURE__*/\n  createAsEffectType(RACE),\n  call:\n  /*#__PURE__*/\n  createAsEffectType(CALL),\n  cps:\n  /*#__PURE__*/\n  createAsEffectType(CPS),\n  fork:\n  /*#__PURE__*/\n  createAsEffectType(FORK),\n  join:\n  /*#__PURE__*/\n  createAsEffectType(JOIN),\n  cancel:\n  /*#__PURE__*/\n  createAsEffectType(CANCEL),\n  select:\n  /*#__PURE__*/\n  createAsEffectType(SELECT),\n  actionChannel:\n  /*#__PURE__*/\n  createAsEffectType(ACTION_CHANNEL),\n  cancelled:\n  /*#__PURE__*/\n  createAsEffectType(CANCELLED),\n  flush:\n  /*#__PURE__*/\n  createAsEffectType(FLUSH),\n  getContext:\n  /*#__PURE__*/\n  createAsEffectType(GET_CONTEXT),\n  setContext:\n  /*#__PURE__*/\n  createAsEffectType(SET_CONTEXT)\n};","import { is, kTrue } from './utils';\nexport var array = function array(patterns) {\n  return function (input) {\n    return patterns.some(function (p) {\n      return matcher(p)(input);\n    });\n  };\n};\nexport var predicate = function predicate(_predicate) {\n  return function (input) {\n    return _predicate(input);\n  };\n};\nexport var string = function string(pattern) {\n  return function (input) {\n    return input.type === String(pattern);\n  };\n};\nexport var symbol = function symbol(pattern) {\n  return function (input) {\n    return input.type === pattern;\n  };\n};\nexport var wildcard = function wildcard() {\n  return kTrue;\n};\nexport default function matcher(pattern) {\n  // prettier-ignore\n  var matcherCreator = pattern === '*' ? wildcard : is.string(pattern) ? string : is.array(pattern) ? array : is.stringableFunc(pattern) ? string : is.func(pattern) ? predicate : is.symbol(pattern) ? symbol : null;\n\n  if (matcherCreator === null) {\n    throw new Error(\"invalid pattern: \" + pattern);\n  }\n\n  return matcherCreator(pattern);\n}","function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nimport { is, check, object, createSetContextWarning } from './utils';\nimport { stdChannel } from './channel';\nimport { identity } from './utils';\nimport { runSaga } from './runSaga';\nexport default function sagaMiddlewareFactory(_ref) {\n  if (_ref === void 0) {\n    _ref = {};\n  }\n\n  var _ref2 = _ref,\n      _ref2$context = _ref2.context,\n      context = _ref2$context === void 0 ? {} : _ref2$context,\n      options = _objectWithoutProperties(_ref2, [\"context\"]);\n\n  var sagaMonitor = options.sagaMonitor,\n      logger = options.logger,\n      onError = options.onError,\n      effectMiddlewares = options.effectMiddlewares;\n\n  if (process.env.NODE_ENV === 'development') {\n    if (is.notUndef(logger)) {\n      check(logger, is.func, 'options.logger passed to the Saga middleware is not a function!');\n    }\n\n    if (is.notUndef(onError)) {\n      check(onError, is.func, 'options.onError passed to the Saga middleware is not a function!');\n    }\n\n    if (is.notUndef(options.emitter)) {\n      check(options.emitter, is.func, 'options.emitter passed to the Saga middleware is not a function!');\n    }\n  }\n\n  function sagaMiddleware(_ref3) {\n    var getState = _ref3.getState,\n        dispatch = _ref3.dispatch;\n    var channel = stdChannel();\n    channel.put = (options.emitter || identity)(channel.put);\n    sagaMiddleware.run = runSaga.bind(null, {\n      context: context,\n      channel: channel,\n      dispatch: dispatch,\n      getState: getState,\n      sagaMonitor: sagaMonitor,\n      logger: logger,\n      onError: onError,\n      effectMiddlewares: effectMiddlewares\n    });\n    return function (next) {\n      return function (action) {\n        if (sagaMonitor && sagaMonitor.actionDispatched) {\n          sagaMonitor.actionDispatched(action);\n        }\n\n        var result = next(action); // hit reducers\n\n        channel.put(action);\n        return result;\n      };\n    };\n  }\n\n  sagaMiddleware.run = function () {\n    throw new Error('Before running a Saga, you must mount the Saga middleware on the Store using applyMiddleware');\n  };\n\n  sagaMiddleware.setContext = function (props) {\n    if (process.env.NODE_ENV === 'development') {\n      check(props, is.object, createSetContextWarning('sagaMiddleware', props));\n    }\n\n    object.assign(context, props);\n  };\n\n  return sagaMiddleware;\n}","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { CANCEL, CHANNEL_END as CHANNEL_END_SYMBOL, TASK, TASK_CANCEL as TASK_CANCEL_SYMBOL, SELF_CANCELLATION } from './symbols';\nimport { noop, is, log as _log, check, deferred, uid as nextEffectId, array, remove, object, makeIterator, createSetContextWarning } from './utils';\nimport { getLocation, addSagaStack, sagaStackToString } from './error-utils';\nimport { asap, suspend, flush } from './scheduler';\nimport { asEffect } from './io';\nimport { channel, isEnd } from './channel';\nimport matcher from './matcher';\nexport function getMetaInfo(fn) {\n  return {\n    name: fn.name || 'anonymous',\n    location: getLocation(fn)\n  };\n}\n\nfunction getIteratorMetaInfo(iterator, fn) {\n  if (iterator.isSagaIterator) {\n    return {\n      name: iterator.meta.name\n    };\n  }\n\n  return getMetaInfo(fn);\n} // TODO: check if this hacky toString stuff is needed\n// also check again whats the difference between CHANNEL_END and CHANNEL_END_TYPE\n// maybe this could become MAYBE_END\n// I guess this gets exported so takeMaybe result can be checked\n\n\nexport var CHANNEL_END = {\n  toString: function toString() {\n    return CHANNEL_END_SYMBOL;\n  }\n};\nexport var TASK_CANCEL = {\n  toString: function toString() {\n    return TASK_CANCEL_SYMBOL;\n  }\n};\n/**\n  Used to track a parent task and its forks\n  In the new fork model, forked tasks are attached by default to their parent\n  We model this using the concept of Parent task && main Task\n  main task is the main flow of the current Generator, the parent tasks is the\n  aggregation of the main tasks + all its forked tasks.\n  Thus the whole model represents an execution tree with multiple branches (vs the\n  linear execution tree in sequential (non parallel) programming)\n\n  A parent tasks has the following semantics\n  - It completes if all its forks either complete or all cancelled\n  - If it's cancelled, all forks are cancelled as well\n  - It aborts if any uncaught error bubbles up from forks\n  - If it completes, the return value is the one returned by the main task\n**/\n\nfunction forkQueue(mainTask, onAbort, cb) {\n  var tasks = [],\n      result,\n      completed = false;\n  addTask(mainTask);\n\n  var getTasks = function getTasks() {\n    return tasks;\n  };\n\n  var getTaskNames = function getTaskNames() {\n    return tasks.map(function (t) {\n      return t.meta.name;\n    });\n  };\n\n  function abort(err) {\n    onAbort();\n    cancelAll();\n    cb(err, true);\n  }\n\n  function addTask(task) {\n    tasks.push(task);\n\n    task.cont = function (res, isErr) {\n      if (completed) {\n        return;\n      }\n\n      remove(tasks, task);\n      task.cont = noop;\n\n      if (isErr) {\n        abort(res);\n      } else {\n        if (task === mainTask) {\n          result = res;\n        }\n\n        if (!tasks.length) {\n          completed = true;\n          cb(result);\n        }\n      }\n    }; // task.cont.cancel = task.cancel\n\n  }\n\n  function cancelAll() {\n    if (completed) {\n      return;\n    }\n\n    completed = true;\n    tasks.forEach(function (t) {\n      t.cont = noop;\n      t.cancel();\n    });\n    tasks = [];\n  }\n\n  return {\n    addTask: addTask,\n    cancelAll: cancelAll,\n    abort: abort,\n    getTasks: getTasks,\n    getTaskNames: getTaskNames\n  };\n}\n\nfunction createTaskIterator(_ref) {\n  var context = _ref.context,\n      fn = _ref.fn,\n      args = _ref.args;\n\n  if (is.iterator(fn)) {\n    return fn;\n  } // catch synchronous failures; see #152 and #441\n\n\n  var result, error;\n\n  try {\n    result = fn.apply(context, args);\n  } catch (err) {\n    error = err;\n  } // i.e. a generator function returns an iterator\n\n\n  if (is.iterator(result)) {\n    return result;\n  } // do not bubble up synchronous failures for detached forks\n  // instead create a failed task. See #152 and #441\n\n\n  return error ? makeIterator(function () {\n    throw error;\n  }) : makeIterator(function () {\n    var pc;\n    var eff = {\n      done: false,\n      value: result\n    };\n\n    var ret = function ret(value) {\n      return {\n        done: true,\n        value: value\n      };\n    };\n\n    return function (arg) {\n      if (!pc) {\n        pc = true;\n        return eff;\n      } else {\n        return ret(arg);\n      }\n    };\n  }());\n}\n\nexport default function proc(iterator, stdChannel, dispatch, getState, parentContext, options, parentEffectId, meta, cont) {\n  if (dispatch === void 0) {\n    dispatch = noop;\n  }\n\n  if (getState === void 0) {\n    getState = noop;\n  }\n\n  if (parentContext === void 0) {\n    parentContext = {};\n  }\n\n  if (options === void 0) {\n    options = {};\n  }\n\n  if (parentEffectId === void 0) {\n    parentEffectId = 0;\n  }\n\n  var _options = options,\n      sagaMonitor = _options.sagaMonitor,\n      logger = _options.logger,\n      onError = _options.onError,\n      middleware = _options.middleware;\n  var log = logger || _log;\n\n  var logError = function logError(err) {\n    log('error', err);\n\n    if (err.sagaStack) {\n      log('error', err.sagaStack);\n    }\n  };\n\n  var taskContext = Object.create(parentContext);\n  var crashedEffect = null;\n  var cancelledDueToErrorTasks = [];\n  /**\n    Tracks the current effect cancellation\n    Each time the generator progresses. calling runEffect will set a new value\n    on it. It allows propagating cancellation to child effects\n  **/\n\n  next.cancel = noop;\n  /**\n    Creates a new task descriptor for this generator, We'll also create a main task\n    to track the main flow (besides other forked tasks)\n  **/\n\n  var task = newTask(parentEffectId, meta, iterator, cont);\n  var mainTask = {\n    meta: meta,\n    cancel: cancelMain,\n    isRunning: true\n  };\n  var taskQueue = forkQueue(mainTask, function onAbort() {\n    cancelledDueToErrorTasks.push.apply(cancelledDueToErrorTasks, taskQueue.getTaskNames());\n  }, end);\n  /**\n    cancellation of the main task. We'll simply resume the Generator with a Cancel\n  **/\n\n  function cancelMain() {\n    if (mainTask.isRunning && !mainTask.isCancelled) {\n      mainTask.isCancelled = true;\n      next(TASK_CANCEL);\n    }\n  }\n  /**\n    This may be called by a parent generator to trigger/propagate cancellation\n    cancel all pending tasks (including the main task), then end the current task.\n     Cancellation propagates down to the whole execution tree holded by this Parent task\n    It's also propagated to all joiners of this task and their execution tree/joiners\n     Cancellation is noop for terminated/Cancelled tasks tasks\n  **/\n\n\n  function cancel() {\n    /**\n      We need to check both Running and Cancelled status\n      Tasks can be Cancelled but still Running\n    **/\n    if (iterator._isRunning && !iterator._isCancelled) {\n      iterator._isCancelled = true;\n      taskQueue.cancelAll();\n      /**\n        Ending with a Never result will propagate the Cancellation to all joiners\n      **/\n\n      end(TASK_CANCEL);\n    }\n  }\n  /**\n    attaches cancellation logic to this task's continuation\n    this will permit cancellation to propagate down the call chain\n  **/\n\n\n  cont && (cont.cancel = cancel); // tracks the running status\n\n  iterator._isRunning = true; // kicks up the generator\n\n  next(); // then return the task descriptor to the caller\n\n  return task;\n  /**\n    This is the generator driver\n    It's a recursive async/continuation function which calls itself\n    until the generator terminates or throws\n  **/\n\n  function next(arg, isErr) {\n    // Preventive measure. If we end up here, then there is really something wrong\n    if (!mainTask.isRunning) {\n      throw new Error('Trying to resume an already finished generator');\n    }\n\n    try {\n      var result;\n\n      if (isErr) {\n        result = iterator.throw(arg);\n      } else if (arg === TASK_CANCEL) {\n        /**\n          getting TASK_CANCEL automatically cancels the main task\n          We can get this value here\n           - By cancelling the parent task manually\n          - By joining a Cancelled task\n        **/\n        mainTask.isCancelled = true;\n        /**\n          Cancels the current effect; this will propagate the cancellation down to any called tasks\n        **/\n\n        next.cancel();\n        /**\n          If this Generator has a `return` method then invokes it\n          This will jump to the finally block\n        **/\n\n        result = is.func(iterator.return) ? iterator.return(TASK_CANCEL) : {\n          done: true,\n          value: TASK_CANCEL\n        };\n      } else if (arg === CHANNEL_END) {\n        // We get CHANNEL_END by taking from a channel that ended using `take` (and not `takem` used to trap End of channels)\n        result = is.func(iterator.return) ? iterator.return() : {\n          done: true\n        };\n      } else {\n        result = iterator.next(arg);\n      }\n\n      if (!result.done) {\n        digestEffect(result.value, parentEffectId, '', next);\n      } else {\n        /**\n          This Generator has ended, terminate the main task and notify the fork queue\n        **/\n        mainTask.isMainRunning = false;\n        mainTask.cont && mainTask.cont(result.value);\n      }\n    } catch (error) {\n      if (mainTask.isCancelled) {\n        logError(error);\n      }\n\n      mainTask.isMainRunning = false;\n      mainTask.cont(error, true);\n    }\n  }\n\n  function end(result, isErr) {\n    iterator._isRunning = false; // stdChannel.close()\n\n    if (!isErr) {\n      iterator._result = result;\n      iterator._deferredEnd && iterator._deferredEnd.resolve(result);\n    } else {\n      addSagaStack(result, {\n        meta: meta,\n        effect: crashedEffect,\n        cancelledTasks: cancelledDueToErrorTasks\n      });\n\n      if (!task.cont) {\n        if (result.sagaStack) {\n          result.sagaStack = sagaStackToString(result.sagaStack);\n        }\n\n        if (result instanceof Error && onError) {\n          onError(result);\n        } else {\n          // TODO: could we skip this when _deferredEnd is attached?\n          logError(result);\n        }\n      }\n\n      iterator._error = result;\n      iterator._isAborted = true;\n      iterator._deferredEnd && iterator._deferredEnd.reject(result);\n    }\n\n    task.cont && task.cont(result, isErr);\n    task.joiners.forEach(function (j) {\n      return j.cb(result, isErr);\n    });\n    task.joiners = null;\n  }\n\n  function runEffect(effect, effectId, currCb) {\n    /**\n      each effect runner must attach its own logic of cancellation to the provided callback\n      it allows this generator to propagate cancellation downward.\n       ATTENTION! effect runners must setup the cancel logic by setting cb.cancel = [cancelMethod]\n      And the setup must occur before calling the callback\n       This is a sort of inversion of control: called async functions are responsible\n      of completing the flow by calling the provided continuation; while caller functions\n      are responsible for aborting the current flow by calling the attached cancel function\n       Library users can attach their own cancellation logic to promises by defining a\n      promise[CANCEL] method in their returned promises\n      ATTENTION! calling cancel must have no effect on an already completed or cancelled effect\n    **/\n    var data; // prettier-ignore\n\n    return (// Non declarative effect\n      is.promise(effect) ? resolvePromise(effect, currCb) : is.iterator(effect) ? resolveIterator(effect, effectId, meta, currCb) // declarative effects\n      : (data = asEffect.take(effect)) ? runTakeEffect(data, currCb) : (data = asEffect.put(effect)) ? runPutEffect(data, currCb) : (data = asEffect.all(effect)) ? runAllEffect(data, effectId, currCb) : (data = asEffect.race(effect)) ? runRaceEffect(data, effectId, currCb) : (data = asEffect.call(effect)) ? runCallEffect(data, effectId, currCb) : (data = asEffect.cps(effect)) ? runCPSEffect(data, currCb) : (data = asEffect.fork(effect)) ? runForkEffect(data, effectId, currCb) : (data = asEffect.join(effect)) ? runJoinEffect(data, currCb) : (data = asEffect.cancel(effect)) ? runCancelEffect(data, currCb) : (data = asEffect.select(effect)) ? runSelectEffect(data, currCb) : (data = asEffect.actionChannel(effect)) ? runChannelEffect(data, currCb) : (data = asEffect.flush(effect)) ? runFlushEffect(data, currCb) : (data = asEffect.cancelled(effect)) ? runCancelledEffect(data, currCb) : (data = asEffect.getContext(effect)) ? runGetContextEffect(data, currCb) : (data = asEffect.setContext(effect)) ? runSetContextEffect(data, currCb) :\n      /* anything else returned as is */\n      currCb(effect)\n    );\n  }\n\n  function digestEffect(effect, parentEffectId, label, cb) {\n    if (label === void 0) {\n      label = '';\n    }\n\n    var effectId = nextEffectId();\n    sagaMonitor && sagaMonitor.effectTriggered({\n      effectId: effectId,\n      parentEffectId: parentEffectId,\n      label: label,\n      effect: effect\n    });\n    /**\n      completion callback and cancel callback are mutually exclusive\n      We can't cancel an already completed effect\n      And We can't complete an already cancelled effectId\n    **/\n\n    var effectSettled; // Completion callback passed to the appropriate effect runner\n\n    function currCb(res, isErr) {\n      if (effectSettled) {\n        return;\n      }\n\n      effectSettled = true;\n      cb.cancel = noop; // defensive measure\n\n      if (sagaMonitor) {\n        isErr ? sagaMonitor.effectRejected(effectId, res) : sagaMonitor.effectResolved(effectId, res);\n      }\n\n      if (isErr) {\n        crashedEffect = effect;\n      }\n\n      cb(res, isErr);\n    } // tracks down the current cancel\n\n\n    currCb.cancel = noop; // setup cancellation logic on the parent cb\n\n    cb.cancel = function () {\n      // prevents cancelling an already completed effect\n      if (effectSettled) {\n        return;\n      }\n\n      effectSettled = true;\n      /**\n        propagates cancel downward\n        catch uncaught cancellations errors; since we can no longer call the completion\n        callback, log errors raised during cancellations into the console\n      **/\n\n      try {\n        currCb.cancel();\n      } catch (err) {\n        logError(err);\n      }\n\n      currCb.cancel = noop; // defensive measure\n\n      sagaMonitor && sagaMonitor.effectCancelled(effectId);\n    }; // if one can find a way to decouple runEffect from closure variables\n    // so it could be the call to it could be referentially transparent\n    // this potentially could be simplified, finalRunEffect created beforehand\n    // and this part of the code wouldnt have to know about middleware stuff\n\n\n    if (is.func(middleware)) {\n      middleware(function (eff) {\n        return runEffect(eff, effectId, currCb);\n      })(effect);\n      return;\n    }\n\n    runEffect(effect, effectId, currCb);\n  }\n\n  function resolvePromise(promise, cb) {\n    var cancelPromise = promise[CANCEL];\n\n    if (is.func(cancelPromise)) {\n      cb.cancel = cancelPromise;\n    } else if (is.func(promise.abort)) {\n      cb.cancel = function () {\n        return promise.abort();\n      };\n    }\n\n    promise.then(cb, function (error) {\n      return cb(error, true);\n    });\n  }\n\n  function resolveIterator(iterator, effectId, meta, cb) {\n    proc(iterator, stdChannel, dispatch, getState, taskContext, options, effectId, meta, cb);\n  }\n\n  function runTakeEffect(_ref2, cb) {\n    var _ref2$channel = _ref2.channel,\n        channel = _ref2$channel === void 0 ? stdChannel : _ref2$channel,\n        pattern = _ref2.pattern,\n        maybe = _ref2.maybe;\n\n    var takeCb = function takeCb(input) {\n      if (input instanceof Error) {\n        cb(input, true);\n        return;\n      }\n\n      if (isEnd(input) && !maybe) {\n        cb(CHANNEL_END);\n        return;\n      }\n\n      cb(input);\n    };\n\n    try {\n      channel.take(takeCb, is.notUndef(pattern) ? matcher(pattern) : null);\n    } catch (err) {\n      cb(err, true);\n      return;\n    }\n\n    cb.cancel = takeCb.cancel;\n  }\n\n  function runPutEffect(_ref3, cb) {\n    var channel = _ref3.channel,\n        action = _ref3.action,\n        resolve = _ref3.resolve;\n\n    /**\n      Schedule the put in case another saga is holding a lock.\n      The put will be executed atomically. ie nested puts will execute after\n      this put has terminated.\n    **/\n    asap(function () {\n      var result;\n\n      try {\n        result = (channel ? channel.put : dispatch)(action);\n      } catch (error) {\n        cb(error, true);\n        return;\n      }\n\n      if (resolve && is.promise(result)) {\n        resolvePromise(result, cb);\n      } else {\n        cb(result);\n        return;\n      }\n    }); // Put effects are non cancellables\n  }\n\n  function runCallEffect(_ref4, effectId, cb) {\n    var context = _ref4.context,\n        fn = _ref4.fn,\n        args = _ref4.args;\n    var result; // catch synchronous failures; see #152\n\n    try {\n      result = fn.apply(context, args);\n    } catch (error) {\n      cb(error, true);\n      return;\n    }\n\n    return is.promise(result) ? resolvePromise(result, cb) : is.iterator(result) ? resolveIterator(result, effectId, getMetaInfo(fn), cb) : cb(result);\n  }\n\n  function runCPSEffect(_ref5, cb) {\n    var context = _ref5.context,\n        fn = _ref5.fn,\n        args = _ref5.args;\n\n    // CPS (ie node style functions) can define their own cancellation logic\n    // by setting cancel field on the cb\n    // catch synchronous failures; see #152\n    try {\n      var cpsCb = function cpsCb(err, res) {\n        return is.undef(err) ? cb(res) : cb(err, true);\n      };\n\n      fn.apply(context, args.concat(cpsCb));\n\n      if (cpsCb.cancel) {\n        cb.cancel = function () {\n          return cpsCb.cancel();\n        };\n      }\n    } catch (error) {\n      cb(error, true);\n      return;\n    }\n  }\n\n  function runForkEffect(_ref6, effectId, cb) {\n    var context = _ref6.context,\n        fn = _ref6.fn,\n        args = _ref6.args,\n        detached = _ref6.detached;\n    var taskIterator = createTaskIterator({\n      context: context,\n      fn: fn,\n      args: args\n    });\n    var meta = getIteratorMetaInfo(taskIterator, fn);\n\n    try {\n      suspend();\n\n      var _task = proc(taskIterator, stdChannel, dispatch, getState, taskContext, options, effectId, meta, detached ? null : noop);\n\n      if (detached) {\n        cb(_task);\n      } else {\n        if (taskIterator._isRunning) {\n          taskQueue.addTask(_task);\n          cb(_task);\n        } else if (taskIterator._error) {\n          taskQueue.abort(taskIterator._error);\n        } else {\n          cb(_task);\n        }\n      }\n    } finally {\n      flush();\n    } // Fork effects are non cancellables\n\n  }\n\n  function runJoinEffect(t, cb) {\n    if (t.isRunning()) {\n      var joiner = {\n        task: task,\n        cb: cb\n      };\n\n      cb.cancel = function () {\n        return remove(t.joiners, joiner);\n      };\n\n      t.joiners.push(joiner);\n    } else {\n      t.isAborted() ? cb(t.error(), true) : cb(t.result());\n    }\n  }\n\n  function runCancelEffect(taskToCancel, cb) {\n    if (taskToCancel === SELF_CANCELLATION) {\n      taskToCancel = task;\n    }\n\n    if (taskToCancel.isRunning()) {\n      taskToCancel.cancel();\n    }\n\n    cb(); // cancel effects are non cancellables\n  }\n\n  function runAllEffect(effects, effectId, cb) {\n    var keys = Object.keys(effects);\n\n    if (!keys.length) {\n      cb(is.array(effects) ? [] : {});\n      return;\n    }\n\n    var completedCount = 0;\n    var completed;\n    var results = {};\n    var childCbs = {};\n\n    function checkEffectEnd() {\n      if (completedCount === keys.length) {\n        completed = true;\n        cb(is.array(effects) ? array.from(_extends({}, results, {\n          length: keys.length\n        })) : results);\n      }\n    }\n\n    keys.forEach(function (key) {\n      var chCbAtKey = function chCbAtKey(res, isErr) {\n        if (completed) {\n          return;\n        }\n\n        if (isErr || isEnd(res) || res === CHANNEL_END || res === TASK_CANCEL) {\n          cb.cancel();\n          cb(res, isErr);\n        } else {\n          results[key] = res;\n          completedCount++;\n          checkEffectEnd();\n        }\n      };\n\n      chCbAtKey.cancel = noop;\n      childCbs[key] = chCbAtKey;\n    });\n\n    cb.cancel = function () {\n      if (!completed) {\n        completed = true;\n        keys.forEach(function (key) {\n          return childCbs[key].cancel();\n        });\n      }\n    };\n\n    keys.forEach(function (key) {\n      return digestEffect(effects[key], effectId, key, childCbs[key]);\n    });\n  }\n\n  function runRaceEffect(effects, effectId, cb) {\n    var completed;\n    var keys = Object.keys(effects);\n    var childCbs = {};\n    keys.forEach(function (key) {\n      var chCbAtKey = function chCbAtKey(res, isErr) {\n        if (completed) {\n          return;\n        }\n\n        if (isErr) {\n          // Race Auto cancellation\n          cb.cancel();\n          cb(res, true);\n        } else if (!isEnd(res) && res !== CHANNEL_END && res !== TASK_CANCEL) {\n          var _response;\n\n          cb.cancel();\n          completed = true;\n          var response = (_response = {}, _response[key] = res, _response);\n          cb(is.array(effects) ? [].slice.call(_extends({}, response, {\n            length: keys.length\n          })) : response);\n        }\n      };\n\n      chCbAtKey.cancel = noop;\n      childCbs[key] = chCbAtKey;\n    });\n\n    cb.cancel = function () {\n      // prevents unnecessary cancellation\n      if (!completed) {\n        completed = true;\n        keys.forEach(function (key) {\n          return childCbs[key].cancel();\n        });\n      }\n    };\n\n    keys.forEach(function (key) {\n      if (completed) {\n        return;\n      }\n\n      digestEffect(effects[key], effectId, key, childCbs[key]);\n    });\n  }\n\n  function runSelectEffect(_ref7, cb) {\n    var selector = _ref7.selector,\n        args = _ref7.args;\n\n    try {\n      var state = selector.apply(void 0, [getState()].concat(args));\n      cb(state);\n    } catch (error) {\n      cb(error, true);\n    }\n  }\n\n  function runChannelEffect(_ref8, cb) {\n    var pattern = _ref8.pattern,\n        buffer = _ref8.buffer;\n    // TODO: rethink how END is handled\n    var chan = channel(buffer);\n    var match = matcher(pattern);\n\n    var taker = function taker(action) {\n      if (!isEnd(action)) {\n        stdChannel.take(taker, match);\n      }\n\n      chan.put(action);\n    };\n\n    stdChannel.take(taker, match);\n    cb(chan);\n  }\n\n  function runCancelledEffect(data, cb) {\n    cb(!!mainTask.isCancelled);\n  }\n\n  function runFlushEffect(channel, cb) {\n    channel.flush(cb);\n  }\n\n  function runGetContextEffect(prop, cb) {\n    cb(taskContext[prop]);\n  }\n\n  function runSetContextEffect(props, cb) {\n    object.assign(taskContext, props);\n    cb();\n  }\n\n  function newTask(id, meta, iterator, cont) {\n    var _ref9;\n\n    iterator._deferredEnd = null;\n    return _ref9 = {}, _ref9[TASK] = true, _ref9.id = id, _ref9.meta = meta, _ref9.toPromise = function toPromise() {\n      if (iterator._deferredEnd) {\n        return iterator._deferredEnd.promise;\n      }\n\n      var def = deferred();\n      iterator._deferredEnd = def;\n\n      if (!iterator._isRunning) {\n        if (iterator._isAborted) {\n          def.reject(iterator._error);\n        } else {\n          def.resolve(iterator._result);\n        }\n      }\n\n      return def.promise;\n    }, _ref9.cont = cont, _ref9.joiners = [], _ref9.cancel = cancel, _ref9.isRunning = function isRunning() {\n      return iterator._isRunning;\n    }, _ref9.isCancelled = function isCancelled() {\n      return iterator._isCancelled;\n    }, _ref9.isAborted = function isAborted() {\n      return iterator._isAborted;\n    }, _ref9.result = function result() {\n      return iterator._result;\n    }, _ref9.error = function error() {\n      return iterator._error;\n    }, _ref9.setContext = function setContext(props) {\n      if (process.env.NODE_ENV === 'development') {\n        check(props, is.object, createSetContextWarning('task', props));\n      }\n\n      object.assign(taskContext, props);\n    }, _ref9;\n  }\n}","import { compose } from 'redux';\nimport { is, check, uid as nextSagaId, wrapSagaDispatch, noop } from './utils';\nimport proc, { getMetaInfo } from './proc';\nimport { stdChannel } from './channel';\nvar RUN_SAGA_SIGNATURE = 'runSaga(options, saga, ...args)';\nvar NON_GENERATOR_ERR = RUN_SAGA_SIGNATURE + \": saga argument must be a Generator function!\";\nexport function runSaga(options, saga) {\n  for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    args[_key - 2] = arguments[_key];\n  }\n\n  if (process.env.NODE_ENV === 'development') {\n    check(saga, is.func, NON_GENERATOR_ERR);\n  }\n\n  var iterator = saga.apply(void 0, args);\n\n  if (process.env.NODE_ENV === 'development') {\n    check(iterator, is.iterator, NON_GENERATOR_ERR);\n  }\n\n  var _options$channel = options.channel,\n      channel = _options$channel === void 0 ? stdChannel() : _options$channel,\n      dispatch = options.dispatch,\n      getState = options.getState,\n      context = options.context,\n      sagaMonitor = options.sagaMonitor,\n      logger = options.logger,\n      effectMiddlewares = options.effectMiddlewares,\n      onError = options.onError;\n  var effectId = nextSagaId();\n\n  if (sagaMonitor) {\n    // monitors are expected to have a certain interface, let's fill-in any missing ones\n    sagaMonitor.effectTriggered = sagaMonitor.effectTriggered || noop;\n    sagaMonitor.effectResolved = sagaMonitor.effectResolved || noop;\n    sagaMonitor.effectRejected = sagaMonitor.effectRejected || noop;\n    sagaMonitor.effectCancelled = sagaMonitor.effectCancelled || noop;\n    sagaMonitor.actionDispatched = sagaMonitor.actionDispatched || noop;\n    sagaMonitor.effectTriggered({\n      effectId: effectId,\n      root: true,\n      parentEffectId: 0,\n      effect: {\n        root: true,\n        saga: saga,\n        args: args\n      }\n    });\n  }\n\n  if ((process.env.NODE_ENV === 'development' || process.env.NODE_ENV === 'test') && is.notUndef(effectMiddlewares)) {\n    var MIDDLEWARE_TYPE_ERROR = 'effectMiddlewares must be an array of functions';\n    check(effectMiddlewares, is.array, MIDDLEWARE_TYPE_ERROR);\n    effectMiddlewares.forEach(function (effectMiddleware) {\n      return check(effectMiddleware, is.func, MIDDLEWARE_TYPE_ERROR);\n    });\n  }\n\n  var middleware = effectMiddlewares && compose.apply(void 0, effectMiddlewares);\n  var task = proc(iterator, channel, wrapSagaDispatch(dispatch), getState, context, {\n    sagaMonitor: sagaMonitor,\n    logger: logger,\n    onError: onError,\n    middleware: middleware\n  }, effectId, getMetaInfo(saga));\n\n  if (sagaMonitor) {\n    sagaMonitor.effectResolved(effectId, task);\n  }\n\n  return task;\n}","import { is, makeIterator } from '../utils';\nvar done = {\n  done: true,\n  value: undefined\n};\nexport var qEnd = {};\nexport function safeName(patternOrChannel) {\n  if (is.channel(patternOrChannel)) {\n    return 'channel';\n  }\n\n  if (is.stringableFunc(patternOrChannel)) {\n    return String(patternOrChannel);\n  }\n\n  if (is.func(patternOrChannel)) {\n    return patternOrChannel.name;\n  }\n\n  return String(patternOrChannel);\n}\nexport default function fsmIterator(fsm, q0, name) {\n  var updateState,\n      qNext = q0;\n\n  function next(arg, error) {\n    if (qNext === qEnd) {\n      return done;\n    }\n\n    if (error) {\n      qNext = qEnd;\n      throw error;\n    } else {\n      updateState && updateState(arg);\n\n      var _fsm$qNext = fsm[qNext](),\n          q = _fsm$qNext[0],\n          output = _fsm$qNext[1],\n          _updateState = _fsm$qNext[2];\n\n      qNext = q;\n      updateState = _updateState;\n      return qNext === qEnd ? done : output;\n    }\n  }\n\n  return makeIterator(next, function (error) {\n    return next(null, error);\n  }, name);\n}","import takeEveryHelper from './takeEvery';\nimport takeLatestHelper from './takeLatest';\nimport takeLeadingHelper from './takeLeading';\nimport throttleHelper from './throttle';\nexport { takeEveryHelper, takeLatestHelper, takeLeadingHelper, throttleHelper };","import fsmIterator, { qEnd, safeName } from './fsmIterator';\nimport { take, fork } from '../io';\nimport { END } from '../channel';\nexport default function takeEvery(patternOrChannel, worker) {\n  for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    args[_key - 2] = arguments[_key];\n  }\n\n  var yTake = {\n    done: false,\n    value: take(patternOrChannel)\n  };\n\n  var yFork = function yFork(ac) {\n    return {\n      done: false,\n      value: fork.apply(void 0, [worker].concat(args, [ac]))\n    };\n  };\n\n  var action,\n      setAction = function setAction(ac) {\n    return action = ac;\n  };\n\n  return fsmIterator({\n    q1: function q1() {\n      return ['q2', yTake, setAction];\n    },\n    q2: function q2() {\n      return action === END ? [qEnd] : ['q1', yFork(action)];\n    }\n  }, 'q1', \"takeEvery(\" + safeName(patternOrChannel) + \", \" + worker.name + \")\");\n}","import fsmIterator, { qEnd, safeName } from './fsmIterator';\nimport { cancel, take, fork } from '../io';\nimport { END } from '../channel';\nexport default function takeLatest(patternOrChannel, worker) {\n  for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    args[_key - 2] = arguments[_key];\n  }\n\n  var yTake = {\n    done: false,\n    value: take(patternOrChannel)\n  };\n\n  var yFork = function yFork(ac) {\n    return {\n      done: false,\n      value: fork.apply(void 0, [worker].concat(args, [ac]))\n    };\n  };\n\n  var yCancel = function yCancel(task) {\n    return {\n      done: false,\n      value: cancel(task)\n    };\n  };\n\n  var task, action;\n\n  var setTask = function setTask(t) {\n    return task = t;\n  };\n\n  var setAction = function setAction(ac) {\n    return action = ac;\n  };\n\n  return fsmIterator({\n    q1: function q1() {\n      return ['q2', yTake, setAction];\n    },\n    q2: function q2() {\n      return action === END ? [qEnd] : task ? ['q3', yCancel(task)] : ['q1', yFork(action), setTask];\n    },\n    q3: function q3() {\n      return ['q1', yFork(action), setTask];\n    }\n  }, 'q1', \"takeLatest(\" + safeName(patternOrChannel) + \", \" + worker.name + \")\");\n}","import fsmIterator, { qEnd, safeName } from './fsmIterator';\nimport { take, call } from '../io';\nimport { END } from '../channel';\nexport default function takeLeading(patternOrChannel, worker) {\n  for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    args[_key - 2] = arguments[_key];\n  }\n\n  var yTake = {\n    done: false,\n    value: take(patternOrChannel)\n  };\n\n  var yCall = function yCall(ac) {\n    return {\n      done: false,\n      value: call.apply(void 0, [worker].concat(args, [ac]))\n    };\n  };\n\n  var action;\n\n  var setAction = function setAction(ac) {\n    return action = ac;\n  };\n\n  return fsmIterator({\n    q1: function q1() {\n      return ['q2', yTake, setAction];\n    },\n    q2: function q2() {\n      return action === END ? [qEnd] : ['q1', yCall(action)];\n    }\n  }, 'q1', \"takeLeading(\" + safeName(patternOrChannel) + \", \" + worker.name + \")\");\n}","import fsmIterator, { qEnd, safeName } from './fsmIterator';\nimport { take, fork, actionChannel, delay } from '../io';\nimport { END } from '../channel';\nimport * as buffers from '../buffers';\nexport default function throttle(delayLength, pattern, worker) {\n  for (var _len = arguments.length, args = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n    args[_key - 3] = arguments[_key];\n  }\n\n  var action, channel;\n  var yActionChannel = {\n    done: false,\n    value: actionChannel(pattern, buffers.sliding(1))\n  };\n\n  var yTake = function yTake() {\n    return {\n      done: false,\n      value: take(channel)\n    };\n  };\n\n  var yFork = function yFork(ac) {\n    return {\n      done: false,\n      value: fork.apply(void 0, [worker].concat(args, [ac]))\n    };\n  };\n\n  var yDelay = {\n    done: false,\n    value: delay(delayLength)\n  };\n\n  var setAction = function setAction(ac) {\n    return action = ac;\n  };\n\n  var setChannel = function setChannel(ch) {\n    return channel = ch;\n  };\n\n  return fsmIterator({\n    q1: function q1() {\n      return ['q2', yActionChannel, setChannel];\n    },\n    q2: function q2() {\n      return ['q3', yTake(), setAction];\n    },\n    q3: function q3() {\n      return action === END ? [qEnd] : ['q4', yFork(action)];\n    },\n    q4: function q4() {\n      return ['q2', yDelay];\n    }\n  }, 'q1', \"throttle(\" + safeName(pattern) + \", \" + worker.name + \")\");\n}","var queue = [];\n/**\n  Variable to hold a counting semaphore\n  - Incrementing adds a lock and puts the scheduler in a `suspended` state (if it's not\n    already suspended)\n  - Decrementing releases a lock. Zero locks puts the scheduler in a `released` state. This\n    triggers flushing the queued tasks.\n**/\n\nvar semaphore = 0;\n/**\n  Executes a task 'atomically'. Tasks scheduled during this execution will be queued\n  and flushed after this task has finished (assuming the scheduler endup in a released\n  state).\n**/\n\nfunction exec(task) {\n  try {\n    suspend();\n    task();\n  } finally {\n    release();\n  }\n}\n/**\n  Executes or queues a task depending on the state of the scheduler (`suspended` or `released`)\n**/\n\n\nexport function asap(task) {\n  queue.push(task);\n\n  if (!semaphore) {\n    suspend();\n    flush();\n  }\n}\n/**\n  Puts the scheduler in a `suspended` state. Scheduled tasks will be queued until the\n  scheduler is released.\n**/\n\nexport function suspend() {\n  semaphore++;\n}\n/**\n  Puts the scheduler in a `released` state.\n**/\n\nfunction release() {\n  semaphore--;\n}\n/**\n  Releases the current lock. Executes all queued tasks if the scheduler is in the released state.\n**/\n\n\nexport function flush() {\n  release();\n  var task;\n\n  while (!semaphore && (task = queue.shift()) !== undefined) {\n    exec(task);\n  }\n}","var createName = function createName(name) {\n  return \"@@redux-saga/\" + name;\n};\n\nvar createSymbol = function createSymbol(id) {\n  id = createName(id);\n  return typeof Symbol === 'function' ? Symbol(id) : id;\n};\n\nvar createGlobalSymbol = function createGlobalSymbol(id) {\n  id = createName(id);\n  return typeof Symbol === 'function' && typeof Symbol.for === 'function' ? Symbol.for(id) : id;\n};\n\nexport var CANCEL =\n/*#__PURE__*/\ncreateSymbol('CANCEL_PROMISE');\nexport var CHANNEL_END =\n/*#__PURE__*/\ncreateSymbol('CHANNEL_END');\nexport var CHANNEL_END_TYPE =\n/*#__PURE__*/\ncreateSymbol('CHANNEL_END');\nexport var IO =\n/*#__PURE__*/\ncreateSymbol('IO');\nexport var MATCH =\n/*#__PURE__*/\ncreateSymbol('MATCH');\nexport var MULTICAST =\n/*#__PURE__*/\ncreateSymbol('MULTICAST');\nexport var SAGA_ACTION =\n/*#__PURE__*/\ncreateSymbol('SAGA_ACTION');\nexport var SELF_CANCELLATION =\n/*#__PURE__*/\ncreateSymbol('SELF_CANCELLATION');\nexport var TASK =\n/*#__PURE__*/\ncreateSymbol('TASK');\nexport var TASK_CANCEL =\n/*#__PURE__*/\ncreateSymbol('TASK_CANCEL');\nexport var SAGA_LOCATION =\n/*#__PURE__*/\ncreateGlobalSymbol('LOCATION');","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { CANCEL, MULTICAST, SAGA_ACTION, TASK } from './symbols';\nexport var konst = function konst(v) {\n  return function () {\n    return v;\n  };\n};\nexport var kTrue =\n/*#__PURE__*/\nkonst(true);\nexport var kFalse =\n/*#__PURE__*/\nkonst(false);\nexport var noop = function noop() {};\nexport var identity = function identity(v) {\n  return v;\n};\nexport function check(value, predicate, error) {\n  if (!predicate(value)) {\n    throw new Error(error);\n  }\n}\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nexport function hasOwn(object, property) {\n  return is.notUndef(object) && hasOwnProperty.call(object, property);\n}\nexport var is = {\n  undef: function undef(v) {\n    return v === null || v === undefined;\n  },\n  notUndef: function notUndef(v) {\n    return v !== null && v !== undefined;\n  },\n  func: function func(f) {\n    return typeof f === 'function';\n  },\n  number: function number(n) {\n    return typeof n === 'number';\n  },\n  string: function string(s) {\n    return typeof s === 'string';\n  },\n  array: Array.isArray,\n  object: function object(obj) {\n    return obj && !is.array(obj) && typeof obj === 'object';\n  },\n  promise: function promise(p) {\n    return p && is.func(p.then);\n  },\n  iterator: function iterator(it) {\n    return it && is.func(it.next) && is.func(it.throw);\n  },\n  iterable: function iterable(it) {\n    return it && is.func(Symbol) ? is.func(it[Symbol.iterator]) : is.array(it);\n  },\n  task: function task(t) {\n    return t && t[TASK];\n  },\n  observable: function observable(ob) {\n    return ob && is.func(ob.subscribe);\n  },\n  buffer: function buffer(buf) {\n    return buf && is.func(buf.isEmpty) && is.func(buf.take) && is.func(buf.put);\n  },\n  pattern: function pattern(pat) {\n    return pat && (is.string(pat) || is.symbol(pat) || is.func(pat) || is.array(pat));\n  },\n  channel: function channel(ch) {\n    return ch && is.func(ch.take) && is.func(ch.close);\n  },\n  stringableFunc: function stringableFunc(f) {\n    return is.func(f) && hasOwn(f, 'toString');\n  },\n  symbol: function symbol(sym) {\n    return Boolean(sym) && typeof Symbol === 'function' && sym.constructor === Symbol && sym !== Symbol.prototype;\n  },\n  multicast: function multicast(ch) {\n    return is.channel(ch) && ch[MULTICAST];\n  }\n};\nexport var object = {\n  assign: function assign(target, source) {\n    for (var i in source) {\n      if (hasOwn(source, i)) {\n        target[i] = source[i];\n      }\n    }\n  }\n};\nexport function remove(array, item) {\n  var index = array.indexOf(item);\n\n  if (index >= 0) {\n    array.splice(index, 1);\n  }\n}\nexport var array = {\n  from: function from(obj) {\n    var arr = Array(obj.length);\n\n    for (var i in obj) {\n      if (hasOwn(obj, i)) {\n        arr[i] = obj[i];\n      }\n    }\n\n    return arr;\n  }\n};\nexport function once(fn) {\n  var called = false;\n  return function () {\n    if (called) {\n      return;\n    }\n\n    called = true;\n    fn();\n  };\n}\nexport function deferred(props) {\n  if (props === void 0) {\n    props = {};\n  }\n\n  var def = _extends({}, props);\n\n  var promise = new Promise(function (resolve, reject) {\n    def.resolve = resolve;\n    def.reject = reject;\n  });\n  def.promise = promise;\n  return def;\n}\nexport function arrayOfDeferred(length) {\n  var arr = [];\n\n  for (var i = 0; i < length; i++) {\n    arr.push(deferred());\n  }\n\n  return arr;\n}\nexport function delay(ms, val) {\n  if (val === void 0) {\n    val = true;\n  }\n\n  var timeoutId;\n  var promise = new Promise(function (resolve) {\n    timeoutId = setTimeout(function () {\n      return resolve(val);\n    }, ms);\n  });\n\n  promise[CANCEL] = function () {\n    return clearTimeout(timeoutId);\n  };\n\n  return promise;\n}\nexport function createMockTask() {\n  var _ref;\n\n  var running = true;\n\n  var _result, _error;\n\n  return _ref = {}, _ref[TASK] = true, _ref.isRunning = function isRunning() {\n    return running;\n  }, _ref.result = function result() {\n    return _result;\n  }, _ref.error = function error() {\n    return _error;\n  }, _ref.setRunning = function setRunning(b) {\n    return running = b;\n  }, _ref.setResult = function setResult(r) {\n    return _result = r;\n  }, _ref.setError = function setError(e) {\n    return _error = e;\n  }, _ref;\n}\nexport function autoInc(seed) {\n  if (seed === void 0) {\n    seed = 0;\n  }\n\n  return function () {\n    return ++seed;\n  };\n}\nexport var uid =\n/*#__PURE__*/\nautoInc();\n\nvar kThrow = function kThrow(err) {\n  throw err;\n};\n\nvar kReturn = function kReturn(value) {\n  return {\n    value: value,\n    done: true\n  };\n};\n\nexport function makeIterator(next, thro, name) {\n  if (thro === void 0) {\n    thro = kThrow;\n  }\n\n  if (name === void 0) {\n    name = 'iterator';\n  }\n\n  var iterator = {\n    meta: {\n      name: name\n    },\n    next: next,\n    throw: thro,\n    return: kReturn,\n    isSagaIterator: true\n  };\n\n  if (typeof Symbol !== 'undefined') {\n    iterator[Symbol.iterator] = function () {\n      return iterator;\n    };\n  }\n\n  return iterator;\n}\n/**\n  Print error in a useful way whether in a browser environment\n  (with expandable error stack traces), or in a node.js environment\n  (text-only log output)\n **/\n\nexport function log(level, message, error) {\n  if (error === void 0) {\n    error = '';\n  }\n\n  /*eslint-disable no-console*/\n  if (typeof window === 'undefined') {\n    console.log(\"redux-saga \" + level + \": \" + message + \"\\n\" + (error && error.stack || error));\n  } else {\n    console[level](message, error);\n  }\n}\nexport function deprecate(fn, deprecationWarning) {\n  return function () {\n    if (process.env.NODE_ENV === 'development') log('warn', deprecationWarning);\n    return fn.apply(void 0, arguments);\n  };\n}\nexport var updateIncentive = function updateIncentive(deprecated, preferred) {\n  return deprecated + \" has been deprecated in favor of \" + preferred + \", please update your code\";\n};\nexport var internalErr = function internalErr(err) {\n  return new Error(\"\\n  redux-saga: Error checking hooks detected an inconsistent state. This is likely a bug\\n  in redux-saga code and not yours. Thanks for reporting this in the project's github repo.\\n  Error: \" + err + \"\\n\");\n};\nexport var createSetContextWarning = function createSetContextWarning(ctx, props) {\n  return (ctx ? ctx + '.' : '') + \"setContext(props): argument \" + props + \" is not a plain object\";\n};\nexport var wrapSagaDispatch = function wrapSagaDispatch(dispatch) {\n  return function (action) {\n    return dispatch(Object.defineProperty(action, SAGA_ACTION, {\n      value: true\n    }));\n  };\n};\n\nvar cloneableGenerator = function cloneableGenerator(generatorFunc) {\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    var history = [];\n    var gen = generatorFunc.apply(void 0, args);\n    return {\n      next: function next(arg) {\n        history.push(arg);\n        return gen.next(arg);\n      },\n      clone: function clone() {\n        var clonedGen = cloneableGenerator(generatorFunc).apply(void 0, args);\n        history.forEach(function (arg) {\n          return clonedGen.next(arg);\n        });\n        return clonedGen;\n      },\n      return: function _return(value) {\n        return gen.return(value);\n      },\n      throw: function _throw(exception) {\n        return gen.throw(exception);\n      }\n    };\n  };\n};\n\nexport { cloneableGenerator };","export { delay, noop, is, deferred, arrayOfDeferred, createMockTask, cloneableGenerator } from './internal/utils';\nexport { SAGA_ACTION, TASK } from './internal/symbols';\nexport { asEffect } from './internal/io';\nexport { CHANNEL_END } from './internal/proc';","import $$observable from 'symbol-observable';\n\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\nvar randomString = function randomString() {\n  return Math.random().toString(36).substring(7).split('').join('.');\n};\n\nvar ActionTypes = {\n  INIT: \"@@redux/INIT\" + randomString(),\n  REPLACE: \"@@redux/REPLACE\" + randomString(),\n  PROBE_UNKNOWN_ACTION: function PROBE_UNKNOWN_ACTION() {\n    return \"@@redux/PROBE_UNKNOWN_ACTION\" + randomString();\n  }\n};\n\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\nfunction isPlainObject(obj) {\n  if (typeof obj !== 'object' || obj === null) return false;\n  var proto = obj;\n\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(obj) === proto;\n}\n\n/**\n * Creates a Redux store that holds the state tree.\n * The only way to change the data in the store is to call `dispatch()` on it.\n *\n * There should only be a single store in your app. To specify how different\n * parts of the state tree respond to actions, you may combine several reducers\n * into a single reducer function by using `combineReducers`.\n *\n * @param {Function} reducer A function that returns the next state tree, given\n * the current state tree and the action to handle.\n *\n * @param {any} [preloadedState] The initial state. You may optionally specify it\n * to hydrate the state from the server in universal apps, or to restore a\n * previously serialized user session.\n * If you use `combineReducers` to produce the root reducer function, this must be\n * an object with the same shape as `combineReducers` keys.\n *\n * @param {Function} [enhancer] The store enhancer. You may optionally specify it\n * to enhance the store with third-party capabilities such as middleware,\n * time travel, persistence, etc. The only store enhancer that ships with Redux\n * is `applyMiddleware()`.\n *\n * @returns {Store} A Redux store that lets you read the state, dispatch actions\n * and subscribe to changes.\n */\n\nfunction createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'function' || typeof enhancer === 'function' && typeof arguments[3] === 'function') {\n    throw new Error('It looks like you are passing several store enhancers to ' + 'createStore(). This is not supported. Instead, compose them ' + 'together to a single function');\n  }\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error('Expected the enhancer to be a function.');\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error('Expected the reducer to be a function.');\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n\n\n  function getState() {\n    if (isDispatching) {\n      throw new Error('You may not call store.getState() while the reducer is executing. ' + 'The reducer has already received the state as an argument. ' + 'Pass it down from the top reducer instead of reading it from the store.');\n    }\n\n    return currentState;\n  }\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n\n\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('Expected the listener to be a function.');\n    }\n\n    if (isDispatching) {\n      throw new Error('You may not call store.subscribe() while the reducer is executing. ' + 'If you would like to be notified after the store has been updated, subscribe from a ' + 'component and invoke store.getState() in the callback to access the latest state. ' + 'See https://redux.js.org/api-reference/store#subscribe(listener) for more details.');\n    }\n\n    var isSubscribed = true;\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      if (isDispatching) {\n        throw new Error('You may not unsubscribe from a store listener while the reducer is executing. ' + 'See https://redux.js.org/api-reference/store#subscribe(listener) for more details.');\n      }\n\n      isSubscribed = false;\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n    };\n  }\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing what changed. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n\n\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error('Actions must be plain objects. ' + 'Use custom middleware for async actions.');\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error('Actions may not have an undefined \"type\" property. ' + 'Have you misspelled a constant?');\n    }\n\n    if (isDispatching) {\n      throw new Error('Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n\n\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error('Expected the nextReducer to be a function.');\n    }\n\n    currentReducer = nextReducer;\n    dispatch({\n      type: ActionTypes.REPLACE\n    });\n  }\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n\n\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object' || observer === null) {\n          throw new TypeError('Expected the observer to be an object.');\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return {\n          unsubscribe: unsubscribe\n        };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  } // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n\n\n  dispatch({\n    type: ActionTypes.INIT\n  });\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}\n\n/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n\n\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n  } catch (e) {} // eslint-disable-line no-empty\n\n}\n\nfunction getUndefinedStateErrorMessage(key, action) {\n  var actionType = action && action.type;\n  var actionDescription = actionType && \"action \\\"\" + String(actionType) + \"\\\"\" || 'an action';\n  return \"Given \" + actionDescription + \", reducer \\\"\" + key + \"\\\" returned undefined. \" + \"To ignore an action, you must explicitly return the previous state. \" + \"If you want this reducer to hold no value, you can return null instead of undefined.\";\n}\n\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {\n  var reducerKeys = Object.keys(reducers);\n  var argumentName = action && action.type === ActionTypes.INIT ? 'preloadedState argument passed to createStore' : 'previous state received by the reducer';\n\n  if (reducerKeys.length === 0) {\n    return 'Store does not have a valid reducer. Make sure the argument passed ' + 'to combineReducers is an object whose values are reducers.';\n  }\n\n  if (!isPlainObject(inputState)) {\n    return \"The \" + argumentName + \" has unexpected type of \\\"\" + {}.toString.call(inputState).match(/\\s([a-z|A-Z]+)/)[1] + \"\\\". Expected argument to be an object with the following \" + (\"keys: \\\"\" + reducerKeys.join('\", \"') + \"\\\"\");\n  }\n\n  var unexpectedKeys = Object.keys(inputState).filter(function (key) {\n    return !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key];\n  });\n  unexpectedKeys.forEach(function (key) {\n    unexpectedKeyCache[key] = true;\n  });\n  if (action && action.type === ActionTypes.REPLACE) return;\n\n  if (unexpectedKeys.length > 0) {\n    return \"Unexpected \" + (unexpectedKeys.length > 1 ? 'keys' : 'key') + \" \" + (\"\\\"\" + unexpectedKeys.join('\", \"') + \"\\\" found in \" + argumentName + \". \") + \"Expected to find one of the known reducer keys instead: \" + (\"\\\"\" + reducerKeys.join('\", \"') + \"\\\". Unexpected keys will be ignored.\");\n  }\n}\n\nfunction assertReducerShape(reducers) {\n  Object.keys(reducers).forEach(function (key) {\n    var reducer = reducers[key];\n    var initialState = reducer(undefined, {\n      type: ActionTypes.INIT\n    });\n\n    if (typeof initialState === 'undefined') {\n      throw new Error(\"Reducer \\\"\" + key + \"\\\" returned undefined during initialization. \" + \"If the state passed to the reducer is undefined, you must \" + \"explicitly return the initial state. The initial state may \" + \"not be undefined. If you don't want to set a value for this reducer, \" + \"you can use null instead of undefined.\");\n    }\n\n    if (typeof reducer(undefined, {\n      type: ActionTypes.PROBE_UNKNOWN_ACTION()\n    }) === 'undefined') {\n      throw new Error(\"Reducer \\\"\" + key + \"\\\" returned undefined when probed with a random type. \" + (\"Don't try to handle \" + ActionTypes.INIT + \" or other actions in \\\"redux/*\\\" \") + \"namespace. They are considered private. Instead, you must return the \" + \"current state for any unknown actions, unless it is undefined, \" + \"in which case you must return the initial state, regardless of the \" + \"action type. The initial state may not be undefined, but can be null.\");\n    }\n  });\n}\n/**\n * Turns an object whose values are different reducer functions, into a single\n * reducer function. It will call every child reducer, and gather their results\n * into a single state object, whose keys correspond to the keys of the passed\n * reducer functions.\n *\n * @param {Object} reducers An object whose values correspond to different\n * reducer functions that need to be combined into one. One handy way to obtain\n * it is to use ES6 `import * as reducers` syntax. The reducers may never return\n * undefined for any action. Instead, they should return their initial state\n * if the state passed to them was undefined, and the current state for any\n * unrecognized action.\n *\n * @returns {Function} A reducer function that invokes every reducer inside the\n * passed object, and builds a state object with the same shape.\n */\n\n\nfunction combineReducers(reducers) {\n  var reducerKeys = Object.keys(reducers);\n  var finalReducers = {};\n\n  for (var i = 0; i < reducerKeys.length; i++) {\n    var key = reducerKeys[i];\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof reducers[key] === 'undefined') {\n        warning(\"No reducer provided for key \\\"\" + key + \"\\\"\");\n      }\n    }\n\n    if (typeof reducers[key] === 'function') {\n      finalReducers[key] = reducers[key];\n    }\n  }\n\n  var finalReducerKeys = Object.keys(finalReducers);\n  var unexpectedKeyCache;\n\n  if (process.env.NODE_ENV !== 'production') {\n    unexpectedKeyCache = {};\n  }\n\n  var shapeAssertionError;\n\n  try {\n    assertReducerShape(finalReducers);\n  } catch (e) {\n    shapeAssertionError = e;\n  }\n\n  return function combination(state, action) {\n    if (state === void 0) {\n      state = {};\n    }\n\n    if (shapeAssertionError) {\n      throw shapeAssertionError;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      var warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache);\n\n      if (warningMessage) {\n        warning(warningMessage);\n      }\n    }\n\n    var hasChanged = false;\n    var nextState = {};\n\n    for (var _i = 0; _i < finalReducerKeys.length; _i++) {\n      var _key = finalReducerKeys[_i];\n      var reducer = finalReducers[_key];\n      var previousStateForKey = state[_key];\n      var nextStateForKey = reducer(previousStateForKey, action);\n\n      if (typeof nextStateForKey === 'undefined') {\n        var errorMessage = getUndefinedStateErrorMessage(_key, action);\n        throw new Error(errorMessage);\n      }\n\n      nextState[_key] = nextStateForKey;\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;\n    }\n\n    return hasChanged ? nextState : state;\n  };\n}\n\nfunction bindActionCreator(actionCreator, dispatch) {\n  return function () {\n    return dispatch(actionCreator.apply(this, arguments));\n  };\n}\n/**\n * Turns an object whose values are action creators, into an object with the\n * same keys, but with every function wrapped into a `dispatch` call so they\n * may be invoked directly. This is just a convenience method, as you can call\n * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.\n *\n * For convenience, you can also pass a single function as the first argument,\n * and get a function in return.\n *\n * @param {Function|Object} actionCreators An object whose values are action\n * creator functions. One handy way to obtain it is to use ES6 `import * as`\n * syntax. You may also pass a single function.\n *\n * @param {Function} dispatch The `dispatch` function available on your Redux\n * store.\n *\n * @returns {Function|Object} The object mimicking the original object, but with\n * every action creator wrapped into the `dispatch` call. If you passed a\n * function as `actionCreators`, the return value will also be a single\n * function.\n */\n\n\nfunction bindActionCreators(actionCreators, dispatch) {\n  if (typeof actionCreators === 'function') {\n    return bindActionCreator(actionCreators, dispatch);\n  }\n\n  if (typeof actionCreators !== 'object' || actionCreators === null) {\n    throw new Error(\"bindActionCreators expected an object or a function, instead received \" + (actionCreators === null ? 'null' : typeof actionCreators) + \". \" + \"Did you write \\\"import ActionCreators from\\\" instead of \\\"import * as ActionCreators from\\\"?\");\n  }\n\n  var keys = Object.keys(actionCreators);\n  var boundActionCreators = {};\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var actionCreator = actionCreators[key];\n\n    if (typeof actionCreator === 'function') {\n      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);\n    }\n  }\n\n  return boundActionCreators;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\n/**\n * Composes single-argument functions from right to left. The rightmost\n * function can take multiple arguments as it provides the signature for\n * the resulting composite function.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing the argument functions\n * from right to left. For example, compose(f, g, h) is identical to doing\n * (...args) => f(g(h(...args))).\n */\nfunction compose() {\n  for (var _len = arguments.length, funcs = new Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce(function (a, b) {\n    return function () {\n      return a(b.apply(void 0, arguments));\n    };\n  });\n}\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\n\nfunction applyMiddleware() {\n  for (var _len = arguments.length, middlewares = new Array(_len), _key = 0; _key < _len; _key++) {\n    middlewares[_key] = arguments[_key];\n  }\n\n  return function (createStore) {\n    return function () {\n      var store = createStore.apply(void 0, arguments);\n\n      var _dispatch = function dispatch() {\n        throw new Error(\"Dispatching while constructing your middleware is not allowed. \" + \"Other middleware would not be applied to this dispatch.\");\n      };\n\n      var middlewareAPI = {\n        getState: store.getState,\n        dispatch: function dispatch() {\n          return _dispatch.apply(void 0, arguments);\n        }\n      };\n      var chain = middlewares.map(function (middleware) {\n        return middleware(middlewareAPI);\n      });\n      _dispatch = compose.apply(void 0, chain)(store.dispatch);\n      return _objectSpread({}, store, {\n        dispatch: _dispatch\n      });\n    };\n  };\n}\n\n/*\n * This is a dummy function to check if the function name has been altered by minification.\n * If the function has been minified and NODE_ENV !== 'production', warn the user.\n */\n\nfunction isCrushed() {}\n\nif (process.env.NODE_ENV !== 'production' && typeof isCrushed.name === 'string' && isCrushed.name !== 'isCrushed') {\n  warning('You are currently using minified code outside of NODE_ENV === \"production\". ' + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) ' + 'to ensure you have the correct code for your production build.');\n}\n\nexport { createStore, combineReducers, bindActionCreators, applyMiddleware, compose, ActionTypes as __DO_NOT_USE__ActionTypes };\n","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport compose from './compose';\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\nexport default function applyMiddleware() {\n  for (var _len = arguments.length, middlewares = Array(_len), _key = 0; _key < _len; _key++) {\n    middlewares[_key] = arguments[_key];\n  }\n\n  return function (createStore) {\n    return function (reducer, preloadedState, enhancer) {\n      var store = createStore(reducer, preloadedState, enhancer);\n      var _dispatch = store.dispatch;\n      var chain = [];\n\n      var middlewareAPI = {\n        getState: store.getState,\n        dispatch: function dispatch(action) {\n          return _dispatch(action);\n        }\n      };\n      chain = middlewares.map(function (middleware) {\n        return middleware(middlewareAPI);\n      });\n      _dispatch = compose.apply(undefined, chain)(store.dispatch);\n\n      return _extends({}, store, {\n        dispatch: _dispatch\n      });\n    };\n  };\n}","function bindActionCreator(actionCreator, dispatch) {\n  return function () {\n    return dispatch(actionCreator.apply(undefined, arguments));\n  };\n}\n\n/**\n * Turns an object whose values are action creators, into an object with the\n * same keys, but with every function wrapped into a `dispatch` call so they\n * may be invoked directly. This is just a convenience method, as you can call\n * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.\n *\n * For convenience, you can also pass a single function as the first argument,\n * and get a function in return.\n *\n * @param {Function|Object} actionCreators An object whose values are action\n * creator functions. One handy way to obtain it is to use ES6 `import * as`\n * syntax. You may also pass a single function.\n *\n * @param {Function} dispatch The `dispatch` function available on your Redux\n * store.\n *\n * @returns {Function|Object} The object mimicking the original object, but with\n * every action creator wrapped into the `dispatch` call. If you passed a\n * function as `actionCreators`, the return value will also be a single\n * function.\n */\nexport default function bindActionCreators(actionCreators, dispatch) {\n  if (typeof actionCreators === 'function') {\n    return bindActionCreator(actionCreators, dispatch);\n  }\n\n  if (typeof actionCreators !== 'object' || actionCreators === null) {\n    throw new Error('bindActionCreators expected an object or a function, instead received ' + (actionCreators === null ? 'null' : typeof actionCreators) + '. ' + 'Did you write \"import ActionCreators from\" instead of \"import * as ActionCreators from\"?');\n  }\n\n  var keys = Object.keys(actionCreators);\n  var boundActionCreators = {};\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var actionCreator = actionCreators[key];\n    if (typeof actionCreator === 'function') {\n      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);\n    }\n  }\n  return boundActionCreators;\n}","import { ActionTypes } from './createStore';\nimport isPlainObject from 'lodash-es/isPlainObject';\nimport warning from './utils/warning';\n\nfunction getUndefinedStateErrorMessage(key, action) {\n  var actionType = action && action.type;\n  var actionName = actionType && '\"' + actionType.toString() + '\"' || 'an action';\n\n  return 'Given action ' + actionName + ', reducer \"' + key + '\" returned undefined. ' + 'To ignore an action, you must explicitly return the previous state. ' + 'If you want this reducer to hold no value, you can return null instead of undefined.';\n}\n\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {\n  var reducerKeys = Object.keys(reducers);\n  var argumentName = action && action.type === ActionTypes.INIT ? 'preloadedState argument passed to createStore' : 'previous state received by the reducer';\n\n  if (reducerKeys.length === 0) {\n    return 'Store does not have a valid reducer. Make sure the argument passed ' + 'to combineReducers is an object whose values are reducers.';\n  }\n\n  if (!isPlainObject(inputState)) {\n    return 'The ' + argumentName + ' has unexpected type of \"' + {}.toString.call(inputState).match(/\\s([a-z|A-Z]+)/)[1] + '\". Expected argument to be an object with the following ' + ('keys: \"' + reducerKeys.join('\", \"') + '\"');\n  }\n\n  var unexpectedKeys = Object.keys(inputState).filter(function (key) {\n    return !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key];\n  });\n\n  unexpectedKeys.forEach(function (key) {\n    unexpectedKeyCache[key] = true;\n  });\n\n  if (unexpectedKeys.length > 0) {\n    return 'Unexpected ' + (unexpectedKeys.length > 1 ? 'keys' : 'key') + ' ' + ('\"' + unexpectedKeys.join('\", \"') + '\" found in ' + argumentName + '. ') + 'Expected to find one of the known reducer keys instead: ' + ('\"' + reducerKeys.join('\", \"') + '\". Unexpected keys will be ignored.');\n  }\n}\n\nfunction assertReducerShape(reducers) {\n  Object.keys(reducers).forEach(function (key) {\n    var reducer = reducers[key];\n    var initialState = reducer(undefined, { type: ActionTypes.INIT });\n\n    if (typeof initialState === 'undefined') {\n      throw new Error('Reducer \"' + key + '\" returned undefined during initialization. ' + 'If the state passed to the reducer is undefined, you must ' + 'explicitly return the initial state. The initial state may ' + 'not be undefined. If you don\\'t want to set a value for this reducer, ' + 'you can use null instead of undefined.');\n    }\n\n    var type = '@@redux/PROBE_UNKNOWN_ACTION_' + Math.random().toString(36).substring(7).split('').join('.');\n    if (typeof reducer(undefined, { type: type }) === 'undefined') {\n      throw new Error('Reducer \"' + key + '\" returned undefined when probed with a random type. ' + ('Don\\'t try to handle ' + ActionTypes.INIT + ' or other actions in \"redux/*\" ') + 'namespace. They are considered private. Instead, you must return the ' + 'current state for any unknown actions, unless it is undefined, ' + 'in which case you must return the initial state, regardless of the ' + 'action type. The initial state may not be undefined, but can be null.');\n    }\n  });\n}\n\n/**\n * Turns an object whose values are different reducer functions, into a single\n * reducer function. It will call every child reducer, and gather their results\n * into a single state object, whose keys correspond to the keys of the passed\n * reducer functions.\n *\n * @param {Object} reducers An object whose values correspond to different\n * reducer functions that need to be combined into one. One handy way to obtain\n * it is to use ES6 `import * as reducers` syntax. The reducers may never return\n * undefined for any action. Instead, they should return their initial state\n * if the state passed to them was undefined, and the current state for any\n * unrecognized action.\n *\n * @returns {Function} A reducer function that invokes every reducer inside the\n * passed object, and builds a state object with the same shape.\n */\nexport default function combineReducers(reducers) {\n  var reducerKeys = Object.keys(reducers);\n  var finalReducers = {};\n  for (var i = 0; i < reducerKeys.length; i++) {\n    var key = reducerKeys[i];\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof reducers[key] === 'undefined') {\n        warning('No reducer provided for key \"' + key + '\"');\n      }\n    }\n\n    if (typeof reducers[key] === 'function') {\n      finalReducers[key] = reducers[key];\n    }\n  }\n  var finalReducerKeys = Object.keys(finalReducers);\n\n  var unexpectedKeyCache = void 0;\n  if (process.env.NODE_ENV !== 'production') {\n    unexpectedKeyCache = {};\n  }\n\n  var shapeAssertionError = void 0;\n  try {\n    assertReducerShape(finalReducers);\n  } catch (e) {\n    shapeAssertionError = e;\n  }\n\n  return function combination() {\n    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var action = arguments[1];\n\n    if (shapeAssertionError) {\n      throw shapeAssertionError;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      var warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache);\n      if (warningMessage) {\n        warning(warningMessage);\n      }\n    }\n\n    var hasChanged = false;\n    var nextState = {};\n    for (var _i = 0; _i < finalReducerKeys.length; _i++) {\n      var _key = finalReducerKeys[_i];\n      var reducer = finalReducers[_key];\n      var previousStateForKey = state[_key];\n      var nextStateForKey = reducer(previousStateForKey, action);\n      if (typeof nextStateForKey === 'undefined') {\n        var errorMessage = getUndefinedStateErrorMessage(_key, action);\n        throw new Error(errorMessage);\n      }\n      nextState[_key] = nextStateForKey;\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;\n    }\n    return hasChanged ? nextState : state;\n  };\n}","/**\n * Composes single-argument functions from right to left. The rightmost\n * function can take multiple arguments as it provides the signature for\n * the resulting composite function.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing the argument functions\n * from right to left. For example, compose(f, g, h) is identical to doing\n * (...args) => f(g(h(...args))).\n */\n\nexport default function compose() {\n  for (var _len = arguments.length, funcs = Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce(function (a, b) {\n    return function () {\n      return a(b.apply(undefined, arguments));\n    };\n  });\n}","import isPlainObject from 'lodash-es/isPlainObject';\nimport $$observable from 'symbol-observable';\n\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\nexport var ActionTypes = {\n  INIT: '@@redux/INIT'\n\n  /**\n   * Creates a Redux store that holds the state tree.\n   * The only way to change the data in the store is to call `dispatch()` on it.\n   *\n   * There should only be a single store in your app. To specify how different\n   * parts of the state tree respond to actions, you may combine several reducers\n   * into a single reducer function by using `combineReducers`.\n   *\n   * @param {Function} reducer A function that returns the next state tree, given\n   * the current state tree and the action to handle.\n   *\n   * @param {any} [preloadedState] The initial state. You may optionally specify it\n   * to hydrate the state from the server in universal apps, or to restore a\n   * previously serialized user session.\n   * If you use `combineReducers` to produce the root reducer function, this must be\n   * an object with the same shape as `combineReducers` keys.\n   *\n   * @param {Function} [enhancer] The store enhancer. You may optionally specify it\n   * to enhance the store with third-party capabilities such as middleware,\n   * time travel, persistence, etc. The only store enhancer that ships with Redux\n   * is `applyMiddleware()`.\n   *\n   * @returns {Store} A Redux store that lets you read the state, dispatch actions\n   * and subscribe to changes.\n   */\n};export default function createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error('Expected the enhancer to be a function.');\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error('Expected the reducer to be a function.');\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n  function getState() {\n    return currentState;\n  }\n\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('Expected listener to be a function.');\n    }\n\n    var isSubscribed = true;\n\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      isSubscribed = false;\n\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n    };\n  }\n\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing what changed. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error('Actions must be plain objects. ' + 'Use custom middleware for async actions.');\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error('Actions may not have an undefined \"type\" property. ' + 'Have you misspelled a constant?');\n    }\n\n    if (isDispatching) {\n      throw new Error('Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error('Expected the nextReducer to be a function.');\n    }\n\n    currentReducer = nextReducer;\n    dispatch({ type: ActionTypes.INIT });\n  }\n\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object') {\n          throw new TypeError('Expected the observer to be an object.');\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return { unsubscribe: unsubscribe };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  }\n\n  // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n  dispatch({ type: ActionTypes.INIT });\n\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}","import createStore from './createStore';\nimport combineReducers from './combineReducers';\nimport bindActionCreators from './bindActionCreators';\nimport applyMiddleware from './applyMiddleware';\nimport compose from './compose';\nimport warning from './utils/warning';\n\n/*\n* This is a dummy function to check if the function name has been altered by minification.\n* If the function has been minified and NODE_ENV !== 'production', warn the user.\n*/\nfunction isCrushed() {}\n\nif (process.env.NODE_ENV !== 'production' && typeof isCrushed.name === 'string' && isCrushed.name !== 'isCrushed') {\n  warning('You are currently using minified code outside of NODE_ENV === \\'production\\'. ' + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or DefinePlugin for webpack (http://stackoverflow.com/questions/30030031) ' + 'to ensure you have the correct code for your production build.');\n}\n\nexport { createStore, combineReducers, bindActionCreators, applyMiddleware, compose };","/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\nexport default function warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n    /* eslint-disable no-empty */\n  } catch (e) {}\n  /* eslint-enable no-empty */\n}","var grammar = module.exports = {\n  v: [{\n    name: 'version',\n    reg: /^(\\d*)$/\n  }],\n  o: [{ //o=- 20518 0 IN IP4 203.0.113.1\n    // NB: sessionId will be a String in most cases because it is huge\n    name: 'origin',\n    reg: /^(\\S*) (\\d*) (\\d*) (\\S*) IP(\\d) (\\S*)/,\n    names: ['username', 'sessionId', 'sessionVersion', 'netType', 'ipVer', 'address'],\n    format: '%s %s %d %s IP%d %s'\n  }],\n  // default parsing of these only (though some of these feel outdated)\n  s: [{ name: 'name' }],\n  i: [{ name: 'description' }],\n  u: [{ name: 'uri' }],\n  e: [{ name: 'email' }],\n  p: [{ name: 'phone' }],\n  z: [{ name: 'timezones' }], // TODO: this one can actually be parsed properly..\n  r: [{ name: 'repeats' }],   // TODO: this one can also be parsed properly\n  //k: [{}], // outdated thing ignored\n  t: [{ //t=0 0\n    name: 'timing',\n    reg: /^(\\d*) (\\d*)/,\n    names: ['start', 'stop'],\n    format: '%d %d'\n  }],\n  c: [{ //c=IN IP4 10.47.197.26\n    name: 'connection',\n    reg: /^IN IP(\\d) (\\S*)/,\n    names: ['version', 'ip'],\n    format: 'IN IP%d %s'\n  }],\n  b: [{ //b=AS:4000\n    push: 'bandwidth',\n    reg: /^(TIAS|AS|CT|RR|RS):(\\d*)/,\n    names: ['type', 'limit'],\n    format: '%s:%s'\n  }],\n  m: [{ //m=video 51744 RTP/AVP 126 97 98 34 31\n    // NB: special - pushes to session\n    // TODO: rtp/fmtp should be filtered by the payloads found here?\n    reg: /^(\\w*) (\\d*) ([\\w\\/]*)(?: (.*))?/,\n    names: ['type', 'port', 'protocol', 'payloads'],\n    format: '%s %d %s %s'\n  }],\n  a: [\n    { //a=rtpmap:110 opus/48000/2\n      push: 'rtp',\n      reg: /^rtpmap:(\\d*) ([\\w\\-\\.]*)(?:\\s*\\/(\\d*)(?:\\s*\\/(\\S*))?)?/,\n      names: ['payload', 'codec', 'rate', 'encoding'],\n      format: function (o) {\n        return (o.encoding) ?\n          'rtpmap:%d %s/%s/%s':\n          o.rate ?\n          'rtpmap:%d %s/%s':\n          'rtpmap:%d %s';\n      }\n    },\n    { //a=fmtp:108 profile-level-id=24;object=23;bitrate=64000\n      //a=fmtp:111 minptime=10; useinbandfec=1\n      push: 'fmtp',\n      reg: /^fmtp:(\\d*) ([\\S| ]*)/,\n      names: ['payload', 'config'],\n      format: 'fmtp:%d %s'\n    },\n    { //a=control:streamid=0\n      name: 'control',\n      reg: /^control:(.*)/,\n      format: 'control:%s'\n    },\n    { //a=rtcp:65179 IN IP4 193.84.77.194\n      name: 'rtcp',\n      reg: /^rtcp:(\\d*)(?: (\\S*) IP(\\d) (\\S*))?/,\n      names: ['port', 'netType', 'ipVer', 'address'],\n      format: function (o) {\n        return (o.address != null) ?\n          'rtcp:%d %s IP%d %s':\n          'rtcp:%d';\n      }\n    },\n    { //a=rtcp-fb:98 trr-int 100\n      push: 'rtcpFbTrrInt',\n      reg: /^rtcp-fb:(\\*|\\d*) trr-int (\\d*)/,\n      names: ['payload', 'value'],\n      format: 'rtcp-fb:%d trr-int %d'\n    },\n    { //a=rtcp-fb:98 nack rpsi\n      push: 'rtcpFb',\n      reg: /^rtcp-fb:(\\*|\\d*) ([\\w-_]*)(?: ([\\w-_]*))?/,\n      names: ['payload', 'type', 'subtype'],\n      format: function (o) {\n        return (o.subtype != null) ?\n          'rtcp-fb:%s %s %s':\n          'rtcp-fb:%s %s';\n      }\n    },\n    { //a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n      //a=extmap:1/recvonly URI-gps-string\n      push: 'ext',\n      reg: /^extmap:(\\d+)(?:\\/(\\w+))? (\\S*)(?: (\\S*))?/,\n      names: ['value', 'direction', 'uri', 'config'],\n      format: function (o) {\n        return 'extmap:%d' + (o.direction ? '/%s' : '%v') + ' %s' + (o.config ? ' %s' : '');\n      }\n    },\n    { //a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:PS1uQCVeeCFCanVmcjkpPywjNWhcYD0mXXtxaVBR|2^20|1:32\n      push: 'crypto',\n      reg: /^crypto:(\\d*) ([\\w_]*) (\\S*)(?: (\\S*))?/,\n      names: ['id', 'suite', 'config', 'sessionConfig'],\n      format: function (o) {\n        return (o.sessionConfig != null) ?\n          'crypto:%d %s %s %s':\n          'crypto:%d %s %s';\n      }\n    },\n    { //a=setup:actpass\n      name: 'setup',\n      reg: /^setup:(\\w*)/,\n      format: 'setup:%s'\n    },\n    { //a=mid:1\n      name: 'mid',\n      reg: /^mid:([^\\s]*)/,\n      format: 'mid:%s'\n    },\n    { //a=msid:0c8b064d-d807-43b4-b434-f92a889d8587 98178685-d409-46e0-8e16-7ef0db0db64a\n      name: 'msid',\n      reg: /^msid:(.*)/,\n      format: 'msid:%s'\n    },\n    { //a=ptime:20\n      name: 'ptime',\n      reg: /^ptime:(\\d*)/,\n      format: 'ptime:%d'\n    },\n    { //a=maxptime:60\n      name: 'maxptime',\n      reg: /^maxptime:(\\d*)/,\n      format: 'maxptime:%d'\n    },\n    { //a=sendrecv\n      name: 'direction',\n      reg: /^(sendrecv|recvonly|sendonly|inactive)/\n    },\n    { //a=ice-lite\n      name: 'icelite',\n      reg: /^(ice-lite)/\n    },\n    { //a=ice-ufrag:F7gI\n      name: 'iceUfrag',\n      reg: /^ice-ufrag:(\\S*)/,\n      format: 'ice-ufrag:%s'\n    },\n    { //a=ice-pwd:x9cml/YzichV2+XlhiMu8g\n      name: 'icePwd',\n      reg: /^ice-pwd:(\\S*)/,\n      format: 'ice-pwd:%s'\n    },\n    { //a=fingerprint:SHA-1 00:11:22:33:44:55:66:77:88:99:AA:BB:CC:DD:EE:FF:00:11:22:33\n      name: 'fingerprint',\n      reg: /^fingerprint:(\\S*) (\\S*)/,\n      names: ['type', 'hash'],\n      format: 'fingerprint:%s %s'\n    },\n    { //a=candidate:0 1 UDP 2113667327 203.0.113.1 54400 typ host\n      //a=candidate:1162875081 1 udp 2113937151 192.168.34.75 60017 typ host generation 0 network-id 3 network-cost 10\n      //a=candidate:3289912957 2 udp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 generation 0 network-id 3 network-cost 10\n      //a=candidate:229815620 1 tcp 1518280447 192.168.150.19 60017 typ host tcptype active generation 0 network-id 3 network-cost 10\n      //a=candidate:3289912957 2 tcp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 tcptype passive generation 0 network-id 3 network-cost 10\n      push:'candidates',\n      reg: /^candidate:(\\S*) (\\d*) (\\S*) (\\d*) (\\S*) (\\d*) typ (\\S*)(?: raddr (\\S*) rport (\\d*))?(?: tcptype (\\S*))?(?: generation (\\d*))?(?: network-id (\\d*))?(?: network-cost (\\d*))?/,\n      names: ['foundation', 'component', 'transport', 'priority', 'ip', 'port', 'type', 'raddr', 'rport', 'tcptype', 'generation', 'network-id', 'network-cost'],\n      format: function (o) {\n        var str = 'candidate:%s %d %s %d %s %d typ %s';\n\n        str += (o.raddr != null) ? ' raddr %s rport %d' : '%v%v';\n\n        // NB: candidate has three optional chunks, so %void middles one if it's missing\n        str += (o.tcptype != null) ? ' tcptype %s' : '%v';\n\n        if (o.generation != null) {\n          str += ' generation %d';\n        }\n\n        str += (o['network-id'] != null) ? ' network-id %d' : '%v';\n        str += (o['network-cost'] != null) ? ' network-cost %d' : '%v';\n        return str;\n      }\n    },\n    { //a=end-of-candidates (keep after the candidates line for readability)\n      name: 'endOfCandidates',\n      reg: /^(end-of-candidates)/\n    },\n    { //a=remote-candidates:1 203.0.113.1 54400 2 203.0.113.1 54401 ...\n      name: 'remoteCandidates',\n      reg: /^remote-candidates:(.*)/,\n      format: 'remote-candidates:%s'\n    },\n    { //a=ice-options:google-ice\n      name: 'iceOptions',\n      reg: /^ice-options:(\\S*)/,\n      format: 'ice-options:%s'\n    },\n    { //a=ssrc:2566107569 cname:t9YU8M1UxTF8Y1A1\n      push: 'ssrcs',\n      reg: /^ssrc:(\\d*) ([\\w_-]*)(?::(.*))?/,\n      names: ['id', 'attribute', 'value'],\n      format: function (o) {\n        var str = 'ssrc:%d';\n        if (o.attribute != null) {\n          str += ' %s';\n          if (o.value != null) {\n            str += ':%s';\n          }\n        }\n        return str;\n      }\n    },\n    { //a=ssrc-group:FEC 1 2\n      //a=ssrc-group:FEC-FR 3004364195 1080772241\n      push: 'ssrcGroups',\n      // token-char = %x21 / %x23-27 / %x2A-2B / %x2D-2E / %x30-39 / %x41-5A / %x5E-7E\n      reg: /^ssrc-group:([\\x21\\x23\\x24\\x25\\x26\\x27\\x2A\\x2B\\x2D\\x2E\\w]*) (.*)/,\n      names: ['semantics', 'ssrcs'],\n      format: 'ssrc-group:%s %s'\n    },\n    { //a=msid-semantic: WMS Jvlam5X3SX1OP6pn20zWogvaKJz5Hjf9OnlV\n      name: 'msidSemantic',\n      reg: /^msid-semantic:\\s?(\\w*) (\\S*)/,\n      names: ['semantic', 'token'],\n      format: 'msid-semantic: %s %s' // space after ':' is not accidental\n    },\n    { //a=group:BUNDLE audio video\n      push: 'groups',\n      reg: /^group:(\\w*) (.*)/,\n      names: ['type', 'mids'],\n      format: 'group:%s %s'\n    },\n    { //a=rtcp-mux\n      name: 'rtcpMux',\n      reg: /^(rtcp-mux)/\n    },\n    { //a=rtcp-rsize\n      name: 'rtcpRsize',\n      reg: /^(rtcp-rsize)/\n    },\n    { //a=sctpmap:5000 webrtc-datachannel 1024\n      name: 'sctpmap',\n      reg: /^sctpmap:([\\w_\\/]*) (\\S*)(?: (\\S*))?/,\n      names: ['sctpmapNumber', 'app', 'maxMessageSize'],\n      format: function (o) {\n        return (o.maxMessageSize != null) ?\n          'sctpmap:%s %s %s' :\n          'sctpmap:%s %s';\n      }\n    },\n    { //a=x-google-flag:conference\n      name: 'xGoogleFlag',\n      reg: /^x-google-flag:([^\\s]*)/,\n      format: 'x-google-flag:%s'\n    },\n    { //a=rid:1 send max-width=1280;max-height=720;max-fps=30;depend=0\n      push: 'rids',\n      reg: /^rid:([\\d\\w]+) (\\w+)(?: ([\\S| ]*))?/,\n      names: ['id', 'direction', 'params'],\n      format: function (o) {\n        return (o.params) ? 'rid:%s %s %s' : 'rid:%s %s';\n      }\n    },\n    { //a=imageattr:97 send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320] recv [x=330,y=250]\n      //a=imageattr:* send [x=800,y=640] recv *\n      //a=imageattr:100 recv [x=320,y=240]\n      push: 'imageattrs',\n      reg: new RegExp(\n        //a=imageattr:97\n        '^imageattr:(\\\\d+|\\\\*)' +\n        //send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320]\n        '[\\\\s\\\\t]+(send|recv)[\\\\s\\\\t]+(\\\\*|\\\\[\\\\S+\\\\](?:[\\\\s\\\\t]+\\\\[\\\\S+\\\\])*)' +\n        //recv [x=330,y=250]\n        '(?:[\\\\s\\\\t]+(recv|send)[\\\\s\\\\t]+(\\\\*|\\\\[\\\\S+\\\\](?:[\\\\s\\\\t]+\\\\[\\\\S+\\\\])*))?'\n      ),\n      names: ['pt', 'dir1', 'attrs1', 'dir2', 'attrs2'],\n      format: function (o) {\n        return 'imageattr:%s %s %s' + (o.dir2 ? ' %s %s' : '');\n      }\n    },\n    { //a=simulcast:send 1,2,3;~4,~5 recv 6;~7,~8\n      //a=simulcast:recv 1;4,5 send 6;7\n      name: 'simulcast',\n      reg: new RegExp(\n        //a=simulcast:\n        '^simulcast:' +\n        //send 1,2,3;~4,~5\n        '(send|recv) ([a-zA-Z0-9\\\\-_~;,]+)' +\n        //space + recv 6;~7,~8\n        '(?:\\\\s?(send|recv) ([a-zA-Z0-9\\\\-_~;,]+))?' +\n        //end\n        '$'\n      ),\n      names: ['dir1', 'list1', 'dir2', 'list2'],\n      format: function (o) {\n        return 'simulcast:%s %s' + (o.dir2 ? ' %s %s' : '');\n      }\n    },\n    { //Old simulcast draft 03 (implemented by Firefox)\n      //  https://tools.ietf.org/html/draft-ietf-mmusic-sdp-simulcast-03\n      //a=simulcast: recv pt=97;98 send pt=97\n      //a=simulcast: send rid=5;6;7 paused=6,7\n      name: 'simulcast_03',\n      reg: /^simulcast:[\\s\\t]+([\\S+\\s\\t]+)$/,\n      names: ['value'],\n      format: 'simulcast: %s'\n    },\n    {\n      //a=framerate:25\n      //a=framerate:29.97\n      name: 'framerate',\n      reg: /^framerate:(\\d+(?:$|\\.\\d+))/,\n      format: 'framerate:%s'\n    },\n    { // RFC4570\n      //a=source-filter: incl IN IP4 239.5.2.31 10.1.15.5\n      name: 'sourceFilter',\n      reg: /^source-filter: *(excl|incl) (\\S*) (IP4|IP6|\\*) (\\S*) (.*)/,\n      names: ['filterMode', 'netType', 'addressTypes', 'destAddress', 'srcList'],\n      format: 'source-filter: %s %s %s %s %s'\n    },\n    { //a=bundle-only\n      name: 'bundleOnly',\n      reg: /^(bundle-only)/\n    },\n    { //a=label:1\n      name: 'label',\n      reg: /^label:(.+)/,\n      format: 'label:%s'\n    },\n    {\n      // RFC version 26 for SCTP over DTLS\n      // https://tools.ietf.org/html/draft-ietf-mmusic-sctp-sdp-26#section-5\n      name:'sctpPort',\n      reg: /^sctp-port:(\\d+)$/,\n      format: 'sctp-port:%s'\n    },\n    {\n      // RFC version 26 for SCTP over DTLS\n      // https://tools.ietf.org/html/draft-ietf-mmusic-sctp-sdp-26#section-6\n      name:'maxMessageSize',\n      reg: /^max-message-size:(\\d+)$/,\n      format: 'max-message-size:%s'\n    },\n    { // any a= that we don't understand is kepts verbatim on media.invalid\n      push: 'invalid',\n      names: ['value']\n    }\n  ]\n};\n\n// set sensible defaults to avoid polluting the grammar with boring details\nObject.keys(grammar).forEach(function (key) {\n  var objs = grammar[key];\n  objs.forEach(function (obj) {\n    if (!obj.reg) {\n      obj.reg = /(.*)/;\n    }\n    if (!obj.format) {\n      obj.format = '%s';\n    }\n  });\n});\n","var parser = require('./parser');\nvar writer = require('./writer');\n\nexports.write = writer;\nexports.parse = parser.parse;\nexports.parseFmtpConfig = parser.parseFmtpConfig;\nexports.parseParams = parser.parseParams;\nexports.parsePayloads = parser.parsePayloads;\nexports.parseRemoteCandidates = parser.parseRemoteCandidates;\nexports.parseImageAttributes = parser.parseImageAttributes;\nexports.parseSimulcastStreamList = parser.parseSimulcastStreamList;\n","var toIntIfInt = function (v) {\n  return String(Number(v)) === v ? Number(v) : v;\n};\n\nvar attachProperties = function (match, location, names, rawName) {\n  if (rawName && !names) {\n    location[rawName] = toIntIfInt(match[1]);\n  }\n  else {\n    for (var i = 0; i < names.length; i += 1) {\n      if (match[i+1] != null) {\n        location[names[i]] = toIntIfInt(match[i+1]);\n      }\n    }\n  }\n};\n\nvar parseReg = function (obj, location, content) {\n  var needsBlank = obj.name && obj.names;\n  if (obj.push && !location[obj.push]) {\n    location[obj.push] = [];\n  }\n  else if (needsBlank && !location[obj.name]) {\n    location[obj.name] = {};\n  }\n  var keyLocation = obj.push ?\n    {} :  // blank object that will be pushed\n    needsBlank ? location[obj.name] : location; // otherwise, named location or root\n\n  attachProperties(content.match(obj.reg), keyLocation, obj.names, obj.name);\n\n  if (obj.push) {\n    location[obj.push].push(keyLocation);\n  }\n};\n\nvar grammar = require('./grammar');\nvar validLine = RegExp.prototype.test.bind(/^([a-z])=(.*)/);\n\nexports.parse = function (sdp) {\n  var session = {}\n    , media = []\n    , location = session; // points at where properties go under (one of the above)\n\n  // parse lines we understand\n  sdp.split(/(\\r\\n|\\r|\\n)/).filter(validLine).forEach(function (l) {\n    var type = l[0];\n    var content = l.slice(2);\n    if (type === 'm') {\n      media.push({rtp: [], fmtp: []});\n      location = media[media.length-1]; // point at latest media line\n    }\n\n    for (var j = 0; j < (grammar[type] || []).length; j += 1) {\n      var obj = grammar[type][j];\n      if (obj.reg.test(content)) {\n        return parseReg(obj, location, content);\n      }\n    }\n  });\n\n  session.media = media; // link it up\n  return session;\n};\n\nvar paramReducer = function (acc, expr) {\n  var s = expr.split(/=(.+)/, 2);\n  if (s.length === 2) {\n    acc[s[0]] = toIntIfInt(s[1]);\n  } else if (s.length === 1 && expr.length > 1) {\n    acc[s[0]] = undefined;\n  }\n  return acc;\n};\n\nexports.parseParams = function (str) {\n  return str.split(/\\;\\s?/).reduce(paramReducer, {});\n};\n\n// For backward compatibility - alias will be removed in 3.0.0\nexports.parseFmtpConfig = exports.parseParams;\n\nexports.parsePayloads = function (str) {\n  return str.split(' ').map(Number);\n};\n\nexports.parseRemoteCandidates = function (str) {\n  var candidates = [];\n  var parts = str.split(' ').map(toIntIfInt);\n  for (var i = 0; i < parts.length; i += 3) {\n    candidates.push({\n      component: parts[i],\n      ip: parts[i + 1],\n      port: parts[i + 2]\n    });\n  }\n  return candidates;\n};\n\nexports.parseImageAttributes = function (str) {\n  return str.split(' ').map(function (item) {\n    return item.substring(1, item.length-1).split(',').reduce(paramReducer, {});\n  });\n};\n\nexports.parseSimulcastStreamList = function (str) {\n  return str.split(';').map(function (stream) {\n    return stream.split(',').map(function (format) {\n      var scid, paused = false;\n\n      if (format[0] !== '~') {\n        scid = toIntIfInt(format);\n      } else {\n        scid = toIntIfInt(format.substring(1, format.length));\n        paused = true;\n      }\n\n      return {\n        scid: scid,\n        paused: paused\n      };\n    });\n  });\n};\n","var grammar = require('./grammar');\n\n// customized util.format - discards excess arguments and can void middle ones\nvar formatRegExp = /%[sdv%]/g;\nvar format = function (formatStr) {\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  return formatStr.replace(formatRegExp, function (x) {\n    if (i >= len) {\n      return x; // missing argument\n    }\n    var arg = args[i];\n    i += 1;\n    switch (x) {\n    case '%%':\n      return '%';\n    case '%s':\n      return String(arg);\n    case '%d':\n      return Number(arg);\n    case '%v':\n      return '';\n    }\n  });\n  // NB: we discard excess arguments - they are typically undefined from makeLine\n};\n\nvar makeLine = function (type, obj, location) {\n  var str = obj.format instanceof Function ?\n    (obj.format(obj.push ? location : location[obj.name])) :\n    obj.format;\n\n  var args = [type + '=' + str];\n  if (obj.names) {\n    for (var i = 0; i < obj.names.length; i += 1) {\n      var n = obj.names[i];\n      if (obj.name) {\n        args.push(location[obj.name][n]);\n      }\n      else { // for mLine and push attributes\n        args.push(location[obj.names[i]]);\n      }\n    }\n  }\n  else {\n    args.push(location[obj.name]);\n  }\n  return format.apply(null, args);\n};\n\n// RFC specified order\n// TODO: extend this with all the rest\nvar defaultOuterOrder = [\n  'v', 'o', 's', 'i',\n  'u', 'e', 'p', 'c',\n  'b', 't', 'r', 'z', 'a'\n];\nvar defaultInnerOrder = ['i', 'c', 'b', 'a'];\n\n\nmodule.exports = function (session, opts) {\n  opts = opts || {};\n  // ensure certain properties exist\n  if (session.version == null) {\n    session.version = 0; // 'v=0' must be there (only defined version atm)\n  }\n  if (session.name == null) {\n    session.name = ' '; // 's= ' must be there if no meaningful name set\n  }\n  session.media.forEach(function (mLine) {\n    if (mLine.payloads == null) {\n      mLine.payloads = '';\n    }\n  });\n\n  var outerOrder = opts.outerOrder || defaultOuterOrder;\n  var innerOrder = opts.innerOrder || defaultInnerOrder;\n  var sdp = [];\n\n  // loop through outerOrder for matching properties on session\n  outerOrder.forEach(function (type) {\n    grammar[type].forEach(function (obj) {\n      if (obj.name in session && session[obj.name] != null) {\n        sdp.push(makeLine(type, obj, session));\n      }\n      else if (obj.push in session && session[obj.push] != null) {\n        session[obj.push].forEach(function (el) {\n          sdp.push(makeLine(type, obj, el));\n        });\n      }\n    });\n  });\n\n  // then for each media line, follow the innerOrder\n  session.media.forEach(function (mLine) {\n    sdp.push(makeLine('m', grammar.m[0], mLine));\n\n    innerOrder.forEach(function (type) {\n      grammar[type].forEach(function (obj) {\n        if (obj.name in mLine && mLine[obj.name] != null) {\n          sdp.push(makeLine(type, obj, mLine));\n        }\n        else if (obj.push in mLine && mLine[obj.push] != null) {\n          mLine[obj.push].forEach(function (el) {\n            sdp.push(makeLine(type, obj, el));\n          });\n        }\n      });\n    });\n  });\n\n  return sdp.join('\\r\\n') + '\\r\\n';\n};\n","'use strict';\n\nmodule.exports = (string, separator) => {\n\tif (!(typeof string === 'string' && typeof separator === 'string')) {\n\t\tthrow new TypeError('Expected the arguments to be of type `string`');\n\t}\n\n\tif (separator === '') {\n\t\treturn [string];\n\t}\n\n\tconst separatorIndex = string.indexOf(separator);\n\n\tif (separatorIndex === -1) {\n\t\treturn [string];\n\t}\n\n\treturn [\n\t\tstring.slice(0, separatorIndex),\n\t\tstring.slice(separatorIndex + separator.length)\n\t];\n};\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nfunction isObject(obj) {\n  var type = typeof obj;\n  return !!obj && (type === 'object' || type === 'function');\n}\n\nfunction isFunction(obj) {\n  return typeof obj === 'function';\n}\n\nvar assign = Object.assign || function assign(to) {\n  var args = arguments;\n  for (var s = 1; s < args.length; s += 1) {\n    var from = args[s];\n    if (from) {\n      var keys = Object.keys(from);\n      for (var i = 0; i < keys.length; i += 1) {\n        var key = keys[i];\n        to[key] = from[key];\n      }\n    }\n  }\n\n  return to;\n};\n\nvar isArray = Array.isArray;\n\nfunction isPlainObject(value) {\n  return !!value && typeof value === 'object' &&\n    Object.getPrototypeOf(value) === Object.prototype;\n}\n\n\n\n\nfunction concatAssignFunctions(dstObject, srcArray, propName) {\n  if (!isArray(srcArray)) { return; }\n\n  var length = srcArray.length;\n  var dstArray = dstObject[propName] || [];\n  dstObject[propName] = dstArray;\n  for (var i = 0; i < length; i += 1) {\n    var fn = srcArray[i];\n    if (isFunction(fn) && dstArray.indexOf(fn) < 0) {\n      dstArray.push(fn);\n    }\n  }\n}\n\n\nfunction combineProperties(dstObject, srcObject, propName, action) {\n  if (!isObject(srcObject[propName])) { return; }\n  if (!isObject(dstObject[propName])) { dstObject[propName] = {}; }\n  action(dstObject[propName], srcObject[propName]);\n}\n\nfunction deepMergeAssign(dstObject, srcObject, propName) {\n  combineProperties(dstObject, srcObject, propName, merge);\n}\nfunction mergeAssign(dstObject, srcObject, propName) {\n  combineProperties(dstObject, srcObject, propName, assign);\n}\n\n/**\n * The 'src' argument plays the command role.\n * The returned values is always of the same type as the 'src'.\n * @param dst\n * @param src\n * @returns {*}\n */\nfunction mergeOne(dst, src) {\n  if (src === undefined) { return dst; }\n\n  // According to specification arrays must be concatenated.\n  // Also, the '.concat' creates a new array instance. Overrides the 'dst'.\n  if (isArray(src)) { return (isArray(dst) ? dst : []).concat(src); }\n\n  // Now deal with non plain 'src' object. 'src' overrides 'dst'\n  // Note that functions are also assigned! We do not deep merge functions.\n  if (!isPlainObject(src)) { return src; }\n\n  // See if 'dst' is allowed to be mutated. If not - it's overridden with a new plain object.\n  var returnValue = isObject(dst) ? dst : {};\n\n  var keys = Object.keys(src);\n  for (var i = 0; i < keys.length; i += 1) {\n    var key = keys[i];\n\n    var srcValue = src[key];\n    // Do not merge properties with the 'undefined' value.\n    if (srcValue !== undefined) {\n      var dstValue = returnValue[key];\n      // Recursive calls to mergeOne() must allow only plain objects or arrays in dst\n      var newDst = isPlainObject(dstValue) || isArray(srcValue) ? dstValue : {};\n\n      // deep merge each property. Recursion!\n      returnValue[key] = mergeOne(newDst, srcValue);\n    }\n  }\n\n  return returnValue;\n}\n\nvar merge = function (dst) {\n  var srcs = [], len = arguments.length - 1;\n  while ( len-- > 0 ) srcs[ len ] = arguments[ len + 1 ];\n\n  return srcs.reduce(mergeOne, dst);\n};\n\n/**\n * Creates new factory instance.\n * @param {Descriptor} descriptor The information about the object the factory will be creating.\n * @returns {Function} The new factory function.\n */\nfunction createFactory(descriptor) {\n  return function Stamp(options) {\n    var args = [], len = arguments.length - 1;\n    while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n    // Next line was optimized for most JS VMs. Please, be careful here!\n    var obj = Object.create(descriptor.methods || null);\n\n    merge(obj, descriptor.deepProperties);\n    assign(obj, descriptor.properties);\n    Object.defineProperties(obj, descriptor.propertyDescriptors || {});\n\n    if (!descriptor.initializers || descriptor.initializers.length === 0) { return obj; }\n\n    if (options === undefined) { options = {}; }\n    var inits = descriptor.initializers;\n    var length = inits.length;\n    for (var i = 0; i < length; i += 1) {\n      var initializer = inits[i];\n      if (isFunction(initializer)) {\n        var returnedValue = initializer.call(obj, options,\n          {instance: obj, stamp: Stamp, args: [options].concat(args)});\n        obj = returnedValue === undefined ? obj : returnedValue;\n      }\n    }\n\n    return obj;\n  };\n}\n\n/**\n * Returns a new stamp given a descriptor and a compose function implementation.\n * @param {Descriptor} [descriptor={}] The information about the object the stamp will be creating.\n * @param {Compose} composeFunction The \"compose\" function implementation.\n * @returns {Stamp}\n */\nfunction createStamp(descriptor, composeFunction) {\n  var Stamp = createFactory(descriptor);\n\n  merge(Stamp, descriptor.staticDeepProperties);\n  assign(Stamp, descriptor.staticProperties);\n  Object.defineProperties(Stamp, descriptor.staticPropertyDescriptors || {});\n\n  var composeImplementation = isFunction(Stamp.compose) ? Stamp.compose : composeFunction;\n  Stamp.compose = function _compose() {\n    var args = [], len = arguments.length;\n    while ( len-- ) args[ len ] = arguments[ len ];\n\n    return composeImplementation.apply(this, args);\n  };\n  assign(Stamp.compose, descriptor);\n\n  return Stamp;\n}\n\n/**\n * Mutates the dstDescriptor by merging the srcComposable data into it.\n * @param {Descriptor} dstDescriptor The descriptor object to merge into.\n * @param {Composable} [srcComposable] The composable\n * (either descriptor or stamp) to merge data form.\n * @returns {Descriptor} Returns the dstDescriptor argument.\n */\nfunction mergeComposable(dstDescriptor, srcComposable) {\n  var srcDescriptor = (srcComposable && srcComposable.compose) || srcComposable;\n  if (!isObject(srcDescriptor)) { return dstDescriptor; }\n\n  mergeAssign(dstDescriptor, srcDescriptor, 'methods');\n  mergeAssign(dstDescriptor, srcDescriptor, 'properties');\n  deepMergeAssign(dstDescriptor, srcDescriptor, 'deepProperties');\n  mergeAssign(dstDescriptor, srcDescriptor, 'propertyDescriptors');\n  mergeAssign(dstDescriptor, srcDescriptor, 'staticProperties');\n  deepMergeAssign(dstDescriptor, srcDescriptor, 'staticDeepProperties');\n  mergeAssign(dstDescriptor, srcDescriptor, 'staticPropertyDescriptors');\n  mergeAssign(dstDescriptor, srcDescriptor, 'configuration');\n  deepMergeAssign(dstDescriptor, srcDescriptor, 'deepConfiguration');\n  concatAssignFunctions(dstDescriptor, srcDescriptor.initializers, 'initializers');\n\n  return dstDescriptor;\n}\n\n/**\n * Given the list of composables (stamp descriptors and stamps) returns\n * a new stamp (composable factory function).\n * @typedef {Function} Compose\n * @param {...(Composable)} [composables] The list of composables.\n * @returns {Stamp} A new stamp (aka composable factory function)\n */\nfunction compose() {\n  var composables = [], len = arguments.length;\n  while ( len-- ) composables[ len ] = arguments[ len ];\n\n  var descriptor = [this]\n    .concat(composables)\n    .filter(isObject)\n    .reduce(mergeComposable, {});\n  return createStamp(descriptor, compose);\n}\n\n\n/**\n * The Stamp Descriptor\n * @typedef {Function|Object} Descriptor\n * @returns {Stamp} A new stamp based on this Stamp\n * @property {Object} [methods] Methods or other data used as object instances' prototype\n * @property {Array<Function>} [initializers] List of initializers called for each object instance\n * @property {Object} [properties] Shallow assigned properties of object instances\n * @property {Object} [deepProperties] Deeply merged properties of object instances\n * @property {Object} [staticProperties] Shallow assigned properties of Stamps\n * @property {Object} [staticDeepProperties] Deeply merged properties of Stamps\n * @property {Object} [configuration] Shallow assigned properties of Stamp arbitrary metadata\n * @property {Object} [deepConfiguration] Deeply merged properties of Stamp arbitrary metadata\n * @property {Object} [propertyDescriptors] ES5 Property Descriptors applied to object instances\n * @property {Object} [staticPropertyDescriptors] ES5 Property Descriptors applied to Stamps\n */\n\n/**\n * The Stamp factory function\n * @typedef {Function} Stamp\n * @returns {*} Instantiated object\n * @property {Descriptor} compose - The Stamp descriptor and composition function\n */\n\n/**\n * A composable object - stamp or descriptor\n * @typedef {Stamp|Descriptor} Composable\n */\n\nexports['default'] = compose;\nmodule.exports = exports['default'];\n//# sourceMappingURL=compose.js.map\n","/* global window */\nimport ponyfill from './ponyfill.js';\n\nvar root;\n\nif (typeof self !== 'undefined') {\n  root = self;\n} else if (typeof window !== 'undefined') {\n  root = window;\n} else if (typeof global !== 'undefined') {\n  root = global;\n} else if (typeof module !== 'undefined') {\n  root = module;\n} else {\n  root = Function('return this')();\n}\n\nvar result = ponyfill(root);\nexport default result;\n","export default function symbolObservablePonyfill(root) {\n\tvar result;\n\tvar Symbol = root.Symbol;\n\n\tif (typeof Symbol === 'function') {\n\t\tif (Symbol.observable) {\n\t\t\tresult = Symbol.observable;\n\t\t} else {\n\t\t\tresult = Symbol('observable');\n\t\t\tSymbol.observable = result;\n\t\t}\n\t} else {\n\t\tresult = '@@observable';\n\t}\n\n\treturn result;\n};\n","/**\n * Module dependencies.\n */\nvar EventEmitter = require('events').EventEmitter\nvar inherits     = require('util').inherits\n\n/**\n * Expose `Timer`.\n */\nmodule.exports = Timer\n\n/**\n * Stores named timers.\n */\nvar timers = {}\n\n/**\n * Initialize a `Timer` object\n * @param {Boolean} start\n * @api public\n */\nfunction Timer(start) {\n  EventEmitter.call(this)\n  this._total = 0\n  this._start = null\n  this._startCount = 0\n  if (start) {\n    this.start()\n  }\n}\n\n/**\n * Timer extends EventEmitter.\n */\ninherits(Timer, EventEmitter)\n\n/**\n * Get a named timer, initialize a new one if it does not exist.\n * @param {String} name\n * @return {Timer}\n * @api public\n */\nTimer.get = function (name) {\n  if (!timers[name]) {\n    timers[name] = new Timer()\n  }\n  return timers[name]\n}\n\n/**\n * Destroy an existing named timer.\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\nTimer.destroy = function (name) {\n  if (timers[name]) {\n    return delete timers[name]\n  }\n  return false\n}\n\n/**\n * Get the total milliseconds the timer has run.\n * @return {Number}\n * #api public\n */\nTimer.prototype.time = function () {\n  var total = this._total\n  total += this.timeFromStart()\n  return total\n}\n\n/**\n * Get the total millisseonds the time has run and emit time event.\n * @return {Number}\n */\nTimer.prototype.emitTime = function () {\n  var time = this.time()\n  this.emit('time', time)\n  return time\n}\n\n/**\n * Get the time in milliseconds since the timer was last started.\n * @return {Number}\n * @api public\n */\nTimer.prototype.timeFromStart = function () {\n  return this.isStarted() ? now() - this._start : 0\n}\n\n/**\n * Check to see if the timer object is currently started.\n * @return {Boolean}\n * @api public\n */\nTimer.prototype.isStarted = function () {\n  return !this.isStopped()\n}\n\n/**\n * Check to see if the timer object is currently stopped.\n * @return {Boolean}\n * @api public\n */\nTimer.prototype.isStopped = function () {\n  return this._start === null\n}\n\n/**\n * Start the timer if it was not already started.\n * @return {Boolean}\n * @api public\n */\nTimer.prototype.start = function () {\n  ++this._startCount\n  if (this.isStopped()) {\n    this._start = now()\n    this.emit('start')\n    return true\n  }\n  return false\n}\n\n/**\n * Stop the timer if it was not already stopped.\n * @return {Boolean}\n * @api public\n */\nTimer.prototype.stop = function () {\n  if (this.isStarted()) {\n    this._total += this.timeFromStart()\n    this._start = null\n    this._stopCount = 0\n    this.emit('stop')\n    return true\n  }\n  return false\n}\n\n/**\n * Stop the timer if once called equal to the number of times start was called.\n * @return {Boolean} true if timer was stopped\n * @api public\n */\nTimer.prototype.stopParallel = function () {\n  if (this.isStarted()) {\n    --this._startCount\n    if (this._startCount === 0) {\n      return this.stop()\n    }\n  }\n  return false\n}\n\n/**\n * Start or stop the timer depending on current state.\n * @return {Boolean}\n * @api public\n */\nTimer.prototype.toggle = function () {\n  return this.start() || this.stop()\n}\n\n/**\n * Return a string representation of the timer.\n * @return {String}\n */\nTimer.prototype.toString = function () {\n  return this.time() + 'ms'\n}\n\n/**\n * Return a numeric value of the timer in milliseconds.\n * @return {Number}\n */\nTimer.prototype.valueOf = function () {\n  return this.time()\n}\n\n/**\n * Get the current time in milliseconds.\n * @return {Number}\n * @api private\n */\nfunction now() {\n  return new Date().getTime();\n}\n","\nvar space = require('to-space-case')\n\n/**\n * Export.\n */\n\nmodule.exports = toCamelCase\n\n/**\n * Convert a `string` to camel case.\n *\n * @param {String} string\n * @return {String}\n */\n\nfunction toCamelCase(string) {\n  return space(string).replace(/\\s(\\w)/g, function (matches, letter) {\n    return letter.toUpperCase()\n  })\n}\n","\n/**\n * Export.\n */\n\nmodule.exports = toNoCase\n\n/**\n * Test whether a string is camel-case.\n */\n\nvar hasSpace = /\\s/\nvar hasSeparator = /(_|-|\\.|:)/\nvar hasCamel = /([a-z][A-Z]|[A-Z][a-z])/\n\n/**\n * Remove any starting case from a `string`, like camel or snake, but keep\n * spaces and punctuation that may be important otherwise.\n *\n * @param {String} string\n * @return {String}\n */\n\nfunction toNoCase(string) {\n  if (hasSpace.test(string)) return string.toLowerCase()\n  if (hasSeparator.test(string)) return (unseparate(string) || string).toLowerCase()\n  if (hasCamel.test(string)) return uncamelize(string).toLowerCase()\n  return string.toLowerCase()\n}\n\n/**\n * Separator splitter.\n */\n\nvar separatorSplitter = /[\\W_]+(.|$)/g\n\n/**\n * Un-separate a `string`.\n *\n * @param {String} string\n * @return {String}\n */\n\nfunction unseparate(string) {\n  return string.replace(separatorSplitter, function (m, next) {\n    return next ? ' ' + next : ''\n  })\n}\n\n/**\n * Camelcase splitter.\n */\n\nvar camelSplitter = /(.)([A-Z]+)/g\n\n/**\n * Un-camelcase a `string`.\n *\n * @param {String} string\n * @return {String}\n */\n\nfunction uncamelize(string) {\n  return string.replace(camelSplitter, function (m, previous, uppers) {\n    return previous + ' ' + uppers.toLowerCase().split('').join(' ')\n  })\n}\n","\nvar clean = require('to-no-case')\n\n/**\n * Export.\n */\n\nmodule.exports = toSpaceCase\n\n/**\n * Convert a `string` to space case.\n *\n * @param {String} string\n * @return {String}\n */\n\nfunction toSpaceCase(string) {\n  return clean(string).replace(/[\\W_]+(.|$)/g, function (matches, match) {\n    return match ? ' ' + match : ''\n  }).trim()\n}\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb, null, ret) },\n            function(rej) { process.nextTick(callbackifyOnRejected, rej, cb) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n  return ([bth[buf[i++]], bth[buf[i++]], \n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]],\n\tbth[buf[i++]], bth[buf[i++]],\n\tbth[buf[i++]], bth[buf[i++]]]).join('');\n}\n\nmodule.exports = bytesToUuid;\n","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\n\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto\n// implementation. Also, find the complete implementation of crypto on IE11.\nvar getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||\n                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));\n\nif (getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n  module.exports = function whatwgRNG() {\n    getRandomValues(rnds8);\n    return rnds8;\n  };\n} else {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n\n  module.exports = function mathRNG() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.adapter = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\n},{}],2:[function(require,module,exports){\n /* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// returns the session description.\nSDPUtils.getDescription = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n};\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  var channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n          ? '/' + headerExtension.direction\n          : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      if (codec.parameters[param]) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\nSDPUtils.parseSsrcGroup = function(line) {\n  var parts = line.substr(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(function(ssrc) {\n      return parseInt(ssrc, 10);\n    })\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n};\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n      'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  // Search in session part, too.\n  lines = lines.concat(SDPUtils.splitLines(sessionpart));\n  var iceParameters = {\n    usernameFragment: lines.filter(function(line) {\n      return line.indexOf('a=ice-ufrag:') === 0;\n    })[0].substr(12),\n    password: lines.filter(function(line) {\n      return line.indexOf('a=ice-pwd:') === 0;\n    })[0].substr(10)\n  };\n  return iceParameters;\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n          mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n          mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(function(extension) {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'cname';\n  });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n  .map(function(line) {\n    var parts = line.substr(17).split(' ');\n    return parts.map(function(part) {\n      return parseInt(part, 10);\n    });\n  });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10)\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  // Gets the first SSRC. Note tha with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n      .map(function(line) {\n        return SDPUtils.parseSsrcMedia(line);\n      })\n      .filter(function(obj) {\n        return obj.attribute === 'cname';\n      })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(msidParts) {\n    return msidParts.attribute === 'msid';\n  });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  var user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var parts = lines[0].substr(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' ')\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  var parts = line.substr(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5]\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  var lines = SDPUtils.splitLines(blob);\n  for (var i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n\n},{}],3:[function(require,module,exports){\n(function (global){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n'use strict';\n\nvar adapterFactory = require('./adapter_factory.js');\nmodule.exports = adapterFactory({window: global.window});\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./adapter_factory.js\":4}],4:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n'use strict';\n\nvar utils = require('./utils');\n// Shimming starts here.\nmodule.exports = function(dependencies, opts) {\n  var window = dependencies && dependencies.window;\n\n  var options = {\n    shimChrome: true,\n    shimFirefox: true,\n    shimEdge: true,\n    shimSafari: true,\n  };\n\n  for (var key in opts) {\n    if (hasOwnProperty.call(opts, key)) {\n      options[key] = opts[key];\n    }\n  }\n\n  // Utils.\n  var logging = utils.log;\n  var browserDetails = utils.detectBrowser(window);\n\n  // Uncomment the line below if you want logging to occur, including logging\n  // for the switch statement below. Can also be turned on in the browser via\n  // adapter.disableLog(false), but then logging from the switch statement below\n  // will not appear.\n  // require('./utils').disableLog(false);\n\n  // Browser shims.\n  var chromeShim = require('./chrome/chrome_shim') || null;\n  var edgeShim = require('./edge/edge_shim') || null;\n  var firefoxShim = require('./firefox/firefox_shim') || null;\n  var safariShim = require('./safari/safari_shim') || null;\n  var commonShim = require('./common_shim') || null;\n\n  // Export to the adapter global object visible in the browser.\n  var adapter = {\n    browserDetails: browserDetails,\n    commonShim: commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n      commonShim.shimCreateObjectURL(window);\n\n      chromeShim.shimGetUserMedia(window);\n      chromeShim.shimMediaStream(window);\n      chromeShim.shimSourceObject(window);\n      chromeShim.shimPeerConnection(window);\n      chromeShim.shimOnTrack(window);\n      chromeShim.shimAddTrackRemoveTrack(window);\n      chromeShim.shimGetSendersWithDtmf(window);\n      chromeShim.shimSenderReceiverGetStats(window);\n      chromeShim.fixNegotiationNeeded(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n      commonShim.shimCreateObjectURL(window);\n\n      firefoxShim.shimGetUserMedia(window);\n      firefoxShim.shimSourceObject(window);\n      firefoxShim.shimPeerConnection(window);\n      firefoxShim.shimOnTrack(window);\n      firefoxShim.shimRemoveStream(window);\n      firefoxShim.shimSenderGetStats(window);\n      firefoxShim.shimReceiverGetStats(window);\n      firefoxShim.shimRTCDataChannel(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\n        logging('MS edge shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = edgeShim;\n      commonShim.shimCreateObjectURL(window);\n\n      edgeShim.shimGetUserMedia(window);\n      edgeShim.shimPeerConnection(window);\n      edgeShim.shimReplaceTrack(window);\n      edgeShim.shimGetDisplayMedia(window);\n\n      // the edge shim implements the full RTCIceCandidate object.\n\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n      commonShim.shimCreateObjectURL(window);\n\n      safariShim.shimRTCIceServerUrls(window);\n      safariShim.shimCreateOfferLegacy(window);\n      safariShim.shimCallbacksAPI(window);\n      safariShim.shimLocalStreamsAPI(window);\n      safariShim.shimRemoteStreamsAPI(window);\n      safariShim.shimTrackEventTransceiver(window);\n      safariShim.shimGetUserMedia(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n};\n\n},{\"./chrome/chrome_shim\":5,\"./common_shim\":7,\"./edge/edge_shim\":1,\"./firefox/firefox_shim\":8,\"./safari/safari_shim\":10,\"./utils\":11}],5:[function(require,module,exports){\n\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nvar utils = require('../utils.js');\nvar logging = utils.log;\n\n/* iterates the stats graph recursively. */\nfunction walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(function(name) {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(function(id) {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nfunction filterStats(result, track, outbound) {\n  var streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  var filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  var trackStats = [];\n  result.forEach(function(value) {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(function(trackStat) {\n    result.forEach(function(stats) {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\nmodule.exports = {\n  shimGetUserMedia: require('./getusermedia'),\n  shimMediaStream: function(window) {\n    window.MediaStream = window.MediaStream || window.webkitMediaStream;\n  },\n\n  shimOnTrack: function(window) {\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n        window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function() {\n          return this._ontrack;\n        },\n        set: function(f) {\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n          }\n          this.addEventListener('track', this._ontrack = f);\n        },\n        enumerable: true,\n        configurable: true\n      });\n      var origSetRemoteDescription =\n          window.RTCPeerConnection.prototype.setRemoteDescription;\n      window.RTCPeerConnection.prototype.setRemoteDescription = function() {\n        var pc = this;\n        if (!pc._ontrackpoly) {\n          pc._ontrackpoly = function(e) {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', function(te) {\n              var receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = pc.getReceivers().find(function(r) {\n                  return r.track && r.track.id === te.track.id;\n                });\n              } else {\n                receiver = {track: te.track};\n              }\n\n              var event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver: receiver};\n              event.streams = [e.stream];\n              pc.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(function(track) {\n              var receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = pc.getReceivers().find(function(r) {\n                  return r.track && r.track.id === track.id;\n                });\n              } else {\n                receiver = {track: track};\n              }\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver: receiver};\n              event.streams = [e.stream];\n              pc.dispatchEvent(event);\n            });\n          };\n          pc.addEventListener('addstream', pc._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n    } else {\n      // even if RTCRtpTransceiver is in window, it is only used and\n      // emitted in unified-plan. Unfortunately this means we need\n      // to unconditionally wrap the event.\n      utils.wrapPeerConnectionEvent(window, 'track', function(e) {\n        if (!e.transceiver) {\n          Object.defineProperty(e, 'transceiver',\n            {value: {receiver: e.receiver}});\n        }\n        return e;\n      });\n    }\n  },\n\n  shimGetSendersWithDtmf: function(window) {\n    // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n    if (typeof window === 'object' && window.RTCPeerConnection &&\n        !('getSenders' in window.RTCPeerConnection.prototype) &&\n        'createDTMFSender' in window.RTCPeerConnection.prototype) {\n      var shimSenderWithDtmf = function(pc, track) {\n        return {\n          track: track,\n          get dtmf() {\n            if (this._dtmf === undefined) {\n              if (track.kind === 'audio') {\n                this._dtmf = pc.createDTMFSender(track);\n              } else {\n                this._dtmf = null;\n              }\n            }\n            return this._dtmf;\n          },\n          _pc: pc\n        };\n      };\n\n      // augment addTrack when getSenders is not available.\n      if (!window.RTCPeerConnection.prototype.getSenders) {\n        window.RTCPeerConnection.prototype.getSenders = function() {\n          this._senders = this._senders || [];\n          return this._senders.slice(); // return a copy of the internal state.\n        };\n        var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n        window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\n          var pc = this;\n          var sender = origAddTrack.apply(pc, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(pc, track);\n            pc._senders.push(sender);\n          }\n          return sender;\n        };\n\n        var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n        window.RTCPeerConnection.prototype.removeTrack = function(sender) {\n          var pc = this;\n          origRemoveTrack.apply(pc, arguments);\n          var idx = pc._senders.indexOf(sender);\n          if (idx !== -1) {\n            pc._senders.splice(idx, 1);\n          }\n        };\n      }\n      var origAddStream = window.RTCPeerConnection.prototype.addStream;\n      window.RTCPeerConnection.prototype.addStream = function(stream) {\n        var pc = this;\n        pc._senders = pc._senders || [];\n        origAddStream.apply(pc, [stream]);\n        stream.getTracks().forEach(function(track) {\n          pc._senders.push(shimSenderWithDtmf(pc, track));\n        });\n      };\n\n      var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n      window.RTCPeerConnection.prototype.removeStream = function(stream) {\n        var pc = this;\n        pc._senders = pc._senders || [];\n        origRemoveStream.apply(pc, [stream]);\n\n        stream.getTracks().forEach(function(track) {\n          var sender = pc._senders.find(function(s) {\n            return s.track === track;\n          });\n          if (sender) {\n            pc._senders.splice(pc._senders.indexOf(sender), 1); // remove sender\n          }\n        });\n      };\n    } else if (typeof window === 'object' && window.RTCPeerConnection &&\n               'getSenders' in window.RTCPeerConnection.prototype &&\n               'createDTMFSender' in window.RTCPeerConnection.prototype &&\n               window.RTCRtpSender &&\n               !('dtmf' in window.RTCRtpSender.prototype)) {\n      var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n      window.RTCPeerConnection.prototype.getSenders = function() {\n        var pc = this;\n        var senders = origGetSenders.apply(pc, []);\n        senders.forEach(function(sender) {\n          sender._pc = pc;\n        });\n        return senders;\n      };\n\n      Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n        get: function() {\n          if (this._dtmf === undefined) {\n            if (this.track.kind === 'audio') {\n              this._dtmf = this._pc.createDTMFSender(this.track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        }\n      });\n    }\n  },\n\n  shimSenderReceiverGetStats: function(window) {\n    if (!(typeof window === 'object' && window.RTCPeerConnection &&\n        window.RTCRtpSender && window.RTCRtpReceiver)) {\n      return;\n    }\n\n    // shim sender stats.\n    if (!('getStats' in window.RTCRtpSender.prototype)) {\n      var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n      if (origGetSenders) {\n        window.RTCPeerConnection.prototype.getSenders = function() {\n          var pc = this;\n          var senders = origGetSenders.apply(pc, []);\n          senders.forEach(function(sender) {\n            sender._pc = pc;\n          });\n          return senders;\n        };\n      }\n\n      var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      if (origAddTrack) {\n        window.RTCPeerConnection.prototype.addTrack = function() {\n          var sender = origAddTrack.apply(this, arguments);\n          sender._pc = this;\n          return sender;\n        };\n      }\n      window.RTCRtpSender.prototype.getStats = function() {\n        var sender = this;\n        return this._pc.getStats().then(function(result) {\n          /* Note: this will include stats of all senders that\n           *   send a track with the same id as sender.track as\n           *   it is not possible to identify the RTCRtpSender.\n           */\n          return filterStats(result, sender.track, true);\n        });\n      };\n    }\n\n    // shim receiver stats.\n    if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n      var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n      if (origGetReceivers) {\n        window.RTCPeerConnection.prototype.getReceivers = function() {\n          var pc = this;\n          var receivers = origGetReceivers.apply(pc, []);\n          receivers.forEach(function(receiver) {\n            receiver._pc = pc;\n          });\n          return receivers;\n        };\n      }\n      utils.wrapPeerConnectionEvent(window, 'track', function(e) {\n        e.receiver._pc = e.srcElement;\n        return e;\n      });\n      window.RTCRtpReceiver.prototype.getStats = function() {\n        var receiver = this;\n        return this._pc.getStats().then(function(result) {\n          return filterStats(result, receiver.track, false);\n        });\n      };\n    }\n\n    if (!('getStats' in window.RTCRtpSender.prototype &&\n        'getStats' in window.RTCRtpReceiver.prototype)) {\n      return;\n    }\n\n    // shim RTCPeerConnection.getStats(track).\n    var origGetStats = window.RTCPeerConnection.prototype.getStats;\n    window.RTCPeerConnection.prototype.getStats = function() {\n      var pc = this;\n      if (arguments.length > 0 &&\n          arguments[0] instanceof window.MediaStreamTrack) {\n        var track = arguments[0];\n        var sender;\n        var receiver;\n        var err;\n        pc.getSenders().forEach(function(s) {\n          if (s.track === track) {\n            if (sender) {\n              err = true;\n            } else {\n              sender = s;\n            }\n          }\n        });\n        pc.getReceivers().forEach(function(r) {\n          if (r.track === track) {\n            if (receiver) {\n              err = true;\n            } else {\n              receiver = r;\n            }\n          }\n          return r.track === track;\n        });\n        if (err || (sender && receiver)) {\n          return Promise.reject(new DOMException(\n            'There are more than one sender or receiver for the track.',\n            'InvalidAccessError'));\n        } else if (sender) {\n          return sender.getStats();\n        } else if (receiver) {\n          return receiver.getStats();\n        }\n        return Promise.reject(new DOMException(\n          'There is no sender or receiver for the track.',\n          'InvalidAccessError'));\n      }\n      return origGetStats.apply(pc, arguments);\n    };\n  },\n\n  shimSourceObject: function(window) {\n    var URL = window && window.URL;\n\n    if (typeof window === 'object') {\n      if (window.HTMLMediaElement &&\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n          get: function() {\n            return this._srcObject;\n          },\n          set: function(stream) {\n            var self = this;\n            // Use _srcObject as a private property for this shim\n            this._srcObject = stream;\n            if (this.src) {\n              URL.revokeObjectURL(this.src);\n            }\n\n            if (!stream) {\n              this.src = '';\n              return undefined;\n            }\n            this.src = URL.createObjectURL(stream);\n            // We need to recreate the blob url when a track is added or\n            // removed. Doing it manually since we want to avoid a recursion.\n            stream.addEventListener('addtrack', function() {\n              if (self.src) {\n                URL.revokeObjectURL(self.src);\n              }\n              self.src = URL.createObjectURL(stream);\n            });\n            stream.addEventListener('removetrack', function() {\n              if (self.src) {\n                URL.revokeObjectURL(self.src);\n              }\n              self.src = URL.createObjectURL(stream);\n            });\n          }\n        });\n      }\n    }\n  },\n\n  shimAddTrackRemoveTrackWithNative: function(window) {\n    // shim addTrack/removeTrack with native variants in order to make\n    // the interactions with legacy getLocalStreams behave as in other browsers.\n    // Keeps a mapping stream.id => [stream, rtpsenders...]\n    window.RTCPeerConnection.prototype.getLocalStreams = function() {\n      var pc = this;\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams).map(function(streamId) {\n        return pc._shimmedLocalStreams[streamId][0];\n      });\n    };\n\n    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      var sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n    var origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function(stream) {\n      var pc = this;\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      stream.getTracks().forEach(function(track) {\n        var alreadyExists = pc.getSenders().find(function(s) {\n          return s.track === track;\n        });\n        if (alreadyExists) {\n          throw new DOMException('Track already exists.',\n              'InvalidAccessError');\n        }\n      });\n      var existingSenders = pc.getSenders();\n      origAddStream.apply(this, arguments);\n      var newSenders = pc.getSenders().filter(function(newSender) {\n        return existingSenders.indexOf(newSender) === -1;\n      });\n      this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n    };\n\n    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream = function(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n    var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n    window.RTCPeerConnection.prototype.removeTrack = function(sender) {\n      var pc = this;\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(function(streamId) {\n          var idx = pc._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            pc._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (pc._shimmedLocalStreams[streamId].length === 1) {\n            delete pc._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n  },\n\n  shimAddTrackRemoveTrack: function(window) {\n    if (!window.RTCPeerConnection) {\n      return;\n    }\n    var browserDetails = utils.detectBrowser(window);\n    // shim addTrack and removeTrack.\n    if (window.RTCPeerConnection.prototype.addTrack &&\n        browserDetails.version >= 65) {\n      return this.shimAddTrackRemoveTrackWithNative(window);\n    }\n\n    // also shim pc.getLocalStreams when addTrack is shimmed\n    // to return the original streams.\n    var origGetLocalStreams = window.RTCPeerConnection.prototype\n        .getLocalStreams;\n    window.RTCPeerConnection.prototype.getLocalStreams = function() {\n      var pc = this;\n      var nativeStreams = origGetLocalStreams.apply(this);\n      pc._reverseStreams = pc._reverseStreams || {};\n      return nativeStreams.map(function(stream) {\n        return pc._reverseStreams[stream.id];\n      });\n    };\n\n    var origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function(stream) {\n      var pc = this;\n      pc._streams = pc._streams || {};\n      pc._reverseStreams = pc._reverseStreams || {};\n\n      stream.getTracks().forEach(function(track) {\n        var alreadyExists = pc.getSenders().find(function(s) {\n          return s.track === track;\n        });\n        if (alreadyExists) {\n          throw new DOMException('Track already exists.',\n              'InvalidAccessError');\n        }\n      });\n      // Add identity mapping for consistency with addTrack.\n      // Unless this is being used with a stream from addTrack.\n      if (!pc._reverseStreams[stream.id]) {\n        var newStream = new window.MediaStream(stream.getTracks());\n        pc._streams[stream.id] = newStream;\n        pc._reverseStreams[newStream.id] = stream;\n        stream = newStream;\n      }\n      origAddStream.apply(pc, [stream]);\n    };\n\n    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream = function(stream) {\n      var pc = this;\n      pc._streams = pc._streams || {};\n      pc._reverseStreams = pc._reverseStreams || {};\n\n      origRemoveStream.apply(pc, [(pc._streams[stream.id] || stream)]);\n      delete pc._reverseStreams[(pc._streams[stream.id] ?\n          pc._streams[stream.id].id : stream.id)];\n      delete pc._streams[stream.id];\n    };\n\n    window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\n      var pc = this;\n      if (pc.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      var streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(function(t) {\n            return t === track;\n          })) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      var alreadyExists = pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n\n      pc._streams = pc._streams || {};\n      pc._reverseStreams = pc._reverseStreams || {};\n      var oldStream = pc._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(function() {\n          pc.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        var newStream = new window.MediaStream([track]);\n        pc._streams[stream.id] = newStream;\n        pc._reverseStreams[newStream.id] = stream;\n        pc.addStream(newStream);\n      }\n      return pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n    };\n\n    // replace the internal stream id with the external one and\n    // vice versa.\n    function replaceInternalStreamId(pc, description) {\n      var sdp = description.sdp;\n      Object.keys(pc._reverseStreams || []).forEach(function(internalId) {\n        var externalStream = pc._reverseStreams[internalId];\n        var internalStream = pc._streams[externalStream.id];\n        sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n            externalStream.id);\n      });\n      return new RTCSessionDescription({\n        type: description.type,\n        sdp: sdp\n      });\n    }\n    function replaceExternalStreamId(pc, description) {\n      var sdp = description.sdp;\n      Object.keys(pc._reverseStreams || []).forEach(function(internalId) {\n        var externalStream = pc._reverseStreams[internalId];\n        var internalStream = pc._streams[externalStream.id];\n        sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n            internalStream.id);\n      });\n      return new RTCSessionDescription({\n        type: description.type,\n        sdp: sdp\n      });\n    }\n    ['createOffer', 'createAnswer'].forEach(function(method) {\n      var nativeMethod = window.RTCPeerConnection.prototype[method];\n      window.RTCPeerConnection.prototype[method] = function() {\n        var pc = this;\n        var args = arguments;\n        var isLegacyCall = arguments.length &&\n            typeof arguments[0] === 'function';\n        if (isLegacyCall) {\n          return nativeMethod.apply(pc, [\n            function(description) {\n              var desc = replaceInternalStreamId(pc, description);\n              args[0].apply(null, [desc]);\n            },\n            function(err) {\n              if (args[1]) {\n                args[1].apply(null, err);\n              }\n            }, arguments[2]\n          ]);\n        }\n        return nativeMethod.apply(pc, arguments)\n        .then(function(description) {\n          return replaceInternalStreamId(pc, description);\n        });\n      };\n    });\n\n    var origSetLocalDescription =\n        window.RTCPeerConnection.prototype.setLocalDescription;\n    window.RTCPeerConnection.prototype.setLocalDescription = function() {\n      var pc = this;\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(pc, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(pc, arguments[0]);\n      return origSetLocalDescription.apply(pc, arguments);\n    };\n\n    // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n    var origLocalDescription = Object.getOwnPropertyDescriptor(\n        window.RTCPeerConnection.prototype, 'localDescription');\n    Object.defineProperty(window.RTCPeerConnection.prototype,\n        'localDescription', {\n          get: function() {\n            var pc = this;\n            var description = origLocalDescription.get.apply(this);\n            if (description.type === '') {\n              return description;\n            }\n            return replaceInternalStreamId(pc, description);\n          }\n        });\n\n    window.RTCPeerConnection.prototype.removeTrack = function(sender) {\n      var pc = this;\n      if (pc.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      var isLocal = sender._pc === pc;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n            'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      pc._streams = pc._streams || {};\n      var stream;\n      Object.keys(pc._streams).forEach(function(streamid) {\n        var hasTrack = pc._streams[streamid].getTracks().find(function(track) {\n          return sender.track === track;\n        });\n        if (hasTrack) {\n          stream = pc._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          pc.removeStream(pc._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        pc.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n  },\n\n  shimPeerConnection: function(window) {\n    var browserDetails = utils.detectBrowser(window);\n\n    // The RTCPeerConnection object.\n    if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        // Translate iceTransportPolicy to iceTransports,\n        // see https://code.google.com/p/webrtc/issues/detail?id=4869\n        // this was fixed in M56 along with unprefixing RTCPeerConnection.\n        logging('PeerConnection');\n        if (pcConfig && pcConfig.iceTransportPolicy) {\n          pcConfig.iceTransports = pcConfig.iceTransportPolicy;\n        }\n\n        return new window.webkitRTCPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype =\n          window.webkitRTCPeerConnection.prototype;\n      // wrap static methods. Currently just generateCertificate.\n      if (window.webkitRTCPeerConnection.generateCertificate) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function() {\n            return window.webkitRTCPeerConnection.generateCertificate;\n          }\n        });\n      }\n    }\n    if (!window.RTCPeerConnection) {\n      return;\n    }\n\n    var origGetStats = window.RTCPeerConnection.prototype.getStats;\n    window.RTCPeerConnection.prototype.getStats = function(selector,\n        successCallback, errorCallback) {\n      var pc = this;\n      var args = arguments;\n\n      // If selector is a function then we are in the old style stats so just\n      // pass back the original getStats format to avoid breaking old users.\n      if (arguments.length > 0 && typeof selector === 'function') {\n        return origGetStats.apply(this, arguments);\n      }\n\n      // When spec-style getStats is supported, return those when called with\n      // either no arguments or the selector argument is null.\n      if (origGetStats.length === 0 && (arguments.length === 0 ||\n          typeof arguments[0] !== 'function')) {\n        return origGetStats.apply(this, []);\n      }\n\n      var fixChromeStats_ = function(response) {\n        var standardReport = {};\n        var reports = response.result();\n        reports.forEach(function(report) {\n          var standardStats = {\n            id: report.id,\n            timestamp: report.timestamp,\n            type: {\n              localcandidate: 'local-candidate',\n              remotecandidate: 'remote-candidate'\n            }[report.type] || report.type\n          };\n          report.names().forEach(function(name) {\n            standardStats[name] = report.stat(name);\n          });\n          standardReport[standardStats.id] = standardStats;\n        });\n\n        return standardReport;\n      };\n\n      // shim getStats with maplike support\n      var makeMapStats = function(stats) {\n        return new Map(Object.keys(stats).map(function(key) {\n          return [key, stats[key]];\n        }));\n      };\n\n      if (arguments.length >= 2) {\n        var successCallbackWrapper_ = function(response) {\n          args[1](makeMapStats(fixChromeStats_(response)));\n        };\n\n        return origGetStats.apply(this, [successCallbackWrapper_,\n          arguments[0]]);\n      }\n\n      // promise-support\n      return new Promise(function(resolve, reject) {\n        origGetStats.apply(pc, [\n          function(response) {\n            resolve(makeMapStats(fixChromeStats_(response)));\n          }, reject]);\n      }).then(successCallback, errorCallback);\n    };\n\n    // add promise support -- natively available in Chrome 51\n    if (browserDetails.version < 51) {\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n          .forEach(function(method) {\n            var nativeMethod = window.RTCPeerConnection.prototype[method];\n            window.RTCPeerConnection.prototype[method] = function() {\n              var args = arguments;\n              var pc = this;\n              var promise = new Promise(function(resolve, reject) {\n                nativeMethod.apply(pc, [args[0], resolve, reject]);\n              });\n              if (args.length < 2) {\n                return promise;\n              }\n              return promise.then(function() {\n                args[1].apply(null, []);\n              },\n              function(err) {\n                if (args.length >= 3) {\n                  args[2].apply(null, [err]);\n                }\n              });\n            };\n          });\n    }\n\n    // promise support for createOffer and createAnswer. Available (without\n    // bugs) since M52: crbug/619289\n    if (browserDetails.version < 52) {\n      ['createOffer', 'createAnswer'].forEach(function(method) {\n        var nativeMethod = window.RTCPeerConnection.prototype[method];\n        window.RTCPeerConnection.prototype[method] = function() {\n          var pc = this;\n          if (arguments.length < 1 || (arguments.length === 1 &&\n              typeof arguments[0] === 'object')) {\n            var opts = arguments.length === 1 ? arguments[0] : undefined;\n            return new Promise(function(resolve, reject) {\n              nativeMethod.apply(pc, [resolve, reject, opts]);\n            });\n          }\n          return nativeMethod.apply(this, arguments);\n        };\n      });\n    }\n\n    // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          var nativeMethod = window.RTCPeerConnection.prototype[method];\n          window.RTCPeerConnection.prototype[method] = function() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          };\n        });\n\n    // support for addIceCandidate(null or undefined)\n    var nativeAddIceCandidate =\n        window.RTCPeerConnection.prototype.addIceCandidate;\n    window.RTCPeerConnection.prototype.addIceCandidate = function() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n  },\n\n  fixNegotiationNeeded: function(window) {\n    utils.wrapPeerConnectionEvent(window, 'negotiationneeded', function(e) {\n      var pc = e.target;\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n      return e;\n    });\n  },\n\n  shimGetDisplayMedia: function(window, getSourceId) {\n    if (!window.navigator || !window.navigator.mediaDevices ||\n        'getDisplayMedia' in window.navigator.mediaDevices) {\n      return;\n    }\n    // getSourceId is a function that returns a promise resolving with\n    // the sourceId of the screen/window/tab to be shared.\n    if (typeof getSourceId !== 'function') {\n      console.error('shimGetDisplayMedia: getSourceId argument is not ' +\n          'a function');\n      return;\n    }\n    window.navigator.mediaDevices.getDisplayMedia = function(constraints) {\n      return getSourceId(constraints)\n        .then(function(sourceId) {\n          var widthSpecified = constraints.video && constraints.video.width;\n          var heightSpecified = constraints.video && constraints.video.height;\n          var frameRateSpecified = constraints.video &&\n            constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3\n            }\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n    };\n    window.navigator.getDisplayMedia = function(constraints) {\n      utils.deprecated('navigator.getDisplayMedia',\n          'navigator.mediaDevices.getDisplayMedia');\n      return window.navigator.mediaDevices.getDisplayMedia(constraints);\n    };\n  }\n};\n\n},{\"../utils.js\":11,\"./getusermedia\":6}],6:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nvar utils = require('../utils.js');\nvar logging = utils.log;\n\n// Expose public methods.\nmodule.exports = function(window) {\n  var browserDetails = utils.detectBrowser(window);\n  var navigator = window && window.navigator;\n\n  var constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    var cc = {};\n    Object.keys(c).forEach(function(key) {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      var r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      var oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        var oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(function(mix) {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  var shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      var remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      var face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      var getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        var matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n          .then(function(devices) {\n            devices = devices.filter(function(d) {\n              return d.kind === 'videoinput';\n            });\n            var dev = devices.find(function(d) {\n              return matches.some(function(match) {\n                return d.label.toLowerCase().indexOf(match) !== -1;\n              });\n            });\n            if (!dev && devices.length && matches.indexOf('back') !== -1) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :\n                                                        {ideal: dev.deviceId};\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  var shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString: function() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, function(c) {\n      navigator.webkitGetUserMedia(c, onSuccess, function(e) {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n\n  navigator.getUserMedia = getUserMedia_;\n\n  // Returns the result of getUserMedia as a Promise.\n  var getUserMediaPromise_ = function(constraints) {\n    return new Promise(function(resolve, reject) {\n      navigator.getUserMedia(constraints, resolve, reject);\n    });\n  };\n\n  if (!navigator.mediaDevices) {\n    navigator.mediaDevices = {\n      getUserMedia: getUserMediaPromise_,\n      enumerateDevices: function() {\n        return new Promise(function(resolve) {\n          var kinds = {audio: 'audioinput', video: 'videoinput'};\n          return window.MediaStreamTrack.getSources(function(devices) {\n            resolve(devices.map(function(device) {\n              return {label: device.label,\n                kind: kinds[device.kind],\n                deviceId: device.id,\n                groupId: ''};\n            }));\n          });\n        });\n      },\n      getSupportedConstraints: function() {\n        return {\n          deviceId: true, echoCancellation: true, facingMode: true,\n          frameRate: true, height: true, width: true\n        };\n      }\n    };\n  }\n\n  // A shim for getUserMedia method on the mediaDevices object.\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\n  if (!navigator.mediaDevices.getUserMedia) {\n    navigator.mediaDevices.getUserMedia = function(constraints) {\n      return getUserMediaPromise_(constraints);\n    };\n  } else {\n    // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n    // function which returns a Promise, it does not accept spec-style\n    // constraints.\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, function(c) {\n        return origGetUserMedia(c).then(function(stream) {\n          if (c.audio && !stream.getAudioTracks().length ||\n              c.video && !stream.getVideoTracks().length) {\n            stream.getTracks().forEach(function(track) {\n              track.stop();\n            });\n            throw new DOMException('', 'NotFoundError');\n          }\n          return stream;\n        }, function(e) {\n          return Promise.reject(shimError_(e));\n        });\n      });\n    };\n  }\n\n  // Dummy devicechange event methods.\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\n  if (typeof navigator.mediaDevices.addEventListener === 'undefined') {\n    navigator.mediaDevices.addEventListener = function() {\n      logging('Dummy mediaDevices.addEventListener called.');\n    };\n  }\n  if (typeof navigator.mediaDevices.removeEventListener === 'undefined') {\n    navigator.mediaDevices.removeEventListener = function() {\n      logging('Dummy mediaDevices.removeEventListener called.');\n    };\n  }\n};\n\n},{\"../utils.js\":11}],7:[function(require,module,exports){\n/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\nvar utils = require('./utils');\n\nmodule.exports = {\n  shimRTCIceCandidate: function(window) {\n    // foundation is arbitrarily chosen as an indicator for full support for\n    // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n    if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n        window.RTCIceCandidate.prototype)) {\n      return;\n    }\n\n    var NativeRTCIceCandidate = window.RTCIceCandidate;\n    window.RTCIceCandidate = function(args) {\n      // Remove the a= which shouldn't be part of the candidate string.\n      if (typeof args === 'object' && args.candidate &&\n          args.candidate.indexOf('a=') === 0) {\n        args = JSON.parse(JSON.stringify(args));\n        args.candidate = args.candidate.substr(2);\n      }\n\n      if (args.candidate && args.candidate.length) {\n        // Augment the native candidate with the parsed fields.\n        var nativeCandidate = new NativeRTCIceCandidate(args);\n        var parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n        var augmentedCandidate = Object.assign(nativeCandidate,\n            parsedCandidate);\n\n        // Add a serializer that does not serialize the extra attributes.\n        augmentedCandidate.toJSON = function() {\n          return {\n            candidate: augmentedCandidate.candidate,\n            sdpMid: augmentedCandidate.sdpMid,\n            sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n            usernameFragment: augmentedCandidate.usernameFragment,\n          };\n        };\n        return augmentedCandidate;\n      }\n      return new NativeRTCIceCandidate(args);\n    };\n    window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n    // Hook up the augmented candidate in onicecandidate and\n    // addEventListener('icecandidate', ...)\n    utils.wrapPeerConnectionEvent(window, 'icecandidate', function(e) {\n      if (e.candidate) {\n        Object.defineProperty(e, 'candidate', {\n          value: new window.RTCIceCandidate(e.candidate),\n          writable: 'false'\n        });\n      }\n      return e;\n    });\n  },\n\n  // shimCreateObjectURL must be called before shimSourceObject to avoid loop.\n\n  shimCreateObjectURL: function(window) {\n    var URL = window && window.URL;\n\n    if (!(typeof window === 'object' && window.HTMLMediaElement &&\n          'srcObject' in window.HTMLMediaElement.prototype &&\n        URL.createObjectURL && URL.revokeObjectURL)) {\n      // Only shim CreateObjectURL using srcObject if srcObject exists.\n      return undefined;\n    }\n\n    var nativeCreateObjectURL = URL.createObjectURL.bind(URL);\n    var nativeRevokeObjectURL = URL.revokeObjectURL.bind(URL);\n    var streams = new Map(), newId = 0;\n\n    URL.createObjectURL = function(stream) {\n      if ('getTracks' in stream) {\n        var url = 'polyblob:' + (++newId);\n        streams.set(url, stream);\n        utils.deprecated('URL.createObjectURL(stream)',\n            'elem.srcObject = stream');\n        return url;\n      }\n      return nativeCreateObjectURL(stream);\n    };\n    URL.revokeObjectURL = function(url) {\n      nativeRevokeObjectURL(url);\n      streams.delete(url);\n    };\n\n    var dsc = Object.getOwnPropertyDescriptor(window.HTMLMediaElement.prototype,\n                                              'src');\n    Object.defineProperty(window.HTMLMediaElement.prototype, 'src', {\n      get: function() {\n        return dsc.get.apply(this);\n      },\n      set: function(url) {\n        this.srcObject = streams.get(url) || null;\n        return dsc.set.apply(this, [url]);\n      }\n    });\n\n    var nativeSetAttribute = window.HTMLMediaElement.prototype.setAttribute;\n    window.HTMLMediaElement.prototype.setAttribute = function() {\n      if (arguments.length === 2 &&\n          ('' + arguments[0]).toLowerCase() === 'src') {\n        this.srcObject = streams.get(arguments[1]) || null;\n      }\n      return nativeSetAttribute.apply(this, arguments);\n    };\n  },\n\n  shimMaxMessageSize: function(window) {\n    if (window.RTCSctpTransport || !window.RTCPeerConnection) {\n      return;\n    }\n    var browserDetails = utils.detectBrowser(window);\n\n    if (!('sctp' in window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n        get: function() {\n          return typeof this._sctp === 'undefined' ? null : this._sctp;\n        }\n      });\n    }\n\n    var sctpInDescription = function(description) {\n      var sections = SDPUtils.splitSections(description.sdp);\n      sections.shift();\n      return sections.some(function(mediaSection) {\n        var mLine = SDPUtils.parseMLine(mediaSection);\n        return mLine && mLine.kind === 'application'\n            && mLine.protocol.indexOf('SCTP') !== -1;\n      });\n    };\n\n    var getRemoteFirefoxVersion = function(description) {\n      // TODO: Is there a better solution for detecting Firefox?\n      var match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n      if (match === null || match.length < 2) {\n        return -1;\n      }\n      var version = parseInt(match[1], 10);\n      // Test for NaN (yes, this is ugly)\n      return version !== version ? -1 : version;\n    };\n\n    var getCanSendMaxMessageSize = function(remoteIsFirefox) {\n      // Every implementation we know can send at least 64 KiB.\n      // Note: Although Chrome is technically able to send up to 256 KiB, the\n      //       data does not reach the other peer reliably.\n      //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n      var canSendMaxMessageSize = 65536;\n      if (browserDetails.browser === 'firefox') {\n        if (browserDetails.version < 57) {\n          if (remoteIsFirefox === -1) {\n            // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n            // fragmentation.\n            canSendMaxMessageSize = 16384;\n          } else {\n            // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n            // messages. Thus, supporting ~2 GiB when sending.\n            canSendMaxMessageSize = 2147483637;\n          }\n        } else if (browserDetails.version < 60) {\n          // Currently, all FF >= 57 will reset the remote maximum message size\n          // to the default value when a data channel is created at a later\n          // stage. :(\n          // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n          canSendMaxMessageSize =\n            browserDetails.version === 57 ? 65535 : 65536;\n        } else {\n          // FF >= 60 supports sending ~2 GiB\n          canSendMaxMessageSize = 2147483637;\n        }\n      }\n      return canSendMaxMessageSize;\n    };\n\n    var getMaxMessageSize = function(description, remoteIsFirefox) {\n      // Note: 65536 bytes is the default value from the SDP spec. Also,\n      //       every implementation we know supports receiving 65536 bytes.\n      var maxMessageSize = 65536;\n\n      // FF 57 has a slightly incorrect default remote max message size, so\n      // we need to adjust it here to avoid a failure when sending.\n      // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n      if (browserDetails.browser === 'firefox'\n           && browserDetails.version === 57) {\n        maxMessageSize = 65535;\n      }\n\n      var match = SDPUtils.matchPrefix(description.sdp, 'a=max-message-size:');\n      if (match.length > 0) {\n        maxMessageSize = parseInt(match[0].substr(19), 10);\n      } else if (browserDetails.browser === 'firefox' &&\n                  remoteIsFirefox !== -1) {\n        // If the maximum message size is not present in the remote SDP and\n        // both local and remote are Firefox, the remote peer can receive\n        // ~2 GiB.\n        maxMessageSize = 2147483637;\n      }\n      return maxMessageSize;\n    };\n\n    var origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription = function() {\n      var pc = this;\n      pc._sctp = null;\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        var isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        var canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        var remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        var maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        var sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get: function() {\n            return maxMessageSize;\n          }\n        });\n        pc._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(pc, arguments);\n    };\n  },\n\n  shimSendThrowTypeError: function(window) {\n    if (!(window.RTCPeerConnection &&\n        'createDataChannel' in window.RTCPeerConnection.prototype)) {\n      return;\n    }\n\n    // Note: Although Firefox >= 57 has a native implementation, the maximum\n    //       message size can be reset for all data channels at a later stage.\n    //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n    function wrapDcSend(dc, pc) {\n      var origDataChannelSend = dc.send;\n      dc.send = function() {\n        var data = arguments[0];\n        var length = data.length || data.size || data.byteLength;\n        if (dc.readyState === 'open' &&\n            pc.sctp && length > pc.sctp.maxMessageSize) {\n          throw new TypeError('Message too large (can send a maximum of ' +\n            pc.sctp.maxMessageSize + ' bytes)');\n        }\n        return origDataChannelSend.apply(dc, arguments);\n      };\n    }\n    var origCreateDataChannel =\n      window.RTCPeerConnection.prototype.createDataChannel;\n    window.RTCPeerConnection.prototype.createDataChannel = function() {\n      var pc = this;\n      var dataChannel = origCreateDataChannel.apply(pc, arguments);\n      wrapDcSend(dataChannel, pc);\n      return dataChannel;\n    };\n    utils.wrapPeerConnectionEvent(window, 'datachannel', function(e) {\n      wrapDcSend(e.channel, e.target);\n      return e;\n    });\n  }\n};\n\n},{\"./utils\":11,\"sdp\":2}],8:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar utils = require('../utils');\n\nmodule.exports = {\n  shimGetUserMedia: require('./getusermedia'),\n  shimOnTrack: function(window) {\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n        window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function() {\n          return this._ontrack;\n        },\n        set: function(f) {\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n            this.removeEventListener('addstream', this._ontrackpoly);\n          }\n          this.addEventListener('track', this._ontrack = f);\n          this.addEventListener('addstream', this._ontrackpoly = function(e) {\n            e.stream.getTracks().forEach(function(track) {\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = {track: track};\n              event.transceiver = {receiver: event.receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            }.bind(this));\n          }.bind(this));\n        },\n        enumerable: true,\n        configurable: true\n      });\n    }\n    if (typeof window === 'object' && window.RTCTrackEvent &&\n        ('receiver' in window.RTCTrackEvent.prototype) &&\n        !('transceiver' in window.RTCTrackEvent.prototype)) {\n      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n        get: function() {\n          return {receiver: this.receiver};\n        }\n      });\n    }\n  },\n\n  shimSourceObject: function(window) {\n    // Firefox has supported mozSrcObject since FF22, unprefixed in 42.\n    if (typeof window === 'object') {\n      if (window.HTMLMediaElement &&\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n          get: function() {\n            return this.mozSrcObject;\n          },\n          set: function(stream) {\n            this.mozSrcObject = stream;\n          }\n        });\n      }\n    }\n  },\n\n  shimPeerConnection: function(window) {\n    var browserDetails = utils.detectBrowser(window);\n\n    if (typeof window !== 'object' || !(window.RTCPeerConnection ||\n        window.mozRTCPeerConnection)) {\n      return; // probably media.peerconnection.enabled=false in about:config\n    }\n    // The RTCPeerConnection object.\n    if (!window.RTCPeerConnection) {\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        if (browserDetails.version < 38) {\n          // .urls is not supported in FF < 38.\n          // create RTCIceServers with a single url.\n          if (pcConfig && pcConfig.iceServers) {\n            var newIceServers = [];\n            for (var i = 0; i < pcConfig.iceServers.length; i++) {\n              var server = pcConfig.iceServers[i];\n              if (server.hasOwnProperty('urls')) {\n                for (var j = 0; j < server.urls.length; j++) {\n                  var newServer = {\n                    url: server.urls[j]\n                  };\n                  if (server.urls[j].indexOf('turn') === 0) {\n                    newServer.username = server.username;\n                    newServer.credential = server.credential;\n                  }\n                  newIceServers.push(newServer);\n                }\n              } else {\n                newIceServers.push(pcConfig.iceServers[i]);\n              }\n            }\n            pcConfig.iceServers = newIceServers;\n          }\n        }\n        return new window.mozRTCPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype =\n          window.mozRTCPeerConnection.prototype;\n\n      // wrap static methods. Currently just generateCertificate.\n      if (window.mozRTCPeerConnection.generateCertificate) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function() {\n            return window.mozRTCPeerConnection.generateCertificate;\n          }\n        });\n      }\n\n      window.RTCSessionDescription = window.mozRTCSessionDescription;\n      window.RTCIceCandidate = window.mozRTCIceCandidate;\n    }\n\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          var nativeMethod = window.RTCPeerConnection.prototype[method];\n          window.RTCPeerConnection.prototype[method] = function() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          };\n        });\n\n    // support for addIceCandidate(null or undefined)\n    var nativeAddIceCandidate =\n        window.RTCPeerConnection.prototype.addIceCandidate;\n    window.RTCPeerConnection.prototype.addIceCandidate = function() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n\n    // shim getStats with maplike support\n    var makeMapStats = function(stats) {\n      var map = new Map();\n      Object.keys(stats).forEach(function(key) {\n        map.set(key, stats[key]);\n        map[key] = stats[key];\n      });\n      return map;\n    };\n\n    var modernStatsTypes = {\n      inboundrtp: 'inbound-rtp',\n      outboundrtp: 'outbound-rtp',\n      candidatepair: 'candidate-pair',\n      localcandidate: 'local-candidate',\n      remotecandidate: 'remote-candidate'\n    };\n\n    var nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n    window.RTCPeerConnection.prototype.getStats = function(\n      selector,\n      onSucc,\n      onErr\n    ) {\n      return nativeGetStats.apply(this, [selector || null])\n        .then(function(stats) {\n          if (browserDetails.version < 48) {\n            stats = makeMapStats(stats);\n          }\n          if (browserDetails.version < 53 && !onSucc) {\n            // Shim only promise getStats with spec-hyphens in type names\n            // Leave callback version alone; misc old uses of forEach before Map\n            try {\n              stats.forEach(function(stat) {\n                stat.type = modernStatsTypes[stat.type] || stat.type;\n              });\n            } catch (e) {\n              if (e.name !== 'TypeError') {\n                throw e;\n              }\n              // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n              stats.forEach(function(stat, i) {\n                stats.set(i, Object.assign({}, stat, {\n                  type: modernStatsTypes[stat.type] || stat.type\n                }));\n              });\n            }\n          }\n          return stats;\n        })\n        .then(onSucc, onErr);\n    };\n  },\n\n  shimSenderGetStats: function(window) {\n    if (!(typeof window === 'object' && window.RTCPeerConnection &&\n        window.RTCRtpSender)) {\n      return;\n    }\n    if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n      return;\n    }\n    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function() {\n        var pc = this;\n        var senders = origGetSenders.apply(pc, []);\n        senders.forEach(function(sender) {\n          sender._pc = pc;\n        });\n        return senders;\n      };\n    }\n\n    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function() {\n        var sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function() {\n      return this.track ? this._pc.getStats(this.track) :\n          Promise.resolve(new Map());\n    };\n  },\n\n  shimReceiverGetStats: function(window) {\n    if (!(typeof window === 'object' && window.RTCPeerConnection &&\n        window.RTCRtpSender)) {\n      return;\n    }\n    if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n      return;\n    }\n    var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers = function() {\n        var pc = this;\n        var receivers = origGetReceivers.apply(pc, []);\n        receivers.forEach(function(receiver) {\n          receiver._pc = pc;\n        });\n        return receivers;\n      };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', function(e) {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function() {\n      return this._pc.getStats(this.track);\n    };\n  },\n\n  shimRemoveStream: function(window) {\n    if (!window.RTCPeerConnection ||\n        'removeStream' in window.RTCPeerConnection.prototype) {\n      return;\n    }\n    window.RTCPeerConnection.prototype.removeStream = function(stream) {\n      var pc = this;\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(function(sender) {\n        if (sender.track && stream.getTracks().indexOf(sender.track) !== -1) {\n          pc.removeTrack(sender);\n        }\n      });\n    };\n  },\n\n  shimRTCDataChannel: function(window) {\n    // rename DataChannel to RTCDataChannel (native fix in FF60):\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n    if (window.DataChannel && !window.RTCDataChannel) {\n      window.RTCDataChannel = window.DataChannel;\n    }\n  },\n\n  shimGetDisplayMedia: function(window, preferredMediaSource) {\n    if (!window.navigator || !window.navigator.mediaDevices ||\n        'getDisplayMedia' in window.navigator.mediaDevices) {\n      return;\n    }\n    window.navigator.mediaDevices.getDisplayMedia = function(constraints) {\n      if (!(constraints && constraints.video)) {\n        var err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n    window.navigator.getDisplayMedia = function(constraints) {\n      utils.deprecated('navigator.getDisplayMedia',\n          'navigator.mediaDevices.getDisplayMedia');\n      return window.navigator.mediaDevices.getDisplayMedia(constraints);\n    };\n  }\n};\n\n},{\"../utils\":11,\"./getusermedia\":9}],9:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar utils = require('../utils');\nvar logging = utils.log;\n\n// Expose public methods.\nmodule.exports = function(window) {\n  var browserDetails = utils.detectBrowser(window);\n  var navigator = window && window.navigator;\n  var MediaStreamTrack = window && window.MediaStreamTrack;\n\n  var shimError_ = function(e) {\n    return {\n      name: {\n        InternalError: 'NotReadableError',\n        NotSupportedError: 'TypeError',\n        PermissionDeniedError: 'NotAllowedError',\n        SecurityError: 'NotAllowedError'\n      }[e.name] || e.name,\n      message: {\n        'The operation is insecure.': 'The request is not allowed by the ' +\n        'user agent or the platform in the current context.'\n      }[e.message] || e.message,\n      constraint: e.constraint,\n      toString: function() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  // getUserMedia constraints shim.\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\n    var constraintsToFF37_ = function(c) {\n      if (typeof c !== 'object' || c.require) {\n        return c;\n      }\n      var require = [];\n      Object.keys(c).forEach(function(key) {\n        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n          return;\n        }\n        var r = c[key] = (typeof c[key] === 'object') ?\n            c[key] : {ideal: c[key]};\n        if (r.min !== undefined ||\n            r.max !== undefined || r.exact !== undefined) {\n          require.push(key);\n        }\n        if (r.exact !== undefined) {\n          if (typeof r.exact === 'number') {\n            r. min = r.max = r.exact;\n          } else {\n            c[key] = r.exact;\n          }\n          delete r.exact;\n        }\n        if (r.ideal !== undefined) {\n          c.advanced = c.advanced || [];\n          var oc = {};\n          if (typeof r.ideal === 'number') {\n            oc[key] = {min: r.ideal, max: r.ideal};\n          } else {\n            oc[key] = r.ideal;\n          }\n          c.advanced.push(oc);\n          delete r.ideal;\n          if (!Object.keys(r).length) {\n            delete c[key];\n          }\n        }\n      });\n      if (require.length) {\n        c.require = require;\n      }\n      return c;\n    };\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (browserDetails.version < 38) {\n      logging('spec: ' + JSON.stringify(constraints));\n      if (constraints.audio) {\n        constraints.audio = constraintsToFF37_(constraints.audio);\n      }\n      if (constraints.video) {\n        constraints.video = constraintsToFF37_(constraints.video);\n      }\n      logging('ff37: ' + JSON.stringify(constraints));\n    }\n    return navigator.mozGetUserMedia(constraints, onSuccess, function(e) {\n      onError(shimError_(e));\n    });\n  };\n\n  // Returns the result of getUserMedia as a Promise.\n  var getUserMediaPromise_ = function(constraints) {\n    return new Promise(function(resolve, reject) {\n      getUserMedia_(constraints, resolve, reject);\n    });\n  };\n\n  // Shim for mediaDevices on older versions.\n  if (!navigator.mediaDevices) {\n    navigator.mediaDevices = {getUserMedia: getUserMediaPromise_,\n      addEventListener: function() { },\n      removeEventListener: function() { }\n    };\n  }\n  navigator.mediaDevices.enumerateDevices =\n      navigator.mediaDevices.enumerateDevices || function() {\n        return new Promise(function(resolve) {\n          var infos = [\n            {kind: 'audioinput', deviceId: 'default', label: '', groupId: ''},\n            {kind: 'videoinput', deviceId: 'default', label: '', groupId: ''}\n          ];\n          resolve(infos);\n        });\n      };\n\n  if (browserDetails.version < 41) {\n    // Work around http://bugzil.la/1169665\n    var orgEnumerateDevices =\n        navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);\n    navigator.mediaDevices.enumerateDevices = function() {\n      return orgEnumerateDevices().then(undefined, function(e) {\n        if (e.name === 'NotFoundError') {\n          return [];\n        }\n        throw e;\n      });\n    };\n  }\n  if (browserDetails.version < 49) {\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      return origGetUserMedia(c).then(function(stream) {\n        // Work around https://bugzil.la/802326\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(function(track) {\n            track.stop();\n          });\n          throw new DOMException('The object can not be found here.',\n                                 'NotFoundError');\n        }\n        return stream;\n      }, function(e) {\n        return Promise.reject(shimError_(e));\n      });\n    };\n  }\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    var remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    var nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      var nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        var obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      var nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    if (browserDetails.version < 44) {\n      return getUserMedia_(constraints, onSuccess, onError);\n    }\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n        'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n};\n\n},{\"../utils\":11}],10:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nvar utils = require('../utils');\n\nmodule.exports = {\n  shimLocalStreamsAPI: function(window) {\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.getLocalStreams = function() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n    }\n    if (!('getStreamById' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.getStreamById = function(id) {\n        var result = null;\n        if (this._localStreams) {\n          this._localStreams.forEach(function(stream) {\n            if (stream.id === id) {\n              result = stream;\n            }\n          });\n        }\n        if (this._remoteStreams) {\n          this._remoteStreams.forEach(function(stream) {\n            if (stream.id === id) {\n              result = stream;\n            }\n          });\n        }\n        return result;\n      };\n    }\n    if (!('addStream' in window.RTCPeerConnection.prototype)) {\n      var _addTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addStream = function(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        if (this._localStreams.indexOf(stream) === -1) {\n          this._localStreams.push(stream);\n        }\n        var pc = this;\n        stream.getTracks().forEach(function(track) {\n          _addTrack.call(pc, track, stream);\n        });\n      };\n\n      window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\n        if (stream) {\n          if (!this._localStreams) {\n            this._localStreams = [stream];\n          } else if (this._localStreams.indexOf(stream) === -1) {\n            this._localStreams.push(stream);\n          }\n        }\n        return _addTrack.call(this, track, stream);\n      };\n    }\n    if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.removeStream = function(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        var index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        var pc = this;\n        var tracks = stream.getTracks();\n        this.getSenders().forEach(function(sender) {\n          if (tracks.indexOf(sender.track) !== -1) {\n            pc.removeTrack(sender);\n          }\n        });\n      };\n    }\n  },\n  shimRemoteStreamsAPI: function(window) {\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.getRemoteStreams = function() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n    }\n    if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n        get: function() {\n          return this._onaddstream;\n        },\n        set: function(f) {\n          if (this._onaddstream) {\n            this.removeEventListener('addstream', this._onaddstream);\n          }\n          this.addEventListener('addstream', this._onaddstream = f);\n        }\n      });\n      var origSetRemoteDescription =\n          window.RTCPeerConnection.prototype.setRemoteDescription;\n      window.RTCPeerConnection.prototype.setRemoteDescription = function() {\n        var pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(function(stream) {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              var event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n    }\n  },\n  shimCallbacksAPI: function(window) {\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    var prototype = window.RTCPeerConnection.prototype;\n    var createOffer = prototype.createOffer;\n    var createAnswer = prototype.createAnswer;\n    var setLocalDescription = prototype.setLocalDescription;\n    var setRemoteDescription = prototype.setRemoteDescription;\n    var addIceCandidate = prototype.addIceCandidate;\n\n    prototype.createOffer = function(successCallback, failureCallback) {\n      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      var promise = createOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n    prototype.createAnswer = function(successCallback, failureCallback) {\n      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      var promise = createAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n    var withCallback = function(description, successCallback, failureCallback) {\n      var promise = setLocalDescription.apply(this, [description]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.setLocalDescription = withCallback;\n\n    withCallback = function(description, successCallback, failureCallback) {\n      var promise = setRemoteDescription.apply(this, [description]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.setRemoteDescription = withCallback;\n\n    withCallback = function(candidate, successCallback, failureCallback) {\n      var promise = addIceCandidate.apply(this, [candidate]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.addIceCandidate = withCallback;\n  },\n  shimGetUserMedia: function(window) {\n    var navigator = window && window.navigator;\n\n    if (!navigator.getUserMedia) {\n      if (navigator.webkitGetUserMedia) {\n        navigator.getUserMedia = navigator.webkitGetUserMedia.bind(navigator);\n      } else if (navigator.mediaDevices &&\n          navigator.mediaDevices.getUserMedia) {\n        navigator.getUserMedia = function(constraints, cb, errcb) {\n          navigator.mediaDevices.getUserMedia(constraints)\n          .then(cb, errcb);\n        }.bind(navigator);\n      }\n    }\n  },\n  shimRTCIceServerUrls: function(window) {\n    // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n    var OrigPeerConnection = window.RTCPeerConnection;\n    window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        var newIceServers = [];\n        for (var i = 0; i < pcConfig.iceServers.length; i++) {\n          var server = pcConfig.iceServers[i];\n          if (!server.hasOwnProperty('urls') &&\n              server.hasOwnProperty('url')) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n    window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n    // wrap static methods. Currently just generateCertificate.\n    if ('generateCertificate' in window.RTCPeerConnection) {\n      Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n        get: function() {\n          return OrigPeerConnection.generateCertificate;\n        }\n      });\n    }\n  },\n  shimTrackEventTransceiver: function(window) {\n    // Add event.transceiver member over deprecated event.receiver\n    if (typeof window === 'object' && window.RTCPeerConnection &&\n        ('receiver' in window.RTCTrackEvent.prototype) &&\n        // can't check 'transceiver' in window.RTCTrackEvent.prototype, as it is\n        // defined for some reason even when window.RTCTransceiver is not.\n        !window.RTCTransceiver) {\n      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n        get: function() {\n          return {receiver: this.receiver};\n        }\n      });\n    }\n  },\n\n  shimCreateOfferLegacy: function(window) {\n    var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n    window.RTCPeerConnection.prototype.createOffer = function(offerOptions) {\n      var pc = this;\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio = !!offerOptions.offerToReceiveAudio;\n        }\n        var audioTransceiver = pc.getTransceivers().find(function(transceiver) {\n          return transceiver.sender.track &&\n              transceiver.sender.track.kind === 'audio';\n        });\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          pc.addTransceiver('audio');\n        }\n\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo = !!offerOptions.offerToReceiveVideo;\n        }\n        var videoTransceiver = pc.getTransceivers().find(function(transceiver) {\n          return transceiver.sender.track &&\n              transceiver.sender.track.kind === 'video';\n        });\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            videoTransceiver.setDirection('sendonly');\n          } else if (videoTransceiver.direction === 'recvonly') {\n            videoTransceiver.setDirection('inactive');\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          pc.addTransceiver('video');\n        }\n      }\n      return origCreateOffer.apply(pc, arguments);\n    };\n  }\n};\n\n},{\"../utils\":11}],11:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar logDisabled_ = true;\nvar deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nfunction extractVersion(uastring, expr, pos) {\n  var match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nfunction wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var proto = window.RTCPeerConnection.prototype;\n  var nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    var wrappedCallback = function(e) {\n      var modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        cb(modifiedEvent);\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    this._eventMap[cb] = wrappedCallback;\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  var nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[cb]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    var unwrappedCb = this._eventMap[cb];\n    delete this._eventMap[cb];\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get: function() {\n      return this['_on' + eventNameToWrap];\n    },\n    set: function(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\n// Utility methods.\nmodule.exports = {\n  extractVersion: extractVersion,\n  wrapPeerConnectionEvent: wrapPeerConnectionEvent,\n  disableLog: function(bool) {\n    if (typeof bool !== 'boolean') {\n      return new Error('Argument type: ' + typeof bool +\n          '. Please use a boolean.');\n    }\n    logDisabled_ = bool;\n    return (bool) ? 'adapter.js logging disabled' :\n        'adapter.js logging enabled';\n  },\n\n  /**\n   * Disable or enable deprecation warnings\n   * @param {!boolean} bool set to true to disable warnings.\n   */\n  disableWarnings: function(bool) {\n    if (typeof bool !== 'boolean') {\n      return new Error('Argument type: ' + typeof bool +\n          '. Please use a boolean.');\n    }\n    deprecationWarnings_ = !bool;\n    return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n  },\n\n  log: function() {\n    if (typeof window === 'object') {\n      if (logDisabled_) {\n        return;\n      }\n      if (typeof console !== 'undefined' && typeof console.log === 'function') {\n        console.log.apply(console, arguments);\n      }\n    }\n  },\n\n  /**\n   * Shows a deprecation warning suggesting the modern and spec-compatible API.\n   */\n  deprecated: function(oldMethod, newMethod) {\n    if (!deprecationWarnings_) {\n      return;\n    }\n    console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n        ' instead.');\n  },\n\n  /**\n   * Browser detector.\n   *\n   * @return {object} result containing browser and version\n   *     properties.\n   */\n  detectBrowser: function(window) {\n    var navigator = window && window.navigator;\n\n    // Returned result object.\n    var result = {};\n    result.browser = null;\n    result.version = null;\n\n    // Fail early if it's not a browser\n    if (typeof window === 'undefined' || !window.navigator) {\n      result.browser = 'Not a browser.';\n      return result;\n    }\n\n    if (navigator.mozGetUserMedia) { // Firefox.\n      result.browser = 'firefox';\n      result.version = extractVersion(navigator.userAgent,\n          /Firefox\\/(\\d+)\\./, 1);\n    } else if (navigator.webkitGetUserMedia) {\n      // Chrome, Chromium, Webview, Opera.\n      // Version matches Chrome/WebRTC version.\n      result.browser = 'chrome';\n      result.version = extractVersion(navigator.userAgent,\n          /Chrom(e|ium)\\/(\\d+)\\./, 2);\n    } else if (navigator.mediaDevices &&\n        navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) { // Edge.\n      result.browser = 'edge';\n      result.version = extractVersion(navigator.userAgent,\n          /Edge\\/(\\d+).(\\d+)$/, 2);\n    } else if (window.RTCPeerConnection &&\n        navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n      result.browser = 'safari';\n      result.version = extractVersion(navigator.userAgent,\n          /AppleWebKit\\/(\\d+)\\./, 1);\n    } else { // Default fallthrough: not supported.\n      result.browser = 'Not a supported browser.';\n      return result;\n    }\n\n    return result;\n  }\n};\n\n},{}]},{},[3])(3)\n});\n","import { cloneDeep, find } from 'lodash/fp';\n\n/**\n * returns a function with params object\n * @param  {Array} An array of strings or objects representing the desired codecs to be removed,\n * can be passed in as a string or as objects with the following signature:\n *  [{\n *      name: 'codecname',\n *      fmtpParams: 'specific ftmp parameter target'\n *  }]\n * @return {Function}        [description]\n *\n * INSTRUCTIONS FOR EXPOSING FUNCTION TO UC VERSION OF THE SDK:\n * the following code will need to be added to the appropriate index files (ie: kandy.uc.js)\n * this will expose the createCodecRemover function in the browser\n    import createCodecRemover from '../../fcs/src/js/sdp/codecRemover';\n    kandy.sdpHandlers = {\n        createCodecRemover\n    };\n    module.exports = kandy;\n\n * INSTRUCTIONS USING RUNNING FUNCTION ONCE EXPOSED\n * From the browser Devtools run the following:\n * const codecRemover = createKandy.sdpHandlers.createCodecRemover(['VP8', 'VP9'])\n * const newSdp = codecRemover(<SDP Object>); // the incoming SDP object\n * console.log(newSdp)\n */\nexport default function createCodecRemover(config) {\n    if(!config){\n        config = [];\n    }\n    // We allow the user to pass in a config of objects or strings, so here we format the strings into objects for uniformity.\n    config = config.map(item => (typeof item === 'string' ? { name: item } : item));\n\n    return function(...params) {\n        // Adding support for new callstack sdp handlers\n        // Old callstack sdp pipeline passes an object to each sdp\n        // handler that contains the currentSdp\n        // New callstack passes 3 arguments to each sdp handler\n        // newSdp, info, originalSdp\n        let oldCallstack = true;\n        let currentSdp;\n        if (params[0].currentSdp) {\n            currentSdp = params[0].currentSdp;\n        } else if (params.length === 3) {\n            oldCallstack = false;\n            currentSdp = params[0];\n        }\n\n        let newSdp = cloneDeep(currentSdp);\n\n        // This is an array of strings representing codec names we want to remove.\n        let codecStringsToRemove = config.map(codec => codec.name);\n\n        newSdp.media.forEach(media => {\n            // This is an array of just the codes (codec payloads) that we FOR SURE want to remove.\n            let finalRemoveList = [];\n            // This is an array of RTP objects who have codecs that are the same as strings passed in via config.\n            let filteredRtp = [];\n\n            // If the current rtp.codec is in the codecStringsToRemove list, add the rtp to filteredRtp\n            filteredRtp = media.rtp.filter(rtp => codecStringsToRemove.includes(rtp.codec));\n\n            filteredRtp.forEach(rtp => {\n                // We grab the relevantCodec config object from the passed in config, based on the name string.\n                const relevantCodec = find(codec => codec.name === rtp.codec, config);\n\n                // We check the relevantCodec. If it is not present, then we have no config info for this specific rtp.\n                if (relevantCodec) {\n                    // If fmtpParams doesnt exist or is of length 0 then we assume we can remove all instances of this codec\n                    if (\n                        !relevantCodec.fmtpParams ||\n                        (relevantCodec.fmtpParams && relevantCodec.fmtpParams.length === 0)\n                    ) {\n                        // We want to delete this codec no matter what, since no fmtp params were included.\n                        finalRemoveList.push(rtp.payload);\n                    } else {\n                        // There are fmtp values for this codec. Therefore we have to check each media.fmtp object to see if it is the right one.\n                        // Then when we find the right fmtp object, we check its config to see if it has the parameters specified in the input.\n                        media.fmtp.forEach(fmtp => {\n                            // We check each iteration to see if we found the right fmtp object.\n                            if (fmtp.payload === rtp.payload) {\n                                // If we found the right fmtp object, we have to make sure each config param is in the fmtp.config.\n                                if (relevantCodec.fmtpParams.every(c => fmtp.config.includes(c))) {\n                                    finalRemoveList.push(rtp.payload);\n                                }\n                            }\n                        });\n                    }\n                }\n            });\n\n            // At this point we should have an array (finalRemoveList) that contains all ORIGINAL codec payloads that we need to remove.\n            // We now need to check fmtp for all rtx payloads ASSOCIATED with the original codec payload.\n            media.fmtp.forEach(fmtp => {\n                // Check if the config contains apt=, which indicates this fmtp is associated with another.\n                if (fmtp.config.includes('apt=')) {\n                    // If so, lets grab the whole string WITHOUT the apt= part, and convet it into an integer. This should be a payload number.\n                    var payload = parseInt(fmtp.config.replace('apt=', ''));\n\n                    // Check if the finalRemoveList contains the payload that this fmtp is associated with.\n                    if (finalRemoveList.includes(payload)) {\n                        // If so, then we need to add this fmtp.payload to the finalRemoveList\n                        finalRemoveList.push(fmtp.payload);\n                    }\n                }\n            });\n\n            // We assume past this point that the finalRemoveList is all powerful.\n            // For each codec in the media.payloads string, if it is in our finalRemoveList list, we remove it.\n            let isNumber = false;\n            if (typeof media.payloads === 'number') {\n                media.payloads = media.payloads.toString();\n                isNumber = true;\n            }\n            if (media.payloads) {\n                media.payloads = media.payloads\n                    .split(' ')\n                    .filter(payload => !finalRemoveList.includes(parseInt(payload)))\n                    .join(' ');\n            }\n            if (media.payloads && isNumber) {\n                media.payloads = parseInt(media.payloads);\n            }\n\n            // For each codec object, if the payload is in our filteredCodes list, we remove the object.\n            if (media.rtp) {\n                media.rtp = media.rtp.filter(rtp => !finalRemoveList.includes(rtp.payload));\n            }\n\n            if (media.fmtp) {\n                media.fmtp = media.fmtp.filter(fmtp => !finalRemoveList.includes(fmtp.payload));\n            }\n            if (media.rtcpFb) {\n                media.rtcpFb = media.rtcpFb.filter(\n                    rtcpFb => !finalRemoveList.includes(rtcpFb.payload)\n                );\n            }\n        });\n\n        // If old callstack, then return the results of the next sdp handler\n        // If new callstack, then just return the modified sdp\n        return oldCallstack ? params[0].next(newSdp) : newSdp;\n    };\n}\n","'use strict';\nconst strictUriEncode = require('strict-uri-encode');\nconst decodeComponent = require('decode-uri-component');\nconst splitOnFirst = require('split-on-first');\n\nfunction encoderForArrayFormat(options) {\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tconst index = result.length;\n\t\t\t\tif (value === undefined) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[', index, ']'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [\n\t\t\t\t\t...result,\n\t\t\t\t\t[encode(key, options), '[', encode(index, options), ']=', encode(value, options)].join('')\n\t\t\t\t];\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (value === undefined) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[]'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '[]=', encode(value, options)].join('')];\n\t\t\t};\n\n\t\tcase 'comma':\n\t\t\treturn key => (result, value, index) => {\n\t\t\t\tif (value === null || value === undefined || value.length === 0) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (index === 0) {\n\t\t\t\t\treturn [[encode(key, options), '=', encode(value, options)].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [[result, encode(value, options)].join(',')];\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (value === undefined) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, encode(key, options)];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '=', encode(value, options)].join('')];\n\t\t\t};\n\t}\n}\n\nfunction parserForArrayFormat(options) {\n\tlet result;\n\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /\\[(\\d*)\\]$/.exec(key);\n\n\t\t\t\tkey = key.replace(/\\[\\d*\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = {};\n\t\t\t\t}\n\n\t\t\t\taccumulator[key][result[1]] = value;\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /(\\[\\])$/.exec(key);\n\t\t\t\tkey = key.replace(/\\[\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\n\t\tcase 'comma':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tconst isArray = typeof value === 'string' && value.split('').indexOf(',') > -1;\n\t\t\t\tconst newValue = isArray ? value.split(',') : value;\n\t\t\t\taccumulator[key] = newValue;\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\t}\n}\n\nfunction encode(value, options) {\n\tif (options.encode) {\n\t\treturn options.strict ? strictUriEncode(value) : encodeURIComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction decode(value, options) {\n\tif (options.decode) {\n\t\treturn decodeComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction keysSorter(input) {\n\tif (Array.isArray(input)) {\n\t\treturn input.sort();\n\t}\n\n\tif (typeof input === 'object') {\n\t\treturn keysSorter(Object.keys(input))\n\t\t\t.sort((a, b) => Number(a) - Number(b))\n\t\t\t.map(key => input[key]);\n\t}\n\n\treturn input;\n}\n\nfunction removeHash(input) {\n\tconst hashStart = input.indexOf('#');\n\tif (hashStart !== -1) {\n\t\tinput = input.slice(0, hashStart);\n\t}\n\n\treturn input;\n}\n\nfunction extract(input) {\n\tinput = removeHash(input);\n\tconst queryStart = input.indexOf('?');\n\tif (queryStart === -1) {\n\t\treturn '';\n\t}\n\n\treturn input.slice(queryStart + 1);\n}\n\nfunction parse(input, options) {\n\toptions = Object.assign({\n\t\tdecode: true,\n\t\tarrayFormat: 'none'\n\t}, options);\n\n\tconst formatter = parserForArrayFormat(options);\n\n\t// Create an object with no prototype\n\tconst ret = Object.create(null);\n\n\tif (typeof input !== 'string') {\n\t\treturn ret;\n\t}\n\n\tinput = input.trim().replace(/^[?#&]/, '');\n\n\tif (!input) {\n\t\treturn ret;\n\t}\n\n\tfor (const param of input.split('&')) {\n\t\tlet [key, value] = splitOnFirst(param.replace(/\\+/g, ' '), '=');\n\n\t\t// Missing `=` should be `null`:\n\t\t// http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\t\tvalue = value === undefined ? null : decode(value, options);\n\n\t\tformatter(decode(key, options), value, ret);\n\t}\n\n\treturn Object.keys(ret).sort().reduce((result, key) => {\n\t\tconst value = ret[key];\n\t\tif (Boolean(value) && typeof value === 'object' && !Array.isArray(value)) {\n\t\t\t// Sort object keys, not values\n\t\t\tresult[key] = keysSorter(value);\n\t\t} else {\n\t\t\tresult[key] = value;\n\t\t}\n\n\t\treturn result;\n\t}, Object.create(null));\n}\n\nexports.extract = extract;\nexports.parse = parse;\n\nexports.stringify = (object, options) => {\n\tif (!object) {\n\t\treturn '';\n\t}\n\n\toptions = Object.assign({\n\t\tencode: true,\n\t\tstrict: true,\n\t\tarrayFormat: 'none'\n\t}, options);\n\n\tconst formatter = encoderForArrayFormat(options);\n\tconst keys = Object.keys(object);\n\n\tif (options.sort !== false) {\n\t\tkeys.sort(options.sort);\n\t}\n\n\treturn keys.map(key => {\n\t\tconst value = object[key];\n\n\t\tif (value === undefined) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (value === null) {\n\t\t\treturn encode(key, options);\n\t\t}\n\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value\n\t\t\t\t.reduce(formatter(key), [])\n\t\t\t\t.join('&');\n\t\t}\n\n\t\treturn encode(key, options) + '=' + encode(value, options);\n\t}).filter(x => x.length > 0).join('&');\n};\n\nexports.parseUrl = (input, options) => {\n\treturn {\n\t\turl: removeHash(input).split('?')[0] || '',\n\t\tquery: parse(extract(input), options)\n\t};\n};\n","'use strict';\nmodule.exports = str => encodeURIComponent(str).replace(/[!'()*]/g, x => `%${x.charCodeAt(0).toString(16).toUpperCase()}`);\n","/**\n * Possible subscription states.\n * @name SUBSCRIPTION_STATE\n * @type {Object}\n */\nexport const SUBSCRIPTION_STATE = {\n  FULL: 'FULL',\n  PARTIAL: 'PARTIAL',\n  NONE: 'NONE'\n}\n\n/**\n * Possible disconnect reasons.\n * @name DISCONNECT_REASONS\n * @type {Object}\n */\nexport const DISCONNECT_REASONS = {\n  GONE: 'GONE',\n  LOST_CONNECTION: 'LOST_CONNECTION'\n}\n","// Redux-Saga\nimport { put } from 'redux-saga/effects'\n// Events\nimport eventsMap from '../interface/events'\nimport { mapEvents } from '../../events/interface/actions'\n\nimport { getLogManager } from '../../logs'\n\n// The interface to follow.\nimport { api, reducer, name } from '../interface'\n\n// State setters.\nimport { update as updateConfig } from '../../config/interface/actions'\n\n// Utilities.\nimport { mergeValues } from '../../common/utils'\n\n/**\n * selector for exposed authentication state\n */\nimport { getExposedState } from '../interface/selectors'\n\nconst log = getLogManager().getLogger('AUTH')\n\n/**\n * Configuration options for the Authentication feature.\n * @public\n * @name config.authentication\n * @memberof config\n * @instance\n * @param {Object} authentication Authentication configs.\n * @param {Object} authentication.server Information for how to reach the platform.\n * @param {string} authentication.server.base Server to be used for requests.\n * @param {string} [authentication.server.protocol=https] Protocol to be used for requests.\n * @param {Number} [authentication.server.port=443] Port to be used for requests.\n * @param {string} [authentication.server.version=v1] Version of the REST API to be used.\n * @param {string} authentication.clientCorrelator Unique ID for the client. This is required by the platform to identify an instance of the application used by the specific device.\n */\n\n/**\n * CPaaS authentication implementation factory.\n * @method authCpaas\n * @param {Object} options - Configuration options for authentication. See above.\n * @return {Object} plugin - An authentication plugin.\n */\nexport default function authCpaas (options = {}) {\n  const defaultOptions = {\n    server: {\n      protocol: 'https',\n      base: undefined,\n      version: 'v1',\n      port: '443'\n    },\n    clientCorrelator: undefined\n  }\n\n  options = mergeValues(defaultOptions, options)\n\n  if (!options.server.base || !options.clientCorrelator) {\n    log.error('Missing required configurations. Please provide proper authentication configurations.')\n  }\n\n  function * init () {\n    // Send the provided options to the store.\n    // This will be `state.config[name]`.\n    yield put(updateConfig(options, name))\n    yield put(mapEvents(eventsMap))\n  }\n\n  const capabilities = ['cpaasAuth']\n\n  return {\n    capabilities,\n    init,\n    api,\n    selector: getExposedState,\n    reducer,\n    name\n  }\n}\n","const prefix = '@@KANDY/'\n\nexport const CONNECT = prefix + 'CONNECT'\nexport const CONNECTION_OCCURRED = prefix + 'CONNECTION_OCCURRED'\nexport const CONNECT_FINISHED = prefix + 'CONNECT_FINISHED'\nexport const GET_USER_DETAILS = prefix + 'GET_USER_DETAILS'\nexport const USER_DETAILS_RECEIVED = prefix + 'USER_DETAILS_RECEIVED'\nexport const DISCONNECT = prefix + 'DISCONNECT'\nexport const DISCONNECT_FINISHED = prefix + 'DISCONNECT_FINISHED'\nexport const RESUBSCRIPTION_FINISHED = prefix + 'RESUBSCRIPTION_FINISHED'\nexport const REFRESH_TOKENS = prefix + 'REFRESH_TOKENS'\nexport const REFRESH_TOKENS_FINISHED = prefix + 'REFRESH_TOKENS_FINISHED'\n\nexport const UPDATE_SUBSCRIPTION = prefix + 'UPDATE_SUBSCRIPTION'\nexport const UPDATE_SUBSCRIPTION_FINISH = prefix + 'UPDATE_SUBSCRIPTION_FINISH'\n\nexport const SET_TOKEN = prefix + 'SET_TOKEN'\n","import * as actionTypes from './actionTypes'\n\n/**\n * Creates a connect action that takes a credentials object.\n *\n * @method connect\n * @param {Object} credentials The credentials to pass to the connect action.\n * @return {Object} A flux standard action.\n */\nexport function connect (credentials) {\n  return {\n    type: actionTypes.CONNECT,\n    payload: { credentials },\n    meta: {\n      isSensitive: true\n    }\n  }\n}\n\n/**\n * Connection Occured action.\n * Signifies that a connection has been made to a service, but that the connection\n *      workflow has not finished yet. Intended for use in scenarios where the\n *      workflow connects to multiple services, to represent the \"intermediate\"\n *      connections.\n *\n * @method connectionOccured\n * @param  {Object} $0\n * @param  {Object} $0.subscription\n * @param  {Object} $0.connection\n * @param  {Object} [$0.error] An error message. Only present if an error occured.\n * @param  {string} platform The backend platform used for the connection.\n * @return {Object} A flux standard action.\n */\nexport function connectionOccured ({ subscription, connection, error }, platform) {\n  var action = {\n    type: actionTypes.CONNECTION_OCCURRED,\n    meta: { platform }\n  }\n\n  if (error) {\n    action.error = true\n    action.payload = error\n  } else {\n    action.payload = { subscription, connection }\n  }\n\n  return action\n}\n\n/**\n * Create a connect finished action that takes a userInfo object on success and possibly\n * an error object.\n *\n * @method connectFinished\n * @param {Object} $0\n * @param {Object} $0.subscription A subscription object. Contains what services to subscribe to.\n * @param {Object} $0.userInfo An object representing the user information.\n * @param {Object} $0.connection A connection object. Information about how to connect to the backend services.\n * @param {string} [$0.error] An error message. Only present if an error occured.\n * @param {string} platform The backend platform we are currently on.\n * @param {boolean} isSSO Boolean for whether the current connection scenario is SSO or not.\n * @return {Object} A flux standard action.\n */\nexport function connectFinished ({ subscription, userInfo, connection, error }, platform, isSSO = false) {\n  var action = {\n    type: actionTypes.CONNECT_FINISHED,\n    meta: {\n      platform,\n      isSSO,\n      isSensitive: true\n    }\n  }\n\n  if (error) {\n    action.error = true\n    action.payload = error\n  } else {\n    action.payload = { subscription, userInfo, connection }\n  }\n\n  return action\n}\n\n/**\n * Creates a getUserDetails action\n *\n * @method getUserDetails\n * @return {Object} A flux standard action.\n */\nexport function getUserDetails () {\n  return { type: actionTypes.GET_USER_DETAILS }\n}\n\n/**\n * Create a user details received action\n *\n * @method userDetailsReceived\n * @param  {Object} userDetailsResponse An object representing the REST response of a user details request.\n * @return {Object} A flux standard action.\n */\nexport function userDetailsReceived (userDetailsResponse) {\n  var action = {\n    type: actionTypes.USER_DETAILS_RECEIVED,\n    payload: {\n      firstName: userDetailsResponse.firstName || userDetailsResponse.user_first_name,\n      user_first_name: userDetailsResponse.user_first_name || userDetailsResponse.firstName,\n      lastName: userDetailsResponse.lastName || userDetailsResponse.user_last_name,\n      user_last_name: userDetailsResponse.user_last_name || userDetailsResponse.lastName,\n      photoURL: userDetailsResponse.photoURL,\n      emailAddress: userDetailsResponse.emailAddress || userDetailsResponse.user_email,\n      user_email: userDetailsResponse.user_email || userDetailsResponse.emailAddress,\n      username: userDetailsResponse.username\n    }\n  }\n\n  return action\n}\n\n/**\n * Creates a disconnect action.\n *\n * @method disconnect\n * @return {Object} A flux standard action.\n */\nexport function disconnect () {\n  return { type: actionTypes.DISCONNECT }\n}\n\n/**\n * Create a disconnectFinished action that possibly takes an error object on failure.\n *\n * @method disconnectFinished\n * @param {Object} params\n * @param {string} [params.error] An error message. Only present if an error occurred.\n * @param {string} [params.reason] Why the disconnectFinished action is being dispatched.\n * @return {Object} A flux standard action.\n */\nexport function disconnectFinished ({ error, reason } = {}) {\n  let action = {\n    type: actionTypes.DISCONNECT_FINISHED,\n    payload: {}\n  }\n\n  if (error) {\n    action.error = true\n    action.payload = error\n  }\n\n  if (reason) {\n    action.payload.reason = reason\n  }\n\n  return action\n}\n\n/**\n * Action creator representing the finish of a resubscription request.\n * Payload mirrors a connect finished action.\n *\n * @method resubscribeFinished\n * @param {Object} $0\n * @param {string} [$0.error] An error message. Only present if an error occured.\n * @param {string} [$0.attemptNum] The attempt number of this resubscription.\n * @param {string} platform The backend platform we are currently on.\n * @return {Object} A flux standard action.\n */\nexport function resubscribeFinished ({ error, attemptNum }, platform) {\n  var action = {\n    type: actionTypes.RESUBSCRIPTION_FINISHED,\n    meta: { platform }\n  }\n\n  if (error) {\n    action.error = true\n    action.payload = error\n    action.payload.attemptNum = attemptNum\n  } else {\n    action.payload = {\n      attemptNum\n    }\n  }\n\n  return action\n}\n\n/**\n * Creates a refreshTokens action with the given credentials as a payload.\n *\n * @method refreshTokens\n * @param {Object} credentials A crendetials object containing tokens.\n * @return {Object} A flux standard action.\n */\nexport function refreshTokens (credentials) {\n  var action = {\n    type: actionTypes.REFRESH_TOKENS,\n    payload: { credentials }\n  }\n  return action\n}\n\n/**\n * Creates a refreshTokensFinished action with connection and platform information.\n * Optionally includes an error.\n *\n * @method refreshTokensFinished\n * @param {Object} $0\n * @param {Object} [$0.error] An optional error object.\n * @param {Object} $0.connection Connection information.\n * @param {string} platform The backend platform we are currently on.\n * @return {Object} A flux standard action.\n */\nexport function refreshTokensFinished ({ error, connection }, platform) {\n  var action = {\n    type: actionTypes.REFRESH_TOKENS_FINISHED,\n    payload: { connection },\n    meta: { platform }\n  }\n  if (error) {\n    action.error = true\n    action.payload = error\n  }\n\n  return action\n}\n\n/**\n * Represents a request to update a current subscription.\n * @method updateSubscription\n * @param  {Object} subscription Information used to update subscription.\n * @return {Object} A flux standard action.\n */\nexport function updateSubscription (subscription) {\n  return {\n    type: actionTypes.UPDATE_SUBSCRIPTION,\n    payload: subscription\n  }\n}\n\n/**\n * Represents that the current subscription has been updated.\n * @method updateSubscriptionFinished\n * @param  {Object} $0\n * @param  {Object} $0.subscription New subscription state to be updated.\n * @param  {Object} [$0.error] Error object, in the case of an error.\n * @param  {string} platform The backend platform used for the subscription.\n * @return {Object} A flux standard action.\n */\nexport function updateSubscriptionFinished ({ subscription, error }, platform) {\n  var action = {\n    type: actionTypes.UPDATE_SUBSCRIPTION_FINISH,\n    meta: { platform }\n  }\n\n  if (error) {\n    action.error = true\n    action.payload = error\n  } else {\n    action.payload = subscription\n  }\n  return action\n}\n\n/**\n * Sets the token information in the state.\n * @method setTokens\n * @param {Object} params Dictionary object of parameters.\n * @param {string} accessToken An access token retrieved using the authentication APIs of the platform.\n * @param {string} idToken An identity token retrieved using the authentication APIs of the platform.\n * @return {Object} A flux standard action.\n */\nexport function setTokens ({ accessToken, idToken }) {\n  return {\n    type: actionTypes.SET_TOKEN,\n    payload: { accessToken, idToken }\n  }\n}\n","import * as actions from './actions'\nimport { getUserInfo as selectUserInfo, getServices } from './selectors'\nimport { SUBSCRIPTION_STATE, DISCONNECT_REASONS } from '../constants'\n\nimport { getLogManager, API_LOG_TAG } from '../../logs'\nconst log = getLogManager().getLogger('AUTH')\n\n/**\n * Authentication API.\n * @method api\n * @param  {Function} $0\n * @param  {Function} $0.dispatch - The redux store's dispatch function.\n * @param  {Function} $0.getState - The redux store's getState function.\n * @return {Object} api - The authentication API object.\n */\nexport default function api ({ dispatch, getState }) {\n  return {\n    /**\n     * Connect with user credentials to any backend services that the SDK instance deals with.\n     *\n     * @public\n     * @memberof api\n     * @requires userCredentialsAuth\n     * @method connect\n     * @param {Object} credentials The credentials object.\n     * @param {string} credentials.username The username including the application's domain.\n     * @param {string} credentials.password The user's password.\n     * @param {string} [credentials.authname] The user's authorization name.\n     * @example\n     * client.connect({\n     *   username: 'alfred@example.com',\n     *   password: '********'\n     *   authname: '********'\n     * });\n     */\n    /**\n     * Connect with user credentials to any backend services that the SDK instance deals with.\n     *\n     * @public\n     * @memberof api\n     * @requires userCredentialsDAKAuth\n     * @method connect\n     * @param {Object} credentials The credentials object.\n     * @param {string} credentials.domainApiKey The Api key for the application's domain.\n     * @param {string} credentials.username The username without the application's domain.\n     * @param {string} credentials.password The user's password.\n     * @example\n     * client.connect({\n     *   domainApiKey: 'DAK1111111111111111111',\n     *   username: 'alfred',\n     *   password: '********'\n     * });\n     */\n    /**\n     * Connect by providing an access token to any backend services that the SDK instance deals with.\n     * You can optionally provide a refresh token and the SDK will automatically get new access tokens.\n     *\n     * @public\n     * @memberof api\n     * @requires accessTokenAuth\n     * @method connect\n     * @param {Object} credentials The credentials object.\n     * @param {string} credentials.username The username without the application's domain.\n     * @param {string} credentials.accessToken An access token for the user with the provided user Id.\n     * @param {string} [credentials.refreshToken] A refresh token for the same user.\n     * @param {number} [credentials.expires] The time in seconds until the access token will expire.\n     * @example\n     * client.connect({\n     *   username: 'alfred@example.com',\n     *   accessToken: 'AT0V1fswAiJadokx1iJMQdG04pRf',\n     *   refreshToken: 'RTG9SV3QAoJaeUSEQCZAHqrhde1yT',\n     *   expires: 3600\n     * });\n     */\n    /**\n     * Connect by providing a username and HMAC token. This connects to any backend services that the SDK instance deals with.\n     * An HMAC token is used to verify a user via the user's authorization within an organization.\n     * HMAC tokens are generated by using the HmacSHA1 algorithm and a key on a data object\n     * containing an `authenticationTokenRequest` object with the following properties:\n     * - subscriberId - The user's subscriber ID in the organization.\n     * - organizationId - The ID of the organization the user is a part of.\n     *\n     * @public\n     * @memberof api\n     * @requires hmacTokenAuth\n     * @method connect\n     * @param {Object} credentials The credentials object.\n     * @param {string} credentials.username The username.\n     * @param {string} credentials.hmacToken An HMAC token for the user with the provided user ID.\n     * @example\n     * const hmacToken = HmacSHA1Algorithm({\n     *   authenticationTokenRequest: {\n     *     subscriberId: 'alfred',\n     *     organizationId: 'example.com'\n     *   }\n     * }, key)\n     *\n     * client.connect({\n     *   username: 'alfred@example.com',\n     *   hmacToken\n     * })\n     */\n    /**\n     * Connect by providing a refresh token, to any backend services that the SDK instance deals with.\n     *\n     * @public\n     * @memberof api\n     * @requires accessTokenAuth\n     * @method connect\n     * @param {Object} credentials The credentials object.\n     * @param {string} credentials.username The username without the application's domain.\n     * @param {string} credentials.refreshToken A refresh token for the same user.\n     * @param {number} [credentials.expires] The time in seconds until the access token will expire.\n     * @example\n     * client.connect({\n     *   username: 'alfred@example.com',\n     *   refreshToken: 'RTG9SV3QAoJaeUSEQCZAHqrhde1yT'\n     *   expires: 3600\n     * });\n     */\n    /**\n     * Connect by providing an OAuth token, to any backend services that the SDK instance deals with.\n     *\n     * @public\n     * @memberof api\n     * @requires oauthToken\n     * @method connect\n     * @param {Object} credentials The credentials object.\n     * @param {string} credentials.username The username without the application's domain.\n     * @param {string} credentials.oauthToken An OAuth token provided by an outside service.\n     * @example\n     * client.connect({\n     *   username: 'alfred@example.com',\n     *   oauthToken: 'RTG9SV3QAoJaeUSEQCZAHqrhde1yT'\n     * });\n     */\n    connect (credentials) {\n      // We won't expose oauthToken because it essentially acts as a password being used in conjunction with username\n      // ..and passwords should NOT be logged.\n      log.debug(API_LOG_TAG + 'connect: ', credentials.username)\n      dispatch(actions.connect(credentials))\n    },\n\n    /**\n     * Disconnects from the backend. This will close the websocket and you will stop receiving events.\n     *\n     * @public\n     * @requires userCredentialsAuth\n     * @requires userCredentialsDAKAuth\n     * @requires accessTokenAuth\n     * @memberof api\n     * @method disconnect\n     */\n    disconnect () {\n      log.debug(API_LOG_TAG + 'disconnect')\n      dispatch(actions.disconnect())\n    },\n\n    /**\n     * If you're authenticating with tokens that expire and have not provided a refresh token to the `connect` function, you can update your access token with `updateToken` before it expires to stay connected.\n     *\n     * @public\n     * @memberof api\n     * @requires accessTokenAuth\n     * @param {Object} credentials The credentials object.\n     * @param {string} credentials.accessToken The new access token.\n     * @method updateToken\n     * @param {Object} credentials The credentials object.\n     * @param {string} credentials.username The username without the application's domain.\n     * @param {string} credentials.accessToken An access token for the user with the provided user Id.\n     */\n    /**\n     * If you're authenticating with tokens that expire and have not provided a refresh token to the `connect` function, you can update your access token with `updateToken` before it expires to stay connected.\n     *\n     * @public\n     * @memberof api\n     * @requires oauthToken\n     * @method updateToken\n     * @param {Object} credentials The credentials object.\n     * @param {string} credentials.username The username without the application's domain.\n     * @param {string} credentials.oauthToken An OAuth token provided by an outside service.\n     * @example\n     * client.updateToken({\n     *   username: 'alfred@example.com',\n     *   oauthToken: 'RTG9SV3QAoJaeUSEQCZAHqrhde1yT'\n     * });\n     */\n    updateToken (credentials) {\n      // We won't expose oauthToken because it essentially acts as a password being used in conjunction with username\n      // ..and passwords should NOT be logged.\n      log.debug(API_LOG_TAG + 'updateToken: ', credentials.username)\n      dispatch(actions.refreshTokens(credentials))\n    },\n\n    /**\n     * Updates the current connection.\n     *\n     * @public\n     * @memberof api\n     * @requires updateConnection\n     * @method updateConnection\n     * @param {Object} connection\n     * @param {Array} connection.services Services to subscribe to for notifications.\n     * @example\n     * client.updateConnection({\n     *   services: ['IM', 'Presence', 'call']\n     * })\n     */\n    updateConnection (connection) {\n      log.debug(API_LOG_TAG + 'updateConnection: ', connection)\n      dispatch(actions.updateSubscription(connection))\n    },\n\n    /**\n     * Retrieves information about the current user.\n     *\n     * @public\n     * @memberof api\n     * @method getUserInfo\n     * @returns {Object} user The user data.\n     * @returns {string} user.username The username of the current user. Note that this username can take different encoded forms.\n     *                                 It's not meant to be displayed to a user.\n     * @returns {string} user.token The current access token.\n     */\n    getUserInfo () {\n      log.debug(API_LOG_TAG + 'getUserInfo')\n      return selectUserInfo(getState())\n    },\n\n    /**\n     * Get the connection state.\n     *\n     * @public\n     * @memberof api\n     * @requires connect\n     * @method getConnection\n     * @returns {Object} connection The connection state.\n     * @returns {boolean} connection.isConnected Whether the authenticated user is currently connected.\n     * @returns {boolean} connection.isPending Whether the authenticated user's connection is currently pending.\n     * @returns {Object} connection.error The error object if an error occured.\n     * @returns {string} connection.error.message The error message.\n     * @returns {string} connection.error.stack The stack trace of the error.\n     */\n    getConnection () {\n      log.debug(API_LOG_TAG + 'getConnection')\n      const { isConnected, isPending, error } = getState().authentication\n      return {\n        isConnected,\n        isPending,\n        error,\n        subscription: getServices(getState())\n      }\n    },\n\n    /**\n     * Retrieves the services that the user is subscribed for.\n     *\n     * @public\n     * @memberof api\n     * @requires services\n     * @method getServices\n     * @return {Array} A list of subscribed-to services.\n     */\n    getServices () {\n      log.debug(API_LOG_TAG + 'getServices')\n      return getServices(getState())\n    },\n\n    /**\n     * Possible subscription states of the user.\n     *\n     * @public\n     * @memberof api\n     * @requires connect\n     * @property {string} FULL All requested feature subscriptions exist.\n     * @property {string} PARTIAL Some feature subscriptions exist.\n     * @property {string} NONE No feature subscriptions exist.\n     */\n    subscriptionStates: SUBSCRIPTION_STATE,\n\n    /**\n     * Possible reasons for disconnecting.\n     *\n     * @public\n     * @memberof api\n     * @requires connect\n     * @property {string} GONE Connection was terminated by the server\n     * @property {string} LOST_CONNECTION Internet connection was lost\n     */\n    disconnectReasons: DISCONNECT_REASONS,\n\n    /**\n     * Sets the authentication tokens necessary to make requests to the platform. The access token\n     * provided establishes what can be accessed by the SDK. The identity token represents who is authenticated.\n     *\n     * @public\n     * @memberof api\n     * @requires cpaasAuth\n     * @method setTokens\n     * @param {Object} params Dictionary object of parameters.\n     * @param {string} params.accessToken An access token retrieved using the authentication APIs of the platform.\n     * @param {string} params.idToken An identity token retrieved using the authentication APIs of the platform.\n     * @example\n     * client.setTokens({\n     *   accessToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...',\n     *   idToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'\n     * })\n     */\n    setTokens ({ accessToken, idToken }) {\n      // We won't log both tokens, just the id one, so that we can still be able to debug.\n      log.debug(API_LOG_TAG + 'setTokens: ', idToken)\n      dispatch(actions.setTokens({ accessToken, idToken }))\n    }\n  }\n}\n","/**\n * Authentication state has changed. You can get the new state by calling `getConnection()`.\n *\n * @public\n * @memberof api\n * @requires connect\n * @event auth:change\n * @param {Object} params\n * @param {string} params.reason The cause of the authentication change, provided in the event of an unsolicited disconnection. See the `disconnectReasons` API for possible values.\n */\nexport const AUTH_CHANGE = 'auth:change'\n\n/**\n * There was an error with authentication.\n *\n * @public\n * @memberof api\n * @requires connect\n * @event auth:error\n * @param {Object} params\n * @param {BasicError} params.error The Basic error object.\n *\n */\nexport const AUTH_ERROR = 'auth:error'\n\n/**\n * An attempt to extend the current user's subscription was made.\n *\n * In a failure scenario, the current user is still connected, and further\n * resubscription attempts will be made, but may become disconnected if the\n * session expires.\n * @public\n * @memberof api\n * @requires connect\n * @event auth:resub\n * @param {Object} params\n * @param {number} params.attemptNum The attempt number of this resubscription.\n * @param {boolean} params.isFailure Whether the resubscription failed or not.\n * @param {BasicError} [params.error] The Basic error object.\n */\nexport const AUTH_RESUB = 'auth:resub'\n","import * as eventTypes from './eventTypes'\nimport * as actionTypes from './actionTypes'\n\nfunction authChangedEvent (action) {\n  return {\n    type: action.error ? eventTypes.AUTH_ERROR : eventTypes.AUTH_CHANGE,\n    args: action.error ? { error: action.payload } : {}\n  }\n}\n\nconst eventsMap = {}\n\neventsMap[actionTypes.CONNECT_FINISHED] = authChangedEvent\neventsMap[actionTypes.USER_DETAILS_RECEIVED] = authChangedEvent\neventsMap[actionTypes.CONNECT] = authChangedEvent\neventsMap[actionTypes.DISCONNECT] = authChangedEvent\neventsMap[actionTypes.REFRESH_TOKENS_FINISHED] = authChangedEvent\neventsMap[actionTypes.UPDATE_SUBSCRIPTION_FINISH] = authChangedEvent\n\neventsMap[actionTypes.DISCONNECT_FINISHED] = function (action) {\n  let discEvent = authChangedEvent(action)\n  if (action.payload.reason === 'GONE') {\n    discEvent.args.forced = true\n  }\n  discEvent.args.reason = action.payload.reason\n  return discEvent\n}\n\neventsMap[actionTypes.RESUBSCRIPTION_FINISHED] = function (action) {\n  let resubEvent = {\n    type: eventTypes.AUTH_RESUB,\n    args: {\n      attemptNum: action.payload.attemptNum,\n      isFailure: action.error || false\n    }\n  }\n\n  if (action.error) {\n    resubEvent.args.error = action.payload\n  }\n  return resubEvent\n}\n\nexport default eventsMap\n","import reducer from './reducers'\nimport name from './name'\nimport api from './api'\n\nexport { reducer, name, api }\n","/**\n * This interface is for an authentication plugin.\n * @type {string}\n */\nconst name = 'authentication'\nexport default name\n","import * as actionTypes from './actionTypes'\nimport { handleActions } from 'redux-actions'\nimport jwtDecode from 'jwt-decode'\n\nimport { merge } from 'lodash/fp'\n\nconst reducers = {}\n\nreducers[actionTypes.CONNECT] = {\n  next (state) {\n    return {\n      ...state,\n      isPending: true,\n      error: undefined\n    }\n  }\n}\n\nreducers[actionTypes.CONNECT_FINISHED] = {\n  next (state, action) {\n    return {\n      ...state,\n      isConnected: true,\n      isPending: false,\n      error: undefined,\n      isSSO: action.meta.isSSO,\n      platform: action.meta.platform,\n      // Separate subscription, connection info based on the platform used.\n      // Store platform subscription information.\n      subscription: {\n        ...state.subscription,\n        [action.meta.platform]: action.payload.subscription\n      },\n      // Store platform connection information to be procided to other plugins.\n      connection: {\n        ...state.connection,\n        [action.meta.platform]: action.payload.connection\n      },\n      // Store user information to be provided to developers.\n      userInfo: action.payload.userInfo\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      isConnected: false,\n      isPending: false,\n      error: action.payload\n    }\n  }\n}\n\n// On connection occured, store the connection information into state, but do\n// not update any status state. The connection has not yet finished.\nreducers[actionTypes.CONNECTION_OCCURRED] = {\n  next (state, action) {\n    return {\n      ...state,\n      // Separate subscription, connection info based on the platform used.\n      // Store platform subscription information.\n      subscription: {\n        ...state.subscription,\n        [action.meta.platform]: action.payload.subscription\n      },\n      // Store platform connection information to be procided to other plugins.\n      connection: {\n        ...state.connection,\n        [action.meta.platform]: action.payload.connection\n      }\n    }\n  }\n}\n\nreducers[actionTypes.DISCONNECT] = {\n  next (state) {\n    return {\n      ...state,\n      isPending: true,\n      error: undefined\n    }\n  }\n}\n\nreducers[actionTypes.DISCONNECT_FINISHED] = {\n  next (state, action) {\n    return {\n      isConnected: false,\n      isPending: false,\n      error: undefined\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      // Treat an error as if we are still disconnected.\n      isConnected: false,\n      isPending: false,\n      error: action.payload\n    }\n  }\n}\n\nreducers[actionTypes.REFRESH_TOKENS_FINISHED] = {\n  next (state, action) {\n    // Merge the updated requestOptions into the current state.\n    let requestOptions = merge(\n      state.connection[action.meta.platform].requestOptions,\n      action.payload.connection.requestOptions\n    )\n\n    return {\n      ...state,\n      connection: {\n        ...state.connection,\n        [action.meta.platform]: {\n          ...state.connection[action.meta.platform],\n          ...action.payload.connection,\n          requestOptions\n        }\n      },\n      userInfo: {\n        ...state.userInfo,\n        accessToken: action.payload.connection.accessToken,\n        refreshToken: action.payload.connection.refreshToken\n      }\n    }\n  }\n}\n\n/*\n * Updates the subscription information for a specified platform.\n */\nreducers[actionTypes.UPDATE_SUBSCRIPTION_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      subscription: {\n        ...state.subscription,\n        [action.meta.platform]: {\n          ...state.subscription[action.meta.platform],\n          ...action.payload\n        }\n      }\n    }\n  }\n}\n\nreducers[actionTypes.SET_TOKEN] = {\n  next (state, action) {\n    // We received an idToken which is a JWT token that represents the identity of\n    // the user. This token contains information about the user. For now we only need\n    // the username. In the future we might use more from this token.\n\n    const idTokenPayload = jwtDecode(action.payload.idToken)\n\n    return {\n      ...state,\n      userInfo: {\n        ...state.userInfo,\n        accessToken: action.payload.accessToken,\n        username: idTokenPayload.preferred_username,\n        identity: idTokenPayload['services-identity']\n      }\n    }\n  }\n}\n\n/**\n * Auth Interface reducer\n * @method reducer\n * @param  {Object}  state - The current redux state.\n * @param  {Object}  action - A flux standard action.\n * @return {Object}  - The new redux state.\n * @example\n * Auth state structure example; connected.\n * authState = {\n *     isConnected: true,\n *     isPending: false,\n *     error: undefined,\n *     subscription: { ... },\n *     connection: { ... },\n *     userInfo: { ... }\n * }\n */\nconst reducer = handleActions(reducers, {\n  isConnected: false,\n  isPending: false\n})\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\nimport { SUBSCRIPTION_STATE } from '../constants'\nimport { platforms } from '../../constants'\n\n/**\n * Plugin selector function to expose state globally\n * @param  {Object} pluginState The localized (plugin) state\n * @return {Object}             The exposed state\n */\nexport function getExposedState (pluginState) {\n  // TODO: Filter out unwanted auth stuff from public state.\n  return cloneDeep(pluginState)\n}\n\n/*\n * Redux-saga selector functions.\n * Used with the `select` effect in sagas to Retrieves\n *      specific portions of the state.\n */\n\n/**\n * Retrieves the config options provided by the auth plugin.\n * @method getAuthConfig\n * @return {Object}\n */\nexport function getAuthConfig (state) {\n  return cloneDeep(state.config.authentication)\n}\n\n/**\n * Retrieves the subscription information of a platform.\n * @method getSubscriptionInfo\n * @param  {string} [platform] - The backend platform in use.\n * @return {Object}\n */\nexport function getSubscriptionInfo (state, platform) {\n  if (!platform) {\n    platform = getPlatform(state)\n  }\n\n  if (state.authentication.subscription) {\n    return cloneDeep(state.authentication.subscription[platform])\n  } else {\n    return undefined\n  }\n}\n\n/**\n * Retrieves the connection information of a platform.\n * Includes the info needed to make requests to that platform.\n * @method getConnectionInfo\n * @param  {string} [platform] - The backend platform in use.\n * @return {Object}\n */\nexport function getConnectionInfo (state, platform) {\n  if (!platform) {\n    platform = getPlatform(state)\n  }\n\n  if (state.authentication.connection) {\n    return cloneDeep(state.authentication.connection[platform])\n  } else {\n    return undefined\n  }\n}\n\n/**\n * Retrieves the domain of the callee address information of a platform.\n * @method getDomain\n * @return {string}\n */\nexport function getDomain (state) {\n  const { username = '', identity = username } = getUserInfo(state)\n  const [, domain = ''] = identity.split('@')\n  return domain\n}\n\n/**\n * Retrieves the identity of the currently logged-in user.\n * The identity is of the form: <userName>@<domain>\n * @method getIdentity\n * @return {string}\n */\nexport function getIdentity (state) {\n  const userInfo = getUserInfo(state)\n  return userInfo.identity || userInfo.username || ''\n}\n\n/**\n * Retrieves the user information.\n * @method getUserInfo\n * @return {Object} An object whose properties are: accessToken, identity & username. Identity is user's primary contact address.\n */\nexport function getUserInfo (state) {\n  return cloneDeep(state.authentication.userInfo) || {}\n}\n\n/**\n * Retrieves a flag from the store representing if the login scenario was SSO or not.\n * @method getAuthScenario\n * @return {boolean}\n */\nexport function getAuthScenario (state) {\n  return cloneDeep(state.authentication.isSSO)\n}\n\n/**\n * Retrieves information about the services that the user is subscribed for.\n * @method getServices\n * @return {Object}\n */\nexport function getServices (state, platform) {\n  let subscription = getSubscriptionInfo(state, platform)\n\n  if (subscription && subscription.servicesInfo) {\n    return subscription.servicesInfo\n  } else {\n    return {\n      // TODO: Have default as part of the reducer.\n      requested: [],\n      received: [],\n      missing: [],\n      status: SUBSCRIPTION_STATE.NONE,\n      services: {}\n    }\n  }\n}\n\n/**\n * Retrieves the name of the backend platform the user is currently subscribed to.\n * @method getPlatform\n * @return {string}\n */\nexport function getPlatform (state) {\n  return cloneDeep(state.authentication.platform)\n}\n\n/**\n * Retrieves info needed to make a REST request for the different platforms.\n * @method getRequestInfo\n * @return {Object}\n */\nexport function getRequestInfo (state, platform) {\n  if (!platform) {\n    platform = getPlatform(state)\n  }\n\n  const { server, subscription, clientCorrelator } = getAuthConfig(state)\n  const { userInfo } = cloneDeep(state.authentication)\n  let requestInfo\n\n  if (platform === platforms.CPAAS) {\n    requestInfo = {\n      baseURL: `${server.protocol}://${server.base}:${server.port}`,\n      version: server.version,\n      username: userInfo.username,\n      // TODO: Token doesn't need to be here if its in requestOptions.\n      token: userInfo.accessToken,\n      clientCorrelator,\n      // TODO: DO NOT hardcode this here (?). The original idea was that this\n      //    is set in state after connection.\n      options: {\n        headers: {\n          Accept: 'application/json',\n          Authorization: `Bearer ${userInfo.accessToken}`,\n          'Content-Type': 'application/json'\n        }\n      }\n    }\n  } else if (platform === platforms.UC) {\n    requestInfo = {\n      baseURL: `${subscription.protocol}://${subscription.server}:${subscription.port}`,\n      version: subscription.version,\n      username: userInfo.username\n    }\n  } else if (platform === platforms.LINK) {\n    requestInfo = {\n      baseURL: `${subscription.protocol}://${subscription.server}:${subscription.port}`,\n      version: subscription.version,\n      username: userInfo.username\n    }\n\n    /*\n     * If the requested platform was Link but the platform set in state is\n     *    UC, and so we're using UC but making a request for SPiDR.\n     * Change the requestInfo provided to ensure the URL will be valid for\n     *    SPiDR and authentication will be valid for CIM.\n     */\n    const setPlatform = getPlatform(state)\n    if (setPlatform === platforms.UC) {\n      requestInfo.version = '1'\n\n      const connInfo = getConnectionInfo(state, setPlatform)\n      if (connInfo && connInfo.requestOptions) {\n        requestInfo.requestOptions = connInfo.requestOptions\n      }\n      return requestInfo\n    }\n  } else {\n    // Platform is not supported\n    return {}\n  }\n\n  const connInfo = getConnectionInfo(state, platform)\n  if (connInfo && connInfo.requestOptions) {\n    requestInfo.requestOptions = connInfo.requestOptions\n  }\n\n  return requestInfo\n}\n","import logs from './logs'\nimport config from './config'\nimport events from './events'\nimport request from './request'\n\n/**\n * This is a list of base plugins that most solutions will need. These plugins provide service-like capabilities\n * to the SDK.\n */\nexport default [\n  { name: 'logs', fn: logs },\n  { name: 'config', fn: config },\n  { name: 'events', fn: events },\n  { name: 'request', fn: request }\n]\n","import { mapKeys } from 'lodash/fp'\n\n/**\n * Helper function. Converts an object so that its keys are the same as its values.\n * @method mapValuesToKeys\n * @param  {Object} source\n * @return {Object}\n */\nfunction mapValuesToKeys (source) {\n  return mapKeys(function (value) {\n    return source[value]\n  })(source)\n}\n\n/**\n * Enum of FCS call states.\n * Key is the \"code\" that FCS uses, and value is the text representation.\n * These are taken from FCS callManager.js, but inversed.\n *      See `fcs.call.States`.\n * @type {Object}\n */\nexport const FCS_CALL_STATES = {\n  0: 'IN_CALL',\n  1: 'ON_HOLD',\n  2: 'RINGING',\n  3: 'ENDED',\n  4: 'REJECTED',\n  5: 'OUTGOING',\n  6: 'INCOMING',\n  7: 'ANSWERING',\n  8: 'JOINED',\n  9: 'RENEGOTIATION',\n  10: 'TRANSFERRED',\n  11: 'ON_REMOTE_HOLD',\n  12: 'CALL_IN_PROGRESS',\n  13: 'EARLY_MEDIA',\n  14: 'TRANSFER_FAILURE',\n  15: 'REPLACING'\n}\n\n/**\n * Call states.\n * Same as FCS_CALL_STATES, except both key and value are the text representation.\n * @name CALL_STATES_FCS\n */\nexport const CALL_STATES_FCS = mapValuesToKeys(FCS_CALL_STATES)\n\n/**\n * Call states\n * Call states used in the cpaas and link call plugins\n * @name CALL_STATES\n */\nexport const CALL_STATES = {\n  INITIATING: 'Initiating',\n  INITIATED: 'Initiated',\n  EARLY_MEDIA: 'Early Media',\n  RINGING: 'Ringing',\n  CANCELLED: 'Cancelled',\n  CONNECTED: 'Connected',\n  ON_HOLD: 'On Hold',\n  ENDED: 'Ended'\n}\n\n/**\n * Possible states a call's media can be in.\n * Describes whether media is flowing or if an endpoint is preventing media flow.\n * @name CALL_MEDIA_STATES\n * @type {Object}\n * @property {string} CONNECTED Both call endpoints allow for media to flow.\n * @property {string} LOCAL_HOLD Local endpoint disallows media from flowing.\n * @property {string} REMOTE_HOLD Remote endpoint disallows media from flowing.\n * @property {string} DUAL_HOLD Both endpoints disallow media from flowing.\n */\nexport const CALL_MEDIA_STATES = {\n  CONNECTED: 'Connected',\n  LOCAL_HOLD: 'Local Hold',\n  REMOTE_HOLD: 'Remote Hold',\n  DUAL_HOLD: 'Dual Hold'\n}\n\n/**\n * Call operations that require negotiation.\n * @name OPERATIONS\n * @type {Object}\n * @property {string} CHANGE_MEDIA Media flow remains the same, includes non-flow related media changes.\n * @property {string} HOLD_MEDIA   Media flow stops. May include non-flow related media changes.\n * @property {string} UNHOLD_MEDIA Media flow restarts. May include non-flow related media changes.\n * @property {string} MUSIC_ON_HOLD Media flow changes to sendonly.\n */\nexport const OPERATIONS = {\n  CHANGE_MEDIA: 'Change Media',\n  HOLD_MEDIA: 'Hold Media',\n  UNHOLD_MEDIA: 'Unhold Media',\n  MUSIC_ON_HOLD: 'Music on hold'\n}\n\n/**\n * Complex call operations.\n * @name COMPLEX_OPERATIONS\n * @type {Object}\n * @property {string} DIRECT_TRANSFER\n * @property {string} CONSULTATIVE_TRANSFER\n * @property {string} JOIN\n */\nexport const COMPLEX_OPERATIONS = {\n  DIRECT_TRANSFER: 'Direct Transfer',\n  CONSULTATIVE_TRANSFER: 'Consultative Transfer',\n  JOIN: 'Join'\n}\n\n/**\n * Complex call operation messages.\n * @name COMPLEX_OPERATION_MESSAGES\n * @type {Object}\n * @property {string} DIRECT_TRANSFER_SUCCESS Success message for direct transfer.\n * @property {string} CONSULTATIVE_TRANSFER_SUCCESS Success message for consultative transfer (matches reasonText from notification).\n * @property {string} JOIN_SUCCESS Success message for join.\n * @property {string} DIRECT_TRANSFER_FAILURE Failure message for direct transfer.\n * @property {string} CONSULTATIVE_TRANSFER_FAILURE Failure message for consultative transfer.\n * @property {string} JOIN_FAILURE Failure message for join.\n */\nexport const COMPLEX_OPERATION_MESSAGES = {\n  DIRECT_TRANSFER_SUCCESS: 'Direct Transfer Successful',\n  CONSULTATIVE_TRANSFER_SUCCESS: 'Transfer Successful',\n  JOIN_SUCCESS: 'Join Successful',\n  DIRECT_TRANSFER_FAILURE: 'Direct Transfer Failed',\n  CONSULTATIVE_TRANSFER_FAILURE: 'Transfer Failed',\n  JOIN_FAILURE: 'Join Failed'\n}\n\n/**\n * Status codes that match success messsages.\n * @name STATUS_CODES\n * @type {Object}\n * @property {number} DIRECT_TRANSFER_SUCCESS Status code for successful direct transfer.\n * @property {number} CONSULTATIVE_TRANSFER_SUCCESS Status code for successful consultative transfer.\n * @property {number} JOIN_SUCCESS Status code for successful join.\n * @property {number} DIRECT_TRANSFER_FAILURE Status code for failed direct transfer.\n * @property {number} CONSULTATIVE_TRANSFER_FAILURE Status code for failed consultative transfer.\n * @property {number} JOIN_FAILURE Status code for failed join.\n */\nexport const STATUS_CODES = {\n  DIRECT_TRANSFER_SUCCESS: 9905,\n  CONSULTATIVE_TRANSFER_SUCCESS: 9905,\n  JOIN_SUCCESS: 9906,\n  DIRECT_TRANSFER_FAILURE: -1,\n  CONSULTATIVE_TRANSFER_FAILURE: -1,\n  JOIN_FAILURE: -2\n}\n\n/**\n * Call direction\n * Indication of which direction the call is going\n * @name CALL_DIRECTION\n */\nexport const CALL_DIRECTION = {\n  INCOMING: 'incoming',\n  OUTGOING: 'outgoing'\n}\n\n/**\n * The default bandwidth limits to use for a track type.\n * @name BANDWIDTH_DEFAULTS\n */\nexport const BANDWIDTH_DEFAULTS = {\n  AUDIO: 5000,\n  VIDEO: 5000\n}\n\n/*\n * A conversion from MediaDeviceInfo.kind values to their more common terms.\n * See: https://developer.mozilla.org/en-US/docs/Web/API/MediaDeviceInfo/kind\n */\nexport const WEBRTC_DEVICE_KINDS = {\n  audioinput: 'microphone',\n  videoinput: 'camera',\n  audiooutput: 'speaker'\n}\n\n/**\n * Enum of ICE media states.\n * These are taken from FCS call, but inversed.\n *      See `fcs.call.MediaStates`.\n * @name FCS_ICE_MEDIA_STATES\n * @type {Object}\n */\nexport const FCS_ICE_MEDIA_STATES = {\n  0: 'NEW',\n  1: 'CHECKING',\n  2: 'CONNECTED',\n  3: 'COMPLETED',\n  4: 'FAILED',\n  5: 'DISCONNECTED',\n  6: 'CLOSED'\n}\n\n/**\n * ICE media states.\n * Same as FCS_ICE_MEDIA_STATES, except both key and value are the text representation.\n * @name ICE_MEDIA_STATES\n */\nexport const ICE_MEDIA_STATES = mapValuesToKeys(FCS_ICE_MEDIA_STATES)\n","// Call plugin.\nimport pluginInterface from '../interfaceNew'\nimport * as sagas from './sagas'\nimport events from '../interfaceNew/events'\n\n// Other plugins.\nimport { mapEvents } from '../../events/interface/actions'\nimport { update as updateConfig } from '../../config/interface/actions'\nimport { sanitizeSdesFromSdp, modifySdpBandwidth } from '../../callstack/utils'\n\n// Helpers.\nimport { mergeValues, autoRestart } from '../../common/utils'\nimport createCodecRemover from 'fcs/src/js/sdp/codecRemover'\n\n// Libraries.\nimport { values } from 'lodash/fp'\nimport { fork, put } from 'redux-saga/effects'\n\n/**\n * Configuration options for the call feature.\n * @public\n * @name config.call\n * @memberof config\n * @instance\n * @param {Object} call The call configuration object.\n * @param {string} [call.sdpSemantics='unified-plan'] The sdpSemantics to use (`'unified-plan'` or `'plan-b'`).\n * @param {Array<IceServer>} [call.iceServers] The list of ICE servers to be used for calls.\n * @param {boolean} [call.serverTurnCredentials=true] Whether server-provided TURN credentials should be used.\n * @param {Array<SdpHandlerFunction>} [call.sdpHandlers] List of SDP handler functions to modify SDP. Advanced usage.\n * @param {boolean} [call.removeH264Codecs=true] Whether to remove \"H264\" codec lines from incoming and outgoing SDP messages.\n */\n\nexport default function cpaasCalls (options = {}) {\n  const defaultOptions = {\n    // The list of TURN/STUN servers to use.\n\n    // TODO: Remove this default once the CPaaS server configuration feature is implemented. These\n    // servers should be sent to us by CPaaS. This default is just here fo ease of use in production.\n    iceServers: [\n      {\n        urls: 'turns:turn-ucc-1.genband.com:443?transport=tcp',\n        credential: ''\n      },\n      {\n        urls: 'turns:turn-ucc-2.genband.com:443?transport=tcp',\n        credential: ''\n      }\n    ],\n    // TODO: Remove this once all the browsers use unified-plan\n    sdpSemantics: 'unified-plan',\n    // Whether the SDK should fetch turn credentials.\n    serverTurnCredentials: true,\n    // Trickle ICE method to use for calls.\n    trickleIceMode: 'NONE',\n    // SDP handlers to be included in the pipeline for every operation.\n    sdpHandlers: [],\n    // filter out H264 Codec\n    removeH264Codecs: true,\n    // Set this to false to bypass sip address normalization\n    normalizeDestination: true\n  }\n\n  options = mergeValues(defaultOptions, options)\n\n  function * init ({ webRTC }) {\n    yield put(updateConfig(options, pluginInterface.name))\n    yield put(mapEvents(events))\n\n    /*\n     * Set SDP handlers to be used for every operation:\n     *\n     * 1. Application provided SDP handlers.\n     *\n     * 2. Disable DTLS-SDES crypto method (ie. delete the line) if there's a better\n     *    crypto method enabled. WebRTC only allows one method to be enabled.\n     *    This is needed for interopability with non-browser endpoints that include\n     *    SDES as a fallback method.\n     *\n     * 3. [optional] Disable H264 Codecs for video calls, used to reduce SDP size\n     *\n     * 4. Modify sdp and add bandwidth limits on it if bandwidth controls are provided.\n     */\n    let sdpHandlers = options.sdpHandlers\n    if (options.removeH264Codecs) {\n      sdpHandlers.push(createCodecRemover(['H264']))\n    }\n    sdpHandlers.push(sanitizeSdesFromSdp)\n    sdpHandlers.push(modifySdpBandwidth)\n\n    // Dependencies to be provided to every call saga.\n    const deps = {\n      webRTC: webRTC.managers,\n      sdpHandlers\n    }\n\n    // Wrap the call sagas in a function that provides them with the webRTC stack.\n    const wrappedSagas = values(sagas).map(saga => {\n      return autoRestart(() => saga(deps))\n    })\n\n    // Run all of the sagas.\n    for (let saga of wrappedSagas) {\n      yield fork(saga)\n    }\n  }\n\n  return {\n    name: pluginInterface.name,\n    api: pluginInterface.api,\n    reducer: pluginInterface.reducer,\n    init,\n    capabilities: ['call', 'cpaas_call', 'cpaas_user_id', 'cpaas_pstn']\n  }\n}\n","// Other plugins.\nimport { getRequestInfo } from '../../../auth/interface/selectors'\n\n// Helpers.\nimport request from '../../../request/effects'\nimport { handleRequestError } from '../../../common/helpers'\nimport { platforms } from '../../../constants'\n\n// Libraries.\nimport { select, call } from 'redux-saga/effects'\n\n/**\n * Creates a webRTC session on the server. CPaaS-specific signalling function.\n *\n * This saga \"starts a call\" between the current user and another, specified\n *    user.\n * Assumptions:\n *    1. The current user is authenticated.\n * Responsibilities:\n *    1. Format parameters as needed for signalling.\n *    2. Perform the REST request.\n *    3. Return the response, formatted.\n * @method createSession\n * @param  {Object} callInfo\n * @param  {string} callInfo.participantAddress The user to receive the call.\n * @param  {string} callInfo.offer The local SDP offer to begin negotiation.\n * @param  {string} [callInfo.displayName] A custom display name to use. Not supported in all environments and may use default display name.\n * @return {Object} response Signalling response.\n * @return {string} [response.wrtcsSessionId] ID that the server uses to track this call.\n * @return {Object} [response.error] An error object, if signalling failed.\n */\nexport function * createSession (callInfo) {\n  // Collect the information needed to make the request.\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  const requestBody = {\n    wrtcsSession: {\n      clientCorrelator: requestInfo.clientCorrelator,\n      tParticipantAddress: callInfo.participantAddress,\n      offer: {\n        sdp: callInfo.offer\n      }\n    }\n  }\n  if (callInfo.displayName) {\n    // Default backend configuration does not support this\n    //  so remote side might see default display name instead.\n    // Backend needs to be configured to allow a custom display name.\n    requestBody.wrtcsSession.tParticipantName = callInfo.displayName\n  }\n  const requestOptions = {\n    method: 'POST',\n    url: `${requestInfo.baseURL}/cpaas/webrtcsignaling/${requestInfo.version}/${requestInfo.username}/sessions`,\n    body: JSON.stringify(requestBody)\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Create session')\n    }\n  } else {\n    const sessionInfo = response.payload.body.wrtcsSession\n    return {\n      error: false,\n      wrtcsSessionId: sessionInfo.resourceURL.split('sessions/')[1]\n    }\n  }\n}\n\n/**\n * Updates a webRTC session on the server with an answer.\n * CPaaS-specific signaling function.\n *\n * This saga \"answers a call\" from another user.\n * Assumptions:\n *    1. The current user is authenticated.\n * Responsibilities:\n *    1. Format parameters as needed for signalling.\n *    2. Perform the REST request.\n *    3. Return the response, formatted.\n * @method answerSession\n * @param  {Object} callInfo\n * @param  {string} callInfo.wrtcsSessionId ID that the server uses to identify the session.\n * @param  {string} callInfo.answer The local SDP to complete negotiation. This may be an offer is performing slow start answer.\n * @return {Object} response Signalling response.\n * @return {Object} [response.error] An error object, if signalling failed.\n */\nexport function * answerSession (callInfo) {\n  // Collect the information needed to make the request.\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  const requestOptions = {\n    method: 'PUT',\n    url:\n      `${requestInfo.baseURL}/cpaas/` +\n      `webrtcsignaling/${requestInfo.version}/${requestInfo.username}/` +\n      `sessions/${callInfo.wrtcsSessionId}/answer`,\n    body: JSON.stringify({\n      wrtcsAnswer: {\n        clientCorrelator: requestInfo.clientCorrelator,\n        sdp: callInfo.answer\n      }\n    })\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Answer session')\n    }\n  } else {\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * Fetch a set of TURN credentials.\n * @method fetchCredentials\n * @param  {Object} requestInfo\n */\nexport function * fetchCredentials (requestInfo) {\n  const requestOptions = {\n    method: 'POST',\n    url: `${requestInfo.baseURL}/cpaas/` + `webrtcsignaling/${requestInfo.version}/${requestInfo.username}/` + `turn`,\n    body: JSON.stringify({\n      wrtcsTurnCredentials: {\n        clientCorrelator: requestInfo.clientCorrelator\n      }\n    })\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Fetch credentials')\n    }\n  } else {\n    return response.payload.body.wrtcsTurnCredentials\n  }\n}\n\n/**\n * Updates an existing webRTC session on the server.\n * CPaaS-specific signalling function.\n *\n * This saga \"updates a session\" between the current user and another, specified\n *    user.\n * Assumptions:\n *    1. The current user is authenticated.\n * Responsibilities:\n *    1. Format parameters as needed for signalling.\n *    2. Perform the REST request.\n *    3. Return the response, formatted.\n * @method updateSession\n * @param  {Object} callInfo\n * @param  {string} callInfo.wrtcsSessionId The ID the backend uses to track the session.\n * @param  {string} callInfo.offer The local SDP offer to begin negotiation.\n * @return {Object} response Signalling response.\n * @return {Object} response.error An error object, if signalling failed.\n */\nexport function * updateSession (callInfo) {\n  // Collect the information needed to make the request.\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  const requestOptions = {\n    method: 'PUT',\n    url:\n      `${requestInfo.baseURL}/cpaas/` +\n      `webrtcsignaling/${requestInfo.version}/${requestInfo.username}/` +\n      `sessions/${callInfo.wrtcsSessionId}/update`,\n    body: JSON.stringify({\n      wrtcsOffer: {\n        clientCorrelator: requestInfo.clientCorrelator,\n        sdp: callInfo.offer\n      }\n    })\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Update session')\n    }\n  } else {\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * Updates a webRTC session on the server with a new state.\n * CPaaS-specific signaling function.\n *\n * The saga updates the server's session to be in a provided state. This can be\n *    used for multiple purposes, such as to indicate ringing or as call audit.\n * Assumptions:\n *    1. The current user is authenticated.\n * Responsibilities:\n *    1. Format parameters as needed for signalling.\n *    2. Perform the REST request.\n *    3. Return the response, formatted.\n * @method updateSessionStatus\n * @param  {Object} callInfo\n * @param  {string} callInfo.wrtcsSessionId ID that the server uses to identify the session.\n * @param  {string} status   The status to put the server session into.\n * @return {Object} response Signalling response.\n * @return {Object} [response.error] An error object, if signalling failed.\n */\nexport function * updateSessionStatus (callInfo, status) {\n  // Collect the information needed to make the request.\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  const requestOptions = {\n    method: 'PUT',\n    url:\n      `${requestInfo.baseURL}/cpaas/` +\n      `webrtcsignaling/${requestInfo.version}/${requestInfo.username}/` +\n      `sessions/${callInfo.wrtcsSessionId}/status`,\n    body: JSON.stringify({\n      wrtcsSessionStatus: {\n        clientCorrelator: requestInfo.clientCorrelator,\n        status\n      }\n    })\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    // Assume for most of errors we can retry..\n    let statusVal = 'Retry'\n\n    if (response.payload.result && response.payload.result.code === 404) {\n      // We got a 404 'Not found' error. In this case we can safely assume status is Closed. No need to keep retrying...\n      statusVal = 'Closed'\n    }\n    return {\n      error: handleRequestError(response, 'Session Status Update'),\n      status: statusVal\n    }\n  } else {\n    return {\n      error: false,\n      status: response.payload.body.wrtcsSessionStatus.status\n    }\n  }\n}\n\n/**\n * REST request to end a webRTC session.\n * @method endSession\n * @param  {Object} callInfo\n * @param  {Object} callInfo.wrtcsSessionId ID that the server uses to identify the session.\n * @return {Object} response Signalling response.\n * @return {Object} [response.error] An BasicError object, if signalling failed.\n */\nexport function * endSession (callInfo) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url:\n      `${requestInfo.baseURL}/cpaas/` +\n      `webrtcsignaling/${requestInfo.version}/${requestInfo.username}/` +\n      `sessions/${callInfo.wrtcsSessionId}`\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'End session')\n    }\n  } else {\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * REST request to reject a webRTC session. (Same as ending a webRTC session)\n * @method rejectSession\n * @param  {Object} callInfo\n * @param  {Object} callInfo.wrtcsSessionId ID that the server uses to identify the session.\n * @return {Object} response Signalling response.\n * @return {Object} [response.error] An BasicError object, if signalling failed.\n */\nexport function * rejectSession (callInfo) {\n  return yield call(endSession, callInfo)\n}\n","// Helpers.\nimport request from '../../../request/effects'\nimport BasicError, { subscriptionCodes } from '../../../errors'\n\n/**\n * Request saga. Generates and sends a REST request to the backend.\n * @method callSubscribe\n * @param  {Object} requestInfo\n * @param  {Object} subInfo\n * @return {Object}\n */\nexport function * callSubscribe (requestInfo, channelInfo) {\n  const requestOptions = {\n    method: 'POST',\n    url:\n      `${requestInfo.baseURL}/cpaas/` +\n      `webrtcsignaling/${requestInfo.version}/${requestInfo.username}/` +\n      `subscriptions`,\n    body: JSON.stringify({\n      wrtcsNotificationSubscription: {\n        callbackReference: {\n          notifyURL: channelInfo.callbackURL\n        },\n        clientCorrelator: requestInfo.clientCorrelator\n      }\n    })\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      // TODO: An actual error.\n      error: new BasicError({\n        message: 'Failed to subscribe for call notifications',\n        code: subscriptionCodes.CPAAS_SERVICE_SUB_FAIL\n      })\n    }\n  } else {\n    return {\n      subscription: response.payload.body.wrtcsNotificationSubscription\n    }\n  }\n}\n\n/**\n * Request saga. Generates and sends a REST request to the backend.\n * @method callUnsubscribe\n * @param  {Object} requestInfo\n * @param  {Object} subInfo\n * @return {Object}\n */\nexport function * callUnsubscribe (requestInfo, subInfo) {\n  const requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url:\n      `${requestInfo.baseURL}/cpaas/` +\n      `webrtcsignaling/${requestInfo.version}/${requestInfo.username}/` +\n      `subscriptions/${subInfo.subscriptionId}`\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: new BasicError({\n        message: 'Failed to unsubscribe from call notifications.',\n        code: subscriptionCodes.CPAAS_SERVICE_SUB_FAIL\n      })\n    }\n  } else {\n    return {\n      error: false\n    }\n  }\n}\n","/**\n * Call saga index.\n * Defines which actions trigger which sagas.\n */\n\n// Call plugin.\nimport * as subSagas from './subscriptions'\nimport * as notificationSagas from './notifications'\nimport * as supportSagas from './support'\nimport * as actionTypes from '../../interfaceNew/actionTypes'\nimport * as requests from '../requests/calls'\n\n// Callstack plugin.\nimport * as establishSagas from '../../../callstack/call/establish'\nimport * as midcallSagas from '../../../callstack/call/midcall'\nimport {\n  incomingCall,\n  parseCallRequest,\n  parseCallResponse,\n  callStatusUpdateEnded,\n  callStatusUpdateRinging\n} from '../../../callstack/call/notifications'\nimport { sendDtmf } from '../../../callstack/call/dtmf'\nimport { sendCallAudit } from '../../../callstack/call/support'\n\n// Other plugins.\nimport { registerService } from '../../../subscription/interface/effects'\nimport { PLUGIN_SUBSCRIPTION_FINISHED } from '../../../subscription/interface/actionTypes'\nimport { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\n\n// Libraries.\nimport { call, takeEvery } from 'redux-saga/effects'\n\n/**\n * Register the call service for subscriptions.\n * @method registerCall\n */\nexport function * registerCall () {\n  yield registerService('call', subSagas.subscribe, subSagas.unsubscribe)\n}\n\n/**\n * Call operations.\n */\n\n/**\n * Start an outgoing call.\n * @method createCall\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * createCall (deps) {\n  yield takeEvery(actionTypes.MAKE_CALL, establishSagas.makeCall, { ...deps, requests })\n}\n\n/**\n * Answer a ringing call.\n * @method answerCall\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * answerCallEntry (deps) {\n  yield takeEvery(actionTypes.ANSWER_CALL, establishSagas.answerCall, { ...deps, requests })\n}\n\n/**\n * Put a call on hold.\n * Currently, \"hold\" is defined as setting media directions to inactive.\n * TODO: There will be different \"hold\" scenarios. Need to determine how to\n *    differentiate between them to know which saga to trigger.\n * @method holdCall\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * holdCall (deps) {\n  yield takeEvery(actionTypes.CALL_HOLD, midcallSagas.offerInactiveMedia, { ...deps, requests })\n}\n\n/**\n * Take a call off hold.\n * Currently, \"unhold\" is defined as setting media directions to sendrecv.\n * TODO: There will be different \"unhold\" scenarios. Need to determine how to\n *    differentiate between them to know which saga to trigger.\n * @method unholdCall\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * unholdCall (deps) {\n  yield takeEvery(actionTypes.CALL_UNHOLD, midcallSagas.offerFullMedia, { ...deps, requests })\n}\n\n/**\n * Add media to a call.\n * @method addMedia\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * addMediaEntry (deps) {\n  yield takeEvery(actionTypes.ADD_MEDIA, midcallSagas.addMedia, { ...deps, requests })\n}\n\n/**\n * Remove media from a call.\n * @method removeMedia\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * removeMediaEntry (deps) {\n  yield takeEvery(actionTypes.REMOVE_MEDIA, midcallSagas.removeMedia, { ...deps, requests })\n}\n\n/**\n * Send DTMF tones for a call.\n * @method sendDTMF\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * sendDTMFEntry (deps) {\n  yield takeEvery(actionTypes.SEND_DTMF, sendDtmf, deps)\n}\n\n/**\n * Call notifications.\n */\n\n/**\n * Handle a \"call incoming\" notification.\n * @method incomingCallNotification\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * incomingCallNotification (deps) {\n  // Curry the signaling function to specify the status.\n  function * updateSessionRinging (...args) {\n    return yield call(requests.updateSessionStatus, ...args, 'Ringing')\n  }\n\n  // Dependencies provided to the Callstack saga.\n  const callDeps = {\n    ...deps,\n    requests: {\n      // Add the wrapped request to CPaaS's set of requests.\n      updateCallRinging: updateSessionRinging\n    }\n  }\n\n  /**\n   * Intercept the CPaaS-specific notification, ensuring parameters are given\n   *    to the Callstack sagas into a generic format.\n   * @method cpaasIncomingCall\n   * @param {Object} action An \"incoming call notification\" action.\n   */\n  function * cpaasIncomingCall (action) {\n    const notification = action.payload.wrtcsSessionInvitationNotification\n\n    // Massage data into a generic format, instead of CPaaS-specific.\n    const params = {\n      sdp: notification.offer.sdp,\n      wrtcsSessionId: notification.link[0].href.split('sessions/')[1],\n      // Remote participant information.\n      remoteName: notification.originatorName,\n      remoteNumber: notification.originatorAddress,\n      calleeNumber: notification.tParticipantAddress\n    }\n\n    // Pass the incoming call parameters to the Callstack for handling.\n    yield call(incomingCall, callDeps, params)\n  }\n\n  // Redux-saga take() pattern.\n  function incomingCallPattern (action) {\n    return action.type === NOTIFICATION_RECEIVED && action.payload.wrtcsSessionInvitationNotification\n  }\n  yield takeEvery(incomingCallPattern, cpaasIncomingCall)\n}\n\n/**\n * Handle a \"call accepted\" notification.\n * @method callAcceptedNotification\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * callAcceptedNotification (deps) {\n  /**\n   * Intercept the CPaaS-specific notification, ensuring parameters are given\n   *    to the Callstack sagas into a generic format.\n   * @method parseAcceptedNotification\n   * @param {Object} action\n   */\n  function * parseAcceptedNotification (action) {\n    const notification = action.payload.wrtcsAcceptanceNotification\n\n    // Pull-out the parameters into a standard format for the Callstack.\n    const params = {\n      sdp: notification.answer.sdp,\n      wrtcsSessionId: notification.link[0].href.split('sessions/')[1]\n    }\n\n    yield call(parseCallResponse, deps, params)\n  }\n\n  // Redux-saga take() pattern.\n  function callAcceptedPattern (action) {\n    return action.type === NOTIFICATION_RECEIVED && action.payload.wrtcsAcceptanceNotification\n  }\n\n  yield takeEvery(callAcceptedPattern, parseAcceptedNotification)\n}\n\n/**\n * Handle a call status websocket notification.\n * @method callStatusNotification\n * @param  {Object} webRTC The webRTC stack.\n */\nexport function * callStatusNotification (deps) {\n  function statusUpdatePattern (status) {\n    return function statusPattern (action) {\n      return (\n        action.type === NOTIFICATION_RECEIVED &&\n        action.payload.wrtcsEventNotification &&\n        action.payload.wrtcsEventNotification.eventType === status\n      )\n    }\n  }\n\n  function * parseStatusNotification (action) {\n    const eventType = action.payload.wrtcsEventNotification.eventType\n    const params = {\n      wrtcsSessionId: action.payload.wrtcsEventNotification.link[0].href.split('sessions/')[1]\n    }\n    if (eventType === 'SessionEnded') {\n      yield call(callStatusUpdateEnded, deps, params)\n    } else if (eventType === 'Ringing') {\n      yield call(callStatusUpdateRinging, deps, params)\n    }\n  }\n\n  // Handle specific call statuses\n  yield takeEvery(statusUpdatePattern('Ringing'), parseStatusNotification)\n  yield takeEvery(statusUpdatePattern('SessionEnded'), parseStatusNotification)\n  yield takeEvery(statusUpdatePattern('Cancelled'), notificationSagas.callStatusUpdateCancelled, deps.webRTC)\n}\n\n/**\n * Handle sending a call audit request\n * TODO: Move the common \"setup\" logic into the Callstack?\n * @method callAudit\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n */\nexport function * callAudit (deps) {\n  const actionTypesToDoAuditOn = [actionTypes.ANSWER_CALL, actionTypes.CALL_ACCEPTED, actionTypes.MAKE_CALL_FINISH]\n\n  // Curry the signaling function to specify the status.\n  function * auditCall (...args) {\n    // For CPaaS, \"call audit\" is to update the call's status to 'Connected'.\n    return yield call(requests.updateSessionStatus, ...args, 'Connected')\n  }\n\n  function callStartAuditPattern (action) {\n    return actionTypesToDoAuditOn.indexOf(action.type) !== -1 && !action.error\n  }\n\n  yield takeEvery([callStartAuditPattern, actionTypes.CALL_AUDIT], sendCallAudit, {\n    requests: {\n      auditCall\n    },\n    webRTC: deps.webRTC\n  })\n}\n\n/**\n * Handle receiving remote offer notifications in a CPaaS format.\n * Uses properties in the notification to create a standardized data object to\n *    be used by the Callstack.\n * @method callOfferNotification\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * callOfferNotification (deps) {\n  // Dependencies provided to the Callstack saga.\n  const callDeps = {\n    ...deps,\n    requests: {\n      /*\n       * CPaaS uses the same REST endpoint for both answering a call and\n       *    answering a renegotiation. Rename the saga so that the Callstack\n       *    uses the correct REST saga.\n       */\n      updateSessionResponse: requests.answerSession\n    }\n  }\n\n  /**\n   * Intercept the CPaaS-specific notification, ensuring parameters are given\n   *    to the Callstack sagas into a generic format.\n   * @method parseOfferNotification\n   * @param {Object} action\n   */\n  function * parseOfferNotification (action) {\n    const notification = action.payload.wrtcsOfferNotification\n\n    // Pull-out the parameters into a standard format for the Callstack.\n    const params = {\n      sdp: notification.offer.sdp,\n      wrtcsSessionId: notification.link[0].href.split('sessions/')[1]\n    }\n\n    yield call(parseCallRequest, callDeps, params)\n  }\n\n  // Redux-saga take() pattern.\n  function callOfferPattern (action) {\n    return action.type === NOTIFICATION_RECEIVED && action.payload.wrtcsOfferNotification\n  }\n\n  yield takeEvery(callOfferPattern, parseOfferNotification)\n}\n\n/**\n * Handle a \"call answer\" notification.\n * @method callAnswerNotification\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * callAnswerNotification (deps) {\n  /**\n   * Intercept the CPaaS-specific notification, ensuring parameters are given\n   *    to the Callstack sagas into a generic format.\n   * @method parseAnswerNotification\n   * @param {Object} action\n   */\n  function * parseAnswerNotification (action) {\n    const notification = action.payload.wrtcsAnswerNotification\n\n    // Pull-out the parameters into a standard format for the Callstack.\n    const params = {\n      sdp: notification.answer.sdp,\n      wrtcsSessionId: notification.link[0].href.split('sessions/')[1]\n    }\n\n    yield call(parseCallResponse, deps, params)\n  }\n\n  // Redux-saga take() pattern.\n  function callAnswerPattern (action) {\n    return action.type === NOTIFICATION_RECEIVED && action.payload.wrtcsAnswerNotification\n  }\n\n  yield takeEvery(callAnswerPattern, parseAnswerNotification)\n}\n\n/**\n * End an ongoing call.\n * @method endCall\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * endCallEntry (deps) {\n  yield takeEvery(actionTypes.END_CALL, midcallSagas.endCall, { ...deps, requests })\n}\n\n/**\n * Ignore an incoming call.\n * @method ignoreCall\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * ignoreCallEntry (deps) {\n  yield takeEvery(actionTypes.IGNORE_CALL, establishSagas.ignoreCall, deps)\n}\n\n/**\n * Reject an incoming call.\n * @method rejectCall\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * rejectCallEntry (deps) {\n  yield takeEvery(actionTypes.REJECT_CALL, establishSagas.rejectCall, { ...deps, requests })\n}\n\n/**\n * Get RTCStatsReport.\n * @method getStats\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n */\nexport function * getStatsEntry (deps) {\n  yield takeEvery(actionTypes.GET_STATS, midcallSagas.getStats, deps)\n}\n\n/**\n * Other.\n */\n\n/**\n * After subscribing for the call service, set turn information for calls.\n * @method setTurnCredentials\n */\nexport function * setTurnCredentials () {\n  function callSubscribePattern (action) {\n    return action.type === PLUGIN_SUBSCRIPTION_FINISHED && action.payload.service === 'call' && !action.error\n  }\n\n  yield takeEvery(callSubscribePattern, supportSagas.setTurnCredentials)\n}\n\n/**\n * Replaces a track with a new track with specified constraints.\n * @method replaceTrackEntry\n * @param {Object} deps             Dependencies to be injected.\n * @param {Object} deps.webRTC      The WebRTC stack.\n */\nexport function * replaceTrackEntry (deps) {\n  yield takeEvery(actionTypes.REPLACE_TRACK, midcallSagas.replaceTrack, deps)\n}\n","/**\n * \"Notification sagas\" handle received notifications.\n * Each saga handles a single websocket notification that may be received from\n *    the backend.\n *\n * There may not be an established webRTC session for these sagas. This may be\n *    because (1) the notification is a new incoming call, or (2) there is a\n *    de-sync between SDK state and server state. This may or may not be\n *    considered as an error scenario (eg. a \"call ended\" notification for a\n *    call the SDK doesn't know about may be safely ignored).\n */\n\n// Call plugin.\nimport { callActions } from '../../interfaceNew/actions'\nimport { CALL_STATES } from '../../constants'\nimport { getCallByWrtcsSessionId } from '../../../call/interfaceNew/selectors'\n\n// Other plugins.\nimport { getLogManager } from '../../../logs'\nimport { closeCall } from '../../../callstack/webrtc/midcall'\n\n// Libraries.\nimport { call, put, select } from 'redux-saga/effects'\n\nconst log = getLogManager().getLogger('CALL')\n\n/**\n * Handles a notification that the remote end call status is 'Cancelled'.\n * @method callStatusUpdateCancelled\n * @param  {Object} action An action representing a call notification.\n */\nexport function * callStatusUpdateCancelled (webRTC, action) {\n  const wrtcsSessionId = action.payload.wrtcsEventNotification.link[0].href.split('sessions/')[1]\n\n  const targetCall = yield select(getCallByWrtcsSessionId, wrtcsSessionId)\n\n  if (!targetCall) {\n    log.debug(`Call for session ${wrtcsSessionId} not found.`)\n    return\n  }\n\n  if (targetCall.state === CALL_STATES.ENDED) {\n    log.debug(`Call ${targetCall.id} is already in ENDED state`)\n    return\n  }\n\n  yield call(closeCall, webRTC, targetCall.id)\n\n  yield put(callActions.callCancelled(targetCall.id))\n}\n","// Call plugin.\nimport { callSubscribe, callUnsubscribe } from '../requests/subscriptions'\n\n// Other plugins.\nimport { reportSubscriptionFinished, reportUnsubscriptionFinished } from '../../../subscription/interface/actions'\nimport { getNotificationChannels } from '../../../subscription/interface/selectors'\nimport { getRequestInfo } from '../../../auth/interface/selectors'\n\n// Helpers.\nimport { platforms } from '../../../constants'\n\n// Libraries.\nimport { call, put, select } from 'redux-saga/effects'\nimport log from 'loglevel'\n\n/**\n * Subscription saga. Creates a new call subscription channel.\n * @method callSubscribe\n */\nexport function * subscribe (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const channels = yield select(getNotificationChannels)\n  const channelInfo = channels.notificationChannels[action.payload.type]\n\n  log.debug(`Subscribing to call service on ${action.payload.type} channel.`)\n  const requestOptions = {}\n  requestOptions.method = 'POST'\n  requestOptions.url =\n    `${requestInfo.baseURL}` +\n    `/cpaas/webrtcsignaling/${requestInfo.version}/${requestInfo.username}` +\n    `/subscriptions`\n\n  log.debug(`Subscribing to call service on ${action.payload.type} channel.`)\n  const response = yield call(callSubscribe, requestInfo, channelInfo)\n\n  yield put(\n    reportSubscriptionFinished({\n      ...response,\n      service: 'call',\n      type: action.payload.type\n    })\n  )\n}\n\n/**\n * Unsubscription saga. Deletes an existing call subscription.\n * @method unsubscribe\n */\nexport function * unsubscribe (action) {\n  const { subscriptions } = yield select(getNotificationChannels)\n  let callSubscription = subscriptions.filter(sub => {\n    return sub.service === 'call' && sub.channelType === action.payload.type\n  })\n\n  if (callSubscription.length === 0) {\n    // \"Error\" scenario: Can't unsubscribe to a service\n    //    that we don't have.\n  } else if (callSubscription.length > 1) {\n    // \"Error\" scenario: There shouldn't be able to have\n    //    more than 1 of the same service.\n  } else {\n    callSubscription = callSubscription[0]\n  }\n\n  log.info(`Unsubscribing from call service on ${action.payload.type} channel.`)\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  const response = yield call(callUnsubscribe, requestInfo, callSubscription)\n\n  yield put(\n    reportUnsubscriptionFinished({\n      ...response,\n      service: 'call',\n      type: action.payload.type\n    })\n  )\n}\n","/**\n * \"Support sagas\" handle call behaviours that are not directly related to calls\n *    themselves, but are required for establishing/maintaining a call.\n *\n * Some sagas do assume that there is an established session (both webRTC and\n *    server; eg. call audits), while others do not (eg. turn credentials).\n */\n\n// Call plugin.\nimport { fetchCredentials } from '../requests/calls'\nimport { turnActions } from '../../interfaceNew/actions'\nimport { getOptions } from '../../interfaceNew/selectors'\n\n// Other plugins.\nimport { getRequestInfo } from '../../../auth/interface/selectors'\nimport { getLogManager } from '../../../logs'\n\n// Helpers.\nimport { platforms } from '../../../constants'\n\n// Libraries.\nimport { call, put, select } from 'redux-saga/effects'\n\nconst log = getLogManager().getLogger('CALL')\n\n/**\n * Handles setting/getting turn/stun information.\n * Fetches TURN credentials from the backend if configured.\n * @method setTurnCredentials\n */\nexport function * setTurnCredentials () {\n  const { iceServers, serverTurnCredentials } = yield select(getOptions)\n\n  // Must have ICE servers configured.\n  if (!iceServers) {\n    log.debug('No ICE servers provided during setup; not using TURN/STUN for calls.')\n    return\n  }\n\n  const turnInfo = {\n    servers: iceServers\n  }\n\n  if (serverTurnCredentials) {\n    log.debug('Retrieving turn credentials from server.')\n\n    // Collect the information needed to make the request.\n    const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n    const response = yield call(fetchCredentials, requestInfo)\n\n    if (response.error) {\n      // TODO: Better error handling; do more than just stop.\n      log.debug('Failed to retrieve turn credentials.')\n      return\n    } else {\n      turnInfo.credentials = response\n\n      // Map the server-provided credentials to the ICE server list.\n      turnInfo.servers = turnInfo.servers.map(server => {\n        return {\n          urls: server.urls || server.url,\n          username: response.username,\n          credential: response.password\n        }\n      })\n    }\n  } else {\n    log.debug('Using application provided turn credentials.')\n  }\n\n  yield put(turnActions.turnChanged(turnInfo))\n}\n","// Call plugin.\nimport { getCallById } from '../../../call/interfaceNew/selectors'\nimport { CALL_STATES } from '../../constants'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../errors'\n\n// Libraries.\nimport { call, select } from 'redux-saga/effects'\nimport { difference, isArray, isObject } from 'lodash/fp'\n\n/**\n * Helper function for sagas that need to perform an operation\n *    on a webRTC session. Checks for common \"error scenarios\".\n * Retrieves information about a \"session\" associated with the\n *    provided call id. \"Session info\" includes the call state\n *    object and webRTC stack session object. Includes an error\n *    if the session is not \"usable\".\n * @method getSessionInfoByCallId\n * @param  {Object} webRTC The webRTC stack.\n * @param  {string} callId The ID of the call.\n * @return {Object} An object with session, targetCall, and/or error objects.\n * @example\n * const callId = action.payload.id\n * const { session, targetCall, error } = yield call(getSessionInfoByCallId, webRTC, callId)\n *\n * if (error) {\n *  // Handle session not being retrievable / common error scenarios.\n * } else if (...) {\n *   // Check for specific error scenarios.\n * } else {\n *   // Operate on session.\n * }\n */\nexport function * getSessionInfoByCallId (webRTC, callId) {\n  const targetCall = yield select(getCallById, callId)\n\n  if (!targetCall) {\n    return {\n      error: new BasicError({\n        message: 'Call state not found: invalid call ID.',\n        code: callCodes.INVALID_PARAM\n      })\n    }\n  } else if (targetCall.state === CALL_STATES.ENDED) {\n    return {\n      targetCall,\n      error: new BasicError({\n        message: 'Call is wrong state: call is already ended.',\n        code: callCodes.INVALID_STATE\n      })\n    }\n  } else if (!targetCall.webrtcSessionId) {\n    return {\n      targetCall,\n      error: new BasicError({\n        message: 'State issue: Call has no webrtcSessionId.',\n        code: callCodes.STATE_DESYNC\n      })\n    }\n  }\n\n  const session = yield call([webRTC.sessionManager, 'get'], targetCall.webrtcSessionId)\n\n  if (!session) {\n    return {\n      targetCall,\n      error: new BasicError({\n        message: 'Session not found: no active webRTC session for call.',\n        code: callCodes.STATE_DESYNC\n      })\n    }\n  }\n\n  return { targetCall, session }\n}\n\n/**\n * Helper function: Check that the call is in an expected state.\n * @method validateCallState\n * @param  {string} callId ID for the call to validate.\n * @param  {Object} expected  Properties that the call state is expected to have.\n * @return {BasicError}\n */\nexport function * validateCallState (callId, expected) {\n  /**\n   * Checks whether set is contained within whole.\n   * Tracks which properties of set are not the same as whole.\n   * @method isSubsetOf\n   * @param  {Object} set\n   * @param  {Object} whole\n   * @return {Array} List of set properties that are not the same as whole.\n   */\n  function isSubsetOf (set, whole) {\n    const differences = []\n    // Ensure that each property in the set is also part of the whole.\n    for (let prop in set) {\n      if (isArray(set[prop])) {\n        // Compare arrays.\n        if (difference(set[prop], whole[prop]).length > 0) {\n          differences.push(prop)\n        }\n      } else if (isObject(set[prop])) {\n        // Compare objects (recursively).\n        if (isSubsetOf(set[prop], whole[prop]).length > 0) {\n          // Don't recursively add to differences.\n          differences.push(prop)\n        }\n      } else {\n        // Compare everything else.\n        if (set[prop] !== whole[prop]) {\n          differences.push(prop)\n        }\n      }\n    }\n\n    return differences\n  }\n\n  const targetCall = yield select(getCallById, callId)\n\n  // Ensure the call state exists.\n  if (!targetCall) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  }\n\n  // Check whether the expected properties are a subset of the call properties.\n  const differences = isSubsetOf(expected, targetCall)\n\n  if (differences.length === 0) {\n    return false\n  } else {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Call is in an invalid state (${differences}).`\n    })\n  }\n}\n\n/**\n * SDP handler function that should be passed into session object's `processOffer` and `processAnswer` function.\n * This function disables old media encryption method SDES (Modifies sdp by removing crypto).\n * However, if only SDES is available, don't disable it.\n * @method sanitizeSdesFromSdp\n * @param {Object} newSdp The sdp so far (could have been modified by previous handlers).\n * @param {RTCSdpType} info Information about the session description.\n * @param {RTCSdpType} info.type The session description's type.\n * @param {string} info.endpoint Which end of the connection created the SDP.\n * @param {Object} originalSdp The sdp in its initial state.\n * @return {Object} The sanitized sdp with crypto removed (if fingerprint exists)\n */\nexport function sanitizeSdesFromSdp (newSdp, info, originalSdp) {\n  for (let mLine of newSdp.media) {\n    if (mLine.crypto && mLine.fingerprint) {\n      delete mLine.crypto\n    }\n  }\n  return newSdp\n}\n","const callPrefix = '@@KANDY/CALL/'\n\n/**\n * Basic call operation actions.\n */\nexport const MAKE_CALL = callPrefix + 'MAKE'\nexport const PENDING_MAKE_CALL = callPrefix + 'PENDING_MAKE'\nexport const SESSION_CREATED = callPrefix + 'SESSION_CREATED'\nexport const MAKE_CALL_FINISH = callPrefix + 'MAKE_FINISH'\n\nexport const MAKE_ANONYMOUS_CALL = callPrefix + 'MAKE_ANONYMOUS_CALL'\n\nexport const CALL_INCOMING = callPrefix + 'INCOMING'\n\nexport const CALL_RINGING = callPrefix + 'RINGING'\nexport const SESSION_PROGRESS = callPrefix + 'SESSION_PROGRESS'\nexport const CALL_CANCELLED = callPrefix + 'CANCELLED'\n\nexport const CALL_AUDIT = callPrefix + 'AUDIT'\n\nexport const ANSWER_CALL = callPrefix + 'ANSWER'\nexport const ANSWER_CALL_FINISH = callPrefix + 'ANSWER_FINISH'\n\nexport const REJECT_CALL = callPrefix + 'REJECT'\nexport const REJECT_CALL_FINISH = callPrefix + 'REJECT_FINISH'\n\nexport const IGNORE_CALL = callPrefix + 'IGNORE'\nexport const IGNORE_CALL_FINISH = callPrefix + 'IGNORE_FINISH'\n\nexport const CALL_ACCEPTED = callPrefix + 'ACCEPTED'\n\nexport const END_CALL = callPrefix + 'END'\nexport const END_CALL_FINISH = callPrefix + 'END_FINISH'\n\nexport const FORWARD_CALL = callPrefix + 'FORWARD_CALL'\nexport const FORWARD_CALL_FINISH = callPrefix + 'FORWARD_CALL_FINISH'\n\nexport const PENDING_OPERATION = callPrefix + 'PENDING_OPERATION'\n\n/**\n * Mid-call operation actions.\n */\n\nexport const UPDATE_CALL = callPrefix + 'UPDATE_CALL'\n\nexport const CALL_HOLD = callPrefix + 'HOLD'\nexport const CALL_HOLD_FINISH = callPrefix + 'HOLD_FINISH'\n\nexport const CALL_UNHOLD = callPrefix + 'UNHOLD'\nexport const CALL_UNHOLD_FINISH = callPrefix + 'UNHOLD_FINISH'\n\nexport const ADD_MEDIA = callPrefix + 'ADD_MEDIA'\nexport const ADD_MEDIA_FINISH = callPrefix + 'ADD_MEDIA_FINISH'\n\nexport const REMOVE_MEDIA = callPrefix + 'REMOVE_MEDIA'\nexport const REMOVE_MEDIA_FINISH = callPrefix + 'REMOVE_MEDIA_FINISH'\n\nexport const MUSIC_ON_HOLD = callPrefix + 'MUSIC_ON_HOLD'\n\nexport const SEND_DTMF = callPrefix + 'SEND_DTMF'\nexport const SEND_DTMF_FINISH = callPrefix + 'SEND_DTMF_FINISH'\n\nexport const GET_STATS = callPrefix + 'GET_STATS'\nexport const GET_STATS_FINISH = callPrefix + 'GET_STATS_FINISH'\n\nexport const CONSULTATIVE_TRANSFER = callPrefix + 'CONSULTATIVE_TRANSFER'\nexport const PENDING_CONSULTATIVE_TRANSFER = callPrefix + 'PENDING_CONSULTATIVE_TRANSFER'\nexport const CONSULTATIVE_TRANSFER_FINISH = callPrefix + 'CONSULTATIVE_TRANSFER_FINISH'\n\nexport const DIRECT_TRANSFER = callPrefix + 'DIRECT_TRANSFER'\nexport const DIRECT_TRANSFER_FINISH = callPrefix + 'DIRECT_TRANSFER_FINISH'\n\nexport const JOIN = callPrefix + 'JOIN'\nexport const PENDING_JOIN = callPrefix + 'PENDING_JOIN'\nexport const JOIN_FINISH = callPrefix + 'JOIN_FINISH'\n\nexport const REPLACE_TRACK = callPrefix + 'REPLACE_TRACK'\nexport const REPLACE_TRACK_FINISH = callPrefix + 'REPLACE_TRACK_FINISH'\n\n/**\n * Remote operation actions.\n */\nexport const CALL_REMOTE_HOLD_FINISH = callPrefix + 'REMOTE_HOLD_FINISH'\nexport const CALL_REMOTE_UNHOLD_FINISH = callPrefix + 'REMOTE_UNHOLD_FINISH'\nexport const REMOTE_ADD_MEDIA_FINISH = callPrefix + 'REMOTE_ADD_MEDIA_FINISH'\nexport const REMOTE_REMOVE_MEDIA_FINISH = callPrefix + 'REMOTE_REMOVE_MEDIA_FINISH'\nexport const REMOTE_START_MOH_FINISH = callPrefix + 'REMOTE_START_MOH_FINISH'\nexport const REMOTE_STOP_MOH_FINISH = callPrefix + 'REMOTE_STOP_MOH_FINISH'\nexport const REMOTE_SLOW_START = callPrefix + 'REMOTE_SLOW_START'\n\n/**\n * Turn action types.\n */\nconst turnPrefix = callPrefix + 'TURN/'\n\nexport const TURN_CHANGED = turnPrefix + 'CHANGED'\n\n/**\n * Track action types.\n */\nconst trackPrefix = callPrefix + 'TRACK/'\n\nexport const TRACK_ADDED = trackPrefix + 'ADDED'\nexport const TRACK_REMOVED = trackPrefix + 'REMOVED'\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { isEmpty } from 'lodash/fp'\n\n/**\n * Helper function for formatting call actions.\n * @method callActionHelper\n * @param  {string} type Action type.\n * @param  {string} id Id of the call being acted on.\n * @param  {Object} [payload={}]\n * @param  {BasicError} [payload.error]\n * @param  {Object} [meta={}]\n * @return {Object} An action.\n */\nfunction callActionHelper (type, id, payload = {}, meta = {}) {\n  /**\n   * Call action format.\n   * Call actions are not FSA-compliant because there are cases where we need\n   *    to provide useful info (for the SDK) and an error object (for the app).\n   *    FSA would require the error object to be the entirety of the payload.\n   * @type {Object}\n   * {\n   *   type,\n   *   payload: {\n   *    ...usefulInfo,\n   *    errorObject\n   *   },\n   *   error,\n   *   meta\n   * }\n   */\n  const action = {\n    type,\n    payload: {\n      ...payload,\n      id\n    }\n  }\n  // Only have meta and error properties on the action if they're needed.\n  if (!isEmpty(meta)) {\n    action.meta = meta\n  }\n  if (payload.error) {\n    action.error = true\n  }\n  return action\n}\n\nexport function makeCall (id, options) {\n  return callActionHelper(actionTypes.MAKE_CALL, id, options)\n}\n\nexport function sessionCreated (id, params) {\n  return callActionHelper(actionTypes.SESSION_CREATED, id, params)\n}\n\nexport function pendingMakeCall (id, options) {\n  return callActionHelper(actionTypes.PENDING_MAKE_CALL, id, options)\n}\n\nexport function makeCallFinish (id, params) {\n  return callActionHelper(actionTypes.MAKE_CALL_FINISH, id, params)\n}\n\nexport function makeAnonymousCall (id, params) {\n  return callActionHelper(actionTypes.MAKE_ANONYMOUS_CALL, id, params)\n}\n\nexport function callIncoming (id, params) {\n  return callActionHelper(actionTypes.CALL_INCOMING, id, params)\n}\n\nexport function callRinging (id, params) {\n  return callActionHelper(actionTypes.CALL_RINGING, id, params)\n}\n\nexport function sessionProgress (id, params) {\n  return callActionHelper(actionTypes.SESSION_PROGRESS, id, params)\n}\n\nexport function callCancelled (id, params) {\n  return callActionHelper(actionTypes.CALL_CANCELLED, id, params)\n}\n\nexport function sendCallAudit (id, params) {\n  return callActionHelper(actionTypes.CALL_AUDIT, id, params)\n}\n\nexport function answerCall (id, options) {\n  return callActionHelper(actionTypes.ANSWER_CALL, id, options)\n}\n\nexport function answerCallFinish (id, params, meta) {\n  return callActionHelper(actionTypes.ANSWER_CALL_FINISH, id, params, meta)\n}\n\nexport function rejectCall (id, options) {\n  return callActionHelper(actionTypes.REJECT_CALL, id, options)\n}\n\nexport function rejectCallFinish (id, params) {\n  return callActionHelper(actionTypes.REJECT_CALL_FINISH, id, params)\n}\n\nexport function callAccepted (id, params) {\n  return callActionHelper(actionTypes.CALL_ACCEPTED, id, params)\n}\n\nexport function ignoreCall (id, params) {\n  return callActionHelper(actionTypes.IGNORE_CALL, id, params)\n}\n\nexport function ignoreCallFinish (id, params) {\n  return callActionHelper(actionTypes.IGNORE_CALL_FINISH, id, params)\n}\n\nexport function endCall (id, params) {\n  return callActionHelper(actionTypes.END_CALL, id, params)\n}\n\nexport function endCallFinish (id, params) {\n  return callActionHelper(actionTypes.END_CALL_FINISH, id, params)\n}\n\nexport function holdCall (id, options) {\n  return callActionHelper(actionTypes.CALL_HOLD, id, options)\n}\n\nexport function holdCallFinish (id, params) {\n  return callActionHelper(actionTypes.CALL_HOLD_FINISH, id, params)\n}\n\nexport function unholdCall (id, options) {\n  return callActionHelper(actionTypes.CALL_UNHOLD, id, options)\n}\n\nexport function unholdCallFinish (id, params) {\n  return callActionHelper(actionTypes.CALL_UNHOLD_FINISH, id, params)\n}\n\nexport function addMedia (id, params) {\n  return callActionHelper(actionTypes.ADD_MEDIA, id, params)\n}\n\nexport function addMediaFinish (id, params) {\n  return callActionHelper(actionTypes.ADD_MEDIA_FINISH, id, params)\n}\n\nexport function removeMedia (id, params) {\n  return callActionHelper(actionTypes.REMOVE_MEDIA, id, params)\n}\n\nexport function removeMediaFinish (id, params) {\n  return callActionHelper(actionTypes.REMOVE_MEDIA_FINISH, id, params)\n}\n\nexport function sendDTMF (id, params) {\n  return callActionHelper(actionTypes.SEND_DTMF, id, params)\n}\n\nexport function sendDTMFFinish (id, params) {\n  return callActionHelper(actionTypes.SEND_DTMF_FINISH, id, params)\n}\n\nexport function getStats (id, params) {\n  return callActionHelper(actionTypes.GET_STATS, id, params)\n}\n\nexport function getStatsFinish (id, params) {\n  return callActionHelper(actionTypes.GET_STATS_FINISH, id, params)\n}\n\nexport function forwardCall (id, params) {\n  return callActionHelper(actionTypes.FORWARD_CALL, id, params)\n}\n\nexport function forwardCallFinish (id, params) {\n  return callActionHelper(actionTypes.FORWARD_CALL_FINISH, id, params)\n}\n\nexport function consultativeTransfer (id, params) {\n  return callActionHelper(actionTypes.CONSULTATIVE_TRANSFER, id, params)\n}\n\nexport function pendingConsultativeTransfer (id, params) {\n  return callActionHelper(actionTypes.PENDING_CONSULTATIVE_TRANSFER, id, params)\n}\n\nexport function consultativeTransferFinish (id, params) {\n  return callActionHelper(actionTypes.CONSULTATIVE_TRANSFER_FINISH, id, params)\n}\n\nexport function directTransfer (id, params) {\n  return callActionHelper(actionTypes.DIRECT_TRANSFER, id, params)\n}\n\nexport function directTransferFinish (id, params) {\n  return callActionHelper(actionTypes.DIRECT_TRANSFER_FINISH, id, params)\n}\n\nexport function join (id, params) {\n  return callActionHelper(actionTypes.JOIN, id, params)\n}\n\nexport function pendingJoin (id, params) {\n  return callActionHelper(actionTypes.PENDING_JOIN, id, params)\n}\n\nexport function joinFinish (id, params) {\n  return callActionHelper(actionTypes.JOIN_FINISH, id, params)\n}\n\nexport function replaceTrack (id, params) {\n  return callActionHelper(actionTypes.REPLACE_TRACK, id, params)\n}\n\nexport function replaceTrackFinish (id, params) {\n  return callActionHelper(actionTypes.REPLACE_TRACK_FINISH, id, params)\n}\n\nexport function pendingOperation (id, params) {\n  return callActionHelper(actionTypes.PENDING_OPERATION, id, params)\n}\n\n/*\n * Remote operations.\n */\n\nexport function remoteHoldFinish (id, params) {\n  return callActionHelper(actionTypes.CALL_REMOTE_HOLD_FINISH, id, params)\n}\n\nexport function remoteUnholdFinish (id, params) {\n  return callActionHelper(actionTypes.CALL_REMOTE_UNHOLD_FINISH, id, params)\n}\n\nexport function remoteAddMediaFinish (id, params) {\n  return callActionHelper(actionTypes.REMOTE_ADD_MEDIA_FINISH, id, params)\n}\n\nexport function remoteRemoveMediaFinish (id, params) {\n  return callActionHelper(actionTypes.REMOTE_REMOVE_MEDIA_FINISH, id, params)\n}\n\nexport function remoteStartMohFinish (id, params) {\n  return callActionHelper(actionTypes.REMOTE_START_MOH_FINISH, id, params)\n}\n\nexport function remoteStopMohFinish (id, params) {\n  return callActionHelper(actionTypes.REMOTE_STOP_MOH_FINISH, id, params)\n}\n\nexport function remoteSlowStart (id, params) {\n  return callActionHelper(actionTypes.REMOTE_SLOW_START, id, params)\n}\n\n// Generic action.\nexport function updateCall (id, params) {\n  return callActionHelper(actionTypes.UPDATE_CALL, id, params)\n}\n","import * as callActionsImport from './call'\nimport * as turnActionsImport from './turn'\n\n// Apparently the following doesn't work:\n//      export * as newName from './place';\n// So import everything from each file, then re-export.\nexport const callActions = callActionsImport\nexport const turnActions = turnActionsImport\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\n/**\n * Represents that TURN information has changed.\n * @method turnChanged\n * @return {Object}\n */\nexport function turnChanged ({ servers, credentials }) {\n  return {\n    type: actionTypes.TURN_CHANGED,\n    payload: {\n      servers,\n      credentials\n    }\n  }\n}\n","// Call plugin.\nimport { callActions as actions } from '../actions'\nimport { getCalls, getCallById, getOptions } from '../selectors'\nimport { normalizeSipUri } from '../../utils/normalization'\n\n// Other plugins.\nimport { getUserInfo, getDomain } from '../../../auth/interface/selectors'\n\n// Libraries.\nimport uuidV4 from 'uuid/v4'\nimport { isEmpty } from 'lodash/fp'\n\nimport { CALL_STATES } from '../../constants'\n\nimport { getLogManager, API_LOG_TAG } from '../../../logs'\n\nconst log = getLogManager().getLogger('CALL')\n\nexport default function callAPI ({ dispatch, getState }) {\n  return {\n    /**\n     * Starts an outgoing call to a {@link call.UserID UserID} or a\n     *    {@link call.PhoneNumber PhoneNumber}.\n     *\n     * The call will be tracked by a unique ID that is returned by the API. The\n     *    application will use this ID to identify and control the call after it\n     *    has been initiated.\n     *\n     * The {@link call.getById} API can be used to retrieve the\n     *    current information about the call.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a {@link call.event:call:start call:start} event\n     *    locally when the operation completes. When the remote participant\n     *    receives the call, a {@link call.event:call:receive call:receive}\n     *    event will be emitted remotely for them.\n     *\n     * The SDK requires access to the machine's media devices (e.g. microphone)\n     *    in order to make a call. If it does not already have permissions to\n     *    use the devices, the user may be prompted by the browser to give\n     *    permissions.\n     * @public\n     * @static\n     * @memberof call\n     * @requires cpaas_call\n     * @method make\n     * @param {UserID|PhoneNumber} destination The desired destination.\n     * @param {Object} media The media options the call should be initialized with.\n     * @param {boolean} [media.audio=false] Whether the call should have audio on start. Currently, audio-less calls are not supported.\n     * @param {Object} [media.audioOptions] Options for configuring the call's audio.\n     * @param {MediaConstraint} [media.audioOptions.deviceId] ID of the microphone to receive audio from.\n     * @param {boolean} [media.video=false] Whether the call should have video on start.\n     * @param {Object} [media.videoOptions] Options for configuring the call's video.\n     * @param {MediaConstraint} [media.videoOptions.deviceId] ID of the camera to receive video from.\n     * @param {MediaConstraint} [media.videoOptions.height] The height of the video.\n     * @param {MediaConstraint} [media.videoOptions.width] The width of the video.\n     * @param {MediaConstraint} [media.videoOptions.frameRate] The frame rate of the video.\n     * @param {Object} [options]\n     * @param {BandwidthControls} [options.bandwidth] Options for configuring media's bandwidth.\n     * @returns {string} The generated ID of the newly created call.\n     * @example\n     * // Listen for the event emitted after making a call.\n     * client.on('call:start', function (params) {\n     *   const { callId, error } = params\n     *   if (error) {\n     *     // Call failed to initialize.\n     *   } else {\n     *     // Call was initialized, and the recipient user will be notified.\n     *   }\n     * })\n     * // Make an audio-only call.\n     * const newCallId = client.call.make(destination, { audio: true })\n     */\n\n    /**\n     * Starts an outgoing call to a {@link call.SIP_URI SIP_URI} or a\n     *    {@link call.TEL_URI TEL_URI}.\n     *\n     * The call will be tracked by a unique ID that is returned by the API. The\n     *    application will use this ID to identify and control the call after it\n     *    has been initiated.\n     *\n     * The {@link call.getById} API can be used to retrieve\n     *    the current information about the call.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a {@link call.event:call:start call:start} event\n     *    locally when the operation completes. When the remote participant\n     *    receives the call, a {@link call.event:call:receive call:receive}\n     *    event will be emitted remotely for them.\n     *\n     * The SDK requires access to the machine's media devices (eg. microphone)\n     *    in order to make a call. If it does not already have permissions to\n     *    use the devices, the user may be prompted by the browser to give\n     *    permissions.\n     * @public\n     * @static\n     * @memberof call\n     * @requires link_call\n     * @method make\n     * @param {SIP_URI|TEL_URI} destination The desired destination.\n     * @param {Object} media The media options the call should be initialized with.\n     * @param {boolean} [media.audio=false] Whether the call should have audio on start. Currently, audio-less calls are not supported.\n     * @param {Object} [media.audioOptions] Options for configuring the call's audio.\n     * @param {MediaConstraint} [media.audioOptions.deviceId] ID of the microphone to receive audio from.\n     * @param {boolean} [media.video=false] Whether the call should have video on start.\n     * @param {boolean} [media.screen=false] Whether the call should have screenshare on start.\n     * @param {Object} [media.videoOptions] Options for configuring the call's video.\n     * @param {Object} [media.screenOptions] Options for configuring the call's screenShare.\n     * @param {MediaConstraint} [media.videoOptions.deviceId] ID of the camera to receive video from.\n     * @param {MediaConstraint} [media.videoOptions.height] The height of the video.\n     * @param {MediaConstraint} [media.videoOptions.width] The width of the video.\n     * @param {MediaConstraint} [media.videoOptions.frameRate] The frame rate of the video.\n     * @param {MediaConstraint} [media.screenOptions.height] The height of the screenShare.\n     * @param {MediaConstraint} [media.screenOptions.width] The width of the screenShare.\n     * @param {MediaConstraint} [media.screenOptions.frameRate] The frame rate of the screenShare.\n     * @param {Object} [options]\n     * @param {BandwidthControls} [options.bandwidth] Options for configuring media's bandwidth.\n     * @param {string} [options.displayName] Custom display name to be provided to the destination. Not supported in all environments and may use default display name.\n     * @returns {string} The generated ID of the newly created call.\n     * @example\n     * // Listen for the event emitted after making a call.\n     * client.on('call:start', function (params) {\n     *   const { callId, error } = params\n     *   if (error) {\n     *     // Call failed to initialize.\n     *   } else {\n     *     // Call was initialized, and the recipient user will be notified.\n     *   }\n     * })\n     * // Make an audio-only call.\n     * const newCallId = client.call.make(destination, { audio: true })\n     */\n    make (destination, media, options = {}) {\n      log.debug(API_LOG_TAG + 'call.make: ', destination, media, options)\n\n      const callId = uuidV4()\n      const from = getUserInfo(getState()).username\n\n      const mediaConstraints = {\n        audio: media.audio && !isEmpty(media.audioOptions) ? media.audioOptions : media.audio,\n        video: media.video && !isEmpty(media.videoOptions) ? media.videoOptions : media.video,\n        screenShare: media.screen && !isEmpty(media.screenOptions) ? media.screenOptions : media.screen\n      }\n\n      const config = getOptions(getState())\n      if (config.normalizeDestination) {\n        // Normalize callee addresses\n        destination = normalizeSipUri(destination, getDomain(getState()))\n        log.info('Address normalized to: ', destination)\n      }\n\n      dispatch(\n        actions.makeCall(callId, {\n          participantAddress: destination,\n          // TODO: Have better property names.\n          from,\n          mediaConstraints,\n          ...options\n        })\n      )\n      return callId\n    },\n\n    /**\n     * Rejects an incoming call.\n     *\n     * The specified call to reject must be in a ringing state with an incoming\n     *    direction. The call will be ended as a result of the operation.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n     *    event locally when the operation completes. The remote participant\n     *    will be notified, through their own\n     *    {@link call.event:call:stateChange call:stateChange} event, that the\n     *    call was rejected.\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @method reject\n     * @param {string} callId The ID of the call to reject.\n     */\n    reject (callId) {\n      log.debug(API_LOG_TAG + 'call.reject: ', callId)\n      dispatch(actions.rejectCall(callId))\n    },\n\n    /**\n     * Answers an incoming call.\n     *\n     * The specified call to answer must be in a ringing state with an incoming\n     *    direction. The call will become connected as a result of the operation.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n     *    event locally when the operation completes. This indicates that the\n     *    call has connected with the remote participant. The\n     *    {@link call.getById} API can be used to retrieve the latest call state\n     *    after the change. Further events will be emitted to indicate that the\n     *    call has received media from the remote participant. See the\n     *    {@link call.event:call:newTrack call:newTrack} event for more\n     *    information about this.\n     *\n     * The SDK requires access to the system's media devices (eg. microphone)\n     *    in order to answer a call. If it does not already have permissions to\n     *    use the devices, the user may be prompted by the browser to give\n     *    permissions.\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @method answer\n     * @param {string} callId The ID of the call to answer.\n     * @param {Object} media The media options the call should be initialized with.\n     * @param {boolean} [media.audio=false] Whether the call should have audio on start. Currently, audio-less calls are not supported.\n     * @param {Object} [media.audioOptions] Options for configuring the call's audio.\n     * @param {MediaConstraint} [media.audioOptions.deviceId] ID of the microphone to receive audio from.\n     * @param {boolean} [media.video=false] Whether the call should have video on start.\n     * @param {boolean} [media.screen=false] Whether the call should have screenshare on start.\n     * @param {Object} [media.videoOptions] Options for configuring the call's video.\n     * @param {Object} [media.screenOptions] Options for configuring the call's screenShare.\n     * @param {MediaConstraint} [media.videoOptions.deviceId] ID of the camera to receive video from.\n     * @param {MediaConstraint} [media.videoOptions.height] The height of the video.\n     * @param {MediaConstraint} [media.videoOptions.width] The width of the video.\n     * @param {MediaConstraint} [media.videoOptions.frameRate] The frame rate of the video.\n     * @param {MediaConstraint} [media.screenOptions.height] The height of the screenShare.\n     * @param {MediaConstraint} [media.screenOptions.width] The width of the screenShare.\n     * @param {MediaConstraint} [media.screenOptions.frameRate] The frame rate of the screenShare.\n     * @param {Object} [options]\n     * @param {BandwidthControls} [options.bandwidth] Options for configuring media's bandwidth.\n     */\n    answer (callId, media, options = {}) {\n      log.debug(API_LOG_TAG + 'call.answer: ', callId, media, options)\n\n      const mediaConstraints = {\n        audio: media.audio && !isEmpty(media.audioOptions) ? media.audioOptions : media.audio,\n        video: media.video && !isEmpty(media.videoOptions) ? media.videoOptions : media.video,\n        screenShare: media.screen && !isEmpty(media.screenOptions) ? media.screenOptions : media.screen\n      }\n\n      dispatch(\n        actions.answerCall(callId, {\n          mediaConstraints,\n          ...options\n        })\n      )\n    },\n\n    /**\n     * Ignores an incoming call.\n     *\n     * The specified call to ignore must be in a ringing state with an incoming\n     *    direction. The call will be ended as a result of the operation.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n     *    event locally when the operation completes. The remote participant\n     *    will not be notified that the call was ignored.\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @method ignore\n     * @param {string} callId The ID of the call to ignore.\n     */\n    ignore (callId) {\n      log.debug(API_LOG_TAG + 'call.ignore: ', callId)\n      dispatch(actions.ignoreCall(callId))\n    },\n\n    /**\n     * Puts a call on hold.\n     *\n     * The specified call to hold must not already be locally held. Any/all\n     *    media received from the remote participant will stop being received,\n     *    and any/all media being sent to the remote participant will stop\n     *    being sent.\n     *\n     * Some call operations cannot be performed while the call is on hold. The\n     *    call can be taken off hold with the {@link call.unhold} API.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n     *    event locally when the operation completes. The remote participant\n     *    will be notified of the operation through a\n     *    {@link call.event:call:stateChange call:stateChange} event as well.\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @method hold\n     * @param {string} callId The ID of the call to hold.\n     */\n    hold (callId) {\n      log.debug(API_LOG_TAG + 'call.hold: ', callId)\n      dispatch(actions.holdCall(callId))\n    },\n\n    /**\n     * Takes a call off hold.\n     *\n     * The specified call to unhold must be locally held. If the call is not\n     *    also remotely held, call media will be reconnected as it was before\n     *    the call was held.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n     *    event locally when the operation completes. The remote participant\n     *    will be notified of the operation through a\n     *    {@link call.event:call:stateChange call:stateChange} event as well.\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @method unhold\n     * @param {string} callId The ID of the call to unhold.\n     */\n    unhold (callId) {\n      log.debug(API_LOG_TAG + 'call.unhold: ', callId)\n      dispatch(actions.unholdCall(callId))\n    },\n\n    /**\n     * Retrieves the information of all calls made during the current session.\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @method getAll\n     * @return {Array<CallObject>} Call objects.\n     * @example\n     * let calls = client.call.getAll()\n     * let currentCalls = calls.filter(call => {\n     *     return call.state === client.call.states.CONNECTED\n     * })\n     */\n    getAll () {\n      log.debug(API_LOG_TAG + 'call.getAll')\n      return getCalls(getState())\n    },\n\n    /**\n     * Retrieves the information of a single call with a specific call ID.\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @static\n     * @method getById\n     * @param {string} callId The ID of the call to retrieve.\n     * @return {CallObject} A call object.\n     */\n    getById (callId) {\n      log.debug(API_LOG_TAG + 'call.getById: ', callId)\n      return getCallById(getState(), callId)\n    },\n\n    /**\n     * Ends an ongoing call.\n     *\n     * The SDK will stop any/all local media associated with the call. Events\n     *    will be emitted to indicate which media tracks were stopped. See the\n     *    {@link call.event:call:trackEnded call:trackEnded} event for more\n     *    information.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n     *    event locally when the operation completes. The remote participant\n     *    will be notified, through their own\n     *    {@link call.event:call:stateChange call:stateChange} event, that the\n     *    call was ended.\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @method end\n     * @param {string} callId The ID of the call to end.\n     */\n    end (callId) {\n      log.debug(API_LOG_TAG + 'call.end: ', callId)\n      dispatch(actions.endCall(callId))\n    },\n\n    /**\n     * Add new media tracks to an ongoing call.\n     * Will get new media tracks from the specific sources to add to the call.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a {@link call.event:call:newTrack call:newTrack} event\n     *    both for the local and remote users to indicate a track has been\n     *    added to the Call.\n     *\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @param {string} callId The ID of the call to add media to.\n     * @param {Object} [media={}] The media options to add to the call.\n     * @param {boolean} [media.audio=false] Whether to add audio to the call.\n     * @param {Object} [media.audioOptions] Options for configuring the call's audio.\n     * @param {MediaConstraint} [media.audioOptions.deviceId] ID of the microphone to receive audio from.\n     * @param {boolean} [media.video=false] Whether to add video to the call.\n     * @param {boolean} [media.screen=false] Whether to add the screenshare to the call.\n     * @param {Object} [media.videoOptions] Options for configuring the call's video.\n     * @param {Object} [media.screenOptions] Options for configuring the call's screenShare.\n     * @param {MediaConstraint} [media.videoOptions.deviceId] ID of the camera to receive video from.\n     * @param {MediaConstraint} [media.videoOptions.height] The height of the video.\n     * @param {MediaConstraint} [media.videoOptions.width] The width of the video.\n     * @param {MediaConstraint} [media.videoOptions.frameRate] The frame rate of the video.\n     * @param {MediaConstraint} [media.screenOptions.height] The height of the screenShare.\n     * @param {MediaConstraint} [media.screenOptions.width] The width of the screenShare.\n     * @param {MediaConstraint} [media.screenOptions.frameRate] The frame rate of the screenShare.\n     * @param {Object} [options]\n     * @param {BandwidthControls} [options.bandwidth] Options for configuring media's bandwidth.\n     */\n    addMedia (callId, media = {}, options = {}) {\n      log.debug(API_LOG_TAG + 'call.addMedia: ', callId, media)\n      const mediaConstraints = {\n        audio: media.audio && !isEmpty(media.audioOptions) ? media.audioOptions : media.audio,\n        video: media.video && !isEmpty(media.videoOptions) ? media.videoOptions : media.video,\n        screenShare: media.screen && !isEmpty(media.screenOptions) ? media.screenOptions : media.screen\n      }\n\n      dispatch(actions.addMedia(callId, { mediaConstraints, ...options }))\n    },\n\n    /**\n     * Remove tracks from an ongoing call.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a {@link call.event:call:trackEnded call:trackEnded}\n     *    event for both the local and remote users to indicate that a track\n     *    has been removed.\n     *\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @param {string} callId The ID of the call to remove media from.\n     * @param {Array} tracks A list of track IDs to remove.\n     * @param {Object} [options]\n     * @param {BandwidthControls} [options.bandwidth] Options for configuring media's bandwidth.\n     */\n    removeMedia (callId, tracks, options = {}) {\n      log.debug(API_LOG_TAG + 'call.removeMedia: ', callId, tracks)\n      dispatch(actions.removeMedia(callId, { tracks, ...options }))\n    },\n\n    /**\n     * Adds local video to an ongoing Call, to start sending to the remote\n     *    participant.\n     *\n     * The latest SDK release (v4.X+) has not yet implemented this API in the\n     *    same way that it was available in previous releases (v3.X). In place\n     *    of this API, the SDK has a more general API that can be used for this\n     *    same behaviour.\n     *\n     * The {@link call.addMedia} API can be used to perform the same behaviour\n     *    as `startVideo`. {@link call.addMedia} is a general-purpose API for\n     *    adding media to a call, which covers the same functionality as\n     *    `startVideo`. Selecting only video options when using\n     *    {@link call.addMedia} will perform the same behaviour as using\n     *    `startVideo`.\n     *\n     * @public\n     * @static\n     * @method startVideo\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @example\n     * // Select media options for adding only video.\n     * const media = {\n     *    audio: false,\n     *    video: true,\n     *    videoOptions: { ... },\n     *    screen: false\n     * }\n     *\n     * // Add the selected media to the call.\n     * client.call.addMedia(callId, media)\n     */\n\n    /**\n     * Removes local video from an ongoing Call, stopping it from being sent\n     *    to the remote participant.\n     *\n     * The latest SDK release (v4.X+) has not yet implemented this API in the\n     *    same way that it was available in previous releases (v3.X). In place\n     *    of this API, the SDK has a more general API that can be used for this\n     *    same behaviour.\n     *\n     * The {@link call.removeMedia} API can be used to perform the same\n     *    behaviour as `stopVideo`. {@link call.removeMedia} is a\n     *    general-purpose API for removing media from a call, which covers the\n     *    same functionality as `stopVideo`. Specifying only the video track(s)\n     *    when using {@link call.removeMedia} will perform the same behaviour\n     *    as using `stopVideo`.\n     *\n     * @public\n     * @static\n     * @method stopVideo\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @example\n     * const call = client.call.getById(callId)\n     * // Get the ID of the Call's video track.\n     * const videoTrack = call.localTracks.find(trackId => {\n     *    const track = call.media.getTrackById(trackId)\n     *    return track.kind === 'video'\n     * })\n     *\n     * // Remove video from the call.\n     * client.call.removeMedia(callId, [ videoTrack ])\n     */\n\n    /**\n     * Adds local screenshare to an ongoing Call, to start sending to the remote\n     *    participant.\n     *\n     * The latest SDK release (v4.X+) has not yet implemented this API in the\n     *    same way that it was available in previous releases (v3.X). In place\n     *    of this API, the SDK has a more general API that can be used for this\n     *    same behaviour.\n     *\n     * The {@link call.addMedia} API can be used to perform the same behaviour\n     *    as `startScreenshare`. {@link call.addMedia} is a general-purpose API\n     *    for adding media to a call, which covers the same functionality as\n     *    `startScreenshare`. Selecting only screen options when using\n     *    {@link call.addMedia} will perform the same behaviour as using\n     *    `startScreenshare`.\n     *\n     * @public\n     * @static\n     * @method startScreenshare\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @example\n     * // Select media options for adding only screenshare.\n     * const media = {\n     *    audio: false,\n     *    video: false,\n     *    screen: true,\n     *    screenOptions: { ... }\n     * }\n     *\n     * // Add the selected media to the call.\n     * client.call.addMedia(callId, media)\n     */\n\n    /**\n     * Removes local screenshare from an ongoing Call, stopping it from being\n     *    sent to the remote participant.\n     *\n     * The latest SDK release (v4.X+) has not yet implemented this API in the\n     *    same way that it was available in previous releases (v3.X). In place\n     *    of this API, the SDK has a more general API that can be used for this\n     *    same behaviour.\n     *\n     * The {@link call.removeMedia} API can be used to perform the same\n     *    behaviour as `stopScreenshare`. {@link call.removeMedia} is a\n     *    general-purpose API for removing media from a call, which covers the\n     *    same functionality as `stopScreenshare`. Specifying only the screen\n     *    track when using {@link call.removeMedia} will perform the same\n     *    behaviour as using `stopScreenshare`.\n     *\n     * There is a caveat that if a Call has multiple video tracks (for example,\n     *    both a video and a screen track), the SDK itself cannot yet\n     *    differentiate one from the other. The application will need to know\n     *    which track was the screen track in this scenario.\n     * @public\n     * @static\n     * @method stopScreenshare\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @example\n     * const call = client.call.getById(callId)\n     * // Get the ID of any/all video tracks on the call.\n     * const videoTracks = call.localTracks.filter(trackId => {\n     *    const track = call.media.getTrackById(trackId)\n     *    // Both video and screen tracks have kind of 'video'.\n     *    return track.kind === 'video'\n     * })\n     *\n     * // Pick out the screen track.\n     * const screenTrack = videoTracks[0]\n     *\n     * // Remove screen from the call.\n     * client.call.removeMedia(callId, [ screenTrack ])\n     */\n\n    /**\n     * Send DTMF tones to a call's audio.\n     *\n     * The provided tone can either be a single DTMF tone (eg. '1') or a\n     *    sequence of DTMF tones (eg. '123') which will be played one after the\n     *    other.\n     *\n     * The specified call must be either in Connected, Ringing, or Early Media\n     *    state, otherwise invoking this API will have no effect.\n     *\n     * The tones will be sent as out-of-band tones if supported by the call,\n     *    otherwise they will be added in-band to the call's audio.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @method sendDTMF\n     * @param {string} callId ID of the call being acted on.\n     * @param {string} tone DTMF tone(s) to send. Valid chracters are ['0','1','2','3','4','5','6','7','8','9','#','*' and ','].\n     * @param {number} [duration=100] The amount of time, in milliseconds, that each DTMF tone should last.\n     * @param {number} [intertoneGap=70] The length of time, in milliseconds, to wait between tones.\n     *\n     */\n    sendDTMF (callId, tone, duration = 100, intertoneGap = 70) {\n      log.debug(API_LOG_TAG + 'call.sendDTMF: ', callId, tone, duration, intertoneGap)\n      dispatch(actions.sendDTMF(callId, { tone, duration, intertoneGap }))\n    },\n\n    /**\n     * Get a report about low-level call statistical information.\n     *\n     * A Track ID can optionally be provided to get a report for a specific\n     *    Track of the Call.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a\n     *    {@link call.event:call:statsReceived call:statsReceived} event, after\n     *    the operation completes, that has the report.\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @param {string} callId The ID of the Call to retrieve the report.\n     * @param {string} [trackId] ID of a Track being used by the Call. If not\n     *    provided, RTCStatsReport is generated for the Call itself.\n     */\n    getStats (callId, trackId) {\n      log.debug(API_LOG_TAG + 'call.getStats: ', callId, trackId)\n      dispatch(actions.getStats(callId, { trackId }))\n    },\n\n    /**\n     * Forwards an incoming call to another user.\n     *\n     * The specified destination will receive the Call instead of the current\n     *    user.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n     *    event after the operation completes.\n     *\n     * @public\n     * @static\n     * @memberof call\n     * @requires link_call\n     * @method forward\n     * @param {string} callId ID of the call being acted on.\n     * @param {SIP_URI|TEL_URI} destination The destination to forward the call to.\n     */\n\n    /**\n     * Forwards an incoming call to another user.\n     *\n     * The specified destination will receive the Call instead of the current\n     *    user.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n     *    event after the operation completes.\n     * @public\n     * @static\n     * @memberof call\n     * @requires cpaas_call\n     * @method forward\n     * @param {string} callId ID of the call being acted on.\n     * @param {UserID|PhoneNumber} destination The destination to forward the call to.\n     */\n    forward (callId, destination) {\n      const config = getOptions(getState())\n      if (config.normalizeDestination) {\n        // Normalize callee addresses\n        destination = normalizeSipUri(destination, getDomain(getState()))\n        log.info('Address normalized to: ', destination)\n      }\n\n      dispatch(actions.forwardCall(callId, { destination }))\n    },\n\n    /**\n     * Performs a \"consultative\" transfer between two ongoing calls (also known\n     *    as an announced or warm transfer). This allows the current user to\n     *    transfer the remote participant of a call to another user, after\n     *    having spoken to both users.\n     *\n     * Both calls used for the transfer must be locally held. After the\n     *    operation, these calls will be ended, as indicated by a\n     *    {@link call.event:call:stateChange call:stateChange} event.\n     *\n     * Both remote participants will see their call be unheld by the operation,\n     *    as indicated by a\n     *    {@link call.event:call:stateChange call:stateChange} event, and will\n     *    be connected to one another afterwards.\n     *\n     * The progression of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event. Both local\n     *    calls will receive this event, since it is an operation on both calls,\n     *    and the remote calls will receive it as if it were a \"remote unhold\"\n     *    operation.\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @method consultativeTransfer\n     * @param {string} callId ID of the call being acted on.\n     * @param {string} otherCallId ID of the other call being acted on.\n     */\n    consultativeTransfer (callId, otherCallId) {\n      dispatch(actions.consultativeTransfer(callId, { otherCallId }))\n    },\n\n    /**\n     * Performs a \"direct\" transfer on a call (also known as an unannounced or\n     *    blind transfer). This allows the current user to transfer the remote\n     *    participant of a call to another user, similar to a \"forward\"\n     *    operation.\n     *\n     * The specified call must be locally held. After the operation, this call\n     *    will be ended, as indicated by a\n     *    {@link call.event:call:stateChange call:stateChange} event.\n     *\n     * The \"destination\" user will receive an incoming call, and when answered,\n     *    they will be connected with the remote participant of the specified\n     *    call.\n     *\n     * The progression of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event. The remote\n     *    participant being transferred will receive it as if it were a \"remote\n     *    unhold\" operation.\n     * @public\n     * @static\n     * @memberof call\n     * @requires link_call\n     * @method directTransfer\n     * @param {string} callId ID of the call being acted on.\n     * @param {SIP_URI|TEL_URI} destination The destination to transfer the call to.\n     */\n\n    /**\n     * Performs a \"direct\" transfer on a call (also known as an unannounced or\n     *    blind transfer). This allows the current user to transfer the remote\n     *    participant of a call to another user, similar to a \"forward\"\n     *    operation.\n     *\n     * The specified call must be locally held. After the operation, this call\n     *    will be ended, as indicated by a\n     *    {@link call.event:call:stateChange call:stateChange} event.\n     *\n     * The \"destination\" user will receive an incoming call, and when answered,\n     *    they will be connected with the remote participant of the specified\n     *    call.\n     *\n     * The progression of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event. The remote\n     *    participant being transferred will receive it as if it were a \"remote\n     *    unhold\" operation.\n     * @public\n     * @static\n     * @memberof call\n     * @requires cpaas_call\n     * @method directTransfer\n     * @param {string} callId ID of the call being acted on.\n     * @param {UserID|PhoneNumber} destination The destination to transfer the call to.\n     */\n    directTransfer (callId, destination) {\n      const config = getOptions(getState())\n      if (config.normalizeDestination) {\n        // Normalize callee addresses\n        destination = normalizeSipUri(destination, getDomain(getState()))\n        log.info('Address normalized to: ', destination)\n      }\n\n      dispatch(actions.directTransfer(callId, { destination }))\n    },\n\n    /**\n     * Performs a \"join\" on two ongoing calls.\n     * This allows the current user to establish a call with audio with two\n     *    remote users.\n     *\n     * Both specified calls must be locally held. The new, \"joined\" call will be\n     *    audio-only, even if either previous call had video. Video cannot be\n     *    added to the \"joined\" call. Both remote participants will see their\n     *    call taken off hold, and will receive additional audio from other\n     *    participants after the operation. Both previous calls for the current\n     *    user will be ended after the operation, as indicated by a\n     *    {@link call.event:call:stateChange call:stateChange} event.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event. Both remote\n     *    participants will also receive this event as if it were a \"remote\n     *    unhold\" operation.\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @method join\n     * @param {string} callId ID of the call being acted on.\n     * @param {string} otherCallId ID of the other call being acted on.\n     */\n    join (callId, otherCallId) {\n      const newCallId = uuidV4()\n      const from = getUserInfo(getState()).username\n      dispatch(actions.join(callId, { otherCallId, newCallId, from }))\n    },\n\n    /**\n     * Replace a call's track with a new track of the same media type.\n     *\n     * The operation will remove the old track from the call and add a\n     *    new track to the call. This effectively allows for changing the\n     *    track constraints (eg. device used) for an ongoing call.\n     *\n     * The progress of the operation will be tracked via the\n     *    {@link call.event:call:operation call:operation} event.\n     *\n     * The SDK will emit a\n     *    {@link call.event:call:trackReplaced call:trackReplaced} event\n     *    locally when the operation completes. The newly added track will need\n     *    to be handled by the local application. The track will be replaced\n     *    seamlessly for the remote application, which will not receive an event.\n     *\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @param {string} callId The ID of the call to replace the track of.\n     * @param {string} trackId The ID of the track to replace.\n     * @param {Object} [media={}] The media options.\n     * @param {boolean} [media.audio=false] Whether to create an audio track.\n     * @param {Object} [media.audioOptions] Options for configuring the audio track.\n     * @param {MediaConstraint} [media.audioOptions.deviceId] ID of the microphone to receive audio from.\n     * @param {boolean} [media.video=false] Whether to create a video track.\n     * @param {Object} [media.videoOptions] Options for configuring the video track.\n     * @param {MediaConstraint} [media.videoOptions.deviceId] ID of the camera to receive video from.\n     * @param {MediaConstraint} [media.videoOptions.height] The height of the video.\n     * @param {MediaConstraint} [media.videoOptions.width] The width of the video.\n     * @param {MediaConstraint} [media.videoOptions.frameRate] The frame rate of the video.\n     * @example\n     * const callId = ...\n     * // Get the video track used by the call.\n     * const videoTrack = ...\n     *\n     * // Replace the specified video track of the call with a new\n     * //    video track.\n     * client.call.replaceTrack(callId, videoTrack.id, {\n     *   // The track should be replaced with a video track using\n     *   //    a specific device. This effectively changes the input\n     *   //    device for an ongoing call.\n     *   video: true,\n     *   videoOptions: {\n     *     deviceId: cameraId\n     *   }\n     * })\n     */\n    replaceTrack (callId, trackId, media) {\n      const mediaConstraints = {\n        audio: media.audio && !isEmpty(media.audioOptions) ? media.audioOptions : media.audio,\n        video: media.video && !isEmpty(media.videoOptions) ? media.videoOptions : media.video\n      }\n      dispatch(actions.replaceTrack(callId, { trackId, mediaConstraints }))\n    },\n\n    /**\n     * Possible states that a Call can be in.\n     *\n     * A Call's state describes the current status of the Call. An application\n     *    should use the state to understand how the Call, and any media\n     *    associated with the Call, should be handled. Which state the Call is\n     *    in defines how it can be interacted with, as certain operations can\n     *    only be performed while in specific states, and tells an application\n     *    whether the Call currently has media flowing between users.\n     *\n     * The Call's state is a property of the {@link call.CallObject CallObject},\n     *    which can be retrieved using the {@link call.getById} or\n     *    {@link call.getAll} APIs.\n     *\n     * The SDK emits a {@link call.event:call:stateChange call:stateChange}\n     *    event when a Call's state changes from one state to another.\n     *\n     * @public\n     * @static\n     * @memberof call\n     * @requires call\n     * @type {Object}\n     * @property {string} INITIATING The (outgoing) call is being started.\n     * @property {string} INITIATED The (outgoing) call has been sent over the network, but has not been received.\n     * @property {string} RINGING The call has been received by both parties, and is waiting to be answered.\n     * @property {string} EARLY_MEDIA The call has not been answered, but media\n     *    is already being received. This may be network-ringing media, IVR\n     *    system media, or other pre-answer medias. When early media is\n     *    supported, this state may replace the Ringing state.\n     * @property {string} CANCELLED The call was disconnected before it could be answered.\n     * @property {string} CONNECTED Both parties are connected and media is flowing.\n     * @property {string} ON_HOLD Both parties are connected but no media is flowing.\n     * @property {string} ENDED The call has ended.\n     * @example\n     * // Use the call states to know how to handle a change in the call.\n     * client.on('call:stateChange', function (params) {\n     *    const call = client.call.getById(params.callId)\n     *    // Check if the call now has media flowing.\n     *    if (call.state === client.call.states.CONNECTED) {\n     *      // The call is now active, and can perform midcall operations.\n     *    }\n     * })\n     */\n    states: CALL_STATES\n\n    /**\n     * The `setDefaultDevices` API from previous SDK releases (3.X) has been\n     *    deprecated in the latest releases (4.X+). The SDK no longer keeps\n     *    track of \"default devices\" on behalf of the application.\n     *\n     * The devices used for a call can be selected as part of the APIs for\n     *    starting the call. Microphone and/or camera can be chosen in the\n     *    {@link call.make} and {@link call.answer} APIs, and speaker can be\n     *    chosen when the audio track is rendered with the\n     *    {@link media.renderTracks} API.\n     * @public\n     * @static\n     * @method setDefaultDevices\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     */\n\n    /**\n     * Changes the camera and/or microphone used for a Call's media input.\n     *\n     * The latest SDK release (v4.X+) has not yet implemented this API in the\n     *    same way that it was available in previous releases (v3.X). In place\n     *    of this API, the SDK has a more general API that can be used for this\n     *    same behaviour.\n     *\n     * The same behaviour as the `changeInputDevices` API can be implemented\n     *    using the general-purpose {@link call.replaceTrack} API. This API can\n     *    be used to replace an existing media track with a new track of the\n     *    same type, allowing an application to change certain aspects of the\n     *    media, such as input device.\n     * @public\n     * @static\n     * @method changeInputDevices\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @example\n     * const call = client.call.getById(callId)\n     * // Get the ID of the Call's video track.\n     * const videoTrack = call.localTracks.find(trackId => {\n     *    const track = client.media.getTrackById(trackId)\n     *    return track.kind === 'video'\n     * })\n     *\n     * // Select the new video options.\n     * const media = {\n     *    video: true,\n     *    videoOptions: {\n     *        deviceId: 'cameraId'\n     *    }\n     * }\n     *\n     * // Change the call's camera by replacing the video track.\n     * client.call.replaceTrack(callId, videoTrack, media)\n     */\n\n    /**\n     * Changes the speaker used for a Call's audio output. Supported on\n     *    browser's that support HTMLMediaElement.setSinkId().\n     *\n     * The latest SDK release (v4.X+) has not yet implemented this API in the\n     *    same way that it was available in previous releases (v3.X). In place\n     *    of this API, the SDK has a more general API that can be used for this\n     *    same behaviour.\n     *\n     * The same behaviour as the `changeSpeaker` API can be implemented by\n     *    re-rendering the Call's audio track.  A speaker can be selected when\n     *    rendering an audio track, so changing a speaker can be simulated\n     *    by unrendering the track with {@link media.removeTracks}, then\n     *    re-rendering it with a new speaker with {@link media.renderTracks}.\n     * @public\n     * @static\n     * @method changeSpeaker\n     * @memberof call\n     * @requires call\n     * @requires callMe\n     * @example\n     * const call = client.call.getById(callId)\n     * // Get the ID of the Call's audio track.\n     * const audioTrack = call.localTracks.find(trackId => {\n     *    const track = client.media.getTrackById(trackId)\n     *    return track.kind === 'audio'\n     * })\n     *\n     * // Where the audio track was previously rendered.\n     * const audioContainer = ...\n     *\n     * // Unrender the audio track we want to change speaker for.\n     * client.media.removeTrack([ audioTrack ], audioContainer)\n     * // Re-render the audio track with a new speaker.\n     * client.media.renderTrack([ audioTrack ], audioContainer, {\n     *    speakerId: 'speakerId'\n     * })\n     */\n  }\n}\n","import callAPI from './call'\n\n/**\n * The 'call' namespace (within the 'api' type) is used to make audio and video calls to and from\n * SIP users and PSTN phones.\n *\n * Call functions are all part of the 'call' namespace.\n *\n * @public\n * @namespace call\n */\n\n/**\n * Information about a Call.\n *\n * Can be retrieved using the {@link call.getAll} or {@link call.getById} APIs.\n *\n * @public\n * @static\n * @module CallObject\n * @typedef {Object} CallObject\n * @memberof call\n * @property {string} id The ID of the call.\n * @property {string} direction The direction in which the call was created. Can be 'outgoing' or 'incoming'.\n * @property {string} state The current state of the call. See {@link call.states} for possible states.\n * @property {boolean} localHold Indicates whether this call is currently being held locally.\n * @property {boolean} remoteHold Indicates whether this call is currently being held remotely.\n * @property {Array<string>} localTracks A list of Track IDs that the call is sending to the remote participant.\n * @property {Array<string>} remoteTracks A list of Track IDs that the call is receiving from the remote participant.\n * @property {Object} remoteParticipant Information about the other call participant.\n * @property {string} [remoteParticipant.displayNumber] The User ID of the remote participant in the form \"username@domain\".\n * @property {string} [remoteParticipant.displayName] The display name of the remote participant.\n * @property {BandwidthControls} bandwidth The bandwidth limitations set for the call.\n * @property {number} startTime The start time of the call in milliseconds since the epoch.\n * @property {number} [endTime] The end time of the call in milliseconds since the epoch.\n */\n\n/**\n * The 'media' namespace provides an interface for interacting with Media that the\n *    SDK has access to. Media is used in conjunction with the {@link call Calls}\n *    feature to manipulate and render the Tracks sent and received from a Call.\n *\n * Media and Track objects are not created directly, but are created as part of\n *    Call operations. Media and Tracks will either be marked as \"local\" or\n *    \"remote\" depending on whether their source is the local user's machine\n *    or a remote user's machine.\n *\n * The Media feature also keeps track of media devices that the user's machine\n *    can access. Any media device (eg. USB headset) connected to the machine\n *    can be used as a source for media. Available devices can be found using\n *    the {@link media.getDevices} API.\n *\n * @public\n * @namespace media\n */\n\n/**\n * The MediaConstraint type defines the format for configuring media options.\n * Either the `exact` or `ideal` property should be provided. If both are present, the\n *    `exact` value will be used.\n *\n * When the `exact` value is provided, it will be the only value considered for the option.\n *    If it cannot be used, the constraint will be considered an error.\n *\n * When the `ideal` value is provided, it will be considered as the optimal value for the option.\n *    If it cannot be used, the closest acceptable value will be used instead.\n *\n * @public\n * @module MediaConstraint\n * @typedef {Object} MediaConstraint\n * @memberof call\n * @property {string} [exact] The required value for the constraint. Other values will not be accepted.\n * @property {string} [ideal] The ideal value for the constraint. Other values will be considered if necessary.\n * @example\n * // Specify video resolution when making a call.\n * client.call.make(destination, {\n *    audio: true,\n *    video: true,\n *    videoOptions: {\n *      // Set height and width constraints to ideally be 1280x720.\n *      height: { ideal: 720 },\n *      width: { ideal: 1280 }\n *    }\n * })\n */\n\n/**\n * The BandwidthControls type defines the format for configuring media and/or track bandwidth options.\n * BandwidthControls only affect received remote tracks of the specified type.\n *\n * @public\n * @module BandwidthControls\n * @typedef {Object} BandwidthControls\n * @memberof call\n * @property {number} [audio] The desired bandwidth bitrate in kilobits per second for received remote audio.\n * @property {number} [video] The desired bandwidth bitrate in kilobits per second for received remote video.\n * @example\n * // Specify received remote video bandwidth limits when making a call.\n * client.call.make(destination, mediaConstraints,\n *  {\n *    bandwidth: {\n *      video: 5\n *    }\n *  }\n * )\n */\n\n/**\n * @public\n * @module IceServer\n * @typedef {Object} IceServer\n * @memberof call\n * @property {Array<string>|string} urls Either an array of URLs for reaching out several ICE servers or a single URL for reaching one ICE server.\n * @property {string} [credential] The credential needed by the ICE server.\n */\n\n/**\n * @public\n * @module SdpHandlerInfo\n * @typedef {Object} SdpHandlerInfo\n * @memberof call\n * @property {RTCSdpType} type The session description's type.\n * @property {string} endpoint Which end of the connection created the SDP.\n */\n\n/**\n * The form of an SDP handler function and the expected arguments that it receives.\n * @public\n * @static\n * @module SdpHandlerFunction\n * @typedef {Function} SdpHandlerFunction\n * @memberof call\n * @param {Object} newSdp The SDP so far (could have been modified by previous handlers).\n * @param {SdpHandlerInfo} info Additional information that might be useful when making SDP modifications.\n * @param {Object} originalSdp The SDP in its initial state.\n * @returns {Object} The resulting modified SDP based on the changes made by this function.\n */\n\n/**\n * The state representation of a Media object.\n * Media is a collection of Track objects.\n *\n * @public\n * @module MediaObject\n * @typedef {Object} MediaObject\n * @memberof call\n * @property {string} id The ID of the Media object.\n * @property {boolean} local Indicator on whether this media is local or remote.\n * @property {Array<TrackObject>} tracks A list of Track objects that are contained in this Media object.\n */\n\n/**\n * A Track is a stream of audio or video media from a single source.\n * Tracks can be retrieved using the Media module's `getTrackById` API and manipulated with other functions of the Media module.\n *\n * @public\n * @module TrackObject\n * @typedef {Object} TrackObject\n * @memberof call\n * @property {Array<string>} containers The list of CSS selectors that were used to render this Track.\n * @property {boolean} disabled Indicator of whether this Track is disabled or not. If disabled, it cannot be re-enabled.\n * @property {string} id The ID of the Track.\n * @property {string} kind The kind of Track this is (audio, video).\n * @property {string} label The label of the device this Track uses.\n * @property {boolean} muted Indicator on whether this Track is muted or not.\n * @property {string} state The state of this Track. Can be 'live' or 'ended'.\n * @property {string} streamId The ID of the Media Stream that includes this Track.\n */\n\n/**\n * A collection of media devices and their information.\n *\n * @public\n * @module DevicesObject\n * @typedef {Object} DevicesObject\n * @memberof call\n * @property {Array<DeviceInfo>} camera A list of camera device information.\n * @property {Array<DeviceInfo>} microphone A list of microphone device information.\n * @property {Array<DeviceInfo>} speaker A list of speaker device information.\n */\n\n/**\n * Contains information about a device.\n *\n * @public\n * @module DeviceInfo\n * @typedef {Object} DeviceInfo\n * @memberof call\n * @property {string} deviceId The ID of the device.\n * @property {string} groupId The group ID of the device. Devices that share a `groupId` belong to the same physical device.\n * @property {string} kind The type of the device (audioinput, audiooutput, videoinput).\n * @property {string} label The name of the device.\n */\n\n/**\n * Call API index.\n * APIs are organized by their namespacing.\n * @method api\n * @param {Object} context\n * @param {Function} context.dispatch The redux store's dispatch function.\n * @param {Function} context.getState The redux store's getState function.\n * @return {Object} The plugin's API object.\n */\nexport default function api (context) {\n  return {\n    call: callAPI(context)\n  }\n}\n","/**\n * Blocking operations that can be performed on a call.\n * ie. no two of thes operations, either local or remote,\n *    can be performed at the same time.\n * TODO: Should all operations just be listed here? Probably.\n */\nexport const OPERATIONS = {\n  // Establishment.\n  MAKE: 'MAKE',\n  ANSWER: 'ANSWER',\n  REJECT: 'REJECT',\n  IGNORE: 'IGNORE',\n  END: 'END',\n  // TODO: Make sure these constants and actionTypes are in-sync with each\n  //    other. Use one to build the other.\n  FORWARD_CALL: 'FORWARD_CALL',\n  // Midcall.\n  HOLD: 'HOLD',\n  UNHOLD: 'UNHOLD',\n  ADD_MEDIA: 'ADD_MEDIA',\n  REMOVE_MEDIA: 'REMOVE_MEDIA',\n  GET_STATS: 'GET_STATS',\n  SEND_DTMF: 'SEND_DTMF',\n  CONSULTATIVE_TRANSFER: 'CONSULTATIVE_TRANSFER',\n  DIRECT_TRANSFER: 'DIRECT_TRANSFER',\n  JOIN: 'JOIN',\n  REPLACE_TRACK: 'REPLACE_TRACK',\n  // Remote-only.\n  START_MOH: 'START_MOH',\n  STOP_MOH: 'STOP_MOH',\n  SLOW_START: 'SLOW_START'\n}\n\n/*\n * Endpoints that can perform operations.\n */\nexport const ENDPOINTS = {\n  LOCAL: 'LOCAL',\n  REMOTE: 'REMOTE'\n  // SERVER: 'SERVER' ?\n}\n\n/*\n * Statuses of an operation.\n */\nexport const OP_STATUS = {\n  ONGOING: 'ONGOING', // The operation is ongoing locally.\n  PENDING: 'PENDING' // The operation is pending remotely.\n}\n\n/*\n * Transitions of an operation.\n */\nexport const OP_TRANSITIONS = {\n  START: 'START', // The operation is starting.\n  UPDATE: 'UPDATE', // The operation is ongoing.\n  FINISH: 'FINISH' // The operation has finished.\n}\n","/**\n * A call operation has either started, been updated, or finished.\n *\n * Information about ongoing call operations are stored with the call\n *    information (see the {@link call.getById} API). This event indicates that\n *    an operation's information has been changed.\n *\n * Local call operations will be tracked from start to finish. An operation may\n *    be updated as it progresses, based on the status of the operation. The\n *    operation status may be ongoing or pending, depending if the operation is\n *    waiting on activity on the local or remote end of the call, respectively.\n *\n * Except in the case of slow-start operations, remote operations will only be\n *    tracked as a \"finish\", to indicate that it occurred.\n * @public\n * @memberof call\n * @event call:operation\n * @param {Object} params\n * @param {string} params.operation The call operation causing this event.\n * @param {string} params.transition The transition reason for the operation change.\n * @param {boolean} params.isLocal Flag indicating whether the operation was local or not.\n * @param {Object} [params.previous] The operation information before this change.\n *    If the transition is to \"start\" the operation, there will be no previous information.\n * @param {string} [params.previous.operation] The operation that was ongoing.\n * @param {string} [params.previous.status] The operation status before this change.\n * @param {BasicError} [params.error] An error object, if the operation was not successful.\n */\nexport const CALL_OPERATION = 'call:operation'\n\n/**\n * An outgoing call has been started.\n *\n * Information about the Call can be retrieved using the {@link call.getById}\n *    API.\n *\n * @public\n * @memberof call\n * @event call:start\n * @param {Object} params\n * @param {string} params.callId The ID of the call.\n * @param {BasicError} [params.error] An error object, if the operation was not successful.\n */\nexport const CALL_STARTED = 'call:start'\n\n/**\n * A new joined call has been started.\n *\n * Information about the Call can be retrieved using the {@link call.getById}\n *    API.\n *\n * @public\n * @memberof call\n * @event call:join\n * @param {Object} params\n * @param {string} params.callId The ID of the call.\n * @param {BasicError} [params.error] An error object, if the operation was not successful.\n */\nexport const CALL_JOIN = 'call:join'\n\n/**\n * A new incoming call has been received.\n *\n * Information about the Call can be retrieved using the {@linkcall.getById}\n *    API.\n *\n * @public\n * @memberof call\n * @event call:receive\n * @param {Object} params\n * @param {string} params.callId The ID of the call.\n * @param {BasicError} [params.error] An error object, if the operation was not successful.\n * @example\n * client.on('call:receive', function(params) {\n *     // We have received a call, prompt the user to respond.\n *     promptUser(client.call.getById(params.callId));\n * });\n */\nexport const CALL_INCOMING = 'call:receive'\n\n/**\n * A Call's state has changed.\n *\n * See {@link call.states} for information about call states.\n * @public\n * @memberof call\n * @event call:stateChange\n * @param {Object} params\n * @param {string} params.callId The ID of the Media object that was operated on.\n * @param {Object} params.previous The call's properties before the operation changed it.\n * @param {string} params.previous.state The previous state of the call.\n * @param {Object} [params.transition]\n * @param {number} [params.transition.statusCode] The status code associated with the particular state change's reason.\n * @param {string} [params.transition.reasonText] The reason for the state change.\n * @param {boolean} [params.previous.localHold] The previous local hold state. Present when the state change was a hold/unhold operation.\n * @param {boolean} [params.previous.remoteHold] The previous remote hold state. Present when the state change was a hold/unhold operation.\n * @param {BasicError} [params.error] An error object, if the operation was not successful.\n * @example\n * client.on('call:stateChange', function (params) {\n *     const call = client.call.getById(params.callId)\n *     const prevState = params.previous.state\n *     log(`Call changed from ${prevState} to ${call.state} state.`)\n *\n *     // Handle the event depending on the new call state.\n *     switch (call.state) {\n *         case client.call.states.CONNECTED:\n *             // Handle being on call with media.\n *             break\n *         case client.call.states.ENDED:\n *             // Handle call ending.\n *             break\n *         ...\n *     }\n * })\n */\nexport const CALL_STATE_CHANGE = 'call:stateChange'\n\n/**\n * New media has been added to the call.\n * @public\n * @memberof call\n * @event call:newMedia\n * @param {Object} params\n * @param {string} params.callId The ID of the call.\n * @param {boolean} params.local Whether the new media is local or not.\n * @param {Array} params.tracks The list of new Tracks.\n * @param {string} params.mediaId The ID of the Media object the Tracks belong to.\n */\nexport const CALL_ADDED_MEDIA = 'call:newMedia'\n\n/**\n * Media has been removed from the call.\n * @public\n * @memberof call\n * @event call:removedMedia\n * @param {Object} params\n * @param {string} params.callId The ID of the call.\n * @param {boolean} params.local Whether the new media is local or not.\n * @param {Array} params.tracks The list of new Tracks.\n */\nexport const CALL_REMOVED_MEDIA = 'call:removedMedia'\n\n/**\n * A new Track has been added to the Call.\n *\n * The Track may have been added by either the local user or remote user using\n *    the {@link call.addMedia} API.\n *\n * Information about the Track can be retrieved using the\n *    {@linkmedia.getTrackById} API.\n *\n * @public\n * @memberof call\n * @event call:newTrack\n * @param {Object} params\n * @param {string} params.callId The ID of the call the track was added to.\n * @param {string} params.mediaId The ID of the media the track was added to.\n * @param {string} params.trackId The ID of the newly added track.\n * @param {boolean} params.local Whether the track is local or not (remote)\n */\nexport const CALL_NEW_TRACK = 'call:newTrack'\n\n/**\n * A Track has been removed from a Call.\n *\n * The Track may have been removed by either the local user or remote user using\n *    the {@link call.removeMedia} API. Tracks are also removed from Calls\n *    automatically while the Call is on hold.\n *\n * @public\n * @memberof call\n * @event call:trackEnded\n * @param {Object} params\n * @param {string} params.callId The ID of the call the track was added to.\n * @param {string} params.mediaId The ID of the media the track was added to.\n * @param {string} params.trackId The ID of the newly added track.\n * @param {boolean} params.local Whether the track is local or not (remote)\n */\nexport const CALL_TRACK_ENDED = 'call:trackEnded'\n\n/**\n * Stats have been retrieved for a Call or specific Track of a Call.\n *\n * See the {@link call.getStats} API for more information.\n *\n * @public\n * @memberof call\n * @event call:statsReceived\n * @param {Object} params\n * @param {string} params.callId The ID of the Call to retrieve stats for.\n * @param {string} [params.trackId] The ID of the Track to retrieve stats for.\n * @param {string} params.result The RTCStatsReport.\n * @param {BasicError} [params.error] An error object, if the operation was not successful.\n */\nexport const STATS_RECEIVED = 'call:statsReceived'\n\n/**\n * A Track has been replaced on the Call.\n *\n * A Track is replaced by the local user using the {@link call.replaceTrack}\n *    API.\n *\n * This event is similar to the {@link call.event:call:newTrack call:newTrack}\n *    event, where the call has a new Track, except that an existing Track has\n *    been removed at the same time. The event includes information about the\n *    Track that was replaced to help an application replace it seamlessly.\n *\n * @public\n * @memberof call\n * @event call:trackReplaced\n * @param {Object} params\n * @param {string} params.callId The ID of the call where a track was replaced.\n * @param {string} [params.newTrackId] The ID of the new track that replaced the old track.\n * @param {TrackObject} [params.oldTrack] State of the replaced track.\n * @param {BasicError} [params.error] An error object, if the operation was not successful.\n */\nexport const CALL_TRACK_REPLACED = 'call:trackReplaced'\n","// Call plugin.\nimport * as eventTypes from './eventTypes'\nimport * as actionTypes from './actionTypes'\nimport { OPERATIONS, OP_TRANSITIONS } from './constants'\n\n// Webrtc plugin.\nimport * as webrtcActionTypes from '../../webrtc/interface/actionTypes'\n\n// Helpers\nimport { getCallById, getCallByWebrtcSessionId } from './selectors'\nimport { cloneDeep } from 'lodash/fp'\n\n/**\n * Helper function to format call events.\n * @method callEventHandler\n * @param  {string} type        The type of event.\n * @param  {Object} action      The action that triggered the event.\n * @param  {Object} [params={}] Any non-consistent information to be included in the event.\n * @return {Object} An event object.\n */\nfunction callEventHandler (type, action, params = {}) {\n  /**\n   * Call event format.\n   * Call events follow a consistent format, based on the consistent format of\n   *    their actions.\n   */\n  return {\n    type,\n    args: {\n      callId: action.payload.id,\n      error: action.error,\n      ...params\n    }\n  }\n}\n\n/**\n * Helper function for converting an action to a \"call state change\" event.\n * Ensures that all such events have consistent parameters.\n * @method stateChangeHandler\n * @param  {Object} action\n * @param  {Object} params\n * @param  {Object} params.prevState Redux state from before the action was processed by reducers.\n * @param  {Object} params.state     Redux state from after the action was processed by reducers.\n * @return {Object} An event object.\n */\nfunction stateChangeHandler (action, params) {\n  // Get the call state before this action updated state.\n  const prevCall = getCallById(params.prevState, action.payload.id)\n\n  return callEventHandler(eventTypes.CALL_STATE_CHANGE, action, {\n    error: action.payload.error,\n    transition: action.payload.transition,\n    previous: {\n      state: prevCall.state,\n      localHold: prevCall.localHold,\n      remoteHold: prevCall.remoteHold\n    }\n  })\n}\n\n/**\n * Helper function for converting an action to a \"call operation\" event.\n * Ensures that all such events have consistent parameters.\n * @method callOperationHandler\n * @param {Object} action\n * @param {Object} params\n * @param {Object} params.prevState The SDK state before this action updated state.\n * @param {string} params.operation The currently occurring operation.\n * @param {string} params.transition The transition reason for the operation change.\n * @param {string} params.isLocal Flag indicating whether the operation is local or not.\n * @param {Object} [any] Additional data provided depending on the operation.\n * @return {Object} An event object.\n */\nfunction callOperationHandler (action, params) {\n  // Get the call state before this action updated state.\n  const prevCall = getCallById(params.prevState, action.payload.id)\n  let previous\n\n  if (prevCall) {\n    previous = params.isLocal ? prevCall.localOp : prevCall.remoteOp\n  }\n\n  return callEventHandler(eventTypes.CALL_OPERATION, action, {\n    // operation params\n    operation: params.operation,\n    transition: params.transition,\n    isLocal: params.isLocal,\n    // previous operation state data\n    previous,\n    // error\n    error: action.payload.error\n  })\n}\n\nexport const callEvents = {}\n\n// START actions\nconst startActionTypesAndOperations = [\n  { type: actionTypes.ANSWER_CALL, operation: OPERATIONS.ANSWER },\n  { type: actionTypes.REJECT_CALL, operation: OPERATIONS.REJECT },\n  { type: actionTypes.IGNORE_CALL, operation: OPERATIONS.IGNORE },\n  { type: actionTypes.END_CALL, operation: OPERATIONS.END },\n  { type: actionTypes.FORWARD_CALL, operation: OPERATIONS.FORWARD_CALL },\n  { type: actionTypes.CALL_HOLD, operation: OPERATIONS.HOLD },\n  { type: actionTypes.CALL_UNHOLD, operation: OPERATIONS.UNHOLD },\n  { type: actionTypes.ADD_MEDIA, operation: OPERATIONS.ADD_MEDIA },\n  { type: actionTypes.REMOVE_MEDIA, operation: OPERATIONS.REMOVE_MEDIA },\n  { type: actionTypes.SEND_DTMF, operation: OPERATIONS.SEND_DTMF },\n  { type: actionTypes.GET_STATS, operation: OPERATIONS.GET_STATS },\n  { type: actionTypes.CONSULTATIVE_TRANSFER, operation: OPERATIONS.CONSULTATIVE_TRANSFER },\n  { type: actionTypes.DIRECT_TRANSFER, operation: OPERATIONS.DIRECT_TRANSFER },\n  { type: actionTypes.JOIN, operation: OPERATIONS.JOIN },\n  { type: actionTypes.REPLACE_TRACK, operation: OPERATIONS.REPLACE_TRACK }\n]\nstartActionTypesAndOperations.forEach(startActionTypeAndOperation => {\n  callEvents[startActionTypeAndOperation.type] = (action, params) => {\n    return callOperationHandler(action, {\n      ...params,\n      operation: startActionTypeAndOperation.operation,\n      transition: OP_TRANSITIONS.START,\n      isLocal: true\n    })\n  }\n})\n\ncallEvents[actionTypes.MAKE_CALL] = (action, params) => {\n  return [\n    callOperationHandler(action, {\n      ...params,\n      operation: OPERATIONS.MAKE,\n      transition: OP_TRANSITIONS.START,\n      isLocal: true\n    }),\n    callEventHandler(eventTypes.CALL_STARTED, action, {\n      error: action.payload.error\n    })\n  ]\n}\n\n// PENDING actions\ncallEvents[actionTypes.PENDING_MAKE_CALL] = (action, params) => {\n  return [\n    callOperationHandler(action, {\n      ...params,\n      operation: OPERATIONS.MAKE,\n      transition: OP_TRANSITIONS.UPDATE,\n      isLocal: true\n    }),\n    stateChangeHandler(action, params)\n  ]\n}\n\ncallEvents[actionTypes.PENDING_OPERATION] = (action, params) => {\n  return callOperationHandler(action, {\n    ...params,\n    operation: action.payload.operation,\n    transition: OP_TRANSITIONS.UPDATE,\n    isLocal: true\n  })\n}\n\ncallEvents[actionTypes.PENDING_CONSULTATIVE_TRANSFER] = (action, params) => {\n  const otherCallAction = cloneDeep(action)\n  otherCallAction.payload.id = action.payload.otherCallId\n  return [\n    callOperationHandler(action, {\n      ...params,\n      operation: OPERATIONS.CONSULTATIVE_TRANSFER,\n      transition: OP_TRANSITIONS.UPDATE,\n      isLocal: true\n    }),\n    callOperationHandler(otherCallAction, {\n      ...params,\n      operation: OPERATIONS.CONSULTATIVE_TRANSFER,\n      transition: OP_TRANSITIONS.UPDATE,\n      isLocal: true\n    })\n  ]\n}\n\ncallEvents[actionTypes.PENDING_JOIN] = (action, params) => {\n  const operationEvents = action.payload.usedCallIds.map(callId => {\n    const newAction = cloneDeep(action)\n    newAction.payload.id = callId\n    return callOperationHandler(newAction, {\n      ...params,\n      operation: OPERATIONS.JOIN,\n      transition: OP_TRANSITIONS.UPDATE,\n      isLocal: true\n    })\n  })\n  operationEvents.push(callEventHandler(eventTypes.CALL_JOIN, action))\n  return operationEvents\n}\n\n// FINISH actions\nconst finishActionTypesAndData = [\n  { type: actionTypes.MAKE_CALL_FINISH, operation: OPERATIONS.MAKE, isLocal: true },\n  { type: actionTypes.CALL_HOLD_FINISH, operation: OPERATIONS.HOLD, isLocal: true },\n  { type: actionTypes.CALL_UNHOLD_FINISH, operation: OPERATIONS.UNHOLD, isLocal: true },\n  { type: actionTypes.CALL_REMOTE_HOLD_FINISH, operation: OPERATIONS.HOLD, isLocal: false },\n  { type: actionTypes.CALL_REMOTE_UNHOLD_FINISH, operation: OPERATIONS.UNHOLD, isLocal: false },\n  { type: actionTypes.REJECT_CALL_FINISH, operation: OPERATIONS.REJECT, isLocal: true },\n  { type: actionTypes.IGNORE_CALL_FINISH, operation: OPERATIONS.IGNORE, isLocal: true },\n  { type: actionTypes.DIRECT_TRANSFER_FINISH, operation: OPERATIONS.DIRECT_TRANSFER, isLocal: true },\n  { type: actionTypes.CONSULTATIVE_TRANSFER_FINISH, operation: OPERATIONS.CONSULTATIVE_TRANSFER, isLocal: true },\n  { type: actionTypes.JOIN_FINISH, operation: OPERATIONS.JOIN, isLocal: true },\n  { type: actionTypes.FORWARD_CALL_FINISH, operation: OPERATIONS.FORWARD_CALL, isLocal: true }\n]\nfinishActionTypesAndData.forEach(finichActionTypeAndData => {\n  callEvents[finichActionTypeAndData.type] = (action, params) => {\n    return [\n      callOperationHandler(action, {\n        ...params,\n        operation: finichActionTypeAndData.operation,\n        isLocal: finichActionTypeAndData.isLocal,\n        transition: OP_TRANSITIONS.FINISH\n      }),\n      stateChangeHandler(action, params)\n    ]\n  }\n})\n\ncallEvents[actionTypes.END_CALL_FINISH] = (action, params) => {\n  return [\n    callOperationHandler(action, {\n      ...params,\n      operation: OPERATIONS.END,\n      transition: OP_TRANSITIONS.FINISH,\n      isLocal: action.payload.isLocal\n    }),\n    stateChangeHandler(action, params)\n  ]\n}\n\ncallEvents[actionTypes.ANSWER_CALL_FINISH] = (action, params) => {\n  const events = []\n  // Emit Call Operation Event\n  events.push(\n    callOperationHandler(action, {\n      ...params,\n      operation: OPERATIONS.ANSWER,\n      transition: OP_TRANSITIONS.FINISH,\n      isLocal: true\n    })\n  )\n\n  // Don't emit a stateChange event if it was a slow start answer. The call isn't actually\n  //    answered yet, so state hasn't changed.\n  // TODO: Don't have this in meta?\n  if (action.meta && action.meta.isSlowStart) {\n    return events\n  }\n\n  events.push(stateChangeHandler(action, params))\n  return events\n}\n\ncallEvents[actionTypes.ADD_MEDIA_FINISH] = (action, params) => {\n  return [\n    callOperationHandler(action, {\n      ...params,\n      operation: OPERATIONS.ADD_MEDIA,\n      transition: OP_TRANSITIONS.FINISH,\n      isLocal: action.payload.local\n    }),\n    callEventHandler(eventTypes.CALL_ADDED_MEDIA, action, {\n      local: action.payload.local,\n      tracks: action.payload.tracks,\n      mediaId: action.payload.mediaId,\n      error: action.payload.error\n    })\n  ]\n}\n\ncallEvents[actionTypes.REMOVE_MEDIA_FINISH] = (action, params) => {\n  return [\n    callOperationHandler(action, {\n      ...params,\n      operation: OPERATIONS.REMOVE_MEDIA,\n      transition: OP_TRANSITIONS.FINISH,\n      isLocal: action.payload.local\n    }),\n    callEventHandler(eventTypes.CALL_REMOVED_MEDIA, action, {\n      local: action.payload.local,\n      tracks: action.payload.tracks,\n      error: action.payload.error\n    })\n  ]\n}\n\ncallEvents[actionTypes.GET_STATS_FINISH] = (action, params) => {\n  return [\n    callOperationHandler(action, {\n      ...params,\n      operation: OPERATIONS.GET_STATS,\n      transition: OP_TRANSITIONS.FINISH,\n      isLocal: true\n    }),\n    callEventHandler(eventTypes.STATS_RECEIVED, action, {\n      result: action.payload.result,\n      error: action.payload.error,\n      trackId: action.payload.trackId\n    })\n  ]\n}\n\ncallEvents[actionTypes.REPLACE_TRACK_FINISH] = (action, params) => {\n  return [\n    callOperationHandler(action, {\n      ...params,\n      operation: OPERATIONS.REPLACE_TRACK,\n      transition: OP_TRANSITIONS.FINISH,\n      isLocal: true\n    }),\n    callEventHandler(eventTypes.CALL_TRACK_REPLACED, action, {\n      error: action.payload.error,\n      newTrackId: action.payload.newTrackId,\n      oldTrack: action.payload.oldTrackState\n    })\n  ]\n}\n\ncallEvents[actionTypes.SEND_DTMF_FINISH] = (action, params) => {\n  return callOperationHandler(action, {\n    ...params,\n    operation: OPERATIONS.SEND_DTMF,\n    transition: OP_TRANSITIONS.FINISH,\n    isLocal: true\n  })\n}\n\n// other actions\ncallEvents[actionTypes.CALL_INCOMING] = action => {\n  return callEventHandler(eventTypes.CALL_INCOMING, action, {\n    error: action.payload.error\n  })\n}\n\ncallEvents[actionTypes.CALL_RINGING] = stateChangeHandler\ncallEvents[actionTypes.SESSION_PROGRESS] = stateChangeHandler\ncallEvents[actionTypes.CALL_CANCELLED] = stateChangeHandler\ncallEvents[actionTypes.CALL_ACCEPTED] = stateChangeHandler\n// TODO: Have a proper event for this since UPDATE_CALL does not change the call's state property.\ncallEvents[actionTypes.UPDATE_CALL] = stateChangeHandler\n\ncallEvents[webrtcActionTypes.SESSION_NEW_TRACK] = (action, context) => {\n  const state = context.state\n  // The webrtc session should have been already created (by handling SESSION_CREATED action -- see above)\n  const call = getCallByWebrtcSessionId(state, action.payload.id)\n\n  if (call) {\n    // By passing callId in the params object it will overwrite\n    // callId that is set in callEventHandler\n    return callEventHandler(eventTypes.CALL_NEW_TRACK, action, {\n      ...action.payload,\n      callId: call.id\n    })\n  }\n  return null\n}\n\ncallEvents[webrtcActionTypes.SESSION_TRACK_ENDED] = (action, context) => {\n  const state = context.state\n  const call = getCallByWebrtcSessionId(state, action.payload.id)\n\n  if (call) {\n    return callEventHandler(eventTypes.CALL_TRACK_ENDED, action, {\n      ...action.payload,\n      callId: call.id\n    })\n  }\n}\n\nexport default {\n  ...callEvents\n}\n","// Import the components of the interface.\nimport api from './api'\nimport reducer from './reducers'\n\n/**\n * This interface is for a call plugin.\n * @type {string}\n */\nconst name = 'call'\n\n// Export the interface as a single object.\nexport default {\n  name,\n  api,\n  reducer\n}\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\nimport { CALL_STATES, CALL_DIRECTION } from '../../constants'\nimport { setOperationState } from '../utils'\n\n// Libraries.\nimport { combineActions, handleActions } from 'redux-actions'\nimport { concat } from 'lodash/fp'\n\n/**\n * A no-op reducer.\n * Some reducers don't need to change state, but need to exist so their actions\n *    can be handled the same way as other actions (eg. wrapped to update local\n *    operation).\n * @method noop\n */\nconst noop = (state, action) => state\n\n/**\n * The reducer logic used for finish operations that end a call.\n * @method callEnder\n */\nconst callEnder = (state, action) => {\n  const now = Date.now()\n  return {\n    ...state,\n    state: CALL_STATES.ENDED,\n    // If there isn't a start time, then the call was never completed.\n    //    Meaning it's duration was 0, so set the start time appropriately.\n    startTime: state.startTime || now,\n    endTime: now,\n    remoteParticipant: {\n      ...state.remoteParticipant,\n      ...action.payload.remoteParticipant\n    },\n    // TODO: Remove this later.\n    isPending: undefined\n  }\n}\n\n// Top-tier reducers: Handles the whole call state.\nconst reducers = {}\n// Call-tier reducers: Handles only a specific call's state.\nconst callReducers = {}\n\n/*\n * Top-tier reducers.\n * Receives the entire call substate as state.\n */\n\n// Add the new call to state.\nreducers[actionTypes.MAKE_CALL] = {\n  next (state, action) {\n    // TODO: Call model? (with defaults for call state)\n    let newCall = {\n      id: action.payload.id,\n      remoteParticipant: {\n        displayNumber: action.payload.participantAddress,\n        displayName: action.payload.participantName\n      },\n      // Number of the remote participant when the call was established.\n      to: action.payload.participantAddress,\n      from: action.payload.from,\n      mediaConstraints: action.payload.mediaConstraints,\n      // TODO: Proper constants.\n      state: CALL_STATES.INITIATING,\n      direction: CALL_DIRECTION.OUTGOING,\n      // Hold status.\n      localHold: false,\n      remoteHold: false,\n      isCaller: true,\n      // Flag indicating whether the call is anonymous or not\n      isAnonymous: action.payload.isAnonymous,\n      // The account token used to make the anonymous call\n      account: action.payload.account\n    }\n\n    // Set the call's operation substate.\n    newCall = setOperationState(newCall, action)\n\n    return concat(state, newCall)\n  }\n}\n\n// Add the new call to state.\nreducers[actionTypes.CALL_INCOMING] = {\n  next (state, action) {\n    return concat(state, {\n      isCaller: false,\n      ...action.payload\n    })\n  }\n}\n\n/*\n * Call-tier reducers.\n * Receive a single call's state as state.\n */\n\ncallReducers[actionTypes.CALL_RINGING] = {\n  next (state, action) {\n    if (action.payload.remoteParticipant) {\n      return {\n        ...state,\n        state: CALL_STATES.RINGING,\n        remoteParticipant: action.payload.remoteParticipant\n      }\n    } else {\n      return {\n        ...state,\n        state: CALL_STATES.RINGING\n      }\n    }\n  }\n}\n\n// Handle Early Media the same as Ringing, just with a different state.\ncallReducers[actionTypes.SESSION_PROGRESS] = {\n  next (state, action) {\n    return {\n      ...state,\n      state: CALL_STATES.EARLY_MEDIA,\n      remoteParticipant: action.payload.remoteParticipant\n    }\n  }\n}\n\n/*\n * Call-tier reducers.\n * Receive a single call's state as state.\n */\n\n/*\n * Some reducers don't need to change state directly, but need to exist.\n * Call-specific reducers are wrapped to keep information about on-going\n *    operations up-to-date.\n */\ncallReducers[actionTypes.PENDING_OPERATION] = noop\ncallReducers[actionTypes.ANSWER_CALL] = noop\ncallReducers[actionTypes.CALL_HOLD] = noop\ncallReducers[actionTypes.CALL_UNHOLD] = noop\ncallReducers[actionTypes.END_CALL] = noop\ncallReducers[actionTypes.ADD_MEDIA] = noop\ncallReducers[actionTypes.REMOVE_MEDIA] = noop\ncallReducers[actionTypes.FORWARD_CALL] = noop\ncallReducers[actionTypes.REJECT_CALL] = noop\ncallReducers[actionTypes.SEND_DTMF] = noop\ncallReducers[actionTypes.SEND_DTMF_FINISH] = noop\ncallReducers[actionTypes.IGNORE_CALL] = noop\ncallReducers[actionTypes.DIRECT_TRANSFER] = noop\ncallReducers[actionTypes.REPLACE_TRACK] = noop\ncallReducers[actionTypes.REPLACE_TRACK_FINISH] = noop\ncallReducers[actionTypes.REMOTE_SLOW_START] = noop\ncallReducers[actionTypes.REMOTE_START_MOH_FINISH] = noop\ncallReducers[actionTypes.REMOTE_STOP_MOH_FINISH] = noop\ncallReducers[actionTypes.GET_STATS] = noop\ncallReducers[actionTypes.GET_STATS_FINISH] = noop\n\ncallReducers[actionTypes.CALL_CANCELLED] = {\n  next (state, action) {\n    return {\n      ...state,\n      state: CALL_STATES.CANCELLED\n    }\n  }\n}\n\ncallReducers[actionTypes.IGNORE_CALL_FINISH] = {\n  next (state, action) {\n    // The call being ignored means it was not completed. Ensure there are times\n    //    in state, and they reflect that the call was not completed.\n    // TODO: Better call times.\n    const now = Date.now()\n\n    return {\n      ...state,\n      startTime: now,\n      endTime: now,\n      state: CALL_STATES.ENDED\n    }\n  }\n}\n\ncallReducers[actionTypes.REJECT_CALL_FINISH] = {\n  next (state, action) {\n    // The call being rejected means it was not completed. Ensure there are\n    //    times in state, and they reflect that the call was not completed.\n    // TODO: Better call times.\n    const now = Date.now()\n\n    return {\n      ...state,\n      startTime: now,\n      endTime: now,\n      state: CALL_STATES.ENDED\n    }\n  }\n}\n\ncallReducers[actionTypes.SESSION_CREATED] = {\n  next (state, action) {\n    // When we get SESSION_CREATED action, the call object already exists as part of reducers state\n    // so we only add the webrtc session id. This way, when call:newTrack action is later triggered,\n    // we can find the call object by searching for this associated webrtcSessionId.\n    return {\n      ...state,\n      webrtcSessionId: action.payload.webrtcSessionId\n    }\n  }\n}\n\ncallReducers[actionTypes.PENDING_MAKE_CALL] = {\n  next (state, action) {\n    return {\n      ...state,\n      state: action.payload.state,\n      wrtcsSessionId: action.payload.wrtcsSessionId,\n      webrtcSessionId: action.payload.webrtcSessionId,\n      bandwidth: action.payload.bandwidth,\n      displayName: action.payload.displayName\n    }\n  }\n}\n\n// Update the new call state based on the outcome.\ncallReducers[actionTypes.MAKE_CALL_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      ...action.payload\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      ...action.payload\n    }\n  }\n}\n\n// Update the call state based on the outcome.\ncallReducers[actionTypes.ANSWER_CALL_FINISH] = {\n  next (state, action) {\n    // If the action has a Session ID, store it as the ID.\n    // In some scenarios (slow start), the we only get an ID\n    //    at the answer step.\n    const webrtcId = action.payload.webrtcSessionId || state.webrtcSessionId\n\n    const newState = {\n      ...state,\n      state: action.payload.state,\n      mediaConstraints: action.payload.mediaConstraints,\n      webrtcSessionId: webrtcId,\n      localHold: false,\n      remoteHold: false,\n      bandwidth: action.payload.bandwidth\n    }\n\n    // Add start time to the call's state here if the call is not a slowstart call\n    if (action.meta && !action.meta.isSlowStart) {\n      newState.startTime = action.payload.startTime\n    }\n\n    return newState\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      ...action.payload\n    }\n  }\n}\n\ncallReducers[actionTypes.CALL_ACCEPTED] = {\n  next (state, action) {\n    return {\n      ...state,\n      ...action.payload\n    }\n  },\n  throw (state, action) {\n    const newState = action.payload.state || state.state\n    return {\n      ...state,\n      state: newState\n    }\n  }\n}\n\n// Handles both success and failure actions the same way.\n// Instead of an object with `next` & `throw` properties, pass in a function.\n// https://redux-actions.js.org/api/handleaction#handleactiontype-reducer-defaultstate\ncallReducers[actionTypes.END_CALL_FINISH] = callEnder\n\ncallReducers[actionTypes.UPDATE_CALL] = {\n  next (state, action) {\n    const { transition, ...payloadWithoutTransition } = action.payload\n    return {\n      ...state,\n      ...payloadWithoutTransition\n    }\n  }\n}\n\ncallReducers[actionTypes.CALL_HOLD_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      localHold: true,\n      state: CALL_STATES.ON_HOLD\n    }\n  }\n}\n\ncallReducers[actionTypes.CALL_UNHOLD_FINISH] = {\n  next (state, action) {\n    const callState = state.remoteHold ? CALL_STATES.ON_HOLD : CALL_STATES.CONNECTED\n    return {\n      ...state,\n      localHold: false,\n      state: callState\n    }\n  }\n}\n\ncallReducers[actionTypes.CALL_REMOTE_HOLD_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      remoteHold: true,\n      state: CALL_STATES.ON_HOLD,\n      remoteParticipant: {\n        ...state.remoteParticipant,\n        ...action.payload.remoteParticipant\n      }\n    }\n  }\n}\n\ncallReducers[actionTypes.CALL_REMOTE_UNHOLD_FINISH] = {\n  next (state, action) {\n    const callState = state.localHold ? CALL_STATES.ON_HOLD : CALL_STATES.CONNECTED\n    return {\n      ...state,\n      remoteHold: false,\n      state: callState,\n      remoteParticipant: {\n        ...state.remoteParticipant,\n        ...action.payload.remoteParticipant\n      }\n    }\n  }\n}\n\ncallReducers[actionTypes.FORWARD_CALL_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      state: CALL_STATES.ENDED\n    }\n  }\n}\n\ncallReducers[actionTypes.DIRECT_TRANSFER_FINISH] = {\n  next: callEnder\n}\n\nreducers[actionTypes.CONSULTATIVE_TRANSFER] = {\n  next (state, action) {\n    const callIds = [action.payload.id, action.payload.otherCallId]\n\n    // Iterate through the calls looking for the two being acted on.\n    //    Update them to set the operation substate.\n    return state.map(call => {\n      if (callIds.includes(call.id)) {\n        return setOperationState(call, action)\n      } else {\n        return call\n      }\n    })\n  }\n}\n\nreducers[actionTypes.PENDING_CONSULTATIVE_TRANSFER] = {\n  next (state, action) {\n    return state.map(call => {\n      if (call.id === action.payload.id || call.id === action.payload.otherCallId) {\n        // Update the local operation in the call's state.\n        return setOperationState(call, action)\n      } else {\n        return call\n      }\n    })\n  }\n}\n\nreducers[actionTypes.CONSULTATIVE_TRANSFER_FINISH] = {\n  next: (state, action) => {\n    return state.map(call => {\n      if (call.id === action.payload.id || call.id === action.payload.otherCallId) {\n        const endedCall = callEnder(call, action)\n        return setOperationState(endedCall, action)\n      } else {\n        return call\n      }\n    })\n  },\n  throw: (state, action) => {\n    return state.map(call => {\n      if (call.id === action.payload.id || call.id === action.payload.otherCallId) {\n        return setOperationState(call, action)\n      } else {\n        return call\n      }\n    })\n  }\n}\n\nreducers[actionTypes.JOIN] = {\n  next (state, action) {\n    // Update operation substate state for both calls used in the operation.\n    const callIds = [action.payload.id, action.payload.otherCallId]\n\n    return state.map(call => {\n      if (callIds.includes(call.id)) {\n        return setOperationState(call, action)\n      } else {\n        return call\n      }\n    })\n  }\n}\n\nreducers[actionTypes.PENDING_JOIN] = {\n  next (state, action) {\n    const newCall = {\n      id: action.payload.id,\n      remoteParticipant: {\n        displayNumber: action.payload.participantAddress,\n        displayName: action.payload.participantName\n      },\n      // TODO: Have better names for `to` & `from`\n      to: action.payload.participantAddress,\n      from: action.payload.from,\n      mediaConstraints: action.payload.mediaConstraints,\n      state: CALL_STATES.INITIATED,\n      direction: CALL_DIRECTION.OUTGOING,\n      // Hold status.\n      localHold: false,\n      remoteHold: false,\n      isCaller: true,\n      wrtcsSessionId: action.payload.wrtcsSessionId,\n      webrtcSessionId: action.payload.webrtcSessionId,\n      isJoinedCall: true\n    }\n\n    return concat(\n      state.map(call => {\n        if (action.payload.usedCallIds.includes(call.id)) {\n          // Update the call's operation substate.\n          return setOperationState(call, action)\n        } else {\n          return call\n        }\n      }),\n      newCall\n    )\n  }\n}\n\nreducers[actionTypes.JOIN_FINISH] = {\n  next: (state, action) => {\n    return state.map(call => {\n      if (\n        call.id === action.payload.id ||\n        (action.payload.usedCallIds && action.payload.usedCallIds.includes(call.id))\n      ) {\n        const endedCall = callEnder(call, action)\n        return setOperationState(endedCall, action)\n      } else {\n        return call\n      }\n    })\n  },\n  throw: (state, action) => {\n    return state.map(call => {\n      if (\n        call.id === action.payload.id ||\n        (action.payload.usedCallIds && action.payload.usedCallIds.includes(call.id))\n      ) {\n        return setOperationState(call, action)\n      } else {\n        return call\n      }\n    })\n  }\n}\n\ncallReducers[actionTypes.ADD_MEDIA_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      bandwidth: action.payload.bandwidth\n    }\n  }\n}\n\ncallReducers[actionTypes.REMOVE_MEDIA_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      bandwidth: action.payload.bandwidth\n    }\n  }\n}\n\n/*\n * Combine all of the call-tier reducers into a single reducer,\n *      each with a default state of empty object.\n */\nconst callReducer = handleActions(callReducers, {})\n\n// Actions routed to call-tier reducers.\nconst specificCallActions = combineActions(\n  actionTypes.PENDING_OPERATION,\n  actionTypes.PENDING_MAKE_CALL,\n  actionTypes.MAKE_CALL_FINISH,\n  actionTypes.ANSWER_CALL,\n  actionTypes.ANSWER_CALL_FINISH,\n  actionTypes.REJECT_CALL,\n  actionTypes.REJECT_CALL_FINISH,\n  actionTypes.CALL_ACCEPTED,\n  actionTypes.CALL_RINGING,\n  actionTypes.SESSION_PROGRESS,\n  actionTypes.CALL_CANCELLED,\n  actionTypes.IGNORE_CALL,\n  actionTypes.IGNORE_CALL_FINISH,\n  actionTypes.END_CALL,\n  actionTypes.END_CALL_FINISH,\n  actionTypes.CALL_HOLD,\n  actionTypes.CALL_HOLD_FINISH,\n  actionTypes.CALL_UNHOLD,\n  actionTypes.CALL_UNHOLD_FINISH,\n  actionTypes.CALL_REMOTE_HOLD_FINISH,\n  actionTypes.CALL_REMOTE_UNHOLD_FINISH,\n  actionTypes.ADD_MEDIA,\n  actionTypes.ADD_MEDIA_FINISH,\n  actionTypes.REMOVE_MEDIA,\n  actionTypes.REMOVE_MEDIA_FINISH,\n  actionTypes.UPDATE_CALL,\n  actionTypes.FORWARD_CALL,\n  actionTypes.FORWARD_CALL_FINISH,\n  actionTypes.DIRECT_TRANSFER,\n  actionTypes.DIRECT_TRANSFER_FINISH,\n  actionTypes.SEND_DTMF,\n  actionTypes.SEND_DTMF_FINISH,\n  actionTypes.JOIN,\n  actionTypes.REPLACE_TRACK,\n  actionTypes.REPLACE_TRACK_FINISH,\n  actionTypes.REMOTE_SLOW_START,\n  actionTypes.REMOTE_START_MOH_FINISH,\n  actionTypes.REMOTE_STOP_MOH_FINISH,\n  actionTypes.GET_STATS,\n  actionTypes.GET_STATS_FINISH,\n  actionTypes.SESSION_CREATED\n)\n\n/*\n * Reducer to handle specific call actions.\n * Routes the actions to the call-tier reducers.\n */\nreducers[specificCallActions] = (state, action) => {\n  return state.map(function (call) {\n    // Only update the call related to the action.\n    if (call.id === action.payload.id) {\n      // Update call state as per the reducer.\n      let updatedCall = callReducer(call, action)\n\n      // Update the operation portion of the call state. This handles both\n      //    successful and failure actions.\n      updatedCall = setOperationState(updatedCall, action)\n      return updatedCall\n    } else {\n      return call\n    }\n  })\n}\n\n/*\n * Combine all of top-tier reducers into a single reducer,\n *      each with a default state of an empty array.\n */\nconst reducer = handleActions(reducers, [])\nexport default reducer\n","import calls from './call'\nimport turn from './turn'\n\n/**\n * Combine subreducers into a single call reducer.\n */\nexport default function (state = {}, action) {\n  return {\n    calls: calls(state.calls, action),\n    turn: turn(state.turn, action)\n  }\n}\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { handleActions } from 'redux-actions'\n\nconst reducers = {}\n\n// Replace any previous information with the new information.\nreducers[actionTypes.TURN_CHANGED] = {\n  next (state, action) {\n    return {\n      ...state,\n      servers: action.payload.servers || state.servers,\n      credentials: {\n        ...state.credentials,\n        ...action.payload.credentials\n      }\n    }\n  }\n}\n\n/*\n * Combine all of top-tier reducers into a single reducer.\n */\nconst reducer = handleActions(reducers, {})\nexport default reducer\n","// Call plugin.\nimport { CALL_STATES } from '../constants'\n\n// Webrtc plugin.\nimport { getSessionById } from '../../webrtc/interface/selectors'\n\n/**\n * Call selectors.\n * Handles retrieving data from the `state.call.calls` substate.\n */\n\n/**\n * Helper function for adding track information to call state.\n * @method addTracksToCall\n * @param  {Object} state\n * @param  {Object} callState\n * @return {Object} Track augmented call state.\n */\nfunction addTracksToCall (state, callState) {\n  const session = getSessionById(state, callState.webrtcSessionId)\n  if (session) {\n    return {\n      ...callState,\n      localTracks: session.localTracks,\n      remoteTracks: session.remoteTracks\n    }\n  } else {\n    return {\n      ...callState,\n      localTracks: [],\n      remoteTracks: []\n    }\n  }\n}\n\n/**\n * Get the list of all calls this session.\n * @method getCalls\n * @param  {Object} state Redux state.\n * @return {Array} A list of all call objects.\n */\nexport function getCalls (state) {\n  // TODO: cloneDeep?\n  return state.call.calls.map(callState => addTracksToCall(state, callState))\n}\n\n/**\n * Retrieves the list of all on-going calls.\n * @method getActiveCalls\n * @param {Object} state Redux state.\n * @return {Array} A list of call objects.\n */\nexport function getActiveCalls (state) {\n  const endedStates = [CALL_STATES.ENDED, CALL_STATES.CANCELLED]\n\n  return getCalls(state).filter(call => !endedStates.includes(call.state))\n}\n\n/**\n * Get the call object of a specific call.\n * @method getCallById\n * @param  {Object} state Redux state.\n * @param  {string} callId The call to retrieve.\n * @return {Object} A call object.\n */\nexport function getCallById (state, callId) {\n  return getCalls(state).find(call => call.id === callId)\n}\n\n/**\n * Get the call object with a specific wrtcsSessionId (backend ID).\n * @method getCallByWrtcsSessionId\n * @param  {Object} state Redux state.\n * @param  {string} wrtcsSessionId The call to retrieve.\n * @return {Object} A call object.\n */\nexport function getCallByWrtcsSessionId (state, wrtcsSessionId) {\n  return getCalls(state).find(call => call.wrtcsSessionId === wrtcsSessionId)\n}\n\n/**\n * Get the call object with a specific webrtcSessionId.\n * @method getCallByWebrtcSessionId\n * @param  {Object} state Redux state.\n * @param  {string} webrtcSessionId The call to retrieve.\n * @return {Object} A call object.\n */\nexport function getCallByWebrtcSessionId (state, webrtcSessionId) {\n  return getCalls(state).find(call => call.webrtcSessionId === webrtcSessionId)\n}\n\n/**\n * Retrieve the call plugin's options.\n * @method getOptions\n * @param  {Object} state Redux state.\n * @return {Object}\n */\nexport function getOptions (state) {\n  return state.config.call\n}\n\n/**\n * Retrieve TURN server/credential information.\n */\nexport function getTurnInfo (state) {\n  return state.call.turn\n}\n","// Call plugin.\nimport { OPERATIONS, OP_STATUS, OP_TRANSITIONS } from './constants'\n\n/*\n * Utility function to parse the operation and operation status from an action.\n * @method getOperationMeta\n * @param  {Object}  actionType A call action.\n * @return {Object}  opMeta             Information about the operation.\n * @return {string}  [opMeta.operation] The call operation the action is about.\n * @return {string}  opMeta.transition  The change in operation the action is for.\n * @return {boolean} opMeta.isLocal     Whether the operation was started locally or not.\n * @throws {Error}   Input must be a standard call action type.\n */\nexport function getOperationMeta (actionType) {\n  // Make sure the input is a call action type.\n  if (typeof actionType !== 'string' || !actionType.includes('/CALL/')) {\n    throw new Error('Invalid input parameter. Must be a Call action.')\n  }\n\n  // Grab the unique part of the action type, after /CALL/\n  const opType = actionType.match(/\\/CALL\\/(.*)/)[1]\n\n  /**\n   * The operation name can be `OPERATION` or `OPER_ATION` (or even multiple _).\n   * It may have the prefix `REMOTE` if it is a remote operation.\n   * It may have the prefix `PENDING` if the operation is now waiting on remote.\n   * It may have the suffix `FINISH` if the operation has ended.\n   * Prefixes / suffixes are separated by a `_`.\n   *\n   * Parse the operation type to split apart the possible sections. Use those\n   *    sections to infer informaton about the operation.\n   */\n  const opMeta = {}\n  const parts = opType.split('_')\n\n  /**\n   * Check the parts for prefixes and update opMeta based on whichever are found.\n   */\n  const validPrefixes = ['REMOTE', 'PENDING']\n  const prefixes = []\n\n  // Check the first parts for prefixes.\n  while (validPrefixes.includes(parts[0])) {\n    // Take the prefix from `parts` and add it to `prefixes`.\n    prefixes.push(parts.shift())\n  }\n\n  // Handle the 'REMOTE' prefix.\n  //    The lack of this prefix means the operation was started locally.\n  opMeta.isLocal = !prefixes.includes('REMOTE')\n\n  // Handle the 'PENDING' prefix.\n  //    The lack of this prefix means the operation is either starting or ending.\n  if (prefixes.includes('PENDING')) {\n    opMeta.transition = OP_TRANSITIONS.UPDATE\n    /**\n     * The `PENDING` prefix is a special-case because it means an operation was\n     *    `ongoing` and is changing to `pending`. We know there won't be a\n     *    suffix, and the operation is already in state, so we don't need to\n     *    find it here (also, it isn't included here).\n     */\n    return opMeta\n  }\n\n  /**\n   * Check the parts for suffixes and update opMeta based on whichever are found.\n   */\n  const validSuffixes = ['FINISH']\n  const suffixes = []\n\n  // Check the last parts for suffixes.\n  while (validSuffixes.includes(parts[parts.length - 1])) {\n    // Take the suffix out of `parts` and add it to `suffixes`.\n    suffixes.push(parts.pop())\n  }\n\n  // Handle the 'FINISH' suffix.\n  //    The lack of this suffix means the operation is just starting (since we\n  //    already checked for the `pending` change before this).\n  opMeta.transition = suffixes.includes('FINISH') ? OP_TRANSITIONS.FINISH : OP_TRANSITIONS.START\n\n  /**\n   * Recombine the remaining parts as the operation.\n   */\n  opMeta.operation = OPERATIONS[parts.join('_')]\n  return opMeta\n}\n\n/**\n * Reducer utility: Wraps a call reducer to update a call's operation subsate.\n *    Only affects either `call.localOp` or `call.remoteOp` portion of state.\n * @method setOperationState\n * @param  {Object} state  Redux state of a [single] call.\n * @param  {Object} action A call action.\n */\nexport function setOperationState (state, action) {\n  let meta\n  try {\n    meta = getOperationMeta(action.type)\n  } catch (err) {\n    // Action type is not a call operation, don't change operation state.\n    return state\n  }\n\n  // The operation has to be defined for start/finish transitions.\n  //    Don't update state if it isn't.\n  if (!meta.operation && meta.transition !== OP_TRANSITIONS.UPDATE) {\n    return state\n  }\n\n  // Determine which operation substate we should be acting on.\n  const stateProp = meta.isLocal ? 'localOp' : 'remoteOp'\n  const current = state[stateProp]\n\n  if (meta.transition === OP_TRANSITIONS.START) {\n    // A new operation is starting...\n\n    if (current) {\n      // ...but there is still an on-going op.\n      // The new operation should be rejected, so state should not change.\n      return state\n    } else {\n      // ...and there is no current operation on-going.\n      // Set the new operation in state.\n      return {\n        ...state,\n        [stateProp]: {\n          operation: meta.operation,\n          status: OP_STATUS.ONGOING\n        }\n      }\n    }\n  } else if (meta.transition === OP_TRANSITIONS.UPDATE) {\n    return {\n      ...state,\n      [stateProp]: {\n        ...state[stateProp],\n        status: OP_STATUS.PENDING,\n        operationData: action.payload.operationData\n      }\n    }\n  } else {\n    // An on-going operation is finishing...\n\n    if (current && current.operation === meta.operation) {\n      // The operation matches the current on-going operation.\n      // Unset it in state.\n      return {\n        ...state,\n        [stateProp]: undefined\n      }\n    } else if (!meta.isLocal && current && current.operation === OPERATIONS.SLOW_START) {\n      // Special case: If the current operation was a remote slow start,\n      //    then the 'finish' won't match. Allow any 'finish' to unset it.\n      return {\n        ...state,\n        [stateProp]: undefined\n      }\n    } else {\n      // ...but it wasn't tracked in state?\n      // Should be considered an error scenario.\n      return state\n    }\n  }\n}\n","/**\n * Extracts the domain from an address if an @ symbol exists and isn't at the start or end of the address.\n * @param {string} addressString The address string to extract the domain from (if it exists).\n * @returns {string} The extracted domain. Empty string of none found.\n */\nfunction extractDomainFromAddress (addressString) {\n  const indexOfAtSymbol = addressString.lastIndexOf('@')\n  if (indexOfAtSymbol !== 0 && indexOfAtSymbol !== addressString.length - 1) {\n    // If '@' symbol found in middle of addressString, split it.\n    if (indexOfAtSymbol !== -1) {\n      return addressString.substr(indexOfAtSymbol + 1)\n    }\n  }\n  return ''\n}\n\n/**\n * Determines which address and domain to use depending on whether the address string contains a domain or not.\n * @param {string} addressString The address string to examine and extract a domain from (if any).\n * @param {string} defaultDomainString The domain to use if the address string does not contain a domain in it.\n * @returns {Object} An object containing the correct address and domain to use.\n */\nfunction separateAddressAndDomain (addressString, defaultDomainString) {\n  const extractedDomain = extractDomainFromAddress(addressString)\n  // If a domain was extracted from the address, use that as the domain and strip it from the address.\n  if (extractedDomain) {\n    return {\n      address: addressString.substr(0, addressString.length - extractedDomain.length - 1),\n      domain: extractedDomain\n    }\n  } else {\n    return {\n      address: addressString,\n      domain: defaultDomainString\n    }\n  }\n}\n\n/**\n * Extracts any pre-pended data before a \":\" (if it exists) from the beginning of a string.\n * @param {string} inputString The string to remove pre-pended data from.\n * @returns {string} The pre-pended data string.\n */\nfunction extractPrependedData (inputString) {\n  const prependedDataMatches = inputString.match(/^.*:/g)\n  if (prependedDataMatches && prependedDataMatches[0]) {\n    return prependedDataMatches[0]\n  } else {\n    return ''\n  }\n}\n\n/**\n * Finds the leading special characters (\"#\", \"+\", \"*\") of an address if it is a phone number.\n * If the address contains letters or any non-visual-separator characters,\n *  it is not a phone number and no leading special characters will be found.\n * @param {string} addressString The address string to find the leading characters of (if any).\n *  The addressString must not contain any pre-pended data such as \"sip:\".\n *  The addressString must not contain a domain.\n * @returns {string} The leading special characters as one string. Empty string if none found.\n */\nfunction extractLeadingSpecialCharacters (addressString) {\n  // A single or group of contiguous characters are considered leading character/s if it is  the following:\n  // - starts at the beginning of the string - ^\n  // - is any of the following characters - [#+*]+\n  // - is followed by a digit or \"(\" - [\\d|(]\n  // - is followed by any number of only digits and visual separators - [\\d \\-.()+]*$\n  const potentialLeadingChars = addressString.match(/^[#+*]+[\\d|(][\\d \\-.()+]*$/g)\n  if (potentialLeadingChars && potentialLeadingChars[0]) {\n    // Guaranteed to have a match for regex [#+*]+ since we have potentialLeadingChars\n    // which was a match for a similar regex and we are simply extracting the leading characters part.\n    const actualLeadingChars = potentialLeadingChars[0].match(/[#+*]+/g)\n    return actualLeadingChars[0]\n  }\n  return ''\n}\n\n/**\n * Outputs a new string without its phone number visual separators (\"-\", \".\", \"(\", \")\", \"+\").\n * @param {string} inputString The string to remove visual separators from.\n * @returns {string} A new string without visual separators.\n */\nfunction withoutVisualSeparators (inputString) {\n  return inputString.replace(/[ \\-.()+]/g, '')\n}\n\n/**\n * Determines whether a string should be considered a phone number or not.\n * @param {string} addressString The address string to check.\n *  The addressString must not contain any pre-pended data such as \"sip:\"\n *  The addressString must not contain any leading special characters.\n *  The addressString must not contain a domain.\n * @returns {boolean} True if the input string is a phone number. False if it is not.\n */\nfunction isPhoneNumber (addressString) {\n  const cleanNumber = withoutVisualSeparators(addressString)\n  const phoneNumberMatch = cleanNumber.match(/^\\d+$/g)\n  return phoneNumberMatch && phoneNumberMatch.length === 1\n}\n\n/**\n * Processes the address string and returns the correct output.\n * If the address is a phone number, visual separators are removed.\n * Otherwise, it will just return the address as-is.\n * @param {string} addressString The address string to process.\n *  The addressString must not contain any pre-pended data such as \"sip:\".\n *  The addressString must not contain any leading special characters (if it is a phone number).\n *  The addressString must not contain a domain.\n * @returns {string} A phone number without visual-separators or the addressString as-is.\n */\nfunction processAddress (addressString) {\n  return isPhoneNumber(addressString) ? withoutVisualSeparators(addressString) : addressString\n}\n\n/**\n * Processes the domain string and returns the correct output.\n * Adds an \"@\" symbol if it isn't present at the beginning of the domain.\n * @param {string} domainString The domain string to process.\n * @returns {string} The domain with \"@\" symbol at the beginning if it doesn't exist.\n */\nfunction processDomain (domainString) {\n  return (domainString.indexOf('@') === 0 ? '' : '@') + domainString\n}\n\n/**\n *The function takes in the input dial string and domain address of the user, performs a normalization process based on the phone number handling normalization rules\n * @function normalizeSipUri\n * @param {string} address   It contains the input dial string the user dials in or the callee address\n * @param {string} domain    It contains the user's domain address\n * @returns {string} output  The output which is the normalized callee address/phone number\n */\nexport function normalizeSipUri (address, domain) {\n  // Remove leading and trailing white spaces.\n  address = address.trim()\n\n  // Extract domain.\n  const resultingAddressAndDomain = separateAddressAndDomain(address, domain)\n  domain = resultingAddressAndDomain.domain\n  address = resultingAddressAndDomain.address\n\n  // Extract pre-pended \"sip:\".\n  const prepend = extractPrependedData(address)\n  address = address.substr(prepend.length)\n\n  // Extract leading characters.\n  const leadingChars = extractLeadingSpecialCharacters(address)\n  address = address.substr(leadingChars.length)\n\n  // Process and build parts into final output in the form of `<prepend>:<leadingChars><address>@<domain>`.\n  return 'sip:' + leadingChars + processAddress(address) + processDomain(domain)\n}\n","// Libraries\nimport sdpTransform from 'sdp-transform'\n\n/**\n * Set all media to inactive in a given sdp string\n * @method setMediaInactive\n * @param  {string}  sdp An sdp string\n * @return {string}  Modified sdp string with media direction set to inactive\n */\nexport function setMediaInactive (sdp) {\n  const regex = /sendrecv|sendonly|recvonly/gi\n  if (!sdp || typeof sdp !== 'string') {\n    return\n  }\n\n  return sdp.replace(regex, 'inactive')\n}\n\n/**\n * Helper function that returns a boolean if media is active or not.\n * @method hasMediaFlowing\n * @param  {string} sdp String representation of a calls sdp.\n */\nexport function * hasMediaFlowing (sdp) {\n  const objectSdp = sdpTransform.parse(sdp)\n\n  // Check that video directions (if there are any) indicate a \"hold\" scenario.\n  const isVideoInactive = objectSdp.media\n    .filter(item => item.type === 'video')\n    .every(media => media && media.direction === 'inactive')\n\n  // Check that audio directions (if there are any) indicate a \"hold\" scenario.\n  const isAudioInactive = objectSdp.media\n    .filter(item => item.type === 'audio')\n    // Special case: In music on hold scenarios, audio may be `sendonly`\n    //    so that the held user can still receive the \"hold music\".\n    .every(media => media && ['inactive', 'sendonly'].includes(media.direction))\n\n  return !isVideoInactive || !isAudioInactive\n}\n\n/**\n * Helper function that returns a boolean if media sendonly (music on hold).\n * @method hasMusicOnHold\n * @param  {string} sdp String representation of a calls sdp.\n */\nexport function * hasMusicOnHold (sdp) {\n  const objectSdp = sdpTransform.parse(sdp)\n  const isMusicOnHold = objectSdp.media\n    .filter(item => item.type === 'audio')\n    .some(media => media && media.direction === 'sendonly')\n\n  // Check that video directions (if there are any) indicate a \"hold\" scenario.\n  const isVideoInactive = objectSdp.media\n    .filter(item => item.type === 'video')\n    .every(media => media && media.direction === 'inactive')\n\n  return isMusicOnHold && isVideoInactive\n}\n","// Helpers.\nimport { CALL_STATES, CALL_MEDIA_STATES } from '../constants'\n\n/**\n * Retrieves the current state of media flow based on a call's state.\n * @method getMediaState\n * @param  {Object} callState A call's state.\n * @return {string} A CALL_MEDIA_STATES enum value.\n */\nexport function getMediaState (callState) {\n  if (hasMedia(callState)) {\n    return CALL_MEDIA_STATES.CONNECTED\n  } else if (isLocalHold(callState)) {\n    return CALL_MEDIA_STATES.LOCAL_HOLD\n  } else if (isRemoteHold(callState)) {\n    return CALL_MEDIA_STATES.REMOTE_HOLD\n  } else if (isDualHold(callState)) {\n    return CALL_MEDIA_STATES.DUAL_HOLD\n  }\n}\n\n/**\n * Checks whether the call state indicates that the call has media.\n * @method hasMedia\n * @param  {Object}  callState Redux call state.\n * @return {boolean}\n */\nexport function hasMedia (callState) {\n  return callState.state === CALL_STATES.CONNECTED && !callState.localHold && !callState.remoteHold\n}\n\n/**\n * Checks whether the call state indicates that the call is locally held (only).\n * @method isLocalHold\n * @param  {Object}  callState Redux call state.\n * @return {boolean}\n */\nexport function isLocalHold (callState) {\n  return callState.state === CALL_STATES.ON_HOLD && callState.localHold && !callState.remoteHold\n}\n\n/**\n * Checks whether the call state indicates that the call is remotely held (only).\n * @method isRemoteHold\n * @param  {Object}  callState Redux call state.\n * @return {boolean}\n */\nexport function isRemoteHold (callState) {\n  return callState.state === CALL_STATES.ON_HOLD && !callState.localHold && callState.remoteHold\n}\n\n/**\n * Checks whether the call state indicates that the call is both locally and\n *    remote held.\n * @method isDualHold\n * @param  {Object}  callState Redux call state.\n * @return {boolean}\n */\nexport function isDualHold (callState) {\n  return callState.state === CALL_STATES.ON_HOLD && callState.localHold && callState.remoteHold\n}\n","/**\n * dtmf.js contains one call operation:\n *    - sendDtmf: Send DTMF tone(s) over a call.\n *\n * and several \"helper\" functions for it:\n *    - playInBand: Functionality for in-band DTMF.\n *    - playOutBand: Functionality for out-of-band DTMF.\n *      - addTones: Generates DTMF tones and adds them to the audio.\n *    - hasTelephoneEvent: Helper to determine out-of-band DTMF support.\n *    - convertTone, splitTones: Helpers for parsing input.\n */\n\n// Call plugin.\nimport { callActions } from '../../call/interfaceNew/actions'\nimport { getCallById } from '../../call/interfaceNew/selectors'\nimport { CALL_STATES } from '../../call/constants'\n\n// Other plugins.\nimport { getLogManager } from '../../logs'\nimport BasicError, { callCodes } from '../../errors'\n\n// Libraries.\nimport { call, delay, put, select } from 'redux-saga/effects'\nimport sdpTransform from 'sdp-transform'\n\nconst log = getLogManager().getLogger('CALL')\n\n/**\n * Entry saga for sending DTMF tones on a call.\n *\n * Determines if the DTMF tones need to be out-of-band (preferred) or in-band.\n *    Referes to helper functions to send the tones.\n *\n * Assumptions:\n *    1. None; everything is checked.\n * Responsibilities:\n *    1. Validate the operation is currently possible.\n *    2. Determine if out-of-band tones are possible for the call.\n *    3. Send the tones, depending on method available.\n * @method sendDtmf\n * @param {Object} deps        Dependencies that the saga uses.\n * @param {Object} deps.webRTC The WebRTC stack.\n * @param {Object} action      A \"send dtmf\" action.\n */\nexport function * sendDtmf (deps, action) {\n  const { webRTC } = deps\n\n  // Get the call.\n  const targetCall = yield select(getCallById, action.payload.id)\n\n  let error\n  /**\n   * Operation requirements:\n   *    1. The call exists.\n   *    2. The call is either Connected, Ringing, or Early Media.\n   *    3. A valid tone was provided.\n   */\n  if (!targetCall) {\n    log.info(`Failed to send DTMF tones on unknown call ${action.payload.id}`)\n    error = new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (![CALL_STATES.CONNECTED, CALL_STATES.RINGING, CALL_STATES.EARLY_MEDIA].includes(targetCall.state)) {\n    log.info(`Failed to send DTMF tones on call ${targetCall.id}: Bad call state.`)\n    error = new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Call is in an invalid state (${targetCall.state}).`\n    })\n  } else if (!action.payload.tone) {\n    log.info(`Failed to send DTMF tones on call ${targetCall.id}: Invalid tone.`)\n    error = new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'No DTMF tone specified.'\n    })\n  }\n\n  if (error) {\n    // Stop the operation if it cannot be performed right now.\n    yield put(callActions.sendDTMFFinish(action.payload.id, { error }))\n    return\n  }\n\n  // Get the webrtc Session for the call.\n  const session = yield call([webRTC.sessionManager, 'get'], targetCall.webrtcSessionId)\n  // Get the remote description for the Session.\n  const remoteDesc = yield call([session, 'getRemoteDescription'])\n\n  // TODO: Is this the correct SDP to use?\n  let canSendOutBand = yield call(hasTelephoneEvent, remoteDesc.sdp)\n\n  let result\n  if (canSendOutBand) {\n    log.debug(`Sending DTMF tones out-of-band for call ${targetCall.id}.`)\n    result = yield call(playOutBand, session, action.payload)\n  } else {\n    log.debug(`Sending DTMF tones in-band for call ${targetCall.id}.`)\n    result = yield call(playInBand, session, action.payload)\n  }\n\n  if (result) {\n    log.info(`Successfully sent DTMF tones for call ${targetCall.id}.`)\n    yield put(callActions.sendDTMFFinish(action.payload.id))\n  } else {\n    log.debug(`Failed to send DTMF tones for call ${targetCall.id}.`)\n    yield put(\n      callActions.sendDTMFFinish(action.payload.id, {\n        error: new BasicError({\n          code: callCodes.GENERIC_ERROR,\n          message: `Unable to send DTMF tones for call ${targetCall.id}.`\n        })\n      })\n    )\n  }\n}\n\n/**\n * Sends DTMF tones out-of-band over a Session.\n * This saga defines how out-of-band tones are sent over a call.\n *\n * The Callstack implementation uses the WebRTC stack's implementation for this.\n *    There is no signaling involved.\n *\n * @method playOutBand\n * @param  {Session} session A Webrtc Session object.\n * @param  {Object}  options\n * @param  {string}  options.tone           The tone sequence.\n * @param  {number}  [options.duration]     The length of each DTMF tone.\n * @param  {number}  [options.intertoneGap] The gap between each DTMF tone.\n * @return {boolean} Whether the operation was succesful or not.\n */\nexport function * playOutBand (session, options) {\n  const result = yield call([session, 'sendDTMF'], options)\n  return result\n}\n\n/**\n * Sends DTMF tones in-band over a Session.\n * This saga defines how in-band tones are sent over a call.\n *\n * DTMF tones are added to the audio track by using AudioContext nodes. A\n *    MediaStream is converted into an audio node, which allows us to add more\n *    audio inputs into the node. The original audio and DTMF tones are mixed\n *    into a single node this way, and the track from this node temporarily\n *    replaces the original track in the Session.\n *\n *                       +-------------------------+\n *    Original           | Additional Audio Source |\n *   MediaStream         +---------+---------------+\n *       |                         |\n *       |                         |\n *       v                         v\n * +-----+-------+         +-------+----------+\n * | Source Node +-------->| Destination Node |\n * +-------------+         +-------+----------+\n *                                 |\n *                                 |\n *                                 v\n *                         MediaStream w/ DTMF\n *\n * @method playInBand\n * @param  {Session} session A Webrtc Session object.\n * @param  {Object}  options\n * @param  {string}  options.tone           The tone sequence.\n * @param  {number}  [options.duration=100]     The length of each DTMF tone.\n * @param  {number}  [options.intertoneGap=70]  The gap between each DTMF tone.\n * @return {boolean} Whether the operation was succesful or not.\n */\nexport function * playInBand (session, options) {\n  let { tone, duration, intertoneGap: gap } = options\n\n  // Ensure optional options are numbers (not strings). If not numbers, or\n  //    undefined, use default values.\n  duration = Number(duration) > 0 ? Number(duration) : 100\n  gap = Number(gap) > -1 ? Number(gap) : 70\n\n  // Get the (native) track the tones will be inserted into.\n  let track\n  for (let localTrack of session.localTracks) {\n    // Matching the track is done this way because we need to yield to getState,\n    //    but we can't yield inside of a `.find(func)` or similar. So iterate\n    //    over the new tracks \"manually\".\n    const state = yield call([localTrack, 'getState'])\n    if (state.kind === 'audio') {\n      track = localTrack\n      break\n    }\n  }\n\n  const stream = yield call([track, 'getStream'])\n  const context = new AudioContext()\n\n  // Create a source node that has the stream media.\n  const source = context.createMediaStreamSource(stream)\n\n  /**\n   * Create the \"destination node\". All audio sources will be connected to This\n   *    node, and it will be used as the \"final output\".\n   */\n  const dest = context.createMediaStreamDestination()\n  // Connect the source node to it, so that it has the original audio.\n  source.connect(dest)\n\n  // Get the track from the destination node and replace the original track\n  //    on the PeerConnection with it. The remote endpoint will now receive\n  //    any/all audio that is connected to the destination node.\n  const newTrack = dest.stream.getAudioTracks()[0]\n  yield call([session.peer, 'replaceTrack'], newTrack, { trackId: track.id })\n\n  // Add the DTMF tones to the destination node.\n  yield call(addTones, context, dest, tone, { duration, gap })\n\n  // Un-replace track on the PeerConnection. This resets the tracks back to\n  //    \"normal\".\n  yield call([session.peer, 'replaceTrack'], track.track, { trackId: newTrack.id })\n\n  // Clean-up the AudioContext nodes.\n  context.close()\n\n  return true\n}\n\n/**\n * Generates DTMF tones based on input, and connects the audio to the provided\n *    target node.\n * @method addTones\n * @param  {AudioContext} context      The AudioContext being used.\n * @param  {AudioNode} targetNode      The AudioNode to add DTMF tones to.\n * @param  {string} tones              The input tones.\n * @param  {Object} [options]\n * @param  {number} [options.duration] The length of each DTMF tone.\n * @param  {number} [options.gap]      The gap between each DTMF tone.\n */\nfunction * addTones (context, targetNode, tones, options) {\n  /**\n   * Node Diagram:\n   * +--------------+\n   * | Oscillator 1 +--+\n   * +--------------+  |    +--------------+\n   *                   +--->|   Osc Node   |\n   * +--------------+  |    +------+-------+\n   * | Oscillator 2 +--+           |\n   * +--------------+              | Connect generated audio\n   *                               v to the provided node.\n   *                        +------+--------+\n   *                        |  Target Node  |\n   *                        +---------------+\n   */\n\n  /**\n   * Step 1: Setup the audio nodes.\n   */\n  // Create the Oscillator nodes that will generate the frequencies.\n  const oscillators = [context.createOscillator(), context.createOscillator()]\n  oscillators[0].type = 'sine'\n  oscillators[1].type = 'sine'\n\n  /**\n   * Create an intermediary Gain node to control the volume of the oscillator\n   *   frequencies before connecting them to anything else.\n   */\n  const oscNode = context.createGain()\n  oscillators[0].connect(oscNode)\n  oscillators[1].connect(oscNode)\n  oscNode.gain.value = 0.1\n\n  // Connect the combined oscillators to the target node. Any tones created\n  //    by the oscillators will be heard in the target node.\n  oscNode.connect(targetNode)\n\n  // Connect the oscillators to the \"destination\" as well, which works magically.\n  // `context.destination` connects to the \"default destination\" (or something\n  //    like that), which will be the machine's speakers. This will play the\n  //    audio locally.\n  oscNode.connect(context.destination)\n\n  /**\n   * Step 2: Use the oscillators to generate DTMF tones.\n   */\n\n  /**\n   * Schedule a frequency to be played for a period of time.\n   * @method scheduleTone\n   * @param  {number} tone  A frequency.\n   * @param  {number} start When the tone should start.\n   * @param  {number} dur   The duration of the tone, in seconds.\n   */\n  function scheduleTone (tone, start, dur) {\n    oscillators[0].frequency.setValueAtTime(tone[0], start)\n    oscillators[0].frequency.setValueAtTime(0, start + dur)\n\n    oscillators[1].frequency.setValueAtTime(tone[1], start)\n    oscillators[1].frequency.setValueAtTime(0, start + dur)\n  }\n\n  const toneSequence = splitTones(tones).map(convertTone)\n\n  // Convert the time units to seconds.\n  const dur = options.duration / 1000\n  const gap = options.gap / 1000\n\n  let toneStart = context.currentTime\n  for (let i = 0; i < toneSequence.length; i++) {\n    scheduleTone(toneSequence[i], toneStart, dur)\n\n    toneStart = toneStart + dur + gap\n  }\n\n  // Start playing the scheduled tones.\n  oscillators[0].start()\n  oscillators[1].start()\n\n  /**\n   * Step 3: Clean-up the audio nodes.\n   */\n\n  // Wait until all tones have finished playing.\n  const numTones = toneSequence.length\n  const delayTime = numTones * (options.duration + options.gap)\n  yield delay(delayTime)\n\n  // Disconnect all nodes from each other.\n  oscNode.disconnect()\n  oscillators[0].stop()\n  oscillators[0].disconnect()\n  oscillators[1].stop()\n  oscillators[1].disconnect()\n}\n\n/**\n * Checks whether an SDP has at least one telephone-event codec.\n *\n * TODO: If there isn't a telephone-event, then the PeerConnection won't have\n *    a \"dtmf sender\" (RTCRtpSender.dtmf). Should preferrably check for that\n *    rather than looking through the SDP.\n * This isn't being done because the Session/Peer models wrap \"send dtmf\" in a\n *    way that makes it inconvenient to use.\n *\n * @method hasTelephoneEvent\n * @param  {string}  stringSdp An SDP.\n * @return {boolean}\n */\nexport function hasTelephoneEvent (stringSdp) {\n  const sdp = sdpTransform.parse(stringSdp)\n\n  const hasCodec = sdp.media\n    .filter(media => media.type === 'audio')\n    .some(media => {\n      return media.rtp.some(rtp => rtp.codec === 'telephone-event')\n    })\n\n  return hasCodec\n}\n\n/**\n * Converts a single tone input to its dual-frequencies.\n * @method convertTone\n * @param  {string} tone A DTMF tone input character.\n * @return {Array} The set of frequencies for the DTMF tone.\n */\nexport function convertTone (tone) {\n  if (typeof tone !== 'string' || tone.length > 1) {\n    throw new Error('Invalid input for DTMF tone.')\n  }\n\n  switch (tone) {\n    case '1':\n      return ['697', '1209']\n    case '2':\n      return ['697', '1336']\n    case '3':\n      return ['697', '1477']\n    case '4':\n      return ['770', '1209']\n    case '5':\n      return ['770', '1336']\n    case '6':\n      return ['770', '1477']\n    case '7':\n      return ['852', '1209']\n    case '8':\n      return ['852', '1336']\n    case '9':\n      return ['852', '1477']\n    case '0':\n      return ['941', '1209']\n    case '*':\n      return ['941', '1336']\n    case '#':\n      return ['941', '1477']\n  }\n}\n\n/**\n * Splits a DTMF tone sequence into individual tones.\n * @method splitTones\n * @param  {string} tone A DTMF tone string.\n * @return {Array} List of single-character tones.\n */\nexport function splitTones (tone) {\n  const matches = tone.match(/[\\d*#]+/)\n  if (!matches || matches[0] !== tone) {\n    throw new Error('Invalid characters in tone.')\n  }\n\n  return tone.split('')\n}\n","/**\n * \"Establish sagas\" handle establishing a call (ie. start or respond to a call).\n *\n * The sagas about starting a call locally assume there is no session established\n *    (since that's what it is doing). The sagas about responding to a call\n *    assume that there is a session (both webRTC and server).\n */\n\n// Call plugin.\nimport { callActions } from '../../call/interfaceNew/actions'\nimport { getCallById, getOptions, getTurnInfo } from '../../call/interfaceNew/selectors'\nimport { CALL_STATES, CALL_DIRECTION } from '../../call/constants'\nimport { checkBandwidthControls } from '../utils/bandwidth'\nimport { validateCallState } from '../../call/cpaas/utils'\n\n// Callstack plugin.\nimport { setupCall, answerWebrtcSession } from '../webrtc/establish'\nimport { closeCall } from '../webrtc/midcall'\nimport { removeUnusedLocalTracks } from '../webrtc/negotiation'\n\n// Other plugins.\nimport { getLogManager } from '../../logs'\n\n// Libraries.\nimport { call, put, select } from 'redux-saga/effects'\n\nconst log = getLogManager().getLogger('CALL')\n\n/**\n * Starts a new outgoing call.\n *\n * This saga defines how a call is started. It performs the webRTC and\n *    signalling operations to create a \"call\" both locally and on the server.\n * Assumptions:\n *     1. None.\n * Responsibilities:\n *     1. Setup the call locally, using the webRTC helper saga.\n *     2. Create the call on the server.\n *     3. Update call state (via redux action).\n * @method makeCall\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.createSession \"Make call\" signalling function.\n * @param {Array}    deps.sdpHandlers The list of SDP handlers to run.\n * @param {Object}   action        An action of type `MAKE_CALL`.\n */\nexport function * makeCall (deps, action) {\n  const requests = deps.requests\n\n  // Create a new local media object for this call.\n  const mediaConstraints = {\n    audio: action.payload.mediaConstraints.audio,\n    video: action.payload.mediaConstraints.video,\n    screenShare: action.payload.mediaConstraints.screenShare\n  }\n\n  const turnInfo = yield select(getTurnInfo)\n  const { trickleIceMode, sdpSemantics } = yield select(getOptions)\n\n  const bandwidth = checkBandwidthControls(action.payload.bandwidth)\n\n  const { error, offerSdp, sessionId, mediaIds } = yield call(setupCall, deps, mediaConstraints, {\n    sdpSemantics,\n    turnInfo,\n    trickleIceMode,\n    bandwidth,\n    callId: action.payload.id\n  })\n\n  // An error occured while trying to setup the WebRTC portion of the call.\n  //    Report the error and mark the call as ended.\n  if (error) {\n    yield put(\n      callActions.makeCallFinish(action.payload.id, {\n        state: CALL_STATES.ENDED,\n        error: error\n      })\n    )\n    return\n  }\n\n  const callInfo = {\n    participantAddress: action.payload.participantAddress,\n    isAnonymous: action.payload.isAnonymous,\n    from: action.payload.from,\n    account: action.payload.account,\n    offer: offerSdp,\n    displayName: action.payload.displayName ? action.payload.displayName : ''\n  }\n\n  const response = yield call(requests.createSession, callInfo)\n  log.debug('Received session response:', response)\n\n  if (!response.error) {\n    yield put(\n      callActions.pendingMakeCall(action.payload.id, {\n        state: CALL_STATES.INITIATED,\n        // The ID that the backend uses to track this webRTC session.\n        wrtcsSessionId: response.wrtcsSessionId,\n        // The ID that the webRTC stack uses to track this webRTC session.\n        webrtcSessionId: sessionId,\n        // The local Media object associated with this call.\n        mediaIds: mediaIds,\n        // The bandwidth of the call.\n        bandwidth,\n        // The custom display name to use. Not supported on all environments.\n        displayName: action.payload.displayName\n      })\n    )\n  } else {\n    // The call failed, so stop the Media object created for the call.\n    // TODO: Update redux state that the Media object is stopped.\n    //    Need an event from Media model to notify about the stop, and listener\n    //    set on Media when it is created (in `createLocalMedia` saga).\n    yield call(closeCall, deps.webRTC, sessionId)\n\n    yield put(\n      callActions.makeCallFinish(action.payload.id, {\n        state: CALL_STATES.ENDED,\n        error: response.error\n      })\n    )\n  }\n}\n\n/**\n * Answers an incoming call.\n *\n * This saga defines how a call is answered. It performs the webRTC and\n *    signaling operations to respond to a call on the server. The local \"call\"\n *    may or may not exist at this point in time, depending if the call is slow\n *    start.\n * If the call is using regular negotiation, the call will exist locally.\n *    Signaling with an answer SDP will establish the call, so it can be\n *    considered \"Connected\" afterwards.\n * If the call is using slow start negotiation, the call needs to be created\n *    locally. An offer SDP from the call will be used for signaling (as per\n *    slow start), but the call cannot be considered \"Connected\" until we\n *    receive a response to the offer SDP.\n * Assumptions:\n *    1. The call is in Ringing state.\n *    2. The call's direction is incoming.\n * Responsibilities:\n *    1. Determine whether Regular or Slow Start negotiation is to be used.\n *    2. Regular: Create an answer for the call, using the webRTC helpers.\n *    3. Regular: Remove local tracks that aren't being used for the call.\n *    4. Regular: Update the call on the server with the answer.\n *    5. Regular: Update call state (via redux actions).\n *    2. Slow Start: Setup the call locally, using the webRTC helper saga.\n *    3. Slow Start: Update the call on the server with an offer.\n *    4. Slow Start: Update state (via redux actions).\n * @method answerCall\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.answerSession \"Answer call\" signalling function.\n * @param {Array}    deps.sdpHandlers The list of SDP handlers to run.\n * @param {Object}   action        An \"answer call\" action.\n */\nexport function * answerCall (deps, action) {\n  const requests = deps.requests\n  const incomingCall = yield select(getCallById, action.payload.id)\n\n  const bandwidth = checkBandwidthControls(action.payload.bandwidth)\n  if (!incomingCall) {\n    // TODO: Should report an error.\n    log.error(`Error: Call ${action.payload.id} not found.`)\n    return\n  }\n\n  // Make sure the call state is what we expect\n  const stateError = yield call(validateCallState, action.payload.id, {\n    state: CALL_STATES.RINGING,\n    direction: 'incoming'\n  })\n  if (stateError) {\n    log.debug(`Invalid call state: ${stateError.message}`)\n    yield put(\n      callActions.answerCallFinish(action.payload.id, {\n        error: stateError\n      })\n    )\n    return\n  }\n\n  const mediaConstraints = {\n    audio: action.payload.mediaConstraints.audio,\n    video: action.payload.mediaConstraints.video,\n    screenShare: action.payload.mediaConstraints.screenShare\n  }\n\n  let webrtcInfo, callInfo, nextState\n  if (incomingCall.isSlowStart) {\n    /*\n     * If the call was a slow start call, then it doesn't have a webRTC session\n     *    yet. We need to setup the session and provide the signaling server\n     *    with an SDP offer.\n     */\n    log.debug('Answering slow start call.', action.payload.id)\n\n    const turnInfo = yield select(getTurnInfo)\n    const { trickleIceMode, sdpSemantics } = yield select(getOptions)\n\n    // Setup a webRTC session.\n    webrtcInfo = yield call(setupCall, deps, mediaConstraints, {\n      sdpSemantics,\n      turnInfo,\n      trickleIceMode,\n      bandwidth\n    })\n\n    if (webrtcInfo.error) {\n      yield put(\n        callActions.answerCallFinish(\n          action.payload.id,\n          {\n            error: webrtcInfo.error\n          },\n          {\n            isSlowStart: incomingCall.isSlowStart\n          }\n        )\n      )\n      return\n    }\n\n    callInfo = {\n      answer: webrtcInfo.offerSdp,\n      wrtcsSessionId: incomingCall.wrtcsSessionId\n    }\n\n    // Even if the answer request is successful, we still need to wait for a\n    //    notification from the signaling server to know if the call is complete.\n    nextState = CALL_STATES.RINGING\n  } else {\n    /*\n     * For a regular call scenario, we perform normal webRTC negotiation.\n     */\n    log.debug('Answering call.', action.payload.id)\n\n    // Update the existing webRTC session with an answer.\n    const sessionOptions = { sessionId: incomingCall.webrtcSessionId, bandwidth, callId: incomingCall.id }\n    webrtcInfo = yield call(answerWebrtcSession, deps, mediaConstraints, sessionOptions)\n\n    if (webrtcInfo.error) {\n      yield put(\n        callActions.answerCallFinish(\n          action.payload.id,\n          {\n            error: webrtcInfo.error\n          },\n          {\n            isSlowStart: incomingCall.isSlowStart\n          }\n        )\n      )\n      return\n    }\n\n    // This removes local tracks that aren't being sent to the other side.\n    yield call(removeUnusedLocalTracks, deps.webRTC, incomingCall.webrtcSessionId)\n\n    callInfo = {\n      answer: webrtcInfo.answerSDP,\n      wrtcsSessionId: incomingCall.wrtcsSessionId\n    }\n\n    // If the answer request is successful, then the call can be considered complete.\n    nextState = CALL_STATES.CONNECTED\n  }\n\n  // Perform the signaling to answer the call.\n  const response = yield call(requests.answerSession, callInfo)\n\n  if (!response.error) {\n    yield put(\n      callActions.answerCallFinish(\n        action.payload.id,\n        {\n          state: nextState,\n          // TODO: Proper start time for slow-start calls.\n          startTime: Date.now(),\n          // The local Media object associated with this call.\n          mediaIds: webrtcInfo.mediaIds,\n          // For slow start calls, there isn't a webRTC session yet.\n          webrtcSessionId: webrtcInfo.sessionId,\n          // TODO: Properly track the media that the call has.\n          mediaConstraints,\n          // The bandwidth of the call\n          bandwidth\n        },\n        {\n          isSlowStart: incomingCall.isSlowStart\n        }\n      )\n    )\n  } else {\n    yield put(\n      callActions.answerCallFinish(\n        action.payload.id,\n        {\n          error: response.error\n        },\n        {\n          isSlowStart: incomingCall.isSlowStart\n        }\n      )\n    )\n  }\n}\n\n/**\n * Rejects an incoming call.\n *\n * This saga defines how a call is rejected. It performs the webRTC and\n *    signalling operations to reject a \"call\" both locally and on the server.\n * Assumptions:\n *    1. None\n * Responsibilities:\n *    1. Cleanup the call locally, using the webRTC helper saga.\n *    2. Reject the call on the server.\n *    3. Update call state (via redux action).\n * @method rejectCall\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.rejectSession \"Reject call\" signalling function.\n * @param {Object}   action        An action of type `REJECT_CALL`.\n */\nexport function * rejectCall (deps, action) {\n  const { webRTC, requests } = deps\n  const incomingCall = yield select(getCallById, action.payload.id)\n\n  // Ensure the call is in a valid state for this operation.\n  const stateError = yield call(validateCallState, action.payload.id, {\n    state: CALL_STATES.RINGING,\n    direction: CALL_DIRECTION.INCOMING\n  })\n\n  if (stateError) {\n    log.debug(`Cannot reject call: ${stateError.message}`)\n    // Report the operation failure.\n    yield put(callActions.rejectCallFinish(action.payload.id, { error: stateError }))\n    return\n  }\n\n  yield call(closeCall, webRTC, incomingCall.webrtcSessionId)\n\n  // Collect the information needed to make the request.\n  const callInfo = {\n    wrtcsSessionId: incomingCall.wrtcsSessionId\n  }\n  const response = yield call(requests.rejectSession, callInfo)\n\n  if (!response.error) {\n    yield put(callActions.rejectCallFinish(action.payload.id))\n  } else {\n    yield put(\n      callActions.rejectCallFinish(action.payload.id, {\n        error: response.error\n      })\n    )\n  }\n}\n\n/**\n * Ignores an incoming call.\n *\n * This saga defines how a call is ignored. It performs the webRTC\n *    operations to ignore a \"call\".\n * Assumptions:\n *    1. None\n * Responsibilities:\n *    1. Cleanup the call locally, using the webRTC helper saga.\n *    2. Update call state (via redux action).\n * @method ignoreCall\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   action        An action of type `IGNORE_CALL`.\n */\nexport function * ignoreCall (deps, action) {\n  const { webRTC } = deps\n\n  // Ensure the call is in a valid state for this operation.\n  const stateError = yield call(validateCallState, action.payload.id, {\n    state: CALL_STATES.RINGING,\n    direction: CALL_DIRECTION.INCOMING\n  })\n\n  if (stateError) {\n    log.debug(`Cannot ignore call: ${stateError.message}`)\n    // Report the operation failure.\n    yield put(callActions.ignoreCallFinish(action.payload.id, { error: stateError }))\n    return\n  }\n\n  const targetCall = yield select(getCallById, action.payload.id)\n\n  // Clean-up webRTC objects. Ignore any errors returned, since we want the\n  //    call / session to be ended either way.\n  yield call(closeCall, webRTC, targetCall.webrtcSessionId)\n\n  // Report the operation complete.\n  yield put(callActions.ignoreCallFinish(targetCall.id))\n}\n\n/**\n *\n * Forwards an incoming call.\n *\n * This saga handles the WebRTC and signalling portions of forwarding an incoming call\n * Assumptions:\n *    1. The action contains a destination address\n * Responsibilities:\n *    1. Perform the signaling to tell the server that we want to forward the call to a specified destination address.\n *    2. Update call state (via redux actions).\n * @method forwardCall\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.forwardSession \"Forward call\" signalling function.\n * @param {Object}   action An action of type `FORWARD_CALL`.\n */\nexport function * forwardCall (deps, action) {\n  const { webRTC, requests } = deps\n\n  const incomingCall = yield select(getCallById, action.payload.id)\n\n  // Ensure the call is in a valid state for this operation.\n  const stateError = yield call(validateCallState, action.payload.id, {\n    state: CALL_STATES.RINGING,\n    direction: CALL_DIRECTION.INCOMING\n  })\n\n  if (stateError) {\n    log.debug(`Cannot forward call: ${stateError.message}`)\n    // Report the operation failure.\n    yield put(callActions.forwardCallFinish(action.payload.id, { error: stateError }))\n    return\n  }\n\n  // Collect the information needed to make the request.\n  const callInfo = {\n    wrtcsSessionId: incomingCall.wrtcsSessionId,\n    address: action.payload.destination\n  }\n  const response = yield call(requests.forwardSession, callInfo)\n\n  if (response.error) {\n    yield put(\n      callActions.forwardCallFinish(action.payload.id, {\n        error: response.error\n      })\n    )\n    return\n  }\n\n  yield call(closeCall, webRTC, incomingCall.webrtcSessionId)\n\n  yield put(callActions.forwardCallFinish(action.payload.id))\n}\n","/**\n * \"Midcall sagas\" handle performing local mid-call operations.\n *\n * These sagas assume that there is an established session (webRTC and server-\n *    side) to perform the operation on. Otherwise, it is considered an error.\n */\n\n// Callstack plugin.\nimport { setupCall } from '../webrtc/establish'\nimport { generateOffer, closeCall, webRtcRemoveMedia, webRtcAddMedia, webRtcReplaceTrack } from '../webrtc/midcall'\n\n// Call plugin.\nimport { callActions } from '../../call/interfaceNew/actions'\nimport { getCallById, getOptions, getTurnInfo } from '../../call/interfaceNew/selectors'\n\n// Other plugins.\nimport { getLogManager } from '../../logs'\nimport BasicError, { callCodes } from '../../errors'\n\n// Helpers.\nimport { validateCallState } from '../../call/cpaas/utils'\nimport { CALL_STATES, CALL_DIRECTION } from '../../call/constants'\n\n// Libraries.\nimport { call, put, select } from 'redux-saga/effects'\nimport { isArray, isEmpty } from 'lodash/fp'\n\nconst log = getLogManager().getLogger('CALL')\n\n/**\n * This saga ends a call, it performs the webRTC and signaling operations to\n *    update the local and server sessions of a call.\n * Assumptions:\n *    1. None.\n * Responsibilities:\n *    1. Perform the signaling to tell the server that we want to end the session\n *    2. Update call state (via redux actions).\n * @method endCall\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.endSession \"End session\" signalling function.\n * @param {Object}   action An action of type `END_CALL`.\n */\nexport function * endCall (deps, action) {\n  const { webRTC, requests } = deps\n  const { id } = action.payload\n\n  // Make sure the call state is what we expect\n  const stateError = yield call(validateCallState, action.payload.id, {})\n  if (stateError) {\n    log.debug(`Call not found: ${stateError.message}`)\n    yield put(\n      callActions.endCallFinish(id, {\n        isLocal: true,\n        error: stateError\n      })\n    )\n    return\n  }\n\n  const { wrtcsSessionId, webrtcSessionId, isAnonymous, account } = yield select(getCallById, id)\n\n  // Perform webRTC functions\n  yield call(closeCall, webRTC, webrtcSessionId)\n\n  // Perform signalling to end the session\n  const response = yield call(requests.endSession, { wrtcsSessionId, isAnonymous, account })\n\n  if (!response.error) {\n    yield put(callActions.endCallFinish(id, { isLocal: true }))\n  } else {\n    yield put(\n      callActions.endCallFinish(id, {\n        isLocal: true,\n        error: response.error\n      })\n    )\n  }\n}\n\n/**\n * Updates an existing call to have inactive media.\n * Can be used as a \"hold\" operation for plain webRTC scenarios.\n *\n * This saga defines how a call is put \"on hold\". It performs the webRTC and\n *    signaling operations to update the local and server sessions of a call.\n *    This represents the start of the webRTC renegotiation process for the\n *    local side.\n * Assumptions:\n *    1. The call is in the correct state for the operation.\n *        - The call exists, and is not already locally held.\n * Responsibilities:\n *    1. Generate an offer with the media directions as \"locally held\".\n *    2. Perform signaling to update the server session with the offer.\n *    3. Update call state (via redux actions).\n * @method offerInactiveMedia\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.updateSession \"Update call\" signalling function.\n * @param {Array}    deps.sdpHandlers The list of SDP handlers to run.\n * @param {Object}   action An action of type `CALL_HOLD`.\n */\nexport function * offerInactiveMedia (deps, action) {\n  const requests = deps.requests\n\n  // Make sure the call state is what we expect\n  const stateError = yield call(validateCallState, action.payload.id, { localHold: false })\n  if (stateError) {\n    log.debug(`Invalid call state: ${stateError.message}`)\n    yield put(\n      callActions.holdCallFinish(action.payload.id, {\n        local: true,\n        error: stateError\n      })\n    )\n    return\n  }\n\n  const targetCall = yield select(getCallById, action.payload.id)\n  const { wrtcsSessionId, webrtcSessionId, isAnonymous, account } = targetCall\n\n  // TODO: Make sure the session is in the correct signaling state to start a\n  //    renegotiation operation.\n  const offer = yield call(\n    generateOffer,\n    deps,\n    webrtcSessionId,\n    {\n      audio: 'inactive',\n      video: 'inactive'\n    },\n    targetCall.bandwidth\n  )\n\n  if (!offer) {\n    log.debug('Failed to generate SDP offer')\n    yield put(\n      callActions.holdCallFinish(action.payload.id, {\n        local: true,\n        error: new BasicError({\n          code: callCodes.INVALID_OFFER,\n          message: 'Failed to generate SDP offer'\n        })\n      })\n    )\n    return\n  }\n\n  const callInfo = {\n    wrtcsSessionId,\n    offer: offer.sdp,\n    isAnonymous,\n    account\n  }\n\n  const response = yield call(requests.updateSession, callInfo)\n\n  if (response.error) {\n    log.debug('Failed to send hold offer.')\n    yield put(\n      callActions.holdCallFinish(action.payload.id, {\n        local: true,\n        error: response.error\n      })\n    )\n  } else {\n    log.debug('Successfully sent hold offer.')\n    yield put(\n      callActions.pendingOperation(action.payload.id, {\n        operation: targetCall.localOp.operation\n      })\n    )\n  }\n}\n\n/**\n * Updates an existing call to have \"full\" media.\n * Can be used as an \"unhold\" operation for plain webRTC scenarios.\n *\n * This saga defines how a call is taken off \"hold\". It performs the webRTC and\n *    signaling operations to update the local and server sessions of a call.\n *    This represents the start of the webRTC renegotiation process for the\n *    local side.\n * Assumptions:\n *    1. The call is in the correct state for the operation.\n *        - The call exists, and is locally held.\n * Responsibilities:\n *    1. Generate an offer with the media directions as \"connected\".\n *    2. Perform signaling to update the server session with the offer.\n *    3. Update call state (via redux actions).\n * @method offerFullMedia\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.updateSession \"Update call\" signalling function.\n * @param {Array}    deps.sdpHandlers The list of SDP handlers to run.\n * @param {Object}   action        A \"unhold call\" action.\n */\nexport function * offerFullMedia (deps, action) {\n  const requests = deps.requests\n\n  // Make sure the call state is what we expect\n  const stateError = yield call(validateCallState, action.payload.id, { localHold: true })\n  if (stateError) {\n    log.debug(`Invalid call state, not on hold: ${stateError.message}`)\n    yield put(\n      callActions.unholdCallFinish(action.payload.id, {\n        local: true,\n        error: stateError\n      })\n    )\n    return\n  }\n\n  const targetCall = yield select(getCallById, action.payload.id)\n  const { wrtcsSessionId, webrtcSessionId, isAnonymous, account } = targetCall\n\n  // TODO: Make sure the session is in the correct signaling state to start a\n  //    renegotiation operation.\n  const offer = yield call(\n    generateOffer,\n    deps,\n    webrtcSessionId,\n    {\n      audio: 'sendrecv',\n      video: 'sendrecv'\n    },\n    targetCall.bandwidth\n  )\n\n  if (!offer) {\n    log.debug('Invalid SDP offer or SDP offer not received.')\n    yield put(\n      callActions.unholdCallFinish(action.payload.id, {\n        local: true,\n        error: new BasicError({\n          code: callCodes.INVALID_OFFER,\n          message: 'Invalid SDP offer or SDP offer not received'\n        })\n      })\n    )\n    return\n  }\n\n  const callInfo = {\n    wrtcsSessionId,\n    offer: offer.sdp,\n    isAnonymous,\n    account\n  }\n\n  const response = yield call(requests.updateSession, callInfo)\n\n  if (response.error) {\n    log.debug('Failed to send unhold offer.')\n    yield put(\n      callActions.unholdCallFinish(action.payload.id, {\n        local: true,\n        error: response.error\n      })\n    )\n  } else {\n    log.debug('Successfully sent unhold offer.')\n    yield put(\n      callActions.pendingOperation(action.payload.id, {\n        operation: targetCall.localOp.operation\n      })\n    )\n  }\n}\n\n/**\n * Gets low-level statistics about a call (or track).\n *\n * This saga defines how/what statistics are retrieved about a call. It performs\n *    the webRTC operations on the local session. No signaling is involved.\n * The retrieved call statistics are a RTCStatsReport as provided by the WebRTC\n *    specification. Stats can be retrieved for either an entire call or\n *    individual tracks.\n * Assumptions:\n *    1. The call is on-going.\n * Responsibilities:\n *    1. Ensure the call exists.\n *    2. Use the webRTC layer to retrieve the stats.\n *    3. Dispatch an action with the results (which triggers an event).\n * @method getStats\n * @param {Object} deps        Dependencies that the saga uses.\n * @param {Object} deps.webRTC The WebRTC stack.\n * @param {Object} action      A \"get Stats\" action.\n */\nexport function * getStats (deps, action) {\n  const { webRTC } = deps\n\n  // TODO: Actually check something other than \"call exists\"?\n  const stateError = yield call(validateCallState, action.payload.id, {})\n\n  if (stateError) {\n    log.debug(`Invalid call state: ${stateError.message}`)\n    yield put(\n      callActions.getStatsFinish(action.payload.id, {\n        error: stateError,\n        trackId: action.payload.trackId\n      })\n    )\n    return\n  }\n\n  // Get the call.\n  const targetCall = yield select(getCallById, action.payload.id)\n\n  // Get the local Session for the call.\n  const session = yield call([webRTC.sessionManager, 'get'], targetCall.webrtcSessionId)\n\n  const trackId = action.payload.trackId\n  // Retrieve the RTCStatsReport from the session.\n  let result\n  try {\n    result = yield call([session, 'getStats'], trackId)\n    log.debug('Successfully got RTCStatsReport.')\n  } catch (error) {\n    yield put(\n      callActions.getStatsFinish(action.payload.id, {\n        error: new BasicError({\n          code: callCodes.GENERIC_ERROR,\n          message: error.message\n        }),\n        trackId\n      })\n    )\n  }\n  if (result) {\n    yield put(callActions.getStatsFinish(action.payload.id, { result, trackId }))\n  }\n}\n\n/**\n * Adds media to the call\n *\n * This saga performs the webRTC and signaling operations to\n *    update local and server sessions of a call.\n * Assumptions:\n *    1. Validate that the call state is \"Connected\".\n *        - The call is connected.\n * Responsibilities:\n *    1. Perform webRTC operations to add media.\n *    2. Update the backend with the new state.\n *    3. Update local state, using Redux\n * @method addMedia\n * @param {Object}  deps          Injected dependencies that addMedia relies on\n * @param {Object}  deps.webRTC   The WebRTC stack.\n * @param {Object}  deps.requests requests that addMedia relies on\n * @param {Function}  deps.requests.updateSession request to update the session on the backend\n * @param {Array}    deps.sdpHandlers The list of SDP handlers to run.\n * @param  {Object} action        An \"add media\" action.\n */\nexport function * addMedia (deps, action) {\n  const requests = deps.requests\n  const { bandwidth } = action.payload\n\n  // Make sure the call state is what we expect\n  const stateError = yield call(validateCallState, action.payload.id, { state: CALL_STATES.CONNECTED })\n  if (stateError) {\n    log.debug(`Invalid call state: ${stateError.message}`)\n    yield put(\n      callActions.addMediaFinish(action.payload.id, {\n        local: true,\n        error: stateError\n      })\n    )\n    return\n  }\n\n  // Get some call data.\n  const { webrtcSessionId, wrtcsSessionId, bandwidth: callBandwidth, isAnonymous, account, localOp } = yield select(\n    getCallById,\n    action.payload.id\n  )\n\n  const finalBandwidth = {\n    audio: bandwidth && bandwidth.audio ? bandwidth.audio : callBandwidth.audio,\n    video: bandwidth && bandwidth.video ? bandwidth.video : callBandwidth.video\n  }\n  // Create media and add tracks using webRTC\n  const { error, sdp, medias } = yield call(webRtcAddMedia, deps, action.payload.mediaConstraints, {\n    sessionId: webrtcSessionId,\n    bandwidth: finalBandwidth\n  })\n\n  if (error) {\n    yield put(\n      callActions.addMediaFinish(action.payload.id, {\n        local: true,\n        error: error\n      })\n    )\n    return\n  }\n\n  const callInfo = {\n    wrtcsSessionId,\n    offer: sdp,\n    isAnonymous,\n    account\n  }\n\n  // Perform signalling to add media\n  const response = yield call(requests.updateSession, callInfo)\n\n  if (response.error) {\n    log.debug('Failed to send add media offer.')\n    yield put(\n      callActions.addMediaFinish(action.payload.id, {\n        local: true,\n        error: response.error\n      })\n    )\n  } else {\n    let tracks = []\n    medias.forEach(media => {\n      tracks = tracks.concat(media.tracks.map(track => track.id))\n    })\n    log.debug('Successfully sent add media offer.', tracks)\n    yield put(\n      callActions.pendingOperation(action.payload.id, {\n        operation: localOp.operation,\n        operationData: {\n          local: true,\n          mediaIds: medias.map(media => media.id),\n          tracks,\n          bandwidth: finalBandwidth\n        }\n      })\n    )\n  }\n}\n\n/**\n *\n * Removes media from an existing session.\n *\n * This saga handles the WebRTC and signalling portions of removing media from an existing call\n * Assumptions:\n *    1. The action contains a tracks object that is neither an array or an empty object\n *    2. The call is in the 'Connected' state\n * Responsibilities:\n *    1. Perform the signaling to tell the server that we want to to remove the specified track\n *    2. Update call state (via redux actions).\n * @method removeMedia\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.updateSession \"Update call\" signalling function.\n * @param {Array}    deps.sdpHandlers The list of SDP handlers to run.\n * @param {Object}   action An action of type `REMOVE_MEDIA`.\n */\nexport function * removeMedia (deps, action) {\n  const requests = deps.requests\n  const { id, tracks, bandwidth } = action.payload\n\n  // Handle scenario where no track ids are provided or not in an array.\n  if (!isArray(tracks) || isEmpty(tracks)) {\n    log.debug(`No track ids specified to remove.`)\n    yield put(\n      callActions.removeMediaFinish(id, {\n        local: true,\n        error: new BasicError({\n          code: callCodes.INVALID_PARAM,\n          message: 'No track ids specified to remove.'\n        })\n      })\n    )\n    return\n  }\n\n  // Make sure the call state is what we expect\n  const stateError = yield call(validateCallState, id, { state: CALL_STATES.CONNECTED })\n  if (stateError) {\n    log.debug(`Invalid call state:  ${stateError.message}`)\n    yield put(\n      callActions.removeMediaFinish(id, {\n        local: true,\n        stateError\n      })\n    )\n    return\n  }\n  // Get some call data.\n  const { webrtcSessionId, wrtcsSessionId, bandwidth: callBandwidth, isAnonymous, account, localOp } = yield select(\n    getCallById,\n    action.payload.id\n  )\n\n  const finalBandwidth = {\n    audio: bandwidth && bandwidth.audio ? bandwidth.audio : callBandwidth.audio,\n    video: bandwidth && bandwidth.video ? bandwidth.video : callBandwidth.video\n  }\n  // Remove media and tracks using webRTC\n  const { sdp, error } = yield call(webRtcRemoveMedia, deps, {\n    sessionId: webrtcSessionId,\n    tracks: tracks,\n    bandwidth: finalBandwidth\n  })\n  if (error) {\n    log.debug(`Failed to remove media: ${error.message}`)\n    yield put(\n      callActions.removeMediaFinish(id, {\n        local: true,\n        error\n      })\n    )\n    return\n  }\n\n  const callInfo = {\n    wrtcsSessionId,\n    offer: sdp,\n    isAnonymous,\n    account\n  }\n\n  const response = yield call(requests.updateSession, callInfo)\n\n  if (response.error) {\n    log.debug('Failed to send remove media offer.')\n    yield put(\n      callActions.removeMediaFinish(id, {\n        local: true,\n        error: response.error\n      })\n    )\n  } else {\n    log.debug('Successfully sent remove media offer.')\n    yield put(\n      callActions.pendingOperation(action.payload.id, {\n        operation: localOp.operation,\n        operationData: {\n          local: true,\n          tracks: tracks,\n          bandwidth: finalBandwidth\n        }\n      })\n    )\n  }\n}\n\n/**\n *\n * Direct Transfers an ongoing call.\n *\n * This saga handles the WebRTC and signalling portions of direct transfering an ongoing call\n * Assumptions:\n *    1. The action contains a destination address\n *    2. The call is in the 'On Hold' state\n * Responsibilities:\n *    1. Perform the signaling to tell the server that we want to direct transfer the call to a specified destination address.\n *    2. Update call state (via redux actions).\n * @method directTransfer\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.directTransferSession \"Direct transfer\" signalling function.\n * @param {Object}   action An action of type `DIRECT_TRANSFER`.\n */\nexport function * directTransfer (deps, action) {\n  const { requests } = deps\n\n  const currentCall = yield select(getCallById, action.payload.id)\n\n  // Ensure the call is in a valid state for this operation.\n  const stateError = yield call(validateCallState, action.payload.id, { state: CALL_STATES.ON_HOLD })\n\n  if (stateError) {\n    log.debug(`Cannot direct transfer call: ${stateError.message}`)\n    // Report the operation failure.\n    yield put(callActions.directTransferFinish(action.payload.id, { error: stateError }))\n    return\n  }\n\n  // Collect the information needed to make the request.\n  const callInfo = {\n    wrtcsSessionId: currentCall.wrtcsSessionId,\n    address: action.payload.destination\n  }\n  const response = yield call(requests.directTransferSession, callInfo)\n\n  if (response.error) {\n    yield put(\n      callActions.directTransferFinish(action.payload.id, {\n        error: response.error\n      })\n    )\n    return\n  }\n\n  yield put(\n    callActions.pendingOperation(action.payload.id, {\n      operation: currentCall.localOp.operation\n    })\n  )\n}\n\n/**\n *\n * Transfers 2 ongoing calls to one another.\n *\n * This saga handles the WebRTC and signalling portions of transferring 2 ongoing calls to one another.\n * Assumptions:\n *    1. The action contains the other call id\n *    2. The calls are in the 'On Hold' state\n * Responsibilities:\n *    1. Perform the signaling to tell the server that we want to transfer 2 ongoing calls to one other.\n *    2. Update call state (via redux actions).\n * @method consultativeTransfer\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.consultativeTransferSessions \"Consultative transfer\" signalling function.\n * @param {Object}   action An action of type `CONSULTATIVE_TRANSFER`.\n */\nexport function * consultativeTransfer (deps, action) {\n  const { requests } = deps\n\n  const currentCall = yield select(getCallById, action.payload.id)\n  const otherCall = yield select(getCallById, action.payload.otherCallId)\n\n  // Ensure the call is in a valid state for this operation.\n  const currentStateError = yield call(validateCallState, action.payload.id, {\n    state: CALL_STATES.ON_HOLD\n  })\n  const otherStateError = yield call(validateCallState, action.payload.otherCallId, {\n    state: CALL_STATES.ON_HOLD\n  })\n\n  if (currentStateError) {\n    log.debug(`Cannot transfer call ${action.payload.id}: ${currentStateError.message}`)\n    // Report the operation failure.\n    yield put(\n      callActions.consultativeTransferFinish(action.payload.id, {\n        error: currentStateError,\n        otherCallId: action.payload.otherCallId\n      })\n    )\n    return\n  }\n\n  if (otherStateError) {\n    log.debug(`Cannot transfer call ${action.payload.otherCallId}: ${otherStateError.message}`)\n    // Report the operation failure.\n    yield put(\n      callActions.consultativeTransferFinish(action.payload.id, {\n        error: otherStateError,\n        otherCallId: action.payload.otherCallId\n      })\n    )\n    return\n  }\n\n  // Collect the information needed to make the request.\n  const callInfo = {\n    wrtcsSessionId: currentCall.wrtcsSessionId,\n    otherWrtcsSessionId: otherCall.wrtcsSessionId,\n    destination: otherCall.direction === 'outgoing' ? otherCall.to : otherCall.from\n  }\n  const response = yield call(requests.consultativeTransferSessions, callInfo)\n\n  if (response.error) {\n    yield put(\n      callActions.consultativeTransferFinish(action.payload.id, {\n        error: response.error,\n        otherCallId: action.payload.otherCallId\n      })\n    )\n    return\n  }\n\n  yield put(callActions.pendingConsultativeTransfer(currentCall.id, { otherCallId: otherCall.id }))\n}\n\n/**\n *\n * Joins 2 ongoing calls.\n *\n * This saga handles the WebRTC and signalling portions of joining 2 ongoing calls\n * Assumptions:\n *    1. The action contains the other call id\n *    2. The calls are in the 'On Hold' state\n * Responsibilities:\n *    1. Perform the signaling to tell the server that we want to join 2 ongoing calls.\n *    2. Update call state (via redux actions).\n * @method join\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.joinSessions \"Join\" signalling function.\n * @param {Object}   action An action of type `JOIN`.\n */\nexport function * join (deps, action) {\n  const requests = deps.requests\n\n  const currentCall = yield select(getCallById, action.payload.id)\n  const otherCall = yield select(getCallById, action.payload.otherCallId)\n\n  // Ensure the call is in a valid state for this operation.\n  const currentStateError = yield call(validateCallState, action.payload.id, {\n    state: CALL_STATES.ON_HOLD\n  })\n  const otherStateError = yield call(validateCallState, action.payload.otherCallId, {\n    state: CALL_STATES.ON_HOLD\n  })\n\n  if (currentStateError) {\n    log.debug(`Cannot join call ${action.payload.id}: ${currentStateError.message}`)\n    // Report the operation failure.\n    yield put(\n      callActions.joinFinish(action.payload.id, {\n        error: currentStateError,\n        usedCallIds: [action.payload.id, action.payload.otherCallId]\n      })\n    )\n    return\n  }\n\n  if (otherStateError) {\n    log.debug(`Cannot join call ${action.payload.otherCallId}: ${otherStateError.message}`)\n    // Report the operation failure.\n    yield put(\n      callActions.joinFinish(action.payload.id, {\n        error: otherStateError,\n        usedCallIds: [action.payload.id, action.payload.otherCallId]\n      })\n    )\n    return\n  }\n\n  const mediaConstraints = {\n    video: false,\n    audio: true\n  }\n\n  const turnInfo = yield select(getTurnInfo)\n  const { trickleIceMode, sdpSemantics } = yield select(getOptions)\n\n  const { offerSdp, sessionId, mediaIds } = yield call(setupCall, deps, mediaConstraints, {\n    sdpSemantics,\n    turnInfo,\n    trickleIceMode\n  })\n\n  // Collect the information needed to make the request.\n  const callInfo = {\n    wrtcsSessionId: currentCall.wrtcsSessionId,\n    otherWrtcsSessionId: otherCall.wrtcsSessionId,\n    sdp: offerSdp\n  }\n  const response = yield call(requests.joinSessions, callInfo)\n\n  if (response.error) {\n    yield put(\n      callActions.joinFinish(action.payload.id, {\n        error: response.error,\n        usedCallIds: [action.payload.id, action.payload.otherCallId]\n      })\n    )\n    return\n  }\n\n  // Determine combined participant name if any\n  const currentCallRemoteName = currentCall.remoteParticipant.displayName\n  const otherCallRemoteName = otherCall.remoteParticipant.displayName\n  let participantName\n  if (currentCallRemoteName && otherCallRemoteName) {\n    participantName = `${currentCallRemoteName},${otherCallRemoteName}`\n  } else if (currentCallRemoteName) {\n    participantName = `${currentCallRemoteName},`\n  } else if (otherCallRemoteName) {\n    participantName = `,${otherCallRemoteName}`\n  }\n\n  // Determine combined remote participant address\n  const currentCallRemoteAddress = currentCall.direction === CALL_DIRECTION.OUTGOING ? currentCall.to : currentCall.from\n  const otherCallRemoteAddress = otherCall.direction === CALL_DIRECTION.OUTGOING ? otherCall.to : currentCall.from\n  const participantAddress = `${currentCallRemoteAddress},${otherCallRemoteAddress}`\n\n  // Dispatch an action to do the following:\n  //  - create a new \"joined\" call in state\n  //  - update calls used in the join to have isPending property\n  yield put(\n    callActions.pendingJoin(action.payload.newCallId, {\n      // The ID that the backend uses to track this webRTC session.\n      wrtcsSessionId: response.newWrtcsSessionId,\n      // The ID that the webRTC stack uses to track this webRTC session.\n      webrtcSessionId: sessionId,\n      // The local Media object associated with this call.\n      mediaIds,\n      // The media constraints this call has.\n      mediaConstraints,\n      // The combined addresses of the 2 other participants in the joined call.\n      participantAddress,\n      // The combined names of the 2 other participants in the joined call.\n      participantName,\n      // This call's current user\n      from: action.payload.from,\n      // The ids of the calls that were used for joining.\n      usedCallIds: [currentCall.id, otherCall.id]\n    })\n  )\n}\n\n/**\n *\n * Replaces an existing track with a new track.\n *\n * This saga handles the WebRTC portion of replacing a track.\n * Assumptions:\n *    1. The action contains call id, trackId, and mediaConstraints\n * Responsibilities:\n *    1. Creates a new track.\n *    2. Replaces an an existing track with the newly created track.\n *    3. Update call state (via redux actions).\n * @method replaceTrack\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   action An action of type `REPLACE_TRACK`.\n */\nexport function * replaceTrack (deps, action) {\n  const { webRTC } = deps\n  const { trackId, mediaConstraints } = action.payload\n\n  const stateError = yield call(validateCallState, action.payload.id, { state: CALL_STATES.CONNECTED })\n  if (stateError) {\n    log.debug(`Invalid call state: ${stateError.message}`)\n    yield put(\n      callActions.replaceTrackFinish(action.payload.id, {\n        error: stateError\n      })\n    )\n    return\n  }\n\n  const currentCall = yield select(getCallById, action.payload.id)\n\n  const { error, newTrackId, oldTrackState } = yield call(webRtcReplaceTrack, webRTC, {\n    sessionId: currentCall.webrtcSessionId,\n    trackId,\n    mediaConstraints\n  })\n\n  if (error) {\n    yield put(callActions.replaceTrackFinish(action.payload.id, { error }))\n  } else {\n    yield put(callActions.replaceTrackFinish(action.payload.id, { newTrackId, oldTrackState }))\n  }\n}\n","// Callstack.\nimport compareMedia from '../sdp/compareMedia'\nimport getOperation from '../sdp/operations'\n\n// Call plugin.\nimport { callActions } from '../../call/interfaceNew/actions'\n\n// Call plugin helpers.\nimport { CALL_STATES, CALL_MEDIA_STATES } from '../../call/constants'\nimport { hasMediaFlowing, setMediaInactive } from '../../call/utils/sdp'\nimport { getMediaState } from '../../call/utils/state'\nimport { OPERATIONS, OP_STATUS } from '../../call/interfaceNew/constants'\n\n// Other plugins.\nimport { getLogManager } from '../../logs'\nimport { recreatePeer, handleOffer, generateOffer } from '../../callstack/webrtc/midcall'\nimport { receivedAnswer, isSameSdpSessionId, removeUnusedLocalTracks } from '../webrtc/negotiation'\n\n// Libraries.\nimport { call, put } from 'redux-saga/effects'\n\nconst log = getLogManager().getLogger('CALL')\n\n/**\n * A \"call update request\" has been received and needs to be handled.\n * The request includes an offer SDP, so this is a regular webRTC scenario.\n *\n * This saga is intended to process all \"call update requests\", that have an\n *    SDP, received from the call's remote side. It is assumed the call has\n *    already been established, so this represents the start of the webRTC\n *    renegotiation process for the local side.\n * Handling the request is expected (but may not necessarily) affect the call's\n *    media. The call state will be updated depending on the requested changes\n *    and the current call state.\n * Assumptions:\n *    1. The request notification is valid.\n *        - Call exists, Call is not Ended, Call is able to receive a request.\n *    2. The SDP is a remote offer SDP.\n *        - Indicates regular webRTC negotiation should occur.\n * Responsibilities:\n *    1. Determine what the remote operation was (ie. what is being offered).\n *    2. Process the offer based on remote oepration and current local state.\n *    3. Remove local tracks that aren't being used for the call.\n *    4. Respond to the request.\n *    5. Update call state (via redux action).\n * @method handleUpdateRequest\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.updateSessionResponse \"Respond to offer\" signalling function.\n * @param {Array}    deps.sdpHandlers The list of SDP handlers to run.\n * @param {Object}   targetCall    The call being acted on.\n * @param {Object}   params        Parameters of the update request.\n * @param {string}   params.sdp          A remote offer SDP.\n * @param {string}   params.remoteNumber Number of the remote participant.\n * @param {string}   params.remoteName   Name of the remote participant.\n */\nexport function * handleUpdateRequest (deps, targetCall, params) {\n  const { webRTC, requests } = deps\n  let { sdp } = params\n  const { remoteNumber, remoteName } = params\n  log.info(`Handling regular update request for call ${targetCall.id}.`)\n\n  const mediaState = yield call(getMediaState, targetCall)\n  log.debug(`Current call info; State: ${targetCall.state}, MediaState: ${mediaState}.`)\n\n  /*\n   * Determine what the remote operation was. The remote operation and our\n   *    current local state will affect how we process the received offer. Our\n   *    response needs to reflect our desired local state, so that the remote\n   *    side does not change the call in an undesired way (eg. offering media\n   *    in a dual hold scenario should not reconnect media).\n   */\n  const session = yield call([webRTC.sessionManager, 'get'], targetCall.webrtcSessionId)\n  if (!session) {\n    log.debug(`webRTC session ${targetCall.webrtcSessionId} not found.`)\n    return\n  }\n  /*\n   * Use the currently set remote SDP and the newly-received remote SDP to\n   *    determine what the remote operation was.\n   */\n  const remoteDesc = yield call([session, 'getLatestRemoteDesc'])\n  const mediaDiff = yield call(compareMedia, remoteDesc.sdp, sdp)\n  let remoteOp = yield call(getOperation, mediaDiff)\n\n  log.debug(`Interpreted update request as a ${remoteOp} operation.`)\n  /**\n   * Check for remoteOp special-cases.\n   *  This is needed for complex operations, where a few renegotiations occur\n   *      as a single remote operation. Some of those renegotiations are\n   *      special-cases (ie. not actual SDK operations).\n   *  If the remoteOp is not \"standard\", then try to fit it to a \"standard\"\n   *    operation that \"fits best\".\n   */\n  const isMediaFlowing = yield call(hasMediaFlowing, sdp)\n  if (remoteOp === 'UNKNOWN') {\n    /*\n     * If the media state is remotely held but the latest renegotiation has\n     *    media flowing, then handle it as an unhold.\n     * This occurs:\n     *  - As part of a remote direct transfer operation (when this user is being\n     *      transferred to another user). When the transferee accepts the call,\n     *      a renegotiation occurs that changes from 'MoH' to 'media flowing'\n     *      state. This needs to be handled as an unhold by the SDK so that\n     *      the call state is updated to reflect the media state.\n     *  - As part of a remote consultative transer operation (when this user was\n     *      the first call specified in the transfer operation, but not for the\n     *      second user). Same 'MoH' to 'media flowing' scenario as direct\n     *      transfer.\n     */\n    if (mediaState === CALL_MEDIA_STATES.REMOTE_HOLD && isMediaFlowing) {\n      remoteOp = OPERATIONS.UNHOLD\n    }\n  } else if (remoteOp === 'NO_CHANGE') {\n    /*\n     * Renegotiation did not change anything media related. This renegotiation\n     *    may have been for a different purpose, such as changing the remote\n     *    endpoint during a transfer.\n     *\n     * Let this remoteOp default to the generic \"update call\" operation except when we're on locally hold.\n     */\n\n    /*\n     * When our media state is Local Hold, this means that our sdp has media as inactive.\n     * Therefore, when we receive remote sdp with media as also inactive, this means the remote side is doing a hold operation.\n     * Because of this, we get a remoteOp of `NO_CHANGE` when we actually want to handle it as a remote operation\n     *  inorder to get into a dual hold state.\n     */\n    if (mediaState === CALL_MEDIA_STATES.LOCAL_HOLD) {\n      remoteOp = OPERATIONS.HOLD\n    }\n  }\n\n  log.info(`Processing update request as remote ${remoteOp} operation in ${mediaState} scenario.`)\n  const callAction = yield call(getCallAction, remoteOp)\n\n  /*\n   * If the remote operation is offering media but the call is locally held,\n   *    then we need to modify the offer to ensure that media does not restart.\n   */\n  if (isMediaFlowing && [CALL_MEDIA_STATES.DUAL_HOLD, CALL_MEDIA_STATES.LOCAL_HOLD].includes(mediaState)) {\n    log.debug('Modifying remote offer to prevent resetting media while in local hold.')\n    sdp = yield call(setMediaInactive, sdp)\n    if (!sdp) {\n      log.debug('SDP is either undefined or not a string.')\n      return\n    }\n  }\n\n  /**\n   * Decision: When we receive a remote offer SDP that has a different \"session\n   *    ID\" as the currently set remote SDP, recreate the call's PeerConnection.\n   * This is a workaround/fix for scenarios where the remote endpoint changes.\n   *    It avoids possible DTLS role conflict issues.\n   */\n  // TODO: Also check fingerprint?\n  const sameSession = yield call(isSameSdpSessionId, webRTC, targetCall.webrtcSessionId, sdp)\n  if (!sameSession) {\n    log.debug(`Received offer SDP is from a different session. Recreating Peer for call ${targetCall.id}.`)\n    yield call(recreatePeer, webRTC, targetCall.webrtcSessionId)\n  }\n\n  /**\n   * If the offer SDP has a DTLS role of active (which is invalid), change it to\n   *    actpass. This is a workaround for transfer scenarios where the offer SDP\n   *    is the remote endpoint's answer SDP from them answering the call. This\n   *    happens when slow-start is not done for the transfer.\n   */\n  if (sdp.includes('setup:active')) {\n    log.debug(`Received offer SDP with active role for call ${targetCall.id}. Changing.`)\n    sdp = sdp.replace(/setup:active/g, 'setup:actpass')\n  }\n\n  // Handle the offer SDP to receive an answer SDP.\n  // TODO: Handle the offer differently depending on remote operation.\n  const { error, answerSDP } = yield call(handleOffer, deps, sdp, targetCall.webrtcSessionId, targetCall.bandwidth)\n\n  if (error) {\n    log.debug('Failed to receive offer SDP.', error)\n    // TODO: Dispatch an error action to notify of the error scenario.\n    // The call may now be in a bad state and needs to be fixed.\n    return\n  }\n\n  /**\n   * This removes local tracks that aren't being sent to the other side. These are being\n   *    removed to prevent any unintended side-effects in subsequent negotiations.\n   * We will not be doing this for the following scenarios:\n   *  - Remote Music-on-Hold - Our senders will have direction as `inactive` and we don't want to\n   *     remove local tracks in this scenario.\n   *  - Remote Hold - Our senders will have direction as `inactive` and we don't want to\n   *     remove local tracks in this scenario.\n   *  - No Change - There are no changes so we don't need to remove local tracks.\n   *  - Remote Unhold while in Dual Hold state - Unholding while in Dual Hold will still keep\n   *     sender direction as `inactive` so we don't want to remove local tracks in this scenario.\n   */\n  if (\n    remoteOp !== OPERATIONS.START_MOH &&\n    remoteOp !== OPERATIONS.HOLD &&\n    remoteOp !== 'NO_CHANGE' &&\n    !(remoteOp === OPERATIONS.UNHOLD && targetCall.localHold && targetCall.remoteHold)\n  ) {\n    yield call(removeUnusedLocalTracks, webRTC, targetCall.webrtcSessionId)\n  }\n\n  // Send answer sdp back to remote side\n  const callInfo = {\n    wrtcsSessionId: targetCall.wrtcsSessionId,\n    answer: answerSDP,\n    isAnonymous: targetCall.isAnonymous,\n    account: targetCall.account\n  }\n\n  const response = yield call(requests.updateSessionResponse, callInfo)\n\n  if (response.error) {\n    // Scenario: The offer was processed, but failed to respond with the answer.\n    // The remote side needs the answer SDP before the call is \"connected\".\n    // TODO: Handle this scenario (retry request or fail/revert operation?)\n    log.debug('Failed to respond to remote offer with an answer.')\n    yield put(\n      callAction(targetCall.id, {\n        remote: true,\n        error: response.error\n      })\n    )\n  } else {\n    log.debug('Successfully responded to remote offer.')\n    yield put(\n      callAction(targetCall.id, {\n        remote: true,\n        remoteParticipant: {\n          displayNumber: remoteNumber,\n          displayName: remoteName\n        }\n      })\n    )\n  }\n}\n\n/**\n * A \"call update request\" has been received and needs to be handled.\n * The request does not include an SDP, so this is a slow start webRTC scenario.\n *\n * This saga is intended to process all \"call update requests\", that have no\n *    SDP, received from the call's remote side. It is assumed the call has\n *    already been established, so this represents the start of the slow start\n *    webRTC renegotiation process for the local side.\n * Handling the request will not affect the call's media at this point. As\n *    opposed to regular negotiation, we require an additional \"call response\"\n *    notification before negotiation is complete. Media and call state will\n *    only be affected by that response notification.\n * Assumptions:\n *    1. The request notification is valid.\n *        - Call exists, Call is not Ended, Call is able to receive a request.\n *    2. There is no SDP.\n *        - Indicates slow start webRTC negotiation should occur.\n * Responsibilities:\n *    1. Generate an offer SDP based on our current local state.\n *    2. Respond to the request with our offer.\n * @method handleSlowUpdateRequest\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.updateSessionResponse \"Respond to offer\" signalling function.\n * @param {Array}    deps.sdpHandlers The list of SDP handlers to run.\n * @param  {Object} targetCall The call being acted on.\n * @param {Object}   params       Parameters of the update request.\n * @param {string}   params.remoteNumber Number of the remote participant.\n * @param {string}   params.remoteName   Name of the remote participant.\n */\nexport function * handleSlowUpdateRequest (deps, targetCall, params) {\n  const { webRTC, requests } = deps\n  const { remoteNumber, remoteName } = params\n\n  log.info(`Handling slow start update request for call ${targetCall.id}.`)\n\n  const mediaState = yield call(getMediaState, targetCall)\n  log.debug(`Current call info; State: ${targetCall.state}, MediaState: ${mediaState}.`)\n\n  /**\n   * Decision: Whenever we receive a slow-start notification, recreate the Peer.\n   *    This is needed in certain situations (but not all...)\n   * Known Scenarios:\n   * 1. Link direct transfer:\n   *    - The user being transferred will be on remote hold and will receive a\n   *        slow-start notification as part of the \"transfer renegotitions\".\n   *        Not recreating the Peer will result in a DTLS role conflict.\n   *    - The user receiving the transfer will negotiate the initial connection,\n   *        then will receive a slow-start notification (when Connected). Not\n   *        recreating the Peer for the slow-start results in DTLS conflict.\n   */\n  log.debug(`Recreating Peer for Session ${targetCall.webrtcSessionId}.`)\n  yield call(recreatePeer, webRTC, targetCall.webrtcSessionId)\n\n  /*\n   * Decision: Whenever we receive an offer without an SDP (slow start), and\n   *    we're not locally held, respond with all media directions as sendrecv.\n   *    This is to signal what we are capable of, rather than what we want.\n   *    When we are locally held, we don't want to allow the remote side to\n   *    restart media, hence respond with media directions as inactive.\n   * This handles two (non-local hold) scenarios specifically:\n   *  1. Re-invite: We have already negotiated to perform the remote operation,\n   *      but we received a second offer (without an SDP) as a side-effect to\n   *      further update media.\n   *    Eg. Music on Hold: The remote operation is to set media to inactive,\n   *      and the re-invite updates media so we can receive the hold audio.\n   *  2. Slow start unhold: We receive an offer without an SDP, but we have no\n   *      idea what the remote operation was. If we are on remote hold, we\n   *      assume that it's a remote unhold operation.\n   */\n  const mediaDirections = {\n    audio: targetCall.localHold ? 'inactive' : 'sendrecv',\n    video: targetCall.localHold ? 'inactive' : 'sendrecv'\n  }\n\n  // Create an offer to use for responding to the slow start notification.\n  const slowOffer = yield call(generateOffer, deps, targetCall.webrtcSessionId, mediaDirections)\n\n  const callInfo = {\n    wrtcsSessionId: targetCall.wrtcsSessionId,\n    answer: slowOffer.sdp,\n    isAnonymous: targetCall.isAnonymous,\n    account: targetCall.account\n  }\n\n  // Respond with our \"offer\".\n  const response = yield call(requests.updateSessionResponse, callInfo)\n\n  if (response.error) {\n    // TODO: Handle this scenario (retry request or fail/revert operation?)\n    log.debug('Failed to respond to update.', response.error)\n    return\n  }\n\n  log.debug('Responded to remote slow start offer. Awaiting response.')\n  /*\n   * The operation is not complete until we receive a response to our offer. The\n   *    response will be handled by the `handleSlowUpdateResponse` saga.\n   */\n  yield put(\n    callActions.remoteSlowStart(targetCall.id, {\n      remoteParticipant: {\n        displayNumber: remoteNumber,\n        displayName: remoteName\n      }\n    })\n  )\n}\n\n/**\n * A \"call update response\" has been received and needs to be handled.\n * The response is for a local operation, so this a regular webRTC scenario.\n *\n * This saga is intended to process all \"call update responses\", that are from\n *    local operations, received from the call's remote side. The call may or\n *    may not be established at this point. This represents the end of the\n *    regular webRTC negotiation process for the local side.\n * Handling the response will affect the call's media, and the call state will\n *    be updated depending on the new media and the current call state.\n * Assumptions:\n *    1. Ensure this is a valid notification.\n *        - Call exists, Call is not ended, Call expects the response.\n *    2. The original operation was started locally.\n *        - Indicates that it was a regular negotiation process.\n * Responsibilities:\n *    1. Have the callstack process the answer SDP.\n *    2. Remove local tracks that aren't being used for the call.\n *    3. TODO: Determine what the original operation was.\n *    4. Update call state (via redux action).\n * @method handleUpdateResponse\n * @param {Object}  deps          Dependencies that the saga uses.\n * @param {Object}  deps.webRTC   The WebRTC stack.\n * @param {Object}  deps.requests The set of platform-specific signalling functions.\n * @param {Array}   deps.sdpHandlers The list of SDP handlers to run.\n * @param  {Object} targetCall The call being acted on.\n * @param  {Object} params\n * @param  {string} params.sdp A remote answer SDP.\n * @param  {string} params.remoteName   Name of the remote participant.\n * @param  {string} params.remoteNumber Number of the remote participant.\n */\nexport function * handleUpdateResponse (deps, targetCall, params) {\n  const { sdp } = params\n  log.info(`Handling regular update response for call ${targetCall.id}.`)\n\n  const mediaState = yield call(getMediaState, targetCall)\n  log.debug(`Current call info; State: ${targetCall.state}, MediaState: ${mediaState}.`)\n\n  // Handle the remote answer SDP.\n  const sessionInfo = { sessionId: targetCall.webrtcSessionId, answerSdp: sdp }\n  const error = yield call(receivedAnswer, deps, sessionInfo, targetCall)\n\n  if (error) {\n    log.debug('Failed to receive answer SDP', error)\n    // TODO: Better error handling.\n    yield put(\n      callActions.callAccepted(targetCall.id, {\n        state: CALL_STATES.ENDED,\n        error\n      })\n    )\n    return\n  }\n\n  const localOp = targetCall.localOp\n\n  /**\n   * This removes local tracks that aren't being sent to the other side.\n   * These are being removed to prevent any unintended side-effects in subsequent negotiations.\n   * We will not be doing this for the following scenarios:\n   *  - localOp does not exist - Means that\n   *    - the call was created as part of a Join operation and so it isn't doing any operations of its own right now.\n   *    - the call was Direct Transferred to and so it isn't doing any operations of its own right now.\n   *  - Local Hold - Our senders will have direction as `inactive` and we don't want to\n   *     remove local tracks in this scenario.\n   *  - Unhold while in Dual Hold state - Unholding while in Dual Hold will still keep\n   *     sender direction as `inactive` so we don't want to remove local tracks in this scenario.\n   */\n  if (\n    localOp &&\n    localOp.operation !== OPERATIONS.HOLD &&\n    !(localOp.operation === OPERATIONS.UNHOLD && targetCall.localHold && targetCall.remoteHold)\n  ) {\n    yield call(removeUnusedLocalTracks, deps.webRTC, targetCall.webrtcSessionId)\n  }\n\n  // Update call state depending on what the current call state is.\n  if ([CALL_STATES.RINGING, CALL_STATES.INITIATED, CALL_STATES.EARLY_MEDIA].includes(targetCall.state)) {\n    log.info(`Handling state change as remote answer operation.`)\n    // Scenario: The call was previously ringing, so this response is a \"call\n    //    accepted\" notification. The call should now be established.\n    // It's possible that the call never entered Ringing state (from Initiated).\n    //    Handle Initiated the same as Ringing.\n    // Transition to Connected state.\n    if (localOp && localOp.status === OP_STATUS.PENDING && localOp.operation === OPERATIONS.MAKE) {\n      yield put(\n        callActions.makeCallFinish(targetCall.id, {\n          state: CALL_STATES.CONNECTED,\n          // TODO: Make sure this is the correct units\n          startTime: Date.now(),\n          // Remote participant's information.\n          remoteParticipant: {\n            displayNumber: params.remoteNumber,\n            displayName: params.remoteName\n          }\n        })\n      )\n    } else {\n      // TODO: Still need this for complex Direct Transfer & Join (remote side). Figure out a better way.\n      yield put(\n        callActions.callAccepted(targetCall.id, {\n          // TODO: Determine when we're actually \"in call\".\n          state: CALL_STATES.CONNECTED,\n          // TODO: Make sure this is the correct units\n          startTime: Date.now(),\n          // Remote participant's information.\n          remoteParticipant: {\n            displayNumber: params.remoteNumber,\n            displayName: params.remoteName\n          }\n        })\n      )\n    }\n  } else if (targetCall.state === CALL_STATES.CONNECTED || targetCall.state === CALL_STATES.ON_HOLD) {\n    // Scenario: The call was previously established, so this response is \"call\n    //    update\" notification. The call is still established.\n    // Transition to next state depending on what the operation was and the\n    //    updated media.\n    if (localOp && localOp.status === OP_STATUS.PENDING) {\n      let finishAction\n      switch (localOp.operation) {\n        case OPERATIONS.HOLD:\n          finishAction = callActions.holdCallFinish\n          break\n        case OPERATIONS.UNHOLD:\n          finishAction = callActions.unholdCallFinish\n          break\n        case OPERATIONS.ADD_MEDIA:\n          finishAction = callActions.addMediaFinish\n          break\n        case OPERATIONS.REMOVE_MEDIA:\n          finishAction = callActions.removeMediaFinish\n          break\n      }\n      if (finishAction) {\n        yield put(finishAction(targetCall.id, localOp.operationData))\n        return\n      }\n    }\n\n    // TODO: Leave this here for now to not break other operations. Need to update this as we convert the other operations.\n    // Determine whether the SDP has active media.\n    const mediaFlowing = yield call(hasMediaFlowing, params.sdp)\n\n    log.info(`Handling state change as local midcall operation ${mediaFlowing ? 'with' : 'without'} media flowing.`)\n    yield put(\n      callActions.updateCall(targetCall.id, {\n        state: mediaFlowing ? CALL_STATES.CONNECTED : CALL_STATES.ON_HOLD\n      })\n    )\n  } else {\n    // Scenario: The call is in an unexpected state for receiving a remote\n    //    answer SDP. This should never happen.\n    log.error(`The call is in a bad state for receiving response. Cannot update.`)\n  }\n}\n\n/**\n * A \"call update response\" has been received and needs to be handled.\n * The response is for a remote operation, so this a slow start webRTC scenario.\n *\n * This saga is intended to process all \"call update responses\", that are from\n *    remote operations, received from the call's remote side. This represents\n *    the end of slow start webRTC negotiation process for the local side.\n * Handling the response will affect the call's media, and the call state will\n *    be updated depending on the new media and the current call state.\n * Assumptions:\n *    1. Ensure this is a valid notification.\n *        - Call exists, Call is not ended, Call expects the response.\n *    2. The original operation was started remotely.\n *        - Indicates that it a was slow start negotiation process.\n *        - The call has a pending remote operation.\n * Responsibilities:\n *    1. Determine what the original operation was.\n *    2. Have the callstack process the answer SDP.\n *    3. Remove local tracks that aren't being used for the call.\n *    4. Update call state (via redux action) based on original operation.\n * @method handleSlowUpdateResponse\n * @param {Object}  deps          Dependencies that the saga uses.\n * @param {Object}  deps.webRTC   The WebRTC stack.\n * @param {Object}  deps.requests The set of platform-specific signalling functions.\n * @param {Array}   deps.sdpHandlers The list of SDP handlers to run.\n * @param  {Object} targetCall The call being acted on.\n * @param  {Object} params\n * @param  {string} params.sdp A remote answer SDP.\n * @param  {string} params.remoteName   Name of the remote participant.\n * @param  {string} params.remoteNumber Number of the remote participant.\n */\nexport function * handleSlowUpdateResponse (deps, targetCall, params) {\n  let { sdp } = params\n  log.info(`Handling slow start update response for call ${targetCall.id}.`)\n\n  const mediaState = yield call(getMediaState, targetCall)\n  log.debug(`Current call info; State: ${targetCall.state}, MediaState: ${mediaState}.`)\n\n  /*\n   * Determine what the remote operation was. The remote operation and our\n   *    current local state will affect how we update the call's state.\n   */\n  const session = yield call([deps.webRTC.sessionManager, 'get'], targetCall.webrtcSessionId)\n  if (!session) {\n    log.debug(`webRTC session ${targetCall.webrtcSessionId} not found.`)\n    return\n  }\n  /*\n   * Use the currently set remote SDP and the newly-received remote SDP to\n   *    determine what the remote operation was.\n   */\n  const remoteDesc = yield call([session, 'getLatestRemoteDesc'])\n  const mediaDiff = yield call(compareMedia, remoteDesc.sdp, sdp)\n\n  const remoteOp = yield call(getOperation, mediaDiff)\n\n  const mediaFlowing = yield call(hasMediaFlowing, sdp)\n  log.info(`Handling state change as remote ${remoteOp} in ${mediaState} scenario.`)\n\n  /*\n   * If the remote operation was an unhold and we're in a dual hold scenario,\n   *    then make sure the remote SDP can't restart media. Do this by ensuring\n   *    that all media directions in the remote SDP are inactive.\n   *\n   * This won't affect the remote end, but it prevents the local side from\n   *    thinking it is receiving a track when it shouldn't be.\n   *\n   * This can occur during slow start renegotiation, if the server doesn't\n   *    respect the media directions we set (assuming we set them correctly).\n   */\n  if (remoteOp === OPERATIONS.UNHOLD && targetCall.localHold === true) {\n    const undesired = ['sendrecv', 'sendonly', 'recvonly']\n    // If any undesirable direction is found in the SDP, replace it with inactive.\n    if (undesired.some(dir => sdp.includes(dir))) {\n      log.debug(`Modifying remote SDP to prevent media in local hold scenario.`)\n      sdp = sdp.replace(/sendrecv|sendonly|recvonly/gi, 'inactive')\n    }\n  }\n\n  // Handle the remote answer SDP.\n  const sessionInfo = { sessionId: targetCall.webrtcSessionId, answerSdp: sdp }\n  const error = yield call(receivedAnswer, deps, sessionInfo, targetCall)\n\n  if (error) {\n    log.debug('Failed to receive answer SDP', error)\n    // TODO: Dispatch an error action to notify of the error scenario.\n    // The call may now be in a bad state and needs to be fixed.\n    return\n  }\n\n  /*\n   * This removes local tracks that aren't being sent to the other side.\n   * These are being removed to prevent any unintended side-effects in subsequent negotiations.\n   * We will not be doing this for the following scenarios:\n   *  - Remote Music-on-Hold - Our senders will have direction as `inactive` and we don't want to\n   *     remove local tracks in this scenario.\n   *  - Remote Hold - Our senders will have direction as `inactive` and we don't want to\n   *     remove local tracks in this scenario.\n   *  - No Change - There are no changes so we don't need to remove local tracks.\n   *  - Remote Unhold while in Dual Hold state - Unholding while in Dual Hold will still keep\n   *     sender direction as `inactive` so we don't want to remove local tracks in this scenario.\n   */\n  if (\n    remoteOp !== OPERATIONS.START_MOH &&\n    remoteOp !== OPERATIONS.HOLD &&\n    remoteOp !== 'NO_CHANGE' &&\n    !(remoteOp === OPERATIONS.UNHOLD && targetCall.localHold && targetCall.remoteHold)\n  ) {\n    yield call(removeUnusedLocalTracks, deps.webRTC, targetCall.webrtcSessionId)\n  }\n\n  if (targetCall.state === CALL_STATES.CONNECTED || targetCall.state === CALL_STATES.ON_HOLD) {\n    let callAction = yield call(getCallAction, remoteOp)\n\n    yield put(\n      callAction(targetCall.id, {\n        state: mediaFlowing ? CALL_STATES.CONNECTED : CALL_STATES.ON_HOLD,\n        // Remote participant's information.\n        remoteParticipant: {\n          displayNumber: params.remoteNumber,\n          displayName: params.remoteName\n        }\n      })\n    )\n  } else {\n    // Scenario: The call is in an unexpected state for receiving a remote\n    //    answer SDP. This should never happen.\n    log.error(`The call is in a bad state for receiving response. Cannot update.`)\n  }\n}\n\n/**\n * Helper function that returns a call action function based on the\n * remote operation being requested\n * TODO: Move this somewhere better.\n * TODO: Do this differently / better.\n * @method getCallAction\n * @param (string) remoteOp Remote operation being requested\n * @returns {function} A redux action creator\n */\nexport function * getCallAction (remoteOp) {\n  // Determine what redux action the operation represents.\n  switch (remoteOp) {\n    case OPERATIONS.HOLD:\n      return callActions.remoteHoldFinish\n    case OPERATIONS.UNHOLD:\n      return callActions.remoteUnholdFinish\n    case OPERATIONS.ADD_MEDIA:\n      return callActions.remoteAddMediaFinish\n    case OPERATIONS.REMOVE_MEDIA:\n      return callActions.remoteRemoveMediaFinish\n    case OPERATIONS.START_MOH:\n      return callActions.remoteStartMohFinish\n    case OPERATIONS.STOP_MOH:\n      return callActions.remoteStopMohFinish\n    case OPERATIONS.SLOW_START:\n      return callActions.remoteSlowStart\n  }\n\n  log.debug(`Call action for ${remoteOp} not known; using generic action.`)\n  return callActions.updateCall\n}\n","/**\n * \"Notification sagas\" handle received notifications.\n * Each saga handles a single websocket notification that may be received from\n *    the backend.\n *\n * There may not be an established webRTC session for these sagas. This may be\n *    because (1) the notification is a new incoming call, or (2) there is a\n *    de-sync between SDK state and server state. This may or may not be\n *    considered as an error scenario (eg. a \"call ended\" notification for a\n *    call the SDK doesn't know about may be safely ignored).\n */\n\n// Call plugin.\nimport { callActions } from '../../call/interfaceNew/actions'\nimport { getOptions, getTurnInfo, getCalls, getCallByWrtcsSessionId } from '../../call/interfaceNew/selectors'\nimport { CALL_STATES, COMPLEX_OPERATION_MESSAGES, STATUS_CODES } from '../../call/constants'\nimport { OPERATIONS, OP_STATUS } from '../../call/interfaceNew/constants'\n\n// Callstack plugin.\nimport * as negotiation from './negotiation'\nimport runPipeline from '../sdp/pipeline'\n\n// Other plugins\nimport { getLogManager } from '../../logs'\nimport { setupIncomingCall } from '../webrtc/establish'\nimport { closeCall } from '../webrtc/midcall'\nimport BasicError, { callCodes } from '../../errors'\n\n// Libraries.\nimport { call, put, select } from 'redux-saga/effects'\nimport uuidV4 from 'uuid/v4'\n\n// Helpers\n// TODO: Move this to a shared location.\nimport { validateCallState } from '../../call/cpaas/utils'\n\nconst log = getLogManager().getLogger('CALL')\n\n/**\n * A \"call incoming\" notification has been received and needs to be handled.\n *\n * This saga is intended to be the entry point for all \"call incoming\"\n *    notifications. A \"call incoming\" notification is the initial offer to\n *    establish a call with a remote endpoint. It represents the start of both\n *    the call flow and webRTC negotiation process for the local side.\n * Handling the notification will create a new call in state.\n * Responsibilities:\n *    1. Have the callstack perform the required webRTC negotiation process.\n *        - Regular or Slow Start negotiation.\n *    2. Respond that the call has been received (ie. ringing).\n *    3. Create call state (via redux action).\n * @method incomingCall\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.updateCallRinging \"Update call\" signalling function.\n * @param {Array}    deps.sdpHandlers The list of SDP handlers to run.\n * @param {Object}   params        Parameters describing the incoming call.\n * @param {string}   [params.sdp]  The remote SDP offer included with the notification (if any).\n * @param {string}   params.wrtcsSessionId ID that the server uses to identify the session.\n * @param {string}   params.remoteNumber   Number of the remote participant.\n * @param {string}   params.remoteName     Display name of the remote participant.\n * @param {string}   params.calleeNumber  Number of the intended call recipient\n */\nexport function * incomingCall (deps, params) {\n  const requests = deps.requests\n  const { sdp, wrtcsSessionId, remoteNumber, remoteName, calleeNumber } = params\n\n  const callId = yield call(uuidV4)\n\n  // Dispatch the action right away so the call is in state at this point.\n  yield put(\n    callActions.callIncoming(callId, {\n      // TODO: Proper constants.\n      direction: 'incoming',\n      state: CALL_STATES.INITIATING,\n      remoteParticipant: {\n        displayName: remoteName,\n        displayNumber: remoteNumber\n      },\n      to: calleeNumber,\n      // Number of the remote participant when the call was established.\n      from: remoteNumber,\n      // The ID that the backend uses to track this webRTC session.\n      wrtcsSessionId,\n\n      // Whether the call was received as a slow start call or not.\n      isSlowStart: !sdp\n    })\n  )\n\n  /**\n   * An incoming call may or may not have an SDP offer associated with it.\n   * If it has an SDP, then it is a \"regular\" call scenario and can be handled\n   *    as a normal webRTC negotiation.\n   * If it has no SDP, then it is a \"slow start\" call scenario. In a slow start\n   *    scenario, the signaling server acts as a webRTC-middleman, requiring\n   *    both sides to provide it with offers and generating the answers itself.\n   */\n  if (sdp) {\n    // Regular call.\n    const turnInfo = yield select(getTurnInfo)\n    const { trickleIceMode, sdpSemantics } = yield select(getOptions)\n\n    // Since we have the remote offer SDP, we can setup a webRTC session.\n    yield call(setupIncomingCall, deps, {\n      offer: {\n        sdp\n      },\n      trickleIceMode,\n      sdpSemantics,\n      turnInfo,\n      callId\n    })\n  } else {\n    // Slow start call.\n    /*\n     * We can't setup a webRTC session yet because generating an offer requires\n     *   media constraints. We need to wait until the application provides\n     *   media information before we can setup the call.\n     */\n  }\n\n  // Send update that the wrtcsSessionStatus is 'Ringing'\n  const callInfo = { wrtcsSessionId }\n  const updateStatusResponse = yield call(requests.updateCallRinging, callInfo)\n\n  if (updateStatusResponse.error) {\n    log.error(\n      `Error: Update session status error - ${updateStatusResponse.error.code}: ${updateStatusResponse.error.message}.`\n    )\n  }\n\n  yield put(\n    callActions.callRinging(callId, {\n      state: CALL_STATES.RINGING\n    })\n  )\n}\n\n/**\n * A \"call request\" notification has been received for an established call\n *    and needs to be handled.\n *\n * This saga is intended to be the entry point for all \"call request\"\n *    notifications received from the call's remote side. This does not include\n *    \"call incoming\" notifications, and so it is assumed the call has already\n *    been established. A \"call request\" notification is the offer from a remote\n *    operation, and so represents the start of the webRTC renegotiation process\n *    for the local side.\n * This saga does not handle the request itself. It determines if it should be\n *    handled and what process is needed to handle it.\n * Responsibilities:\n *    1. Ensure this is a valid request notification.\n *        - Call exists, Call is not ended, TODO: Call is able to receive a request.\n *    2. Determine how the request should be handled.\n *        - Regular or slow start negotiation process.\n *    3. Pass the request off to the appropriate handler.\n * @method parseCallRequest\n * @param {Object} deps         Dependencies that the saga uses.\n * @param {Object} params       Parameters describing the incoming call.\n * @param {string} [params.sdp] The remote SDP offer included with the notification (if any).\n * @param {string} params.wrtcsSessionId ID that the server uses to identify the session.\n * @param {string} params.remoteName   Name of the remote participant.\n * @param {string} params.remoteNumber Number of the remote participant.\n */\nexport function * parseCallRequest (deps, params) {\n  const { wrtcsSessionId, sdp, remoteName, remoteNumber } = params\n  const targetCall = yield select(getCallByWrtcsSessionId, wrtcsSessionId)\n\n  if (!targetCall) {\n    // Scenario: No call is associated with the wrtcsSessionId.\n    log.debug(`Received request for unknown wrtcsSession: ${wrtcsSessionId}. Ignoring.`)\n    return\n  } else if (targetCall.state === CALL_STATES.ENDED) {\n    // Scenario: The associated call is ended, and should not have an active\n    //    webRTC session.\n    log.debug(`Received request for ended call: ${targetCall.id}. Ignoring.`)\n    return\n  }\n  // TODO: Make sure the call is able to receive a `respondCallRequest`\n  //    notification (ie. has no pending operation).\n  log.info(`Received update request ${sdp ? 'with' : 'without'} SDP for call: ${targetCall.id}. Processing.`)\n\n  /**\n   * How the request should be handled depends on whether it includes an SDP.\n   *    - SDP: Regular webRTC negotiation.\n   *    - No SDP: Slow start webRTC negotiation.\n   */\n  if (sdp) {\n    yield call(negotiation.handleUpdateRequest, deps, targetCall, { sdp, remoteNumber, remoteName })\n  } else {\n    yield call(negotiation.handleSlowUpdateRequest, deps, targetCall, { remoteNumber, remoteName })\n  }\n}\n\n/**\n * A \"call response\" notification has been received and needs to be handled.\n *\n * This saga is intended to be the entry point for all \"call response\"\n *    notifications received from the call's remote side. A \"call response\"\n *    notification is the answer to an operation that was previously\n *    performed (a \"call request\"), and so represents the last step in the\n *    webRTC negotiation process.\n * This saga does not handle the response itself. It determines if it should be\n *    handled and what process is needed to handle it.\n * Responsibilities:\n *    1. Ensure this is a valid notification.\n *        - Call exists, Call is not ended, TODO: Call expects the response.\n *    2. Determine what negotiation process the response is from.\n *        - Regular or slow start negotiation process.\n *    3. Pass the request off to the appropriate handler.\n * @method parseCallResponse\n * @param  {Object} webRTC The webRTC stack.\n * @param {Object} deps         Dependencies that the saga uses.\n * @param {Object} params       Parameters describing the incoming call.\n * @param {string} [params.sdp] The remote SDP offer included with the notification (if any).\n * @param {string} params.wrtcsSessionId ID that the server uses to identify the session.\n * @param {string} params.remoteName   Name of the remote participant.\n * @param {string} params.remoteNumber Number of the remote participant.\n */\nexport function * parseCallResponse (deps, params) {\n  const { wrtcsSessionId, sdp } = params\n  const targetCall = yield select(getCallByWrtcsSessionId, wrtcsSessionId)\n\n  if (!targetCall) {\n    // Scenario: The notification is about a call that state does not know about.\n    //    Ignore the notification.\n    log.debug(`Received response for unknown wrtcsSession: ${wrtcsSessionId}. Ignoring.`)\n    return\n  } else if (targetCall.state === CALL_STATES.ENDED) {\n    // Scenario: The notification is about a call that state says is ended.\n    //    Ignore the notification, since ended calls should not have an active\n    //    webRTC Session.\n    log.debug(`Received response for ended call: ${targetCall.id}. Ignoring.`)\n    return\n  }\n  // TODO: Make sure the call is expecting a `respondCallUpdate` notification.\n  //    ie. has a pending operation.\n  log.info(`Received response for call: ${targetCall.id}. Processing.`)\n\n  /**\n   * Check that the notification was not an \"error\" notification.\n   * Status code 49 with a `retryAfter` value indicates the original operation\n   *    failed (likely glare condition) and the SDK should retry the operation.\n   * TODO: This check is currently Link-specific. Depending on how CPaaS\n   *    indicates a failed/glare operation, either standardize this check or\n   *    move this into Link-specific saga.\n   */\n  if (!sdp && params.code === 49 && params.retryAfter) {\n    // TODO: Properly handle this scenario. The call may be in a bad state\n    //    because we set an offer but not an answer. May need to revert\n    //    signaling state and/or re-perform operation internally.\n    // For now, fail loudly and abort the operation to prevent crashes. The\n    //    negotiation sagas expect there to be an SDP.\n    // The call state will be left in a broken state because of KAA-1607.\n    log.error(`Response indicates an error scenario (${params.message}). Aborting operation.`)\n    return\n  }\n\n  /**\n   * Determine if the original operation was done locally or remotely. This\n   *    indicates whether it was regular or slow start negotiation.\n   * If it was from a remote slow start operation, it will be tracked in the\n   *    call state.\n   */\n  if (targetCall.remoteOp && targetCall.remoteOp.operation === OPERATIONS.SLOW_START) {\n    yield call(negotiation.handleSlowUpdateResponse, deps, targetCall, params)\n  } else {\n    yield call(negotiation.handleUpdateResponse, deps, targetCall, params)\n  }\n}\n\n/**\n * A call status notification indicating other session has ended has been received and needs to be handled.\n *\n * This saga is intended to handle the call status notifications that indicates a call has ended.\n * This notification means that the session has ended on the other side and we need to end our session as well.\n * Handling the notification will cleanup the session's media and puts the call in ENDED state.\n * Responsibilities:\n *    1. Have the callstack perform the required webRTC cleanup process.\n *    2. Update call state to ENDED (via redux action).\n * @method callStatusUpdateEnded\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   params        Parameters describing the incoming call.\n * @param {string}   params.wrtcsSessionId ID that the server uses to identify the session.\n * @param {string}   [params.reasonText]   Human-readable explanation for the call change.\n * @param {string}   [params.statusCode]     Code representing the reason for the call change.\n * @param {string}   params.remoteName   Name of the remote participant.\n * @param {string}   params.remoteNumber Number of the remote participant.\n */\nexport function * callStatusUpdateEnded (deps, params) {\n  const { wrtcsSessionId, reasonText, statusCode } = params\n\n  const calls = yield select(getCalls)\n  // TODO: `find` --> IE11 support.\n  const currentCall = calls.find(call => call.wrtcsSessionId === wrtcsSessionId)\n\n  if (!currentCall) {\n    log.debug(`Error: wrtcs session call ${wrtcsSessionId} not found.`)\n    return\n  }\n\n  // Make sure the call state is what we expect\n  const stateError = yield call(validateCallState, currentCall.id, {})\n  if (stateError) {\n    log.debug(`Error: call session not found: ${stateError.message}`)\n    return\n  }\n\n  if (currentCall.state === CALL_STATES.ENDED) {\n    log.debug(`Error: wrtcs session call ${wrtcsSessionId} already in 'Ended' state.`)\n    return\n  }\n\n  const endParams = {\n    isLocal: false, // end operation was caused by remote side.\n    // Remote participant's information.\n    remoteParticipant: {\n      displayNumber: params.remoteNumber,\n      displayName: params.remoteName\n    },\n    transition: {\n      prevState: currentCall.state\n    }\n  }\n  if (statusCode) {\n    endParams.transition.statusCode = statusCode\n  }\n  if (reasonText) {\n    endParams.transition.reasonText = reasonText\n  }\n\n  if (reasonText) {\n    let customStatusCode = statusCode\n    if (!statusCode && statusCode !== 0) {\n      if (reasonText === COMPLEX_OPERATION_MESSAGES.DIRECT_TRANSFER_SUCCESS) {\n        customStatusCode = STATUS_CODES.DIRECT_TRANSFER_SUCCESS\n      } else if (reasonText === COMPLEX_OPERATION_MESSAGES.CONSULTATIVE_TRANSFER_SUCCESS) {\n        customStatusCode = STATUS_CODES.CONSULTATIVE_TRANSFER_SUCCESS\n      } else if (reasonText === COMPLEX_OPERATION_MESSAGES.JOIN_SUCCESS) {\n        customStatusCode = STATUS_CODES.JOIN_SUCCESS\n      }\n    }\n    endParams.transition = { reasonText, statusCode: customStatusCode }\n  }\n\n  yield call(closeCall, deps.webRTC, currentCall.webrtcSessionId)\n\n  const localOp = currentCall.localOp\n  if (localOp && localOp.operation && localOp.status === OP_STATUS.PENDING) {\n    let transition\n    let finishAction\n    switch (localOp.operation) {\n      case OPERATIONS.DIRECT_TRANSFER:\n        finishAction = callActions.directTransferFinish\n        transition = {\n          reasonText: COMPLEX_OPERATION_MESSAGES.DIRECT_TRANSFER_SUCCESS,\n          statusCode: STATUS_CODES.DIRECT_TRANSFER_SUCCESS\n        }\n        break\n      case OPERATIONS.CONSULTATIVE_TRANSFER:\n        finishAction = callActions.consultativeTransferFinish\n        transition = {\n          reasonText: COMPLEX_OPERATION_MESSAGES.CONSULTATIVE_TRANSFER_SUCCESS,\n          statusCode: STATUS_CODES.CONSULTATIVE_TRANSFER_SUCCESS\n        }\n        break\n      case OPERATIONS.JOIN:\n        finishAction = callActions.joinFinish\n        transition = {\n          reasonText: COMPLEX_OPERATION_MESSAGES.JOIN_SUCCESS,\n          statusCode: STATUS_CODES.JOIN_SUCCESS\n        }\n        break\n    }\n    if (finishAction) {\n      yield put(finishAction(currentCall.id, { transition }))\n      return\n    }\n  }\n\n  // TODO: Don't expose these directly. Create our own convention so that transition data\n  //       can be consistent across different operations.\n  yield put(callActions.endCallFinish(currentCall.id, endParams))\n}\n\n/**\n * A \"call status update\" has been received and needs to be handled.\n * The update specifies the server session is in \"ringing\" state.\n *\n * This saga handles the \"call ringing\" notification by updating the local\n *    session state to match the server session state. This only affects the\n *    local call state.\n * Responsibilities:\n *    1. Update call state to RINGING (via redux action).\n * @method callStatusUpdateRinging\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   params        Parameters describing the incoming call.\n * @param {string}   params.wrtcsSessionId ID that the server uses to identify the session.\n * @param {string}   params.remoteName   Name of the remote participant.\n * @param {string}   params.remoteNumber Number of the remote participant.\n */\nexport function * callStatusUpdateRinging (deps, params) {\n  const { wrtcsSessionId } = params\n\n  const calls = yield select(getCalls)\n  // TODO: `find` --> IE11 support.\n  const currentCall = calls.find(call => call.wrtcsSessionId === wrtcsSessionId)\n\n  if (!currentCall) {\n    log.error(`Error: wrtcs session call ${wrtcsSessionId} not found.`)\n    return\n  }\n\n  // Make sure the call state is what we expect\n  const stateError = yield call(validateCallState, currentCall.id, { state: CALL_STATES.INITIATED })\n  if (stateError) {\n    log.debug(`Invalid call state: ${stateError.message}`)\n    return\n  }\n\n  yield put(\n    callActions.callRinging(currentCall.id, {\n      // Remote participant's information.\n      remoteParticipant: {\n        displayNumber: params.remoteNumber,\n        displayName: params.remoteName\n      }\n    })\n  )\n}\n\n/**\n * A call status notification indicating that an operation has failed and needs to be handled.\n *\n * This saga handles the \"session fail\" notification by generating a transition object\n *    containing proper statusCode and reasonText and removing the current pending operation.\n * Responsibilities:\n *    1. Generate transition object containing proper statusCode and reasonText depending on pending operation.\n * @method callStatusUpdateFailed\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   params        Parameters describing the incoming call.\n * @param {string}   params.wrtcsSessionId ID that the server uses to identify the session.\n */\nexport function * callStatusUpdateFailed (deps, params) {\n  const { wrtcsSessionId } = params\n\n  const calls = yield select(getCalls)\n  // TODO: `find` --> IE11 support.\n  const currentCall = calls.find(call => call.wrtcsSessionId === wrtcsSessionId)\n\n  if (!currentCall) {\n    log.error(`Error: wrtcs session call ${wrtcsSessionId} not found.`)\n    return\n  }\n\n  const localOp = currentCall.localOp\n  if (localOp && localOp.operation && localOp.status === OP_STATUS.PENDING) {\n    let transition\n    let finishAction\n    switch (localOp.operation) {\n      case OPERATIONS.DIRECT_TRANSFER:\n        finishAction = callActions.directTransferFinish\n        // TODO: May or may not need this when generic operation event is setup.\n        transition = {\n          reasonText: COMPLEX_OPERATION_MESSAGES.DIRECT_TRANSFER_FAILURE,\n          statusCode: STATUS_CODES.DIRECT_TRANSFER_FAILURE\n        }\n        break\n      case OPERATIONS.CONSULTATIVE_TRANSFER:\n        finishAction = callActions.consultativeTransferFinish\n        transition = {\n          reasonText: COMPLEX_OPERATION_MESSAGES.CONSULTATIVE_TRANSFER_FAILURE,\n          statusCode: STATUS_CODES.CONSULTATIVE_TRANSFER_FAILURE\n        }\n        break\n      case OPERATIONS.JOIN:\n        finishAction = callActions.joinFinish\n        transition = {\n          reasonText: COMPLEX_OPERATION_MESSAGES.JOIN_FAILURE,\n          statusCode: STATUS_CODES.JOIN_FAILURE\n        }\n        break\n    }\n    if (finishAction) {\n      yield put(\n        finishAction(currentCall.id, {\n          error: new BasicError({\n            message: `Operation ${localOp.operation} failed.`,\n            code: callCodes.GENERIC_ERROR\n          }),\n          transition\n        })\n      )\n      return\n    }\n  }\n\n  yield put(callActions.updateCall(currentCall.id))\n}\n\n/**\n * A \"session progress\" notification has been received. It contains an \"early\n *    media\" SDP (pranswer) that needs to be processed.\n *\n * Processing a pranswer is done by:\n *    1. Validating the Call / Session.\n *    2. Running the SDP through the SDP pipeline.\n *    3. Setting the SDP as the Session's remote description (as pranswer).\n *    4. Updating the Call state.\n *\n * @method receiveEarlyMedia\n * @param {Object} deps         Dependencies that the saga uses.\n * @param {Object} deps.webRTC  The WebRTC stack.\n * @param {Object} params       Parameters describing the notification.\n */\nexport function * receiveEarlyMedia (deps, params) {\n  const { wrtcsSessionId } = params\n  const { webRTC, sdpHandlers } = deps\n\n  /**\n   * Get the call from state.\n   */\n  const currentCall = yield select(getCallByWrtcsSessionId, wrtcsSessionId)\n  if (!currentCall) {\n    log.error(`Error: wrtcs session call ${wrtcsSessionId} not found.`)\n    return\n  }\n\n  /**\n   * Get the Webrtc Session.\n   */\n  const session = yield call([webRTC.sessionManager, 'get'], currentCall.webrtcSessionId)\n  if (!session) {\n    log.debug(`webRTC session ${currentCall.webrtcSessionId} not found.`)\n    // TODO: Better error.\n    return\n  }\n\n  try {\n    /*\n     * Run the remote SDP pranswer through any SDP handlers provided, then set it\n     *    as the Session's remote description.\n     */\n    const sdp = yield call(runPipeline, sdpHandlers, params.sdp, {\n      type: 'pranswer',\n      endpoint: 'remote'\n    })\n    yield call([session, 'processAnswer'], {\n      type: 'pranswer',\n      sdp: sdp\n    })\n  } catch (err) {\n    log.debug(`Failed to process pranswer for Call ${currentCall.id}; ignoring.`)\n    return\n  }\n\n  yield put(\n    callActions.sessionProgress(currentCall.id, {\n      // Remote participant's information.\n      remoteParticipant: {\n        displayNumber: params.remoteNumber,\n        displayName: params.remoteName\n      }\n    })\n  )\n}\n","// Call plugin.\nimport { callActions } from '../../call/interfaceNew/actions'\nimport { getCallById } from '../../call/interfaceNew/selectors'\nimport { CALL_STATES } from '../../call/constants'\n\n// Callstack plugin.\nimport { closeCall } from '../webrtc/midcall'\n\n// Other plugins.\nimport { getLogManager } from '../../logs'\n\n// Libraries.\nimport { call, put, select, delay } from 'redux-saga/effects'\n\nconst log = getLogManager().getLogger('CALL')\n\n/**\n * Sends a call audit.\n *\n * This saga defines how/when a call audit is sent. It performs the signaling\n *    operations to audit the session on the server. There are no local webRTC\n *    operations involved.\n * Audits are sent in a loop. The saga receives the context of the call from\n *    the previous audit loop. It uses that to know if the loop should continue\n *    or not.\n * Assumptions:\n *    1. None.\n * Responsibilities:\n *    1. Determine if an audit should be sent.\n *        - Both the server or local sessions are on-going.\n *    2. Perform signaling (if needed).\n *    3. Dispatch \"call audit\" action.\n *        - Triggers the next loop. Includes info about the call context.\n * @method sendCallAudit\n * @param {Object}   deps          Dependencies that the saga uses.\n * @param {Object}   deps.webRTC   The WebRTC stack.\n * @param {Object}   deps.requests The set of platform-specific signalling functions.\n * @param {Function} deps.requests.auditCall \"Call audit\" signalling function.\n * @param {Object}   action        The action that triggered the audit.\n */\nexport function * sendCallAudit (deps, action) {\n  const { webRTC, requests } = deps\n\n  const { error, id, status } = action.payload\n  const delayMs = error ? 5000 : 25000\n\n  yield delay(delayMs)\n  const currentCall = yield select(getCallById, id)\n\n  // Some basic validation\n  if (!currentCall) {\n    log.error(`Error: call id ${id} not found.`)\n    return\n  }\n\n  if (currentCall.state === CALL_STATES.ENDED) {\n    log.debug(`Call id ${id} has ended; stopping call audits`)\n    return\n  }\n\n  // If we get here, we know we have an active call. Just log our next intent...\n  if (!status) {\n    // If the action has no status, then the call starting triggered this audit.\n    log.debug(`Starting audits for call ${id}.`)\n  } else if (status === 'Retry') {\n    // If the previous audit failed for an unknown reason, retry it.\n    log.debug(`Call status is \"Unknown\"; retrying failed audit for call ${id}.`)\n  }\n\n  // Send our audit request\n  const updateStatusResponse = yield call(requests.auditCall, {\n    wrtcsSessionId: currentCall.wrtcsSessionId,\n    isAnonymous: currentCall.isAnonymous,\n    account: currentCall.account\n  })\n\n  // Schedule for another audit request\n  if (updateStatusResponse.error) {\n    // We have an error but status is not Closed, so we continue sending audit request in hoping audit will recover\n    log.debug(\n      `Error: Update session status error - ${updateStatusResponse.error.code}: ${updateStatusResponse.error.message}.`\n    )\n    yield put(\n      callActions.sendCallAudit(id, {\n        error: updateStatusResponse.error,\n        status: updateStatusResponse.status\n      })\n    )\n  } else {\n    log.debug(`Call audit for ${id}: Call is ${updateStatusResponse.status}.`)\n    yield put(callActions.sendCallAudit(id, { status: updateStatusResponse.status }))\n  }\n\n  if (updateStatusResponse.status === 'Closed') {\n    // If this audit returned 'Closed', then the audit loop should stop right away.\n    log.debug(`Call status is \"Closed\"; Hanging up the active call & stopping associated call audits for id: ${id}.`)\n\n    // Also hangup call automatically (from webRTC perspective)\n    yield call(closeCall, webRTC, currentCall.webrtcSessionId)\n\n    // Also, cleanup Redux state by sending END_CALL_FINISH action\n    yield put(\n      callActions.endCallFinish(id, {\n        isLocal: true,\n        transition: { statusCode: 9909, reasonText: 'Call has ended due to call audit failure.' }\n      })\n    )\n  }\n}\n","/*\n * Compare Media / SDP.\n *\n * These functions aim to determine how a Webrtc operation changed a\n *    PeerConnection's (local) SDP. It does this by comparing two SDPs from the\n *    same PeerConnection, one from before and one from after the operation.\n * The output (a `MediaDiff` object) is a description of how each media\n *    section of the SDP was changed by the operation.\n *\n * This file examines the SDP/media from a webrtc/SDP level, not from a call/SDK\n *    level.\n */\n\n// Other plugins.\nimport { getLogManager } from '../../logs'\n\n// Libraries.\nimport sdpTransform from 'sdp-transform'\n\nconst log = getLogManager().getLogger('SDP')\n\n/**\n * Description of how a media line changes from one SDP to the next.\n * @typedef {string} MediaTransition\n */\n\n/**\n * The possible values for media transitions.\n * @enum {MediaTransition}\n */\nexport const MEDIA_TRANSITIONS = {\n  START: 'START',\n  STOP: 'STOP',\n  SAME: 'SAME'\n}\n\n/**\n * Compare two SDPs to determine the differences in their media sections.\n * The SDPs need to have been created by the same source.\n * @method compareSdp\n * @param  {string}  prevSdpString A previous SDP.\n * @param  {string}  sdpString     A new SDP.\n * @return {MediaDiff}\n */\nexport default function compareMedia (prevSdpString, sdpString) {\n  // Parse the SDP string into an SDP object for easier handling.\n  const prevSdp = sdpTransform.parse(prevSdpString)\n  const sdp = sdpTransform.parse(sdpString)\n\n  // Take out only the parts of the SDP that we are interested in.\n  //    Each \"media\" relates to a media section of the SDP.\n  const prevMedia = summarizeMedia(prevSdp)\n  const currMedia = summarizeMedia(sdp)\n\n  // Media found in the previous SDP but not the latest SDP were removed.\n  const removed = []\n  // Media found in the latest SDP but not the previous SDP were added.\n  const added = []\n  // Media found in both SDPs may have been changed.\n  const changed = []\n  const unchanged = []\n\n  // For each media section in the previous SDP,\n  //    try to find a matching media section in the current SDP.\n  prevMedia.forEach(prevM => {\n    const currM = currMedia.find(media => media.sectionId === prevM.sectionId)\n    if (!currM) {\n      // If no match found, then the media section was removed from the SDP.\n      removed.push(prevM)\n    } else {\n      // If a match is found, compare the two sections.\n      const changes = compareSummary(prevM, currM)\n\n      if (changes.sending === MEDIA_TRANSITIONS.SAME && changes.receiving === MEDIA_TRANSITIONS.SAME) {\n        // No changes.\n        unchanged.push(prevM)\n      } else {\n        // Changes. Include both the media summary and the changes found.\n        /**\n         * Description of how a media line changed, with the latest summary.\n         * @typedef  {Object}       ChangedMedia\n         * @property {MediaSummary} media        The new summary of the media section.\n         * @property {MediaChanges} changes      The changes that occurred to the media.\n         */\n        changed.push({ media: currM, changes })\n      }\n    }\n  })\n\n  // For each media section in the current SDP,\n  //    try to find a matching media section in the previous SDP.\n  currMedia.forEach(currM => {\n    const prevM = prevMedia.find(media => media.sectionId === currM.sectionId)\n    if (!prevM) {\n      // If no match found, then the media section was added to the current SDP.\n      added.push(currM)\n    } else {\n      // Nothing else to check. Already found removed and (un)changed media.\n    }\n  })\n\n  /**\n   * The computed differences of media sections between two SDPs.\n   * @typedef  {Object}              MediaDiff\n   * @property {Array<MediaSummary>} added     Media sections that are new in the latest SDP.\n   * @property {Array<MediaSummary>} removed   Media sections that are missing in the latest SDP.\n   * @property {Array<ChangedMedia>} changed   Media changes between the two SDPs.\n   * @property {Array<MediaSummary>} unchanged Media sections that remained the same.\n   */\n  return {\n    added,\n    removed,\n    changed,\n    unchanged\n  }\n}\n\n/**\n * Reduce the media information in the SDP to only what we will use.\n * The SDP object provided as input is assumed to use standard values.\n *\n * Only supports SDPs where there is only one track per media section.\n *    eg. Plan-B when there is max 1 track per media type, and Unified-Plan (?).\n *\n * @method summarizeMedia\n * @param  {Object} sdp The full SDP object.\n * @return {Array<MediaSummary>} Summarized media sections from the SDP.\n */\nexport function summarizeMedia (sdp) {\n  const sdpMedia = []\n  sdp.media.forEach(media => {\n    /*\n     * Generate/Find a unique ID for this media section. This will be used to\n     *    compare against another SDP's media sections to find matching\n     *    sections.\n     */\n    const sectionId = media.mid\n\n    if (media.ssrcGroups && media.ssrcGroups.length > 1) {\n      /*\n       * All of the logic in this file assumes that a media section only has 1\n       *    track. If there are more than one, it means that we are using\n       *    Plan-B with more than 1 track of the same media type, which is not\n       *    something that we want to support.\n       */\n      log.debug(`Media section contains multiple ssrc groups. Summary for ${sectionId} will be wrong.`)\n    }\n\n    // Whether this media section is sending and/or receiving.\n    const willSend = media.direction.includes('send')\n    const willReceive = media.direction.includes('recv')\n\n    let mediaId, trackId\n    /*\n     * If the media section is sending, then it has information about the track\n     *    that it is sending.\n     *\n     * Note: The media section will never have information about a track it is\n     *    receiving (ie. willReceive), because the SDP only describes the\n     *    \"local\" PeerConnection's situation.\n     */\n    if (willSend) {\n      /**\n       * The SDP should either have a `msid` property (a=msid line) or `ssrc`\n       *    lines with the same information (`a=ssrc:... label:...` and\n       *    `a=ssrc:... mslabel:...`).\n       * If it has nethier, then the SDP says it wants to send a track, but it\n       *    has no track to send.\n       */\n      if (media.msid) {\n        ;[mediaId, trackId] = media.msid.split(' ')\n      } else if (media.ssrcs) {\n        mediaId = media.ssrcs.find(ssrc => ssrc.attribute === 'mslabel').value\n        trackId = media.ssrcs.find(ssrc => ssrc.attribute === 'label').value\n      }\n    } else {\n      // This media section is not sending a track, so there is no information.\n      mediaId = undefined\n      trackId = undefined\n    }\n\n    /**\n     * Summarized information about a media section from an SDP.\n     * @typedef  {Object}  MediaSummary\n     * @property {string}  sectionId   A unique identifier for the media section.\n     * @property {string}  type        The type of media line.\n     * @property {boolean} willSend    Whether the media will send data.\n     * @property {boolean} willReceive Whether the media will receive data.\n     * @property {string}  mediaId     The MediaStream ID of the media.\n     * @property {string}  trackId     The MediaStreamTrack ID of the media.\n     */\n    const summary = {\n      sectionId,\n      type: media.type,\n      willSend,\n      willReceive,\n      mediaId,\n      trackId\n    }\n\n    sdpMedia.push(summary)\n  })\n  return sdpMedia\n}\n\n/**\n * Compare two summarized Media section objects to determine how it changed.\n * @method compareSummary\n * @param  {MediaSummary} prevMedia The previous media summary.\n * @param  {MediaSummary} currMedia The current meduia summary.\n * @return {MediaChanges} How the media directions changed from prevMedia to currMedia.\n */\nexport function compareSummary (prevMedia, currMedia) {\n  /**\n   * Description of changes to a media line.\n   * @typedef  {Object} MediaChanges\n   * @property {MediaTransition} sending   The change in the media sending data.\n   * @property {MediaTransition} receiving The change in the media receiving data.\n   */\n  const change = {\n    sending: undefined,\n    receiving: undefined\n  }\n\n  if (prevMedia.willSend !== currMedia.willSend) {\n    if (currMedia.willSend) {\n      // Started sending.\n      change.sending = MEDIA_TRANSITIONS.START\n    } else {\n      // Stopped sending.\n      change.sending = MEDIA_TRANSITIONS.STOP\n    }\n  } else {\n    // No change.\n    change.sending = MEDIA_TRANSITIONS.SAME\n  }\n\n  if (prevMedia.willReceive !== currMedia.willReceive) {\n    if (currMedia.willReceive) {\n      // Started receiving.\n      change.receiving = MEDIA_TRANSITIONS.START\n    } else {\n      // Stopped receiving.\n      change.receiving = MEDIA_TRANSITIONS.STOP\n    }\n  } else {\n    // No change.\n    change.receiving = MEDIA_TRANSITIONS.SAME\n  }\n\n  return change\n}\n","import { MEDIA_TRANSITIONS } from './compareMedia'\n\n// Constants.\nimport { OPERATIONS } from '../../call/interfaceNew/constants'\n\n/**\n * Based on a MediaDiff object, determine what the call operation was that\n *    caused the SDP/media change.\n * @method getOperation\n * @param  {MediaDiff} mediaDiff\n * @return {string}\n */\nexport default function getOperation (mediaDiff) {\n  // Naively just check one operation after the other.\n  // TODO: Make this more efficient?\n  // TODO: These MoH checks should take into account current call state.\n  //    Start/Stop MoH should only be possible in specific states.\n  if (wasHold(mediaDiff)) {\n    return OPERATIONS.HOLD\n  } else if (wasUnhold(mediaDiff)) {\n    return OPERATIONS.UNHOLD\n  } else if (wasStartMoh(mediaDiff)) {\n    // Check 'start MoH' before 'add media' because 'start MoH' is a special\n    //    case of 'add media'.\n    return OPERATIONS.START_MOH\n  } else if (wasAddMedia(mediaDiff)) {\n    return OPERATIONS.ADD_MEDIA\n  } else if (wasStopMoh(mediaDiff)) {\n    // Check 'stop MoH' before 'remove media' because 'stop MoH' is a special\n    //    case of 'remove media'.\n    return OPERATIONS.STOP_MOH\n  } else if (wasRemoveMedia(mediaDiff)) {\n    return OPERATIONS.REMOVE_MEDIA\n  } else if (wasNoChange(mediaDiff)) {\n    return 'NO_CHANGE'\n  } else {\n    return 'UNKNOWN'\n  }\n}\n\n/**\n * A \"hold\" operation is when all media lines change to be \"inactive\".\n * Some media may have already been inactive. \"Hold\" is specifically when\n *    all active media becomes inactive, hence there is no longer any media\n *    flowing.\n *\n * This differs from a \"stop MoH\" operation by requiring at least one media to\n *    be \"flowing\" (both sending and receiving) before the operation. For\n *    \"stop MoH\", the media would only be sending (and not receiving) before.\n *\n * In terms of SDP changes, it is defined as:\n *    1) At least one media was 'flowing' before the SDP change.\n *    2) No media is 'flowing' after the SDP change.\n *    3) No media was added.\n *    4) No media was removed.\n *    5) All media that changed was stopped.\n *        ie. is being \"held\".\n *    6) All media that is unchanged is not sending/receiving.\n *        ie. was already \"held\".\n * @method wasHold\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasHold (mediaDiff) {\n  const { added, removed, changed, unchanged } = mediaDiff\n\n  /*\n   * 1 & 2) Some media was flowing before the change, and no media is flowing\n   *    after the change. This ensures \"hold\" is distinct from \"stop MoH\"\n   *    scenarios.\n   */\n  const stoppedFlowing = hadMediaFlowing(mediaDiff) && !hasMediaFlowing(mediaDiff)\n\n  /*\n   * 3 & 4) No media was added or removed.\n   */\n  const sameMedia = added.length === 0 && removed.length === 0\n\n  /*\n   * 5a) Some media did change.\n   */\n  const didChange = changed.length > 0\n\n  /*\n   * 5b) For all media that changed,\n   *    all changes were either `stop` or `remain stopped`.\n   */\n  const allStopped = changed.every(({ media, changes }) => {\n    // This media is not sending.\n    const notSending =\n      changes.sending === MEDIA_TRANSITIONS.STOP || (changes.sending === MEDIA_TRANSITIONS.SAME && !media.willSend)\n    // This media is not receiving.\n    const notReceiving =\n      changes.receiving === MEDIA_TRANSITIONS.STOP ||\n      (changes.receiving === MEDIA_TRANSITIONS.SAME && !media.willReceive)\n\n    return notSending && notReceiving\n  })\n\n  /*\n   * 6) For all media that was not changed,\n   *    no media is being sent/received.\n   */\n  const stillStopped = unchanged.every(media => {\n    return !media.willSend && !media.willReceive\n  })\n\n  return stoppedFlowing && sameMedia && didChange && allStopped && stillStopped\n}\n\n/**\n * An \"unhold\" operation is when all media lines were previously inactive and\n *    some change to be active.\n * Not all media needs to change to be active, only some.\n *\n * This differs from a \"start MoH\" operation by requiring some media to be\n *    \"flowing\" (both sending and receiving) after the operation. For\n *    \"start MoH\", the media would only be sending (and not receiving) after.\n *\n * In terms of SDP changes, it is defined as:\n *    1) No media was flowing beforehand.\n *    2) At least one media is flowing afterwards.\n *    3) No media was added.\n *    4) No media was removed.\n *    5) All media that changed was started.\n *        ie. is being \"unheld\"\n *    6) All media that is unchanged is not sending/receiving.\n *        ie. was (and still is) \"held\"\n * @method wasUnhold\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasUnhold (mediaDiff) {\n  const { added, removed, changed, unchanged } = mediaDiff\n\n  /*\n   * 1 & 2) No media was flowing before the change, and some media is flowing\n   *    after the change. This ensures \"unhold\" is distinct from \"start MoH\"\n   *    scenarios.\n   */\n  const startedFlowing = !hadMediaFlowing(mediaDiff) && hasMediaFlowing(mediaDiff)\n\n  /*\n   * 3 & 4) No media was added or removed.\n   */\n  const sameMedia = added.length === 0 && removed.length === 0\n\n  /*\n   * 6) For all media that was not changed,\n   *    no media is being sent/received.\n   */\n  const noUnchangedSend = unchanged.every(media => {\n    return !media.willSend && !media.willReceive\n  })\n\n  /*\n   * 5a) Some media did change.\n   */\n  const didChange = changed.length > 0\n\n  /*\n   * 5b) For all media that was changed,\n   *    all changes were either `start` or `remain stopped`.\n   */\n  const onlyStartChanges = changed.every(({ media, changes }) => {\n    const onlyStartSending =\n      changes.sending === MEDIA_TRANSITIONS.START || (changes.sending === MEDIA_TRANSITIONS.SAME && !media.willSend)\n\n    const onlyStartReceiving =\n      changes.receiving === MEDIA_TRANSITIONS.START ||\n      (changes.receiving === MEDIA_TRANSITIONS.SAME && !media.willReceive)\n\n    return onlyStartSending && onlyStartReceiving\n  })\n\n  return startedFlowing && sameMedia && noUnchangedSend && didChange && onlyStartChanges\n}\n\n/**\n * An \"add media\" operation is when the latest SDP is sending tracks that the\n *    previous SDP was not sending. This can either be a new, sending media\n *    section or an existing media section that was changed to now send.\n *\n * The \"start MoH\" scenario is a special-case of \"add media\". When one audio\n *    track is added/started, with no media flowing beforehand, then that could\n *    either be a \"start MoH\" or \"add media\" operation. From a webrtc/SDP\n *    viewpoint, they are the same thing in that scenario, so there is no way\n *    to tell them apart using only a MediaDiff object.\n * If both ends of the Call are SDK clients, then \"start MoH\" can only be done\n *    when the Call is on hold (by definition), and \"add media\" can only be\n *    done when the Call is not on hold (requirement set by the API), but we\n *    can't make that assumption.\n *\n * In terms of SDP changes, it is defined as:\n *    1) No media [sections] was removed.\n *    2) Any media added is sending.\n *    3) Any media that changed started sending.\n * @method wasAddMedia\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasAddMedia (mediaDiff) {\n  const { added, removed, changed } = mediaDiff\n\n  /*\n   * 1) No media sections were removed.\n   */\n  const wasntRemoved = removed.length === 0\n\n  /*\n   * 2a & 3a) Something was added or changed.\n   */\n  const somethingStarted = added.length > 0 || changed.length > 0\n\n  /*\n   * 2b) Any media sections added are sending.\n   */\n  const addedSending = added.every(media => media.willSend)\n\n  /*\n   * 3b) Any media that changed was to start sending.\n   */\n  const changedSending = changed.every(({ media, changes }) => {\n    return changes.sending === MEDIA_TRANSITIONS.START && changes.receiving === MEDIA_TRANSITIONS.SAME\n  })\n\n  /*\n   * Unchanged media is not checked for.\n   *    By definition, it is the same as before, and could be in any state.\n   */\n\n  return wasntRemoved && somethingStarted && addedSending && changedSending\n}\n\n/**\n * A \"remove media\" operation is when some media sections stop sending (with no\n *    other changes).\n *\n * The \"stop MoH\" scenario is a special-case of \"remove media\". When one audio\n *    track is removed, leaving no media flowing afterwards, then that could\n *    either be a \"stop MoH\" or \"remove media\" operation. From a webrtc/SDP\n *    viewpoint, they are the same thing in that scenario, so there is no way\n *    to tell them apart using only a MediaDiff object.\n * If both ends of the Call are SDK clients, then \"stop MoH\" can only be done\n *    when the Call is on hold (by definition), and \"remove media\" can only be\n *    done when the Call is not on hold (requirement set by the API), but we\n *    can't make that assumption.\n *\n * In terms of SDP changes, it is defined as:\n *    1) No media was added.\n *    2) No media [sections] were removed.\n *    3) Some existing media stopped sending (ie. tracks were removed).\n * @method wasRemoveMedia\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasRemoveMedia (mediaDiff) {\n  const { added, removed, changed } = mediaDiff\n\n  /*\n   * 1 & 2) No media sections were added or removed.\n   */\n  const wasntAdded = added.length === 0\n  const wasntRemoved = removed.length === 0\n\n  /*\n   * 3a) Some media sections changed.\n   */\n  const wasChanged = changed.length > 0\n\n  /*\n   * 3b) For all media sections that changed,\n   *      the only change was to stop sending.\n   */\n  const onlyStopSending = changed.every(({ media, changes }) => {\n    return (\n      changes.sending === MEDIA_TRANSITIONS.STOP &&\n      // Receiving may be SAME or START, depending if the previous media\n      //    direction was sendrecv (SAME) or sendonly (START).\n      // TODO: Update `ChangedMedia` to include the pre-change media summary?\n      changes.receiving !== MEDIA_TRANSITIONS.STOP\n    )\n  })\n\n  /*\n   * Unchanged media is not checked for.\n   *    By definition, it is the same as before, and could in any state.\n   */\n\n  return wasntAdded && wasntRemoved && wasChanged && onlyStopSending\n}\n\n/**\n * A \"start Music on Hold\" operation is when media is currently held, and one\n *    audio media is changed to \"send only\".\n *\n * This checker does not guarentee that it was a \"start MoH\" scenario, and not\n *    a very specific \"add media\" scenario. It is an edge-case, but it is\n *    possible that both sides of the Call removed all media, then one side\n *    adds a single audio track. There is no way to tell the difference with\n *    only a MediaDiff object.\n *\n * In terms of SDP changes, it is defined as:\n *    0) A \"add media\" scenario where:\n *    1) One inactive audio section starts sending.\n *    2) All other media remains unchanged.\n *    3) Any unchanged media is inactive.\n * @method wasStartMoh\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasStartMoh (mediaDiff) {\n  const { added, removed, changed, unchanged } = mediaDiff\n\n  // 0) \"Start MoH\" is a \"add media\" scenario that has extra requirements.\n  if (!wasAddMedia(mediaDiff)) {\n    return false\n  }\n\n  /*\n   * 1) Only one audio line should be changed, to send only.\n   */\n  const onlyAudioChange =\n    // Only one audio line changed.\n    changed.length === 1 &&\n    changed[0].media.type === 'audio' &&\n    // The change was to start sending media.\n    changed[0].changes.sending === MEDIA_TRANSITIONS.START &&\n    // Receiving media remains unchanged; not receiving.\n    changed[0].changes.receiving === MEDIA_TRANSITIONS.SAME &&\n    !changed[0].media.willReceive\n\n  /*\n   * 2) No media was added or removed.\n   */\n  const sameMedia = added.length === 0 && removed.length === 0\n\n  /*\n   * 3) For all media that is unchanged,\n   *    they are not sending/receiving.\n   */\n  const inactiveUnchanged = unchanged.every(media => {\n    return !media.willSend && !media.willReceive\n  })\n\n  return sameMedia && inactiveUnchanged && onlyAudioChange\n}\n\n/**\n * A \"stop Music on Hold\" operation is when media starts in a MoH state, then\n *    reverts back to an \"on hold\" state.\n *\n * This checker does not guarentee that it was a \"stop MoH\" scenario, and not\n *    a very specific \"remove media\" scenario. It is possible that a Call is\n *    established with one-way audio (and no video), then the audio is removed.\n *    There is no way to tell the difference with only a MediaDiff object.\n *\n * In terms of SDP changes, it is defined as:\n *    0) A \"remove media\" scenario where:\n *    1) One audio section changed stopped sending.\n *    2) All other media remains unchanged.\n *    3) Any unchanged media is inactive.\n * @method wasStopMoh\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasStopMoh (mediaDiff) {\n  const { added, removed, changed, unchanged } = mediaDiff\n\n  // 0) \"Stop MoH\" is a \"remove media\" scenario that has extra requirements.\n  if (!wasRemoveMedia(mediaDiff)) {\n    return false\n  }\n\n  /*\n   * 1) Only one audio line should be changed, from send only to inactive.\n   */\n  const stopSendAudio =\n    // Only one audio line changed.\n    changed.length === 1 &&\n    changed[0].media.type === 'audio' &&\n    // The change was to stop sending media.\n    changed[0].changes.sending === MEDIA_TRANSITIONS.STOP &&\n    // Receiving media remains unchanged; not receiving.\n    changed[0].changes.receiving === MEDIA_TRANSITIONS.SAME &&\n    !changed[0].media.willReceive\n\n  /*\n   * 2) No media was added or removed.\n   */\n  const sameMedia = added.length === 0 && removed.length === 0\n\n  /*\n   * 3) For all media that is unchanged,\n   *    they are not sending/receiving.\n   */\n  const inactiveUnchanged = unchanged.every(media => {\n    return !media.willSend && !media.willReceive\n  })\n\n  return sameMedia && inactiveUnchanged && stopSendAudio\n}\n\n/**\n * A \"no change\" media operation is when all media sections remain the same.\n *    The remote operation was something other than changing media.\n *\n * In terms of SDP comparison, it is defined as:\n *    1) No media sections were added, removed, or changed.\n *    2) Some media remained unchanged.\n * @method wasNoChange\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasNoChange (mediaDiff) {\n  const { added, removed, changed, unchanged } = mediaDiff\n\n  /*\n   * No media did anything other than `unchanged`.\n   */\n  const noChange = added.length === 0 && removed.length === 0 && changed.length === 0\n\n  /*\n   * ...but there is media in the SDP.\n   */\n  const hasUnchanged = unchanged.length > 0\n\n  return noChange && hasUnchanged\n}\n\n/**\n * Determines whether a MediDiff object describes the SDP as having had media\n *    flowing (a media both sending and receiving; flowing in both directions)\n *    _before_ the SDP changes.\n * @method hadMediaFlowing\n * @param  {MediaDiff} mediaDiff\n * @return {boolean}   Whether the MediaDiff has media flowing before the change.\n */\nexport function hadMediaFlowing (mediaDiff) {\n  const { removed, changed, unchanged } = mediaDiff\n\n  /*\n   * If any unchanged media is sending and receiving, then media was (and still\n   *    is) flowing before the SDP change.\n   */\n  const unchangedFlowing = unchanged.some(media => {\n    return media.willSend && media.willReceive\n  })\n\n  /*\n   * If any changed media was sending and receiving, then media was flowing\n   *    before the SDP change.\n   */\n  const changedFlowing = changed.some(({ media, changes }) => {\n    /*\n     * A changed media was sending before the change if\n     *    1) the change was to stop sending, or\n     *    2) sending didn't change, and is still sending.\n     */\n    const wasSending =\n      changes.sending === MEDIA_TRANSITIONS.STOP || (changes.sending === MEDIA_TRANSITIONS.SAME && media.willSend)\n\n    /*\n     * A changed media was receiving before the change if\n     *    1) the change was to stop receiving, or\n     *    2) receiving didn't change, and is still receiving.\n     */\n    const wasReceiving =\n      changes.receiving === MEDIA_TRANSITIONS.STOP ||\n      (changes.receiving === MEDIA_TRANSITIONS.SAME && media.willReceive)\n\n    return wasSending && wasReceiving\n  })\n\n  /*\n   * If any removed media was sending and receiving, then media was flowing\n   *    before the SDP change.\n   */\n  const removedFlowing = removed.some(media => {\n    return media.willSend && media.willReceive\n  })\n\n  /*\n   * Ignore `added` media, since that tells us nothing about media before the\n   *    SDP change.\n   */\n\n  return unchangedFlowing || changedFlowing || removedFlowing\n}\n\n/**\n * Determines whether a MediDiff object describes the SDP as having media\n *    flowing (a media both sending and receiving; flowing in both directions)\n *    _after_ the SDP changes.\n * @method hasMediaFlowing\n * @param  {MediaDiff} mediaDiff\n * @return {boolean}   Whether the MediaDiff has media flowing after the change.\n */\nexport function hasMediaFlowing (mediaDiff) {\n  const { added, changed, unchanged } = mediaDiff\n\n  /*\n   * If any unchanged media is sending and receiving, then media is (and was)\n   *    flowing after the SDP change.\n   */\n  const unchangedFlowing = unchanged.some(media => {\n    return media.willSend && media.willReceive\n  })\n\n  /*\n   * If any changed media is sending and receiving, then media is flowing\n   *    after the SDP change.\n   */\n  const changedFlowing = changed.some(({ media, changes }) => {\n    return media.willSend && media.willReceive\n  })\n\n  /*\n   * If any added media is sending and receiving, then media is flowing\n   *    after the SDP change.\n   */\n  const addedFlowing = added.some(media => {\n    return media.willSend && media.willReceive\n  })\n\n  /*\n   * Ignore `removed` media, since that tells us nothing about media after the\n   *    SDP change.\n   */\n\n  return unchangedFlowing || changedFlowing || addedFlowing\n}\n","// Libraries.\nimport log from 'loglevel'\nimport sdpTransform from 'sdp-transform'\nimport { cloneDeep, isArray, isFunction } from 'lodash/fp'\n\n/**\n * Basic SDP pipeline runner.\n * @method sdpPipeline\n * @param  {Array}      handlers       List of functions that transform the SDP.\n * @param  {string}     sdp            The session description.\n * @param  {RTCSdpType} info           Information about the session description.\n * @param  {RTCSdpType} info.type      The session description's type.\n * @param  {string}     info.endpoint  Which end of the connection created the SDP.\n * @param  {boolean}    info.isInitiator Whether this session initiated the connection or not.\n * @param  {BandwidthControls} [info.bandwidth] Information about bandwidth controls.\n * @return {string}     The modified session description.\n */\nexport default function runPipeline (handlers, sdp, info) {\n  let objectSdp = sdpTransform.parse(sdp)\n\n  const originalSdp = Object.freeze(objectSdp)\n  let newSdp = cloneDeep(originalSdp)\n\n  if (isArray(handlers)) {\n    handlers.forEach(handler => {\n      if (isFunction(handler)) {\n        newSdp = handler(newSdp, info, originalSdp)\n      } else {\n        log.error(`SDP handler not a function; skipping.`)\n      }\n    })\n  }\n\n  return sdpTransform.write(newSdp)\n}\n","import { BANDWIDTH_DEFAULTS } from '../../call/constants'\n\n/**\n * Checks whether the bandwidth controls provided exist and are numbers.\n * If not, then a default limit is used.\n * @param {BandwidthControls} bandwidthControls The bandwidth controls to check.\n */\nexport function checkBandwidthControls (bandwidthControls) {\n  const finalBandwidthControls = { ...bandwidthControls }\n\n  if (!bandwidthControls || !(bandwidthControls.audio && typeof bandwidthControls.audio === 'number')) {\n    finalBandwidthControls.audio = BANDWIDTH_DEFAULTS.AUDIO\n  }\n  if (!bandwidthControls || !(bandwidthControls.video && typeof bandwidthControls.video === 'number')) {\n    finalBandwidthControls.video = BANDWIDTH_DEFAULTS.VIDEO\n  }\n  return finalBandwidthControls\n}\n","// Other plugins.\nimport { getLogManager } from '../../logs'\n\nconst log = getLogManager().getLogger('SDPHANDLER')\n\n/**\n * SDP handler function that should be passed into session object's `processOffer` and `processAnswer` function.\n * This function disables old media encryption method SDES (Modifies sdp by removing crypto).\n * However, if only SDES is available, don't disable it.\n *\n * @method sanitizeSdesFromSdp\n * @param {Object} newSdp The SDP so far (could have been modified by previous handlers).\n * @param {RTCSdpType} info Information about the session description.\n * @param {RTCSdpType} info.type The session description's type.\n * @param {string} info.endpoint Which end of the connection created the SDP.\n * @param {Object} originalSdp The SDP in its initial state.\n * @return {Object} The sanitized SDP with crypto removed (if fingerprint exists)\n */\nexport function sanitizeSdesFromSdp (newSdp, info, originalSdp) {\n  for (let mLine of newSdp.media) {\n    if (mLine.crypto && mLine.fingerprint) {\n      log.debug('Removing SDES line from SDP media section.')\n      delete mLine.crypto\n    }\n  }\n  return newSdp\n}\n\n/**\n * Function generator for an SDP handler function that changes the DTLS role of the SDP.\n * @method changeDtlsRoleTo\n * @param  {string} role\n * @return {Function} SDP handler.\n */\nexport function changeDtlsRoleTo (role) {\n  return function changeDtlsRole (newSdp, info, originalSdp) {\n    // Grab the original DTLS role for logging purposes.\n    //    Assumed that the DTLS role is the same in every media section.\n    const original = newSdp.media[0].setup\n    log.debug(`Changing SDP DTLS role from ${original} to ${role}.`)\n\n    // Change the DTLS role in every media section.\n    newSdp.media.map(media => {\n      media.setup = role\n      return media\n    })\n\n    return newSdp\n  }\n}\n\n/**\n * An SDP handler that adds bandwidth options to the SDP.\n * Supports Chrome & Firefox by generating 2 types of configs:\n *  - 'AS' for Chrome in kilobits per second\n *  - 'TIAS' for Firefox in bits per second\n * @method modifySdpBandwidth\n * @param {BandwidthControls} bandwidthControls\n * @return {Function} SDP handler.\n */\nexport function modifySdpBandwidth (newSdp, info, originalSdp) {\n  /**\n   * Generates bandwidth configs that Chrome & Firefox can recognize.\n   * @param {number} limit The bandwidth limit in kilobits per second.\n   */\n  function generateBandwidthConfigs (limit) {\n    return [\n      {\n        type: 'AS', // Chrome supports this (in kilobits per second)\n        limit\n      },\n      {\n        type: 'TIAS', // Firefox supports this (in bits per second)\n        limit: limit * 1000\n      }\n    ]\n  }\n\n  if (info.bandwidth) {\n    // For more details on bandwidth controls, see here https://webrtchacks.com/limit-webrtc-bandwidth-sdp/.\n    if (info.bandwidth.audio) {\n      newSdp.media\n        .filter(media => media.type === 'audio')\n        .forEach(media => {\n          media.bandwidth = generateBandwidthConfigs(info.bandwidth.audio)\n        })\n    }\n    if (info.bandwidth.video) {\n      newSdp.media\n        .filter(media => media.type === 'video')\n        .forEach(media => {\n          media.bandwidth = generateBandwidthConfigs(info.bandwidth.video)\n        })\n    }\n  }\n  return newSdp\n}\n","import { getSdpSessionId } from '../../../../webrtc/src/sdpUtils/extractors'\n\n/**\n * Checks whether two SDPs have the same session ID.\n * @method hasSameSessionId\n * @param  {string}  sdp    A valid SDP string.\n * @param  {string}  newSdp A valid SDP string.\n * @return {boolean} Whether the two SDPs have the same session ID.\n */\nexport function hasSameSessionId (sdp, newSdp) {\n  const firstSdpSessionId = getSdpSessionId(sdp)\n  const secondSdpSessionId = getSdpSessionId(newSdp)\n\n  if (firstSdpSessionId && secondSdpSessionId) {\n    return firstSdpSessionId === secondSdpSessionId\n  }\n}\n","// Call plugin.\nimport { callActions } from '../../call/interfaceNew/actions'\n\n// Helpers\nimport { getLogManager } from '../../logs'\nimport runPipeline from '../sdp/pipeline'\n\n// WebRTC operations.\nimport * as mediaOps from './media'\n\n// Libraries.\nimport { call, put } from 'redux-saga/effects'\n\nconst log = getLogManager().getLogger('CALLSTACK')\n\n/**\n * Performs the WebRTC portion necessary for establishing outgoing calls\n *\n * @method setupCall\n * @param  {Object} deps\n * @param  {Object} deps.webRTC      The WebRTC stack.\n * @param  {Array}  deps.sdpHandlers SDP handlers.\n * @param  {Object} mediaConstraints Video and audio media constraints\n * @param  {boolean} mediaConstraints.audio Whether to enable audio or not\n * @param  {boolean} mediaConstraints.video Whether to enable video or not\n * @param  {Object} sessionOptions\n * @param  {Object} sessionOptions.callId The id of the call\n * @param  {Object} sessionOptions.sdpSemantics Semantics for Real Time Communication configurations\n * @param  {Object} sessionOptions.turnInfo Contains information required for setting up ICE servers\n * @param  {string} sessionOptions.trickleIceMode What mode to be used for trickle ICE\n * @param  {Object} [sessionOptions.bandwidth] Contains configuration details for setting bandwidth\n * @return {Object} Object\n * @return {string} Object.offerSdp Session Description Protocol for a call offer\n * @return {string} Object.sessionId session identifier\n * @return {Array}  Object.mediaIds call identifiers\n */\nexport function * setupCall (deps, mediaConstraints, sessionOptions) {\n  const { webRTC, sdpHandlers } = deps\n  const { sdpSemantics, turnInfo, trickleIceMode, bandwidth, callId } = sessionOptions\n\n  const { medias, error } = yield call(mediaOps.createLocal, webRTC, mediaConstraints)\n\n  if (error) {\n    return { error }\n  }\n\n  // Create a webRTC session to represent this call.\n  const session = yield call([webRTC.sessionManager, 'create'], {\n    peer: {\n      rtcConfig: {\n        sdpSemantics,\n        iceServers: turnInfo.servers\n      },\n      trickleIceMode\n    }\n  })\n\n  // Trigger a new action specifying that the session has been created\n  yield put(\n    callActions.sessionCreated(callId, {\n      webrtcSessionId: session.id\n    })\n  )\n\n  // Add the tracks to the session.\n  let allTracks = []\n\n  for (let eachMedia of medias) {\n    let tracks = yield call([eachMedia, 'getTracks'])\n    allTracks = [...allTracks, ...tracks]\n  }\n  yield call([session, 'addTracks'], allTracks)\n\n  /*\n   * Create the local SDP offer, run it through any provided SDP handlers,\n   *    then set it as the Session's local description.\n   */\n  let offer = yield call([session, 'createOffer'])\n\n  offer.sdp = yield call(runPipeline, sdpHandlers, offer.sdp, {\n    type: offer.type,\n    endpoint: 'local',\n    bandwidth\n  })\n  offer = yield call([session, 'setLocalDescription'], offer)\n\n  return {\n    error: false,\n    offerSdp: offer.sdp,\n    sessionId: session.id,\n    mediaIds: medias.map(media => media.id)\n  }\n}\n\n/**\n * Prepares the WebRTC portions of setting up an incoming call\n *\n * @method setupIncomingCall\n * @param  {Object} deps\n * @param  {Object} deps.webRTC      The WebRTC stack.\n * @param  {Array}  deps.sdpHandlers SDP handlers.\n * @param  {Object} sessionOptions\n * @param  {string} sessionOptions.callId the local call id\n * @param  {Object} sessionOptions.sdpSemantics semantics for the SDP, contains video and audio constraints\n * @param  {Object} sessionOptions.turnInfo TURN information, contains server info\n * @param  {string} sessionOptions.trickleIceMode the mode to enable for Trickle ICE\n * @param  {Object} sessionOptions.offer an offer containing an SDP\n * @return {string} sessionId an identifier for the session\n */\nexport function * setupIncomingCall (deps, sessionOptions) {\n  const { webRTC, sdpHandlers } = deps\n  const { sdpSemantics, turnInfo, trickleIceMode, callId } = sessionOptions\n  let offer = sessionOptions.offer\n\n  const session = yield call([webRTC.sessionManager, 'create'], {\n    peer: {\n      rtcConfig: {\n        sdpSemantics,\n        iceServers: turnInfo.servers\n      },\n      trickleIceMode\n    }\n  })\n\n  /*\n   * Run the remote SDP offer through any SDP handlers provided, then set it\n   *    as the Session's remote description.\n   */\n  offer.sdp = yield call(runPipeline, sdpHandlers, offer.sdp, {\n    type: offer.type,\n    endpoint: 'remote'\n  })\n\n  yield call([session, 'processOffer'], {\n    type: 'offer',\n    sdp: offer.sdp\n  })\n\n  // Trigger a new action specifying that the session has been created\n  yield put(\n    callActions.sessionCreated(callId, {\n      webrtcSessionId: session.id\n    })\n  )\n\n  return session.id\n}\n\n/**\n * Prepares the WebRTC portions of answering a call\n *\n * @method answerWebrtcSession\n * @param  {Object} deps\n * @param  {Object} deps.webRTC      The WebRTC stack.\n * @param  {Array}  deps.sdpHandlers SDP handlers.\n * @param  {Object} mediaConstraints Video and audio media constraints\n * @param  {boolean} mediaConstraints.audio Whether to enable audio or not\n * @param  {boolean} mediaConstraints.video Whether to enable video or not\n * @param  {Object} sessionOptions\n * @param  {string} sessionOptions.sessionId the local webrtc session id\n * @param  {string} sessionOptions.callId the local call id\n * @param  {Object} [sessionOptions.bandwidth] Contains configuration details for setting bandwidth\n * @return {Object} Object\n * @return {string} Object.answerSDP Session Description Protocol for answer\n * @return {string} Object.mediaId an identifier for media\n */\nexport function * answerWebrtcSession (deps, mediaConstraints, sessionOptions) {\n  const { webRTC, sdpHandlers } = deps\n  const { sessionId, bandwidth } = sessionOptions\n\n  // Get the webRTC session that represents this call.\n  const session = yield call([webRTC.sessionManager, 'get'], sessionId)\n\n  if (!session) {\n    log.error(`Error: webRTC session ${sessionId} not found.`)\n    return\n  }\n\n  const { medias, error } = yield call(mediaOps.createLocal, webRTC, mediaConstraints)\n\n  if (error) {\n    return { error }\n  }\n\n  let allTracks = []\n\n  // Add the tracks to the session.\n  for (let eachMedia of medias) {\n    let tracks = yield call([eachMedia, 'getTracks'])\n    allTracks = [...allTracks, ...tracks]\n  }\n  yield call([session, 'addTracks'], allTracks)\n\n  /*\n   * Create the local SDP answer, run it through any provided SDP handlers,\n   *    then set it as the Session's local description.\n   */\n  let answer = yield call([session, 'createAnswer'])\n  answer.sdp = yield call(runPipeline, sdpHandlers, answer.sdp, {\n    type: answer.type,\n    endpoint: 'local',\n    bandwidth\n  })\n  answer = yield call([session, 'setLocalDescription'], answer)\n\n  return {\n    error: false,\n    answerSDP: answer.sdp,\n    mediaIds: medias.map(media => media.id)\n  }\n}\n","import { getLogManager } from '../../logs'\nimport BasicError, { callCodes } from '../../errors'\n\n// Libraries.\nimport { call } from 'redux-saga/effects'\n\nconst log = getLogManager().getLogger('CALLSTACK')\n\n/**\n * Use the WebRTC stack to create a local Media object.\n * @method createLocal\n * @param  {Object} webRTC           The WebRTC stack.\n * @param  {Object} mediaConstraints The native gUM constraints.\n * @return {Object} Results object, with either `media` or `error` property.\n */\nexport function * createLocal (webRTC, mediaConstraints) {\n  log.debug('Getting media with constraints: ', mediaConstraints)\n\n  // Default return values.\n  const result = { medias: [], error: false }\n\n  try {\n    if (mediaConstraints.screenShare) {\n      let screenShareContraints = {\n        video: mediaConstraints.screenShare\n      }\n\n      let screenShareMedia = yield call([webRTC.media, 'createLocalScreen'], screenShareContraints)\n      result.medias.push(screenShareMedia)\n    }\n\n    if (mediaConstraints.audio || mediaConstraints.video) {\n      let media = yield call([webRTC.media, 'createLocal'], mediaConstraints)\n      result.medias.push(media)\n    }\n  } catch (err) {\n    let errMessage\n    if (err.name === 'OverconstrainedError') {\n      errMessage = `Failed to get media due to constraint: ${err.constraint}.`\n    } else {\n      errMessage = `Failed to get media => Name: ${err.name}; Error Message :${err.message}.`\n    }\n\n    log.info(errMessage)\n\n    // Clean up successfull media object when there is partial media failure.\n    for (let eachMedia of result.medias) {\n      yield call([eachMedia, 'stop'])\n    }\n\n    result.error = new BasicError({\n      message: errMessage,\n      code: callCodes.USER_MEDIA_ERROR\n    })\n  }\n\n  return result\n}\n","// Callstack plugin.\nimport runPipeline from '../sdp/pipeline'\n\n// Other Plugins\nimport { getLogManager } from '../../logs'\nimport BasicError, { callCodes } from '../../errors'\n\n// WebRTC operations.\nimport * as mediaOps from './media'\n\n// Libraries\nimport { call, all } from 'redux-saga/effects'\nimport { isUndefined, isEmpty } from 'lodash/fp'\n\nconst log = getLogManager().getLogger('CALLSTACK')\n\n/**\n * Recreates the internal Peer of a Session.\n * @method recreatePeer\n * @param {Object} webRTC    The WebRTC stack.\n * @param {string} sessionId The Session to act on.\n */\nexport function * recreatePeer (webRTC, sessionId) {\n  const session = yield call([webRTC.sessionManager, 'get'], sessionId)\n  if (!session) {\n    log.debug(`webRTC session ${sessionId} not found.`)\n    return\n  }\n\n  yield call([session, 'recreatePeer'])\n}\n\n/**\n * Performs the webRTC session functions associated with closing a call\n *\n * @method closeCall\n * @param {Object} webRTC A WebRTC instance\n * @param {string} sessionId the local webRTC session id, used to lookup the session object\n */\nexport function * closeCall (webRTC, sessionId) {\n  const session = yield call([webRTC.sessionManager, 'get'], sessionId)\n  if (!session) {\n    log.debug(`webRTC session ${sessionId} not found.`)\n    return\n  }\n\n  yield all(session.localTracks.map(track => call([track, 'cleanup'])))\n\n  yield call([session, 'end'])\n}\n\n/**\n * Performs webRTC portions of receiving an \"offer\" Session Description Protocol\n *\n * @method handleOffer\n * @param  {Object} deps\n * @param  {Object} deps.webRTC      The WebRTC stack.\n * @param  {Array}  deps.sdpHandlers SDP handlers.\n * @param  {string} offer Session Description protocol offer\n * @param  {string} webrtcSessionId local webrtc session id\n * @param {BandwidthControls} bandwidth bandwidth configurations to use\n * @returns {Object}\n */\nexport function * handleOffer (deps, offer, webrtcSessionId, bandwidth) {\n  const { webRTC, sdpHandlers } = deps\n  const session = yield call([webRTC.sessionManager, 'get'], webrtcSessionId)\n\n  if (!session) {\n    log.debug(`webRTC session ${webrtcSessionId} not found.`)\n    return\n  }\n\n  /*\n   * Run the remote SDP offer through any SDP handlers provided, then set it\n   *    as the Session's remote description.\n   */\n  offer = yield call(runPipeline, sdpHandlers, offer, {\n    type: 'offer',\n    endpoint: 'remote'\n  })\n\n  // TODO: Make sure the session is in the correct signaling state to process an offer.\n  const error = yield call([session, 'processOffer'], {\n    type: 'offer',\n    sdp: offer\n  })\n\n  if (error) {\n    return { error }\n  }\n\n  /*\n   * Create the local SDP answer, run it through any provided SDP handlers,\n   *    then set it as the Session's local description.\n   */\n  let answer = yield call([session, 'createAnswer'])\n  answer.sdp = yield call(runPipeline, sdpHandlers, answer.sdp, {\n    type: answer.type,\n    endpoint: 'local',\n    bandwidth\n  })\n  answer = yield call([session, 'setLocalDescription'], answer)\n\n  return {\n    answerSDP: answer.sdp\n  }\n}\n\n/**\n * Performs the webRTC session functions associated with creating an SDP offer\n *\n * @method generateOffer\n * @param {Object} deps\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n * @param {string} sessionId the local webRTC session id, used to lookup the session object\n * @param {Object} mediaDirections\n * @param {string} mediaDirections.audio mode of audio add to the sdp offer\n * @param {string} mediaDirections.video mode of video add to the sdp offer\n * @param {BandwidthControls} bandwidth bandwidth configurations to use\n * @return {Object} offer object containing a Session Description Protocol\n */\nexport function * generateOffer (deps, sessionId, mediaDirections, bandwidth) {\n  const { webRTC, sdpHandlers } = deps\n  const session = yield call([webRTC.sessionManager, 'get'], sessionId)\n\n  if (!session) {\n    log.debug(`webRTC session ${sessionId} not found.`)\n    return\n  }\n\n  /*\n   * Create the local SDP offer, run it through any provided SDP handlers,\n   *    then set it as the Session's local description.\n   */\n  // TODO: Make sure the session is in the correct signaling state to start a\n  //    renegotiation operation.\n  let offer = yield call([session, 'createOffer'], {\n    mediaDirections\n  })\n  offer.sdp = yield call(runPipeline, sdpHandlers, offer.sdp, {\n    type: offer.type,\n    endpoint: 'local',\n    bandwidth\n  })\n  offer = yield call([session, 'setLocalDescription'], offer)\n\n  return offer\n}\n\n/**\n * Performs the webRTC responsibilities for adding media\n *\n * @param {Object} deps\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n * @param  {Object} mediaConstraints Video and audio media constraints\n * @param  {boolean} mediaConstraints.audio Whether to enable audio or not\n * @param  {boolean} mediaConstraints.video Whether to enable video or not\n * @param  {Object} sessionOptions\n * @param  {string} sessionOptions.sessionId the local webrtc session id\n * @param  {Object} [sessionOptions.bandwidth] Contains configuration details for setting bandwidth\n * @return {Object} Object\n * @return {string} Object.sdp An offer in the form of a Session Description Protocol\n * @return {Object} Object.media media object containing tracks\n */\nexport function * webRtcAddMedia (deps, mediaConstraints, sessionOptions) {\n  const { webRTC, sdpHandlers } = deps\n  const { medias, error } = yield call(mediaOps.createLocal, webRTC, mediaConstraints)\n  const { sessionId, bandwidth } = sessionOptions\n\n  if (error) {\n    return { error }\n  }\n  const session = yield call([webRTC.sessionManager, 'get'], sessionId)\n\n  let allTracks = []\n\n  for (let eachMedia of medias) {\n    let tracks = yield call([eachMedia, 'getTracks'])\n\n    allTracks = [...allTracks, ...tracks]\n  }\n\n  yield call([session, 'addTracks'], allTracks)\n\n  /*\n   * Create the local SDP offer, run it through any provided SDP handlers,\n   *    then set it as the Session's local description.\n   */\n  // TODO: Make sure the session is in the correct signaling state to start a\n  //    renegotiation operation.\n  let offer = yield call([session, 'createOffer'])\n  offer.sdp = yield call(runPipeline, sdpHandlers, offer.sdp, {\n    type: offer.type,\n    endpoint: 'local',\n    bandwidth\n  })\n  offer = yield call([session, 'setLocalDescription'], offer)\n\n  let mediaStates = []\n\n  for (let eachMediaState of medias) {\n    let mediaState = yield call([eachMediaState, 'getState'])\n\n    mediaStates = [...mediaStates, mediaState]\n  }\n\n  return { error: false, medias: mediaStates, sdp: offer.sdp }\n}\n\n/**\n * Performs the webRTC responsibilities for removing media\n *\n * @param {Object} deps\n * @param {Object} deps.webRTC      The WebRTC stack.\n * @param {Array}  deps.sdpHandlers SDP handlers.\n * @param {Object} sessionOptions\n * @param  {string} sessionOptions.sessionId The local webrtc session id\n * @param {Array} sessionOptions.tracks A list of track IDs to remove\n * @param  {Object} [sessionOptions.bandwidth] Contains configuration details for setting bandwidth\n * @return {Object} Object\n * @return {string} Object.sdp An offer in the form of a Session Description Protocol\n */\nexport function * webRtcRemoveMedia (deps, sessionOptions) {\n  const { webRTC, sdpHandlers } = deps\n  const { sessionId, tracks, bandwidth } = sessionOptions\n  // Get the tracks that we want to remove\n  const localTracksToRemove = yield call([webRTC.track, 'getTracks'], tracks)\n  const invalidTrackIds = []\n  for (var i = 0; i < localTracksToRemove.length; i++) {\n    if (isUndefined(localTracksToRemove[i])) {\n      invalidTrackIds.push(tracks[i])\n    }\n  }\n\n  if (!isEmpty(invalidTrackIds)) {\n    const message = 'Invalid track id(s) provided'\n    log.debug(message)\n    return {\n      error: new BasicError({\n        code: callCodes.INVALID_PARAM,\n        message\n      })\n    }\n  }\n\n  const session = yield call([webRTC.sessionManager, 'get'], sessionId)\n\n  // Removes tracks from peer (Will stop tracks from being sent to remote participant).\n  // Does NOT end the tracks.\n  yield call([session, 'removeTracks'], tracks)\n\n  // TODO: This should only cleanup the removed tracks, shouldn't it?\n  // Ends the tracks.\n  // Clean-up the local tracks.\n  yield all(localTracksToRemove.map(track => call([track, 'cleanup'])))\n\n  /*\n   * Create the local SDP offer, run it through any provided SDP handlers,\n   *    then set it as the Session's local description.\n   */\n  // TODO: Make sure the session is in the correct signaling state to start a\n  //    renegotiation operation.\n  let offer = yield call([session, 'createOffer'])\n  offer.sdp = yield call(runPipeline, sdpHandlers, offer.sdp, {\n    type: offer.type,\n    endpoint: 'local',\n    bandwidth\n  })\n  offer = yield call([session, 'setLocalDescription'], offer)\n\n  return {\n    sdp: offer.sdp\n  }\n}\n\n/**\n * Performs the webRTC responsibilities for replacing a track\n *\n * @param {Object} webRTC A WebRTC instance\n * @param {Object} params\n * @param {string} params.sessionId The id of the session to replace the track of\n * @param {string} params.trackId The id of the track to replace\n * @param  {Object} params.mediaConstraints Video or audio media constraints\n * @param  {Object|boolean} params.mediaConstraints.audio Audio configs\n * @param  {Object|boolean} params.mediaConstraints.video Video configs\n * @returns {Object} replaceTrackResult The result of the track replace operation\n * @returns {BasicError} [replaceTrackResult.error] Error object\n * @returns {string} newTrackId The ID of the new track that we used to replace the old one.\n * @returns {Object} replaceTrackResult.oldTrackState The state of the old track before it was replaced.\n */\nexport function * webRtcReplaceTrack (webRTC, params) {\n  const { sessionId, trackId, mediaConstraints } = params\n\n  const session = yield call([webRTC.sessionManager, 'get'], sessionId)\n  const oldTrack = session.localTracks.find(track => track.id === trackId)\n\n  if (!oldTrack) {\n    return {\n      error: new BasicError({\n        code: callCodes.INVALID_PARAM,\n        message: `Old track ${trackId} not found.`\n      }),\n      newTrackId: undefined\n    }\n  }\n\n  const oldTrackState = yield call([oldTrack, 'getState'])\n  const oldTrackKind = oldTrackState.kind\n\n  // Verify that there are constraints for the old track's kind.\n  if (!mediaConstraints[oldTrackKind]) {\n    return {\n      error: new BasicError({\n        code: callCodes.INVALID_PARAM,\n        message: `Media constraints missing data for ${oldTrackKind}.`\n      }),\n      newTrackId: undefined\n    }\n  }\n\n  const finalMediaConstraints = {\n    [oldTrackKind]: mediaConstraints[oldTrackKind]\n  }\n\n  // Create Media\n  const { medias: newMedias, error: createLocalError } = yield call(mediaOps.createLocal, webRTC, finalMediaConstraints)\n  if (createLocalError) {\n    return { error: createLocalError, newTrackId: undefined }\n  }\n\n  let allNewTracks = []\n\n  // Find the new track that matches the old track we want to replace.\n\n  for (let eachMedia of newMedias) {\n    let newTracks = yield call([eachMedia, 'getTracks'])\n    allNewTracks = [...allNewTracks, ...newTracks]\n  }\n\n  let newTrack\n  for (let track of allNewTracks) {\n    // Matching the track is done this way because we need to yield to getState,\n    //    but we can't yield inside of a `.find(func)` or similar. So iterate\n    //    over the new tracks \"manually\".\n    const state = yield call([track, 'getState'])\n    if (state.kind === oldTrackKind) {\n      newTrack = track\n      break\n    }\n  }\n\n  if (!newTrack) {\n    return {\n      error: new BasicError({\n        code: callCodes.USER_MEDIA_ERROR,\n        message: `${oldTrackKind} track not found`\n      }),\n      newTrackId: undefined\n    }\n  }\n\n  // Replaces the track\n  const replaceTrackError = yield call([session, 'replaceTrack'], newTrack.track, { trackId })\n  if (replaceTrackError) {\n    // If cannot replace old track, cleanup the newly created track\n    yield call([newTrack, 'cleanup'])\n    return {\n      error: new BasicError({\n        code: callCodes.GENERIC_ERROR,\n        message: replaceTrackError.message\n      }),\n      newTrackId: undefined\n    }\n  }\n\n  // cleanup old track\n  yield call([oldTrack, 'cleanup'])\n\n  return {\n    newTrackId: newTrack.id,\n    oldTrackState\n  }\n}\n","// Other Plugins\nimport { getLogManager } from '../../logs'\nimport BasicError, { callCodes } from '../../errors'\n\n// Helpers.\nimport { changeDtlsRoleTo } from '../utils'\nimport { hasSameSessionId } from '../utils/sdp'\nimport runPipeline from '../sdp/pipeline'\n\n// Libraries.\nimport { call, all } from 'redux-saga/effects'\n\nconst log = getLogManager().getLogger('CALLSTACK')\n\n/**\n * Compares whether a new remote SDP for a Session has the same SDP session ID\n *    of the previous remote SDP.\n * @method isSameSdpSessionId\n * @param  {Object}  webRTC    The webRTC stack.\n * @param  {string}  sessionId ID of the Session under question.\n * @param  {string}  sdp       New remote SDP to compare the current one with.\n * @return {boolean}\n */\nexport function * isSameSdpSessionId (webRTC, sessionId, sdp) {\n  const session = yield call([webRTC.sessionManager, 'get'], sessionId)\n  const currentDesc = session.peer.remoteDescription\n\n  // TODO: How to act when there isn't a remote SDP set?\n  // Currently: Return falsy to cause a recreate. If there isn't a remote SDP\n  //    set, it's possible we're in an error scenario.\n  if (currentDesc && currentDesc.sdp) {\n    const sameId = yield call(hasSameSessionId, currentDesc.sdp, sdp)\n    return sameId\n  }\n}\n\n/**\n * Removes local tracks that are not being sent to the other side.\n * This is meant to be called when a remote sdp has been processed.\n * @method removeUnusedLocalTracks\n * @param  {Object}  webRTC    The webRTC stack.\n * @param  {string}  sessionId ID of the Session under question.\n */\nexport function * removeUnusedLocalTracks (webRTC, sessionId) {\n  const session = yield call([webRTC.sessionManager, 'get'], sessionId)\n  const localTracksIsSending = yield call([session, 'getLocalTracksIsSendingStatus'])\n\n  // Only get the track ids where the track is not sending.\n  const trackIdsToRemove = Object.keys(localTracksIsSending).filter(localTrackId => !localTracksIsSending[localTrackId])\n  const tracksToRemove = yield call([webRTC.track, 'getTracks'], trackIdsToRemove)\n  log.debug(`Tracks to be removed due to not being actively used for the call: ${trackIdsToRemove}`)\n\n  // Removes tracks from peer (Will stop tracks from being sent to remote participant).\n  // Does NOT end the tracks.\n  yield call([session, 'removeTracks'], trackIdsToRemove)\n\n  // Ends the tracks.\n  // Clean-up the local tracks.\n  yield all(tracksToRemove.map(track => call([track, 'cleanup'])))\n}\n\n/**\n * An answer SDP has been received and should be applied to the Session.\n *\n * This saga is intended to handle all webRTC scenarios where a remote answer\n *    SDP has been received and needs to be added to the Session. At this point\n *    in negotiation, a Session should have been created and a local offer SDP\n *    set. This can be for initial negotiation or for midcall renegotiation, so\n *    the Session may or may not have a \"current remote SDP\" already.\n * This saga will complete the negotiation process, as both ends will have both\n *    an offer and answer SDP set.\n * Responsibilities:\n *    1. Ensure this is a valid operation.\n *        - Session exists, Session is in correct signaling state.\n *    2. Check the answer SDP for abnormal scenarios.\n *        - DTLS role issue.\n *    3. Process the answer SDP via Session's APIs.\n * @method receivedAnswer\n * @param {Object} webRTC An instance of webRTC\n * @param {Object} sessionInfo Session related information for the operation.\n * @param {string} sessionInfo.sessionId ID for the local webRTC Session.\n * @param {string} sessionInfo.answerSdp The received answer SDP.\n * @param {Object} targetCall Information about the call that this Session is associated with.\n * @returns {Object} Error object if any have occured. Undefined otherwise.\n */\nexport function * receivedAnswer (deps, sessionInfo, targetCall) {\n  const { webRTC, sdpHandlers } = deps\n  log.debug(`Processing SDP answer for session ${sessionInfo.sessionId}.`)\n\n  const sessionId = sessionInfo.sessionId\n  let answerSdp = sessionInfo.answerSdp\n  const session = yield call([webRTC.sessionManager, 'get'], sessionId)\n\n  if (!session) {\n    log.debug(`webRTC session ${sessionId} not found.`)\n    // TODO: Better error.\n    return\n  }\n  // TODO: Ensure Session is in the correct signaling state for an answer SDP.\n\n  /*\n   * If the answer we received has DTLS role of 'actpass', then this is not a\n   *    normal webRTC scenario. An answer SDP cannot have 'actpass' as the role.\n   * It is assumed that the reason for this is a slow start call.\n   */\n  if (answerSdp.includes('a=setup:actpass')) {\n    /*\n     * Change the DTLS role depending on which side of the call the user is.\n     * Change the caller to passive and the callee to active roles, because\n     *    this is how it would be set for a regular call.\n     */\n    const newRole = targetCall.isCaller ? 'passive' : 'active'\n    log.debug(`Received answer SDP has role of actpass. Changing to ${newRole}.`)\n    sdpHandlers.push(changeDtlsRoleTo(newRole))\n  }\n\n  /*\n   * Provide the answer SDP to the Session for \"processing\".\n   * If successful, the webRTC negotiation process is considered complete.\n   */\n  let error\n  try {\n    /*\n     * Run the remote SDP answer through any SDP handlers provided, then set it\n     *    as the Session's remote description.\n     */\n    answerSdp = yield call(runPipeline, sdpHandlers, answerSdp, {\n      type: 'answer',\n      endpoint: 'remote'\n    })\n    yield call([session, 'processAnswer'], {\n      type: 'answer',\n      sdp: answerSdp\n    })\n  } catch (err) {\n    // TODO: Better error handling.\n    log.debug(`Failed to process answer: ${err.message}`)\n    let errorInfo\n    if (err.message.includes('The order of m-lines')) {\n      errorInfo = {\n        code: 'call:10',\n        message: 'Failed to receive answer due to media negotiation mismatch.'\n      }\n    } else {\n      errorInfo = {\n        code: callCodes.GENERIC_ERROR,\n        message: `Failed to receive answer: ${err.message}`\n      }\n    }\n    error = new BasicError(errorInfo)\n  }\n\n  // TODO: Handle webRTC errors here.\n\n  return error\n}\n","export { waitFor } from './waitFor'\n","import { all, call, cancel, delay, fork, race, take, join, setContext, getContext } from 'redux-saga/effects'\nimport { getLogManager } from '../../logs'\n\nconst log = getLogManager().getLogger('EFFECTS')\nconst WAIT_SAGA_CONTEXT = 'waitSagaContext'\n\n/**\n * Simple saga that simply does a take, to allow a take effect to be forked.\n *\n * @param {(string|Function|Array)} pattern The action or action selector to wait for.\n */\nfunction * processTake (pattern) {\n  const result = yield take(pattern)\n\n  const waitContext = yield getContext(WAIT_SAGA_CONTEXT)\n  if (waitContext) {\n    log.debug(`Finished wait (${++waitContext.numFinishedWaits} of ${waitContext.numTotalWaits})`)\n    log.trace(`Wait processed action: : ${pattern}`)\n  }\n\n  return result\n}\n\n/**\n * Saga that processes the wait effect.\n * @param {number} timeout The number of milliseconds to wait for the actions to be dispatched.\n * @param {Array.<(string|Function|Array)>} waitPatterns An array of actions or action selectors to wait for.\n */\nfunction * waitSaga (timeout, waitPatterns) {\n  const waitSagaContext = {\n    numFinishedWaits: 0,\n    numTotalWaits: waitPatterns.length\n  }\n\n  // Use a context to add debugging information for the child saga processTake to use.\n  yield setContext({\n    [WAIT_SAGA_CONTEXT]: waitSagaContext\n  })\n\n  // Fork all of the takes\n  const waitTasks = yield all(waitPatterns.map(pattern => fork(processTake, pattern)))\n\n  log.debug(`Waiting ${timeout} msecs for ${waitSagaContext.numTotalWaits} actions to happen.`)\n\n  // Race between the wait tasks and a delay.\n  let { results, timeoutResult } = yield race({\n    results: join(...waitTasks),\n    timeoutResult: delay(timeout)\n  })\n\n  // If we have a timeout, gather partial results.\n  if (timeoutResult) {\n    // Get partial results from tasks\n    results = waitTasks.map(task => task.result())\n\n    // Cancel remaining wait tasks\n    yield cancel(...waitTasks)\n\n    log.debug(\n      `Waiting for actions timed out. ${waitSagaContext.numFinishedWaits} actions were processed out of ${\n        waitSagaContext.numTotalWaits\n      }.`\n    )\n  } else {\n    // NOTE: The `join` effect from the currently used version of redux-saga will return an object if one\n    // task is passed in, and an array if more than one tasks are passed. When updating redux-saga version\n    // check to see if this is still required\n    results = Array.isArray(results) ? results : [results]\n\n    log.debug(`Waiting for actions completed, all ${waitSagaContext.numTotalWaits} actions were processed`)\n  }\n\n  return {\n    timeout: !!timeoutResult,\n    results\n  }\n}\n\n/**\n * Type defining the result of a yielded wait effect.\n *\n * @typedef {Object} WaitEffectResult\n * @property {Array.<Action>} results The array of results for all of the patterns. This can contain partial results.\n *                                    Action patterns that have timed out will be undefined.\n * @property {boolean} timeout The wait timed out.\n */\n\n/**\n * A redux-saga wait effect. This effect will wait for a specified set of actions to occur an return the result\n * of each `take` effect performed on each action. If the wait times out, then the result will contain partial results\n * as well as mark the result as having timed out.\n *\n * @param {number} timeout\n * @param {Array.<ActionPattern>} waitPatterns The list of wait patterns.\n * @return A blocking redux-saga effect that will instruct the middleware to wait for the actions matching the wait\n *         patterns or until a timeout is reached. The result from the yielded will be of type {@link WaitEffectResult}.\n * @see {@link https://redux-saga.js.org/docs/api/#takepattern Redux-saga's take documentation} for supported patterns.\n */\nexport function waitFor (timeout, waitPatterns) {\n  return call(waitSaga, timeout, waitPatterns)\n}\n","import BasicError from '../../errors'\n\n/**\n * The CPaaS handleRequestError helper is intended to parse \"response\" actions\n *    representing error responses for REST requests. CPaaS provides consistent\n *    error responses, so a single parser is able to handle most scenarios.\n * @method handleRequestError\n * @param  {Object}     response    A \"response\" action.\n * @param  {string}     [operation] The name of the operation that was performed.\n * @return {BasicError}\n */\nexport function handleRequestError (response, operation) {\n  let message = (operation ? `${operation} request` : 'Request') + ' failed: '\n  let code\n\n  if (response && response.payload) {\n    /**\n     * Extract the data from the action.\n     *    The `body` is the REST response body (if present).\n     *    The `result` is meta-info about the REST request (always present).\n     *\n     * An expected body looks like:\n     *    body: {\n     *      requestError: {\n     *        <exceptionType>: {\n     *          messageId, text, variables\n     *        }\n     *      }\n     *    }\n     */\n    const { body, result } = response.payload\n    /**\n     * Scenario: CPaaS provided a nice error object. Figure out the type of\n     *    error and parse out the error information it has.\n     */\n    if (body && body.requestError) {\n      // Possible errors are serviceException or policyException.\n      const { serviceException, policyException } = body.requestError\n      // There should only ever be one or the other.\n      let exception = serviceException || policyException\n\n      // Format the information in the except to be a proper sentence.\n      message = formatString(exception.text, exception.variables)\n\n      // TODO: Do we want to wrap the backend's error codes?\n      code = exception.messageId\n    } else {\n      /**\n       * Scenario: CPaaS provided a response body with the error, but with an\n       *    unexpected format. Revert to using the information from the\n       *    REST request \"result\" instead of the body.\n       */\n      message += result.message\n      code = result.code\n    }\n  } else {\n    /**\n     * Scenario: Something really wrong happened, where the response action\n     *    doesn't even have a payload.\n     */\n    message += 'Unknown error.'\n    // TODO: Real code.\n    code = 4\n  }\n\n  return new BasicError({ message, code })\n}\n\n/**\n * Utility function for formatting a CPaaS error response.\n * // TODO: Move this to a more common/utils location.\n */\nfunction formatString (text, variables) {\n  return text.replace(/%(\\d+)/g, function (_, m) {\n    return variables[--m]\n  })\n}\n","export { handleRequestError } from './handleRequestError'\n","// Libraries.\nimport { mergeAllWith, isArray } from 'lodash/fp'\nimport paramParser from 'query-string'\nimport { call } from 'redux-saga/effects'\n\n/**\n * Deeply merges the values of multiple objects. Objects on the left receive the values from objects on their right.\n * Unlike lodash's default merge behavior this doesn't merge arrays.\n *\n * @name mergeValues\n * @param {...Object} objects - Objects to merge\n * @return {Object} A new object containing the merged values.\n */\nexport function mergeValues (...objects) {\n  return mergeAllWith((leftValue, rightValue) => {\n    // Overwrite the default behavior of lodash's merge for arrays and simply\n    // clobber what's on the left so we don't end up with merged arrays.\n    if (isArray(leftValue)) {\n      return rightValue\n    }\n  }, objects)\n}\n\n/**\n * Utility function to convert an object to a query string.\n *\n * @param {Object} params An object of query parameters to be parsed and converted for use in a URL string\n * @param {Object} [options] Options to be passed to the query-string library\n * * @param {String} [options.arrayFormat] Format in which to compose array values which were passed as query parameters\n */\nexport function toQueryString (params = {}, options = {}) {\n  if (Object.keys(params).length > 0) {\n    const stringifiedParams = paramParser.stringify(params, options)\n    return '?' + stringifiedParams\n  }\n  return ''\n}\n\n/**\n * Higher-order function to auto-restart sagas when they crash.\n * Based on: https://github.com/redux-saga/redux-saga/pull/644#issuecomment-266454875\n * @method autoRestart\n * @param  {Generator} saga The saga to wrap.\n * @return {Generator} Wrapped saga.\n */\nexport function autoRestart (saga) {\n  return function * autoRestarting (...args) {\n    // Only restart the saga if it crashed; avoid restarting it if\n    //      it returned normally.\n    let shouldRestart = false\n    do {\n      try {\n        yield call(saga, ...args)\n        shouldRestart = false\n      } catch (e) {\n        // TODO: Re-add this log line.\n        // Importing the LogManager in this file breaks tests for an unknown\n        //    reason. Should find out why so that we can log in our utils.\n        // log.error(`Unhandled error in saga ${saga.name}.`, e)\n        console.log(`Unhandled error in saga ${saga.name}.`, e)\n        shouldRestart = true\n      }\n    } while (shouldRestart)\n  }\n}\n","/**\n * This file is a plugin for the \"Config\" plugin\n * Reference info: https://confluence.genband.com/display/KSDK/Plugins\n */\nimport pluginInterface from './interface'\n\n/**\n * Config Plugin\n *\n * @method configImplementation\n * @return {Object} An instance of the \"Config\" plugin.\n */\n\n// yarn lint:docs complains if this isn't defined in a plugin.\n/**\n * @module config\n */\nexport default function configImplementation () {\n  return {\n    // Interface Components:\n    name: pluginInterface.name,\n    capabilities: ['config'],\n    api: pluginInterface.api,\n    reducer: pluginInterface.reducer\n  }\n}\n","const PREFIX = '@@KANDY/'\n\nexport const CONFIG_UPDATE = PREFIX + 'CONFIG_UPDATE'\n","import * as actionTypes from './actionTypes'\n\n/**\n * Add or update a specific key within the store.config.\n *\n * @param {Object} values The values that will be placed in the store.\n * @param {string} [pluginName] The plugin name of the config being set.\n * @return {Action} action A redux action.\n */\nexport function update (values, pluginName = '') {\n  var payload\n  // Use the plugin name as a substate key, if present.\n  if (pluginName) {\n    payload = {\n      [pluginName]: values\n    }\n  } else {\n    payload = values\n  }\n\n  return {\n    type: actionTypes.CONFIG_UPDATE,\n    payload: payload\n  }\n}\n","import * as actions from './actions'\nimport { getConfiguration } from './selectors'\n\nimport { getLogManager, API_LOG_TAG } from '../../logs'\n\nconst log = getLogManager().getLogger('CONFIG')\n\nexport default function api (context) {\n  const configApi = {\n    /**\n     * Gets the current configuration Object. This is the object that is initially set as part of SDK creation using 'create' function.\n     *\n     * @public\n     * @memberof api\n     * @requires config\n     * @method getConfig\n     * @returns {Object} A configuration Object.\n     */\n    getConfig: function () {\n      log.debug(API_LOG_TAG + 'getConfig')\n      return getConfiguration(context.getState())\n    },\n\n    /**\n     * Update values in the global Config section of the store. The values pertain to the SDK configuration.\n     *\n     * @public\n     * @static\n     * @memberof api\n     * @requires config\n     * @method updateConfig\n     * @param {Object} newConfigValues Key-value pairs that will be placed into the store. See {@link config} for details on what key-value pairs are available for use.\n     */\n    updateConfig: function (newConfigValues) {\n      log.debug(API_LOG_TAG + 'updateConfig: ', newConfigValues)\n      context.dispatch(actions.update(newConfigValues))\n    }\n  }\n\n  return configApi\n}\n","import api from './api'\nimport reducer from './reducers'\n\n/**\n * This interface is for a Config plugin.\n * @type {string}\n */\nconst name = 'config'\n\nexport default {\n  reducer,\n  name,\n  api\n}\n","import * as actionTypes from './actionTypes'\nimport { handleActions } from 'redux-actions'\nimport { merge } from 'lodash/fp'\n\nconst reducers = {}\n\nreducers[actionTypes.CONFIG_UPDATE] = {\n  next (state, action) {\n    return merge(state, action.payload)\n  }\n}\n\n// Config default state is an empty Object\nconst reducer = handleActions(reducers, {})\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\n\n/**\n * Retrieves configuration Object stored in state\n *\n * @method getConfiguration\n * @param  {Object} state Redux state.\n * @return {Object}\n */\nexport function getConfiguration (state) {\n  return cloneDeep(state.config)\n}\n","// Connectivity plugin.\nimport { name, reducer, api } from '../interface'\nimport eventsMap from '../interface/events'\nimport { wsConnectFlow } from './sagas'\n\n// Other plugins.\nimport { update as updateConfig } from '../../config/interface/actions'\nimport { mapEvents } from '../../events/interface/actions'\n\n// Libraries.\nimport { put } from 'redux-saga/effects'\nimport { connCheckResponsibility } from '../../constants'\n\n/**\n * Base Connectivity plugin factory.\n * Responsible for handling websockets.\n * @method baseConnectivity\n * @param  {Object} [options={}] Connectivity configs. See above.\n * @return {Object} Plugin - A connectivity plugin.\n */\nexport default function baseConnectivity (options) {\n  // For backwards compatibility, convert the old style to the new style.\n  if (typeof options.method === 'string') {\n    let method = options.method\n    options.method = {\n      type: method,\n      // In both old scenarios, the client is responsible.\n      responsibleParty: connCheckResponsibility.CLIENT\n    }\n  }\n\n  function * init () {\n    yield put(updateConfig(options, name))\n    yield put(mapEvents(eventsMap))\n  }\n\n  return {\n    sagas: [wsConnectFlow],\n    init,\n    name,\n    reducer,\n    api\n  }\n}\n","// Connectivity plugin.\nimport { openWebsocket, closeWebsocket, wsEmitter } from './websocket'\nimport { getConnectivityConfig, getPingInterval, getCheckConnectivity } from '../interface/selectors'\nimport * as actionTypes from '../interface/actionTypes'\nimport * as actions from '../interface/actions'\n\n// Other plugins.\nimport { getSubscriptionInfo, getConnectionInfo } from '../../auth/interface/selectors'\n\n// Libraries.\nimport { takeEvery, delay, call, put, fork, cancel, actionChannel, race, select, take } from 'redux-saga/effects'\n\nimport { getLogManager } from '../../logs'\n\n// Constants\nimport { platforms, connCheckMethods, connCheckResponsibility } from '../../constants'\n\n// Get the logger\nconst log = getLogManager().getLogger('CONNECTIVITY')\n\nexport function * wsConnectFlow () {\n  const chan = yield actionChannel(actionTypes.WS_ATTEMPT_CONNECT)\n  yield takeEvery(chan, websocketLifecycle)\n}\n\n/**\n * Saga that handles a websocket over its lifecycle.\n * @method websocketLifecycle\n * @param  {Object} wsConnectAction\n */\nexport function * websocketLifecycle (wsConnectAction) {\n  const wsInfo = wsConnectAction.payload\n  const { platform, isReconnect } = wsConnectAction.meta\n\n  // Try to open the websocket.\n  let websocket = yield call(connectWebsocket, wsInfo, platform)\n\n  // Append information to the websocket, so that its accessible elsewhere.\n  // TODO: Remove this and replace with proper redux state storage.\n  websocket.kandy = yield select(getConnectivityConfig)\n\n  websocket.kandy.wsInfo = wsInfo\n  websocket.kandy.platform = platform\n\n  // If the websocket didn't open, dispatch the error and stop here.\n  if (websocket.error) {\n    if (isReconnect) {\n      yield put(actions.wsReconnectFailed(undefined, platform))\n      return\n    } else {\n      yield put(actions.wsConnectFinished(new Error(websocket.message), platform))\n      return\n    }\n  }\n\n  // set last contact in both cases to be now\n  websocket.kandy.lastContact = Date.now()\n\n  let emitTask = yield fork(wsEmitter, websocket, platform)\n\n  // determine which pingFlow is appropriate\n  let pingFlow\n  if (websocket.kandy.method.responsibleParty === connCheckResponsibility.SERVER) {\n    pingFlow = yield fork(serverPingFlow, websocket, platform)\n  } else {\n    pingFlow = yield fork(clientPingFlow, websocket, platform)\n  }\n\n  // Dispatch the finish action, to notify that the websocket is connected.\n  yield put(actions.wsConnectFinished(websocket, platform))\n\n  // Redux-saga take() pattern.\n  // Take end of lifecycle WS actions for this platform.\n  function closeWebsocketPattern (action) {\n    return (\n      (action.type === actionTypes.WS_DISCONNECT || action.type === actionTypes.LOST_CONNECTION) &&\n      action.meta.platform === platform\n    )\n  }\n\n  // Wait for a disconnect or lost connection action.\n  const action = yield take(closeWebsocketPattern)\n\n  // Whether we're disconnecting or have lost connection,\n  //      we want to cancel these tasks either way.\n  yield cancel(emitTask, pingFlow)\n\n  if (action.type === actionTypes.WS_DISCONNECT) {\n    // If we're disconnecting, close the websocket to end it's lifecycle.\n    yield call(closeWebsocket, websocket)\n    yield put(actions.wsDisconnectFinished(undefined, platform))\n  } else {\n    // If this is a Link websocket, we need to ensure the URL is using the\n    //     \"latest\" access token from state.\n    if (wsConnectAction.meta.platform === platforms.UC) {\n      let { notificationChannel } = yield select(getSubscriptionInfo)\n      let { accessToken, oauthToken } = yield select(getConnectionInfo)\n      wsInfo.url = notificationChannel\n      if (oauthToken && !accessToken) {\n        wsInfo.params = {\n          access_token: oauthToken\n        }\n      } else {\n        wsInfo.params = {\n          token: accessToken\n        }\n      }\n    }\n\n    // If we've lost connection, re-dispatch the initial action, so that we can\n    //      start the lifecycle over.\n    yield put(actions.wsAttemptConnect(wsInfo, wsConnectAction.meta.platform, true))\n  }\n}\n\n/**\n * if we receieve a server ping we want to respond with a pong,\n * if there is none we want to check to see if its been too long since the server last pinged us and if it has been then reconnect,\n * otherwise we just want to increment the time since the last ping\n * @param {Object} ws a websocket connected to the backend\n * @return {Object} yields a Flux standard action\n */\nexport function * serverPingFlow (ws) {\n  const { lastContact, platform, maxMissedPings, autoReconnect } = ws.kandy\n  let timeOfLastPing = Date.now()\n\n  while (true) {\n    let pingInterval = yield select(getPingInterval)\n    pingInterval = typeof pingInterval !== 'undefined' ? pingInterval : 120000\n    const maxIdleDuration = pingInterval * maxMissedPings\n\n    // wait for incoming server pings or disconnect actions on an interval\n    const { serverPing, disconnect } = yield race({\n      expiry: delay(pingInterval),\n      serverPing: take(actionTypes.RECEIVE_SERVER_PING),\n      disconnect: take(actionTypes.WS_DISCONNECT_FINISHED)\n    })\n\n    // is disconnect action receieved then exit\n    if (disconnect) {\n      break\n    }\n\n    if (serverPing) {\n      // server sent us a ping so reset the timeSinceLastPing\n      timeOfLastPing = Date.now()\n\n      // pingInterval is stored in milliseconds but comes in as seconds so convert\n      const pingIntervalMillis = serverPing.payload.connCheck.interval * 1000\n      // Prevent firing actions if pingInterval hasnt changed\n      if (pingIntervalMillis !== pingInterval) {\n        yield put(actions.changePingInterval(pingIntervalMillis, platform))\n      }\n\n      const message = { connAck: {} }\n      const error = _sendWSMessage(ws, JSON.stringify(message))\n\n      // if the pong websocket message has an error then try to reconnect\n      if (error) {\n        if (autoReconnect) {\n          yield put(actions.lostConnection(undefined, platform))\n        }\n        break\n      }\n    } else {\n      if (Date.now() - timeOfLastPing >= maxIdleDuration) {\n        log.warn('closing websocket due to inactivity. (have not received pong from server)', platform)\n\n        // try to reconnect or exit\n        if (autoReconnect) {\n          yield put(actions.lostConnection(undefined, platform))\n        }\n        break\n      } else {\n        log.debug(`${platform} websocket last contact: ${lastContact}. Reconnect after ${maxIdleDuration}.`)\n      }\n    }\n  }\n}\n\n/**\n * This flow is rewponsible for handling keepAlive and pingPong methods for client,\n * if keepAlive is used the client simply sends the keepAlive message to the websocket after waiting the pingInterval\n * if pingPong is used the client is responsible for pinging the server and listening for server \"pong\" responses via the websocket\n * the client will then determine if too much time has passed and attempt to reconnect if its not receiving server pongs or if an error occurs\n * @param {Object} ws a websoocket connected to the backend\n * @return {Object} yields a Flux standard action\n */\nexport function * clientPingFlow (ws) {\n  const { lastContact, platform, maxMissedPings, autoReconnect } = ws.kandy\n  const { checkConnectivity, method } = yield select(getConnectivityConfig)\n\n  let timeOfLastPong = Date.now()\n  let message = ''\n  let shouldCheck\n\n  while (true) {\n    // If the flag was explicitly set in state, prefer that over the config.\n    shouldCheck = yield select(getCheckConnectivity)\n    shouldCheck = typeof shouldCheck !== 'undefined' ? shouldCheck : checkConnectivity\n\n    const { pingInterval } = yield select(getConnectivityConfig)\n    const maxIdleDuration = pingInterval * maxMissedPings\n    const intervalInSeconds = pingInterval / 1000\n\n    if (shouldCheck) {\n      if (method.type === connCheckMethods.PING_PONG) {\n        message = { connCheck: { interval: intervalInSeconds } }\n      } else if (method.type === connCheckMethods.KEEP_ALIVE) {\n        message = { message_type: 'ping' }\n      } else {\n        log.error(`invalid connectivity method ${method}`)\n        break\n      }\n\n      log.debug(`${platform} sending a ${method.type}.`)\n\n      const error = _sendWSMessage(ws, JSON.stringify(message))\n      if (error) {\n        log.error('Exception in pingFlow: ' + error.message)\n        if (autoReconnect) {\n          yield put(actions.lostConnection(undefined, platform))\n        }\n        break\n      }\n    } else {\n      log.debug('Set to not check websocket connectivity. Waiting for connectivity status change')\n\n      // If we shouldn't ping, wait until we receive a trigger to (maybe) ping.\n      const shouldCheckConnectivity = yield take(\n        action => action.type === 'CHANGE_CONNECTIVITY_CHECKING' && action.payload\n      )\n      log.debug(`Connectivity check setting changed. Check connectivity?: ${shouldCheckConnectivity}`)\n      continue\n    }\n\n    const delayStartTime = Date.now()\n    // Wait for either the ping interval, a disconnect or a pong from the server\n    let { disconnect, serverPong } = yield race({\n      expiry: delay(pingInterval),\n      serverPong: take(actionTypes.RECEIVE_SERVER_PONG),\n      disconnect: take(actionTypes.WS_DISCONNECT_FINISHED)\n    })\n\n    // If we receive a serverPong, we will not have waited the full pingInterval duration.\n    //    Determine how long we were waiting for, so that we know how long to wait (again)\n    //    to fulfill the full pingInterval duration (before restarting the ping loop).\n    const timeElapsed = Date.now() - delayStartTime\n\n    // If we received a disconnect action, stop the pings and exit.\n    if (disconnect) {\n      break\n    }\n\n    if (method.type === connCheckMethods.PING_PONG) {\n      if (serverPong) {\n        // we receieved a pong, wait pingInterval to send another ping\n        timeOfLastPong = Date.now()\n\n        const timeUntilNextPing = pingInterval - timeElapsed\n        let { disconnect } = yield race({\n          expiry: delay(timeUntilNextPing),\n          disconnect: take(actionTypes.WS_DISCONNECT_FINISHED)\n        })\n        // If we received a disconnect action, stop the pings and exit.\n        if (disconnect) {\n          break\n        }\n      } else {\n        if (Date.now() - timeOfLastPong >= maxIdleDuration) {\n          log.warn('closing websocket due to inactivity. (have not received pong from server)', platform)\n\n          // its been too long since the last pong, attempt to reconnect or exit\n          if (autoReconnect) {\n            yield put(actions.lostConnection(undefined, platform))\n          }\n\n          break\n        } else {\n          log.debug(`${platform} websocket last contact: ${lastContact}. Reconnect after ${maxIdleDuration}.`)\n        }\n      }\n    }\n  }\n}\n\n/**\n * Generic Websocket message that takes a websocket and a message and sends it\n * @param  {Object} ws  websocket\n * @return {Object}     Error object\n */\nfunction _sendWSMessage (ws, message) {\n  try {\n    if (ws && ws.readyState === 1) {\n      ws.send(message)\n    } else {\n      throw new Error('websocket was not in readyState')\n    }\n  } catch (e) {\n    return e\n  }\n}\n\n/**\n * Helper function for connecting to a websocket.\n * Attempts to connect a specified number of times before returning an error.\n * Includes a delay in between attempts, determined by configs.\n * @method connectWebsocket\n * @param  {Object} wsInfo\n * @return {Websocket|Object}  Either a connected websocket or an error object.\n */\nexport function * connectWebsocket (wsInfo, platform) {\n  let configs = yield select(getConnectivityConfig)\n  let connectionAttempt = 0\n  let delayTime = 0\n  let websocket\n\n  // Redux-saga take() pattern.\n  // Take disconnect websocket action for this platform.\n  function disconnectWebsocketPattern (action) {\n    return action.type === actionTypes.WS_DISCONNECT && action.meta.platform === platform\n  }\n\n  // If no limit is set, we will continually attempt to reconnect.\n  if (!configs.reconnectLimit) {\n    log.debug('No connectivity reconnect limit set.')\n  }\n\n  while (connectionAttempt < configs.reconnectLimit || !configs.reconnectLimit) {\n    try {\n      // Try to open the websocket. Blocking call.\n      websocket = yield call(openWebsocket, wsInfo)\n      log.debug('Successfully connected to websocket.', platform)\n      break\n    } catch (err) {\n      connectionAttempt++\n      websocket = err\n      log.debug(`Failed websocket connection (#${connectionAttempt}): ${websocket.message}.`, platform)\n\n      // If we want to try to reconnect, delay a certain about of time before trying.\n      if (connectionAttempt < configs.reconnectLimit || !configs.reconnectLimit) {\n        // Increase the delay time if we're not at the limit.\n        if (delayTime !== configs.reconnectTimeLimit) {\n          delayTime = configs.reconnectDelay * Math.pow(configs.reconnectTimeMultiplier, connectionAttempt - 1)\n          delayTime = delayTime < configs.reconnectTimeLimit ? delayTime : configs.reconnectTimeLimit\n        }\n        log.debug(`Websocket reconnect attempt after ${delayTime}ms.`, platform)\n\n        // Wait for either the delay period or a trigger to stop connection attempts.\n        let { disconnect } = yield race({\n          delay: delay(delayTime),\n          disconnect: take(disconnectWebsocketPattern)\n        })\n\n        if (disconnect) {\n          break\n        }\n      } else {\n        log.debug('Stopping websocket connection attempts.', platform)\n      }\n    }\n  }\n\n  // Return either the websocket or the latest error.\n  return websocket\n}\n","import { wsClosed, wsError, receiveServerPing, receiveServerPong } from '../interface/actions'\nimport { eventChannel, END, buffers } from 'redux-saga'\nimport { take, put, call } from 'redux-saga/effects'\n\nimport { toQueryString } from '../../common/utils'\n\nimport { websocketNotification } from '../../notifications/interface/actions'\n\nconst INITIAL_BUFFER_SIZE = 50\n\n/**\n * Create a new websocket.\n * @method openWebsocket\n * @param  {Object} options Websocket configuration options.\n * @param {string} options.protocol Websocket protocol to use.\n * @param {string} options.server Websocket hostname.\n * @param {string} options.port Websocket port to use.\n * @param {string} options.url Websocket notification channel.\n * @param {Object} options.params A list of URL params to attach to the websocket.\n * @return {WebSocket} ws Newly connected websocket.\n */\nexport function openWebsocket (options) {\n  // Create the websocket.\n  let ws = new WebSocket(\n    `${options.protocol}://${options.server}:${options.port}${options.url}` + toQueryString(options.params)\n  )\n\n  // Use a promise to wait for the first message from the websocket.\n  // This indicates whether the WS opened successfully or not.\n  let validateWS = new Promise((resolve, reject) => {\n    const onOpen = function () {\n      ws.onopen = null\n      ws.onerror = null\n      resolve(ws)\n    }\n    const onError = function () {\n      ws.onopen = null\n      ws.onerror = null\n\n      // TODO: Fix this?\n      /* eslint-disable-next-line prefer-promise-reject-errors */\n      reject({\n        error: true,\n        message: 'Could not connect to websocket. Received error on open.'\n      })\n    }\n    ws.onopen = onOpen\n    ws.onerror = onError\n  })\n  return validateWS\n}\n\n/**\n * Clean-up a provided websocket.\n * @method closeWebsocket\n * @param  {Websocket} ws Websocket to be cleaned-up.\n * @return {Websocket} ws The websocket after being cleaned.\n */\nexport function closeWebsocket (ws) {\n  if (ws.close) {\n    ws.close()\n  } else {\n    ws.onclose = null\n  }\n\n  ws.onmessage = null\n  ws.onopen = null\n  ws.onerror = null\n}\n\n/**\n * Create an event channel for a given websocket\n * @param  {WebSocket} ws       The websocket to make an event channel for.\n * @param {string} [platform=link]    The backend platform associated with the websocket.\n * @return {EventChannel}              The event channel corresponding to the WebSocket\n */\nfunction createWsChannel (ws, platform) {\n  // this function handles server messages\n  return eventChannel(emit => {\n    // Define handlers\n    ws.onmessage = message => {\n      // Mark this websocket are being connected as of now.\n      ws.kandy.lastContact = Date.now()\n\n      var data = JSON.parse(message.data)\n      if (data.connCheck) {\n        // Handle CPaaS server pings\n        emit(receiveServerPing(data, platform))\n      } else if (data.connAck) {\n        // Handle CPaaS server pongs\n        emit(receiveServerPong(data, platform))\n      } else {\n        emit(websocketNotification(data, platform))\n      }\n    }\n    ws.onclose = data => {\n      emit(wsClosed(data, platform))\n      emit(END)\n    }\n    ws.onerror = err => {\n      emit(wsError(new Error(err), platform))\n      emit(END)\n    }\n\n    return () => closeWebsocket(ws)\n  }, buffers.expanding(INITIAL_BUFFER_SIZE))\n}\n\n/**\n * Saga worker for creating a websocket and emitting its events\n * @param {Object} ws configuration options.\n * @param {string} [platform=link]    The backend platform associated with the websocket.\n * @return {Generator}\n */\nexport function * wsEmitter (ws, platform) {\n  var wsChannel = yield call(createWsChannel, ws, platform)\n  while (true) {\n    const action = yield take(wsChannel)\n    yield put(action)\n  }\n}\n","import baseConnectivity from '../common/base'\nimport { connCheckMethods } from '../../constants'\nimport { defaults } from 'lodash/fp'\n\nconst defaultValues = {\n  method: { type: connCheckMethods.PING_PONG, responsibleParty: 'client' },\n  pingInterval: 30000,\n  reconnectLimit: 5,\n  reconnectDelay: 5000,\n  reconnectTimeMultiplier: 1,\n  reconnectTimeLimit: 640000,\n  autoReconnect: true,\n  maxMissedPings: 3,\n  checkConnectivity: true\n}\n\n/**\n * Configuration options for the Connectivity feature.\n * @public\n * @name config.connectivity\n * @memberof config\n * @instance\n * @param {Object} connectivity Connectivity configs.\n * @param {Object} connectivity.method Configuration for how connectivity checks should be made.\n * @param {String} [connectivity.method.type='pingPong'] The method of connectivity checking to use: `keepAlive` or `pingPong`.\n * @param {String} [connectivity.method.responsibleParty='client'] Configures who is responsible for initiating the connectivity check: `client` or `server`.\n * @param {Number} [connectivity.pingInterval=30000] Time in between websocket ping attempts (milliseconds). Only used for when the client is responsible for ping/connCheck.\n * @param {Number} [connectivity.reconnectLimit=5] Number of failed reconnect attempts before reporting an error. Can be set to 0 to not limit reconnection attempts.\n * @param {Number} [connectivity.reconnectDelay=5000] Base time between websocket reconnect attempts (milliseconds).\n * @param {Number} [connectivity.reconnectTimeMultiplier=1] Reconnect delay multiplier for subsequent attempts. The reconnect delay time will be multiplied by this factor after each failed reconnect attempt to increase the delay between attempts.\n * @param {Number} [connectivity.reconnectTimeLimit=640000] Maximum time delay between reconnect attempts (milliseconds). Used in conjunction with `reconnectTimeMultiplier` to prevent overly long delays between reconnection attempts.\n * @param {Boolean} [connectivity.autoReconnect=true] Flag to determine whether reconnection will be attempted automatically after connectivity disruptions.\n * @param {Number} [connectivity.maxMissedPings=3] Maximum pings sent (without receiving a response) before reporting an error.\n * @param {Boolean} [connectivity.checkConnectivity=true] Flag to determine whether to enable connectivity checking or not.\n */\nexport default function connectivity (options = {}) {\n  return baseConnectivity(defaults(defaultValues, options))\n}\n","const prefix = '@@KANDY/CONN/'\n\n// Actions to tell connectivity plugin what to do\nexport const WS_ATTEMPT_CONNECT = prefix + 'WS_ATTEMPT_CONNECT'\nexport const WS_CONNECT_FINISHED = prefix + 'WS_CONNECT_FINISHED'\nexport const WS_DISCONNECT = prefix + 'WS_DISCONNECT'\nexport const WS_DISCONNECT_FINISHED = prefix + 'WS_DISCONNECT_FINISHED'\nexport const WS_RECONNECT_FAILED = prefix + 'WS_RECONNECT_FAILED'\n\n// actions for hooking into connectivity plugin behaviour\nexport const WS_CLOSED = prefix + 'WS_CLOSED'\nexport const WS_ERROR = prefix + 'WS_ERROR'\n\nexport const LOST_CONNECTION = prefix + 'LOST_CONNECTION'\n\nexport const RECEIVE_SERVER_PING = prefix + 'RECEIVE_SERVER_PING'\nexport const RECEIVE_SERVER_PONG = prefix + 'RECEIVE_SERVER_PONG'\n\nexport const CHANGE_CONNECTIVITY_CHECKING = prefix + 'CHANGE_CONNECTIVITY_CHECKING'\nexport const CHANGE_PING_INTERVAL = prefix + 'CHANGE_PING_INTERVAL'\n","import * as actionTypes from './actionTypes'\n// Constants\nimport { platforms } from '../../constants'\n\n/**\n * @param {string} type\n */\nfunction createWsAction (type) {\n  /**\n   * @param {any=} payload\n   * @param {string=} platform\n   * @param {boolean=} [isReconnect] flag to signify if we are reconnecting or not.\n   */\n  function action (payload, platform = platforms.LINK, isReconnect = false) {\n    return {\n      type,\n      // TODO: This must check for basic error eventually instead.\n      error: payload instanceof Error,\n      payload,\n      meta: { platform, isReconnect }\n    }\n  }\n  return action\n}\n\nexport const wsAttemptConnect = createWsAction(actionTypes.WS_ATTEMPT_CONNECT)\nexport const wsDisconnect = createWsAction(actionTypes.WS_DISCONNECT)\nexport const wsConnectFinished = createWsAction(actionTypes.WS_CONNECT_FINISHED)\nexport const wsDisconnectFinished = createWsAction(actionTypes.WS_DISCONNECT_FINISHED)\nexport const wsReconnectFailed = createWsAction(actionTypes.WS_RECONNECT_FAILED)\n\nexport const wsClosed = createWsAction(actionTypes.WS_CLOSED)\nexport const wsError = createWsAction(actionTypes.WS_ERROR)\n\nexport const lostConnection = createWsAction(actionTypes.LOST_CONNECTION)\n\nexport const receiveServerPing = createWsAction(actionTypes.RECEIVE_SERVER_PING)\nexport const receiveServerPong = createWsAction(actionTypes.RECEIVE_SERVER_PONG)\n\nexport const changeConnectivityChecking = createWsAction(actionTypes.CHANGE_CONNECTIVITY_CHECKING)\nexport const changePingInterval = createWsAction(actionTypes.CHANGE_PING_INTERVAL)\n","// Constants\nimport { platforms } from '../../constants'\n\n/**\n * The 'connection' namespace is used to connect and maintain connections between\n * the SDK and one or more backend servers.\n *\n * @public\n * @namespace connection\n */\n\nimport { changeConnectivityChecking } from './actions'\nimport { getConnectionState } from './selectors'\n\nimport { getLogManager, API_LOG_TAG } from '../../logs'\n\nconst log = getLogManager().getLogger('CONNECTIVITY')\n\nexport default function api ({ dispatch, getState }) {\n  const connectivityApi = {\n    /**\n     * Get the state of the websocket.\n     * @public\n     * @memberof connection\n     * @method getSocketState\n     * @param {string} [platform='link'] Backend platform for which to request the websocket's state.\n     */\n    getSocketState (platform = platforms.LINK) {\n      log.debug(API_LOG_TAG + 'connection.getSocketState: ', platform)\n      return getConnectionState(getState(), platform)\n    },\n\n    /**\n     * Enables or disables connectivity checking.\n     * @public\n     * @memberof connection\n     * @method enableConnectivityChecking\n     * @param {boolean} enable Enable connectivity checking.\n     */\n    enableConnectivityChecking (enable) {\n      log.debug(API_LOG_TAG + 'connection.enableConnectivityChecking: ', enable)\n      dispatch(changeConnectivityChecking(enable))\n    }\n  }\n  return { connection: connectivityApi }\n}\n","import { wsAttemptConnect, wsDisconnect } from './actions'\nimport { WS_CONNECT_FINISHED, WS_DISCONNECT_FINISHED, WS_ERROR } from './actionTypes'\nimport { put, take } from 'redux-saga/effects'\n\n/**\n * Custom redux-saga effect.\n * Wraps \"communication\" between the connectivity plugin and another plugin\n *     for connecting to a websocket.\n * @method connectWebsocket\n * @param {Object} websocketInfo Information needed to create the websocket.\n * @param {string} websocketInfo.protocol\n * @param {string} websocketInfo.server\n * @param {string} websocketInfo.port\n * @param {string} websocketInfo.url\n * @param {Object} [websocketInfo.params]\n * @param {string} platform The backend platform being connected to.\n * @return {Object} The response action of type `WS_CONNECT_FINISHED`.\n */\nexport function * connectWebsocket (websocketInfo, platform) {\n  // Dispatch the action that triggers a saga to connect to a websocket.\n  yield put(wsAttemptConnect(websocketInfo, platform))\n\n  // Wait for the action that signifies the result of the above action.\n  const responseAction = yield take(action => {\n    return action.type === WS_CONNECT_FINISHED && action.meta.platform === platform\n  })\n\n  // Return the response.\n  return responseAction\n}\n\n/**\n * Effect for disconnecting a websocket to a platform.\n * @method disconnectWebsocket\n * @param  {Object} payload\n * @param  {string} platform The backend platform being disconnected from.\n * @return {Object} The response action of type `WS_DISCONNECT_FINISHED`.\n */\nexport function * disconnectWebsocket (payload, platform) {\n  // Dispatch the action that triggers a saga to disconnect the websocket.\n  yield put(wsDisconnect(payload, platform))\n\n  // Wait for the action that signifies the result of the above action.\n  const responseAction = yield take(action => {\n    return (action.type === WS_DISCONNECT_FINISHED || action.type === WS_ERROR) && action.meta.platform === platform\n  })\n\n  // Return the response.\n  return responseAction\n}\n","/**\n * The websocket to the server has changed state.\n *\n * @public\n * @memberof connection\n * @event ws:change\n * @param {Object} params\n * @param {string} params.platform The platform\n */\nexport const WS_CHANGE = 'ws:change'\n","import * as eventTypes from './eventTypes'\nimport * as actionTypes from './actionTypes'\n\nvar events = {}\n\nevents[actionTypes.WS_CONNECT_FINISHED] = function (action) {\n  if (action.error) {\n    // TODO: Handle the error case?\n  } else {\n    return {\n      type: eventTypes.WS_CHANGE,\n      args: { platform: action.meta.platform }\n    }\n  }\n}\n\nevents[actionTypes.LOST_CONNECTION] = function (action) {\n  return {\n    type: eventTypes.WS_CHANGE,\n    args: { platform: action.meta.platform }\n  }\n}\n// TODO: Differentiate between types of disconnects?\nevents[actionTypes.WS_DISCONNECT_FINISHED] = events[actionTypes.LOST_CONNECTION]\n\n// TODO: Does an app care that we're trying to connect/reconnect?\nevents[actionTypes.WS_ATTEMPT_CONNECT] = function (action) {\n  return {\n    type: eventTypes.WS_CHANGE,\n    args: { platform: action.meta.platform }\n  }\n}\n\nexport default events\n","import name from './name'\nimport api from './api'\nimport reducer from './reducers'\n\nexport { name, api, reducer }\n","const name = 'connectivity'\nexport default name\n","import * as actionTypes from './actionTypes'\nimport { handleActions } from 'redux-actions'\nimport { omit } from 'lodash/fp'\n\nconst reducers = {}\n\nreducers[actionTypes.WS_ATTEMPT_CONNECT] = {\n  next (state, action) {\n    return {\n      ...state,\n      [action.meta.platform]: {\n        ...state[action.meta.platform],\n        connected: false,\n        pinging: false\n      }\n    }\n  }\n}\n\nreducers[actionTypes.WS_RECONNECT_FAILED] = {\n  next (state, action) {\n    return {\n      ...state,\n      [action.meta.platform]: {\n        ...state[action.meta.platform],\n        connected: false,\n        pinging: false\n      }\n    }\n  }\n}\n\nreducers[actionTypes.WS_CONNECT_FINISHED] = {\n  next (state, action) {\n    return {\n      ...state,\n      [action.meta.platform]: {\n        ...state[action.meta.platform],\n        connected: true,\n        method: action.payload.kandy.method,\n        platform: action.meta.platform,\n        ...omit('checkConnectivity', action.payload.kandy)\n      }\n    }\n  },\n  throw (state, action) {\n    return {\n      [action.meta.platform]: {\n        connected: false,\n        pinging: false\n      }\n    }\n  }\n}\n\nreducers[actionTypes.LOST_CONNECTION] = {\n  next (state, action) {\n    return {\n      ...state,\n      [action.meta.platform]: {\n        ...state[action.meta.platform],\n        connected: false,\n        pinging: false\n      }\n    }\n  }\n}\n\nreducers[actionTypes.WS_DISCONNECT_FINISHED] = {\n  next (state, action) {\n    return {\n      [action.meta.platform]: {\n        connected: false,\n        pinging: false\n      }\n    }\n  },\n  throw (state, action) {\n    return {\n      [action.meta.platform]: {\n        connected: false,\n        pinging: false\n      }\n    }\n  }\n}\n\nreducers[actionTypes.WS_ERROR] = {\n  next (state, action) {\n    return {\n      [action.meta.platform]: {\n        connected: false,\n        pinging: false\n      }\n    }\n  },\n  throw (state, action) {\n    return {\n      [action.meta.platform]: {\n        connected: false,\n        pinging: false\n      }\n    }\n  }\n}\n\n/*\n  Accepts a boolean payload for checkConnectivity\n */\nreducers[actionTypes.CHANGE_CONNECTIVITY_CHECKING] = {\n  next (state, action) {\n    return {\n      ...state,\n      checkConnectivity: action.payload\n    }\n  }\n}\n\n/*\n  Accepts a payload for pingInterval in MILLISECONDS\n */\nreducers[actionTypes.CHANGE_PING_INTERVAL] = {\n  next (state, action) {\n    return {\n      ...state,\n      pingInterval: action.payload\n    }\n  }\n}\n\n/**\n * Connectivity Interface reducer\n * @method reducer\n * @param  {Object}  state - The current redux state.\n * @param  {Object}  action - A flux standard action.\n * @return {Object}  - The new redux state.\n */\nconst reducer = handleActions(reducers, {})\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\nimport name from './name'\n\nexport function getConnectionState (state, platform) {\n  if (state[name][platform]) {\n    return cloneDeep(state[name][platform])\n  } else {\n    return new Error('No sockets are up. Have you attempted to connect?')\n  }\n}\n\n/**\n * Retrieves the config options provided by the connectivity plugin.\n * @method getConnectivityConfig\n * @return {Object}\n */\nexport function getConnectivityConfig (state) {\n  return state.config[name]\n}\n\n/**\n * Retrieves the pingInterval property from state\n * @method getPingInterval\n * @param {Object} state Redux state.\n * @return {Object}\n */\nexport function getPingInterval (state) {\n  return state[name].pingInterval\n}\n\n/**\n * Retrieves the checkConnectivity property from state\n * @method getCheckConnectivity\n * @param {Object} state Redux state.\n * @return {Object}\n */\nexport function getCheckConnectivity (state) {\n  return state[name].checkConnectivity\n}\n","export const platforms = {\n  LINK: 'link',\n  UC: 'uc',\n  CPAAS: 'cpaas'\n}\n\nexport const notificationTypes = {\n  WEBSOCKET: 'websocket',\n  PUSH: 'push'\n}\n\nexport const connCheckResponsibility = {\n  CLIENT: 'client',\n  SERVER: 'server'\n}\n\nexport const connCheckMethods = {\n  KEEP_ALIVE: 'keepAlive',\n  PING_PONG: 'pingPong'\n}\n","/**\n * The User ID ie: joe@test.3s5j.att.com\n *\n * @public\n * @static\n * @module UserID\n * @typedef {string} UserID\n * @memberof user\n * @requires cpaas_user_id\n */\n\n/**\n * The User ID ie: joe@test.3s5j.att.com\n *\n * @public\n * @static\n * @module UserID\n * @typedef {string} UserID\n * @memberof call\n * @requires cpaas_user_id\n */\n\n/**\n * The SIP URI ie: sip:joe@domain.com\n *\n * @public\n * @static\n * @module SIP_URI\n * @typedef {string} SIP_URI\n * @memberof call\n * @requires link_user_id\n */\n\n/**\n * The Phone Numer ie: +18885559876\n *\n * @public\n * @static\n * @module PhoneNumber\n * @typedef {string} PhoneNumber\n * @memberof call\n * @requires cpaas_pstn\n */\n\n/**\n * The TEL URI ie: tel:+18885559876\n *\n * @public\n * @static\n * @module TEL_URI\n * @typedef {string} TEL_URI\n * @memberof call\n * @requires link_pstn\n */\n","/**\n * Error codes for the Auth plugin.\n * @name authCodes\n */\nexport const authCodes = {\n  INVALID_CREDENTIALS: 'authentication:1',\n  CONNECT_FAIL_WS_ERROR: 'authentication:2',\n  LINK_UNSUBSCRIBE_FAIL: 'authentication:3',\n  LINK_SUBSCRIBE_FAIL: 'authentication:4',\n  LINK_EXTEND_SUBSCRIPTION_FAIL: 'authentication:5',\n  LINK_UPDATE_SUBSCRIPTION_FAIL: 'authentication:6',\n  UC_SUBSCRIBE_FAIL: 'authentication:7',\n  UC_REFRESH_TOKEN_FAIL: 'authentication:8',\n  UC_CREATE_TOKEN_FAIL: 'authentication:9',\n  UC_EXTEND_SUBSCRIPTION_FAIL: 'authentication:10',\n  UC_DISCONNECT_FAIL: 'authentication:11',\n  MISSING_SERVICE: 'authentication:12'\n}\n\n/**\n * Error codes for the Call plugin.\n * @name callCodes\n */\nexport const callCodes = {\n  UNKNOWN_ERROR: 'call:1',\n  GENERIC_ERROR: 'call:2',\n  INIT_MEDIA_FAILED: 'call:3',\n  USER_MEDIA_ERROR: 'call:4',\n  NOT_SUPPORTED: 'call:5',\n  // The call is in the wrong state.\n  INVALID_STATE: 'call:6',\n  // A provided parameter is not valid.\n  INVALID_PARAM: 'call:7',\n  // There is a desync between components' state.\n  STATE_DESYNC: 'call:8',\n  // Offer could not be generated\n  INVALID_OFFER: 'call:9'\n}\n\n/**\n * Error codes for the Call History plugin.\n * @name callHistoryCodes\n */\nexport const callHistoryCodes = {\n  UNKNOWN_ERROR: 'callHistory:1',\n  BAD_REQUEST: 'callHistory:2',\n  NOT_FOUND: 'callHistory:3'\n}\n/**\n * @name clickToCallCodes\n */\nexport const clickToCallCodes = {\n  MISSING_ARGS: 'clickToCall:1',\n  RESPONSE_ERROR: 'clickToCall:2'\n}\n/**\n * Error codes for the Groups plugin.\n * @name groupsCodes\n */\nexport const groupsCodes = {\n  UNKNOWN_ERROR: 'groups:1',\n  GENERIC_ERROR: 'groups:2',\n  MISSING_PARAMETERS: 'groups:3'\n}\n\n/**\n * Error codes for the Message plugin.\n * @name messagingCodes\n */\nexport const messagingCodes = {\n  CREATE_GROUP_FAIL: 'messaging:1',\n  MARK_READ_FAIL: 'messaging:2',\n  REMOVE_MEMBERS_FAIL: 'messaging:3',\n  ADD_MEMBERS_FAIL: 'messaging:4',\n  SEND_MESSAGE_FAIL: 'messaging:5',\n  FETCH_MESSAGES_FAIL: 'messaging:6',\n  FILE_UPLOAD_FAIL: 'messaging:7',\n  FETCH_CONVERSATIONS_FAIL: 'messaging:8',\n  INVALID_DESTINATION: 'messaging:9',\n  INVALID_FILE_PARTS: 'messaging:10',\n  SET_IS_TYPING_FAIL: 'messaging:11'\n}\n\n/**\n * Error codes for the Message Waiting Indicator plugin.\n * @name mwiCodes\n */\nexport const mwiCodes = {\n  FETCH_MWI_FAIL: 'mwi:1'\n}\n\n/**\n * Error codes from the Sip Events plugin.\n * @name sipEventCodes\n */\nexport const sipEventCodes = {\n  UNKNOWN_ERROR: 'sipEvents:1',\n  // The user did not subscribe/connect for the specified sip event service.\n  NOT_PROVISIONED: 'sipEvents:2',\n  // The user is not subscribed for the specified sip event.\n  NOT_SUBSCRIBED: 'sipEvents:3'\n}\n\n/**\n * Error codes for the audio bridge portion of the call plugin.\n * @name bridgeCodes\n */\nexport const bridgeCodes = {\n  UNKNOWN_ERROR: 'audioBridge:1',\n  // TODO: Make \"invalid input\" (and others) a generic code.\n  INVALID_INPUT: 'audioBridge:2',\n  ALREADY_EXISTS: 'audioBridge:3',\n  NOT_FOUND: 'audioBridge:4',\n  NOT_SUPPORTED: 'audioBridge:5',\n  MEDIA_NOT_FOUND: 'audioBridge:6',\n  INVALID_STATE: 'audioBridge:7'\n}\n\n/**\n * Error codes for the subscription plugin.\n * @name subscriptionCodes\n */\nexport const subscriptionCodes = {\n  WS_CONNECTION_ERROR: 'subscription:1',\n  CPAAS_WSREQUEST_FAIL: 'subscription:2',\n  CPAAS_WSREVOKE_FAIL: 'subscription:3',\n  CPAAS_WSREFRESH_FAIL: 'subscription:4',\n  CPAAS_SERVICE_SUB_FAIL: 'subscription:5',\n  CPAAS_SERVICE_UNSUB_FAIL: 'subscription:6',\n  CPAAS_UNSUBSCRIBE_FAIL: 'subscription:7'\n}\n/**\n * Error codes for the Presence plugin.\n * @name presenceCodes\n */\nexport const presenceCodes = {\n  INVALID_STATUS: 'presence:1',\n  INVALID_ACTIVITY: 'presence:2'\n}\n\n/**\n * Error codes for the Users plugin\n * @name usersCodes\n */\nexport const usersCodes = {\n  UNKNOWN: 'users:1',\n  REFRESH_CONTACTS_FAIL: 'users:2',\n  DIRECTORY_REQUEST_FAIL: 'users:3',\n  INVALID_PARAM: 'users:4'\n}\n","/**\n * The Basic Error object. Provides information about an error that occurred in the SDK.\n * @public\n * @static\n * @module BasicError\n * @typedef {Object} BasicError\n * @memberof api\n * @property {string} code The code of the error. If no code is known, this will be 'NO_CODE'.\n * @property {string} message A human-readable message to describe the error. If no message is known, this will be 'An error occured'.\n */\n\nexport {\n  authCodes,\n  callCodes,\n  callHistoryCodes,\n  groupsCodes,\n  messagingCodes,\n  mwiCodes,\n  sipEventCodes,\n  clickToCallCodes,\n  bridgeCodes,\n  subscriptionCodes,\n  presenceCodes,\n  usersCodes\n} from './codes'\n\nexport default class BasicError {\n  constructor ({ message, code }) {\n    this.name = 'BasicError'\n    this.code = code || 'NO_CODE'\n    this.message = message ? `${message}` : 'An error occurred.'\n  }\n}\n","/*\n * Event emitter module. Can be used as a standalone factory or as a mixin.\n *\n * @private\n * @class emitter\n * @example\n * ``` javascript\n * var eventEmitter = emitter(); // Create a new emitter.\n * emitter(myEmittingObject.prototype); // Mixin to an existing object.\n * ```\n */\nexport default function eventEmitter (prototype = {}) {\n  var eventMap = []\n  var subscribeMap = []\n  var strictMode = false\n\n  /*\n   * Check if the event is a valid event type.\n   */\n  function checkEvent (type) {\n    if (strictMode && !eventMap[type]) {\n      throw new Error('Invalid event type: ' + type)\n    }\n  }\n\n  return Object.assign(prototype, {\n    /*\n     * Define an event type with the event emitter.\n     *\n     * @method define\n     * @param {String} type The name for the event type.\n     */\n    define: function (type) {\n      eventMap[type] = eventMap[type] || []\n    },\n\n    /*\n     * Define an alias for an event type.\n     *\n     * @method alias\n     * @param {String} type The event type for which to add an alias.\n     * @param {String} alias The alias name for the event type.\n     * @throws {Error} Invalid event type\n     */\n    alias: function (type, alias) {\n      checkEvent(type)\n\n      eventMap[alias] = eventMap[type] = eventMap[type] || []\n    },\n\n    /*\n     * Add an event listener for the specified event type.\n     *\n     * @method on\n     * @param {String} type The event type for which to add the listener.\n     * @param {Function} listener The listener for the event type. The parameters\n     *                            of the listener depend on the event type.\n     * @throws {Error} Invalid event type\n     */\n    on: function (type, listener) {\n      checkEvent(type)\n      ;(eventMap[type] = eventMap[type] || []).push(listener)\n    },\n\n    /*\n     * Removes an event listener for the specified event type.\n     *\n     * @method off\n     * @param {String} type The event type for which to remote the listener.\n     * @param {Function} listener The listener to remove.\n     * @throws {Error} Invalid event type\n     */\n    off: function (type, listener) {\n      checkEvent(type)\n\n      var list = eventMap[type] || []\n      var i = list.length\n      while (i--) {\n        if (listener === list[i]) {\n          list.splice(i, 1)\n        }\n      }\n    },\n\n    /*\n     * Emits an event of the specified type.\n     *\n     * @method emit\n     * @param {String} type The event type to emit.\n     * @param {any} [...args] The arguments to pass to the listeners of the event.\n     * @throws {Error} Invalid event type\n     */\n    emit: function (type) {\n      checkEvent(type)\n\n      var args = Array.prototype.slice.call(arguments, 1)\n      var list = eventMap[type] || []\n      var i = 0\n\n      for (; i < list.length; i++) {\n        list[i].apply(undefined, args)\n      }\n      for (var j = 0; j < subscribeMap.length; j++) {\n        subscribeMap[j].call(undefined, type, args)\n      }\n    },\n\n    /*\n     * Add a subscription for all event types.\n     *\n     * @method subscribe\n     * @param {Function} listener The listener for all event types.\n     * @throws {Error} Listener not a function\n     */\n    subscribe: function (listener) {\n      if (typeof listener === 'function') {\n        subscribeMap.push(listener)\n      } else {\n        throw new Error('Listener not a function')\n      }\n    },\n\n    /*\n     * Remove a subscription for all event types.\n     *\n     * @method unsubscribe\n     * @param {Function} listener The listener for all event types.\n     * @throws {Error} Listener not a function\n     */\n    unsubscribe: function (listener) {\n      if (typeof listener === 'function') {\n        var i = subscribeMap.length\n        while (i--) {\n          if (listener === subscribeMap[i]) {\n            subscribeMap.splice(i, 1)\n          }\n        }\n      } else {\n        throw new Error('Listener not a function')\n      }\n    },\n\n    /*\n     * Sets the emitter in strict mode where it only allows events that have been defined or aliases.\n     *\n     * @method setStrictMode\n     * @param {Boolean} strict Whether to set strict mode for the emitter.\n     */\n    setStrictMode: function (strict) {\n      strictMode = strict\n    }\n  })\n}\n","// Events plugin.\nimport pluginInterface from './interface'\nimport { emitEvent } from './interface/actions'\nimport * as actionTypes from './interface/actionTypes'\n\nimport eventEmitter from './eventEmitter'\n\n/**\n * Event Emitter Implementation.\n * Factory function to create the Event Emitter Implementation.\n * Defines the functionality exposed by an Event Emitter Interface.\n */\nexport default function eventsImplementation () {\n  return {\n    name: pluginInterface.name,\n    middleware: middleware,\n    api: pluginInterface.api,\n    reducer: pluginInterface.reducer\n  }\n}\n\n/**\n * Implementation of Event Emitter Interface.\n * @return {Middleware} middleware Middleware to be applied to the redux store.\n */\nfunction middleware (context) {\n  var emitter = eventEmitter()\n  var eventMap = {}\n\n  /**\n   * Middleware to handle Event Emitter Interface actions.\n   * Redirects Interface actions to the Plugin functionality, and dispatches\n   *      actions to update the store if needed.\n   * @type {Function}\n   */\n  return next => action => {\n    switch (action.type) {\n      case actionTypes.EVENTS_ON:\n        emitter.on(action.payload.eventType, action.payload.listener)\n        break\n      case actionTypes.EVENTS_OFF:\n        emitter.off(action.payload.eventType, action.payload.listener)\n        break\n      case actionTypes.EVENTS_SUBSCRIBE:\n        emitter.subscribe(action.payload)\n        break\n      case actionTypes.EVENTS_UNSUBSCRIBE:\n        emitter.unsubscribe(action.payload)\n        break\n      case actionTypes.EVENTS_ALIAS:\n        emitter.alias(action.payload.eventType, action.payload.alias)\n        break\n      case actionTypes.EVENTS_EMIT:\n        emitter.emit(action.payload.eventType, ...action.payload.args)\n        break\n      case actionTypes.MAP_EVENTS:\n        for (let actionType in action.payload) {\n          if (action.payload.hasOwnProperty(actionType)) {\n            let mapper = action.payload[actionType]\n            if (eventMap.hasOwnProperty(actionType)) {\n              eventMap[actionType].push(mapper)\n            } else {\n              eventMap[actionType] = [mapper]\n            }\n          }\n        }\n        break\n      default:\n        if (eventMap.hasOwnProperty(action.type)) {\n          // Get state both before and after allowing the action to go through\n          //    the reducers. This lets events have compare state changes.\n          const prevState = context.getState()\n          let result = next(action)\n          const state = context.getState()\n\n          // make this compatible with promise middleware by ensuring we\n          // wait for the promise to resolve. It's easier to just always\n          // use a promise, as opposed to handling cases.\n          if (!result || !result.then) {\n            result = Promise.resolve(result)\n          }\n          result.then(function () {\n            for (let mapper of eventMap[action.type]) {\n              // Use the mapper(s) for this specific event to create the event object(s).\n              // Event mappings have access to the action and states pre+post reducer.\n              let events = mapper(action, { prevState, state })\n              if (!events) {\n                events = []\n              } else if (!Array.isArray(events)) {\n                events = [events]\n              }\n              for (let event of events) {\n                if (!event.args) {\n                  event.args = {}\n                }\n                context.dispatch(emitEvent(event.type, event.args))\n              }\n            }\n          })\n          return result\n        }\n        break\n    }\n\n    return next(action)\n  }\n}\n","const PREFIX = '@@KANDY/'\n\nexport const EVENTS_ON = PREFIX + 'EVENTS_ON'\nexport const EVENTS_OFF = PREFIX + 'EVENTS_OFF'\nexport const EVENTS_SUBSCRIBE = PREFIX + 'EVENTS_SUBSCRIBE'\nexport const EVENTS_UNSUBSCRIBE = PREFIX + 'EVENTS_UNSUBSCRIBE'\nexport const EVENTS_ALIAS = PREFIX + 'EVENTS_ALIAS'\nexport const EVENTS_EMIT = PREFIX + 'EVENTS_EMIT'\nexport const MAP_EVENTS = PREFIX + 'MAP_EVENTS'\n","import * as actionTypes from './actionTypes'\n\n/**\n * Add an action-to-event mapping\n * @param  {Object} mapping A mapping object\n * @return {action}          A redux action.\n */\nexport function mapEvents (mapping) {\n  return {\n    type: actionTypes.MAP_EVENTS,\n    payload: mapping\n  }\n}\n\n/* Interface actions */\n\n/**\n * Add a listener for a specified event type.\n *\n * @param {string} type The event type to add the listener on.\n * @param {Function} listener The event listener to be added.\n * @return {Action} action A redux action.\n */\nexport function on (type, listener) {\n  return {\n    type: actionTypes.EVENTS_ON,\n    payload: {\n      eventType: type,\n      listener: listener\n    }\n  }\n}\n\n/**\n * Remove a listener from a specified event type.\n *\n * @param {string} type The event type to remove the listener from.\n * @param {Function} listener The event listener to be removed.\n * @return {Action} action A redux action.\n */\nexport function off (type, listener) {\n  return {\n    type: actionTypes.EVENTS_OFF,\n    payload: {\n      eventType: type,\n      listener: listener\n    }\n  }\n}\n\n/**\n * Add a global event listener.\n *\n * @param {Function} listener The event listener to be added.\n * @return {Action} action A redux action.\n */\nexport function subscribe (listener) {\n  return {\n    type: actionTypes.EVENTS_SUBSCRIBE,\n    payload: listener\n  }\n}\n\n/**\n * Remove a global event listener.\n *\n * @param {Function} listener The event listener to be removed.\n * @return {Action} action A redux action.\n */\nexport function unsubscribe (listener) {\n  return {\n    type: actionTypes.EVENTS_UNSUBSCRIBE,\n    payload: listener\n  }\n}\n\n/* Internal actions */\n\n/*\n * Emits an event of the specified type.\n *\n * @method emitEvent\n * @param {Object} payload Information of the event to emit.\n * @throws {Error} Invalid event type\n * @return action An EVENTS_EMIT action.\n */\nexport function emitEvent (type, ...args) {\n  if (type === undefined) {\n    throw Error('Attempted to emit an event without a type.')\n  }\n\n  return {\n    type: actionTypes.EVENTS_EMIT,\n    payload: { eventType: type, args }\n  }\n}\n\n/*\n * Define an alias for an event type.\n *\n * @method alias\n * @param {String} type The event type for which to add an alias.\n * @param {String} alias The alias name for the event type.\n */\nexport function aliasEvent (type, alias) {\n  if (type === undefined || alias === undefined) {\n    throw Error('Invalid attempt to alias an event.')\n  }\n\n  return {\n    type: actionTypes.EVENTS_ALIAS,\n    payload: { eventType: type, alias }\n  }\n}\n","// Actions the interface uses.\nimport { on, off, subscribe, unsubscribe } from './actions'\n\nimport { getLogManager, API_LOG_TAG } from '../../logs'\n\nconst log = getLogManager().getLogger('EVENTS')\n\n/**\n * API for Event Emitter plugin.\n * Defines the public end-points exposed by event plugins.\n * @param  {Object} context The sdk instance context.\n * @returns {Object} api     The interface object.\n */\nexport default function api ({ dispatch }) {\n  var api = {}\n\n  /**\n   * Add an event listener for the specified event type. The event is emmited by the SDK instance.\n   *\n   * @public\n   * @memberof api\n   * @method on\n   * @param {string} type The event type for which to add the listener.\n   * @param {Function} listener The listener for the event type. The parameters of the listener depend on the event type.\n   * @throws {Error} Invalid event type\n   * @example\n   * // Listen for events of a specific type emitted by the SDK.\n   * client.on('dummy:event', function (params) {\n   *    // Handle the event.\n   * })\n   */\n  api.on = function (type, listener) {\n    log.debug(API_LOG_TAG + 'on: ', type)\n    dispatch(on(type, listener))\n  }\n\n  /**\n   * Removes an event listener for the specified event type. The event is emmited by the SDK instance.\n   *\n   * @public\n   * @memberof api\n   * @method off\n   * @param {string} type The event type for which to remote the listener.\n   * @param {Function} listener The listener to remove.\n   * @throws {Error} Invalid event type\n   */\n  api.off = function (type, listener) {\n    log.debug(API_LOG_TAG + 'off: ', type)\n    dispatch(off(type, listener))\n  }\n\n  /**\n   * Adds a global event listener to SDK instance.\n   *\n   * @public\n   * @memberof api\n   * @method subscribe\n   * @param {Function} listener The event listener to add. The parameters are (type, ...args), where args depend on the event type.\n   * @throws {Error} Listener not a function\n   */\n  api.subscribe = function (listener) {\n    log.debug(API_LOG_TAG + 'subscribe')\n    dispatch(subscribe(listener))\n  }\n\n  /**\n   * Removes a global event listener from SDK instance.\n   *\n   * @public\n   * @memberof api\n   * @method unsubscribe\n   * @param {Function} listener The event listener to remove.\n   * @throws {Error} Listener not a function\n   */\n  api.unsubscribe = function (listener) {\n    log.debug(API_LOG_TAG + 'unsubscribe')\n    dispatch(unsubscribe(listener))\n  }\n\n  return api\n}\n","// Import the components of the interface.\nimport api from './api'\nimport reducer from './reducers'\n\n/**\n * This interface is for an events plugin.\n * @type {string}\n */\nconst name = 'events'\n\nexport default {\n  name,\n  api,\n  reducer\n}\n","// Events plugin.\nimport * as actionTypes from './actionTypes'\n\n// Libraries.\nimport { update, add, concat, contains } from 'lodash/fp'\n\nfunction eventReducer (state = { aliases: [], count: 0 }, action) {\n  switch (action.type) {\n    case actionTypes.EVENTS_ON:\n      return update('count', add(1), state)\n    case actionTypes.EVENTS_OFF:\n      return update('count', add(-1), state)\n    case actionTypes.EVENTS_ALIAS:\n      return update('aliases', concat(action.payload.alias), state)\n    default:\n      return state\n  }\n}\n\n/**\n * Reducer for Event Emitter plugin.\n * Defines the events an Event plugin should dispatch to modify state.\n * @param  {Object} [state={}] The events substate.\n * @param  {Object} action     A Flux Standard action.\n * @returns {Object} state      The new event substate.\n */\nexport default function reducer (state = {}, action) {\n  // Only handle event types.\n  if (!contains(action.type, actionTypes)) {\n    return state\n  }\n\n  return {\n    ...state,\n    [action.payload.eventType]: eventReducer(state[action.payload.eventType], action)\n  }\n}\n","// Libraries.\nimport { combineReducers, createStore, applyMiddleware, compose as composeWithoutDevTools } from 'redux'\nimport { composeWithDevTools } from 'redux-devtools-extension'\nimport createSagaMiddleware from 'redux-saga'\nimport { memoize, mergeWith } from 'lodash/fp'\nimport { fork } from 'redux-saga/effects'\nimport compose from 'stampit/compose'\n\n// Helpers.\nimport { autoRestart } from './common/utils'\n\n// Plugins.\nimport { getLogManager } from './logs'\nconst log = getLogManager().getLogger('FACTORY')\n\n/**\n * Returns whether the passed in property descriptor represents a normal ES3 property defined like so:\n *\n * ```\n * var bar = {\n *    name: 'value'\n * };\n *\n * isNormalProperty(bar.getOwnPropertyDescriptor('name'));\n * // => true\n * ```\n *\n * @param {PropertyDescriptor} propertyDescriptor The property descriptor to check for normalcy.\n * @return {boolean} True if the property is a normal property, false otherwise.\n */\nfunction isNormalProperty ({ enumerable, configurable, writable, get, set }) {\n  return configurable && enumerable && writable && !get && !set\n}\n\nconst factoryDefaults = {\n  enableReduxDevTools: false,\n  allowProxy: false\n}\n\n/**\n * Creates an instance of the SDK with the specified plugins and configuration.\n *\n * @param {Plugin[]} plugins - The list of plugins to load into this instance of the SDK.\n * @param {Object} [options] - Factory options\n * @param {boolean} [options.enableReduxDevTools] - A flag to indicate whether or not to include Redux Dev Tools\n * @param {boolean} [options.allowProxy] Whether the factory should allow the Proxy Plugin to be included.\n */\nexport function factory (plugins, options = factoryDefaults) {\n  // Log the SDK's version (templated by webpack) on initialization.\n  let version = '4.9.0'\n  log.info(`SDK version: ${version}`)\n\n  var sagas = []\n  var store\n  var selectors = {}\n  var middlewares = []\n  var reducers = {}\n  var initSagas = []\n  const shared = {}\n  var context = {\n    capabilities: [],\n    api: {},\n    primitives: {},\n    getState () {\n      if (!store) {\n        throw Error('Store is not available during factory creation')\n      }\n      return store.getState()\n    },\n    dispatch (...args) {\n      if (!store) {\n        throw Error('Store is not available during factory creation')\n      }\n      return store.dispatch(...args)\n    },\n    subscribe (fn) {\n      if (!store) {\n        throw Error('Store is not available during factory creation')\n      }\n      return store.subscribe(fn)\n    }\n  }\n\n  // Special case middleware for logging.\n  var loggerMiddleware\n\n  // Run all the plugins to build the context.\n  // Set up each plugin component individually.\n  plugins.forEach(function (plugin) {\n    // Ignore the Proxy Plugin if not configured to allow it.\n    if (plugin.name === 'proxy' && !options.allowProxy) {\n      plugin = {}\n    }\n\n    if (plugin.capabilities) {\n      context.capabilities = context.capabilities.concat(plugin.capabilities)\n    }\n    if (plugin.reducer) {\n      reducers[plugin.name] = plugin.reducer\n    }\n    if (plugin.selector) {\n      selectors[plugin.name] = memoize(plugin.selector)\n    }\n    if (plugin.middleware) {\n      if (plugin.name === 'logs') {\n        loggerMiddleware = plugin.middleware\n      } else {\n        middlewares.push(() => plugin.middleware(context)) // pass context to middleware instead of store\n      }\n    }\n    if (plugin.api) {\n      // The following mergeWith uses a customizer that functions like Object.assign\n      // except it copies property descriptors so that accessor type properties\n      // are copied fully instead of just copying their current values.\n      // The first two parameters are not being used.\n      context.api = mergeWith(\n        (objValue, srcValue, property, destination, source) => {\n          const descriptor = Object.getOwnPropertyDescriptor(source, property)\n          if (descriptor && !isNormalProperty(descriptor)) {\n            Object.defineProperty(destination, property, descriptor)\n          } else {\n            if (destination === undefined) {\n              destination = {}\n            }\n            destination[property] = source[property]\n          }\n        },\n        context.api,\n        plugin.api(context)\n      )\n    }\n    if (plugin.init) {\n      initSagas.push(plugin.init)\n    }\n    if (plugin.sagas) {\n      sagas = sagas.concat(plugin.sagas)\n    }\n    // TODO: Revisit this. Looks a little extreme for a couple stamps...\n    if (plugin.mixins) {\n      // Define a base stamp that all stamps will be composed with.\n      //      This gives stamps access to the factory's context.\n      let baseStamp = {\n        propertyDescriptors: {\n          context: {\n            get () {\n              return context\n            }\n          }\n        }\n      }\n      for (let objName in plugin.mixins) {\n        if (plugin.mixins.hasOwnProperty(objName)) {\n          // Ensure that every stamp starts with the base stamp.\n          if (!context.primitives.hasOwnProperty(objName)) {\n            context.primitives[objName] = baseStamp\n          }\n          context.primitives[objName] = compose(\n            context.primitives[objName],\n            plugin.mixins[objName]\n          )\n        }\n      }\n    }\n\n    /**\n     * Plugins are allowed to share data between them by providing it to the\n     *    factory. All shared data will be collected as a single object, and\n     *    that object will be provided to plugins during their `init` saga.\n     * It is intended that a plugin can \"override\" another plugin's shared data.\n     * The order that plugins are given to the factory matters because of this.\n     * `plugin.shared` is expected to be an object.\n     */\n    if (plugin.shared) {\n      for (let key in plugin.shared) {\n        if (shared[key]) {\n          log.debug(`Replacing shared ${key} with ${key} from ${plugin.name}.`)\n          shared[key] = plugin.shared[key]\n        } else {\n          shared[key] = plugin.shared[key]\n        }\n      }\n    }\n  })\n\n  if (loggerMiddleware) {\n    // The redux logger middleware should be the last middleware.\n    middlewares.push(() => loggerMiddleware(context))\n  }\n\n  // Compose the root saga\n  function * rootSaga () {\n    // Give all plugins an opportunity to initialize themselves.\n    // Note: Sagas have not been forked yet, so init cannot use them\n    //      by dispatching actions. See PR #698.\n    // Note: If anything asynchronous is done in an init, it MUST be\n    //      non-blocking (ie. use fork, not call). See PR #699.\n    for (let init of initSagas) {\n      // Note: Yield directly to init. If redux-saga's `call()` is used, then the\n      //      factory returns before the instance is done all inits. See PR #699.\n      // Provide the factory's shared data (from plugins) to the `init` saga.\n      yield * init(shared)\n    }\n    // Run all of the sagas provided by implementation plugins.\n    for (let saga of sagas) {\n      yield fork(autoRestart(saga))\n    }\n  }\n\n  // Alias our composeMiddleware to conditionally include devTools as per the provided configuration flag\n  const composeMiddleware = options.enableReduxDevTools ? composeWithDevTools : composeWithoutDevTools\n\n  // don't include saga stuff if there are no sagas.\n  if (initSagas.length + sagas.length > 0) {\n    var sagaMiddleware = createSagaMiddleware()\n\n    // Create the store with the plugins (incl. sagas) and with the configuration as the initial state.\n    store = createStore(combineReducers(reducers), composeMiddleware(applyMiddleware(sagaMiddleware, ...middlewares)))\n\n    sagaMiddleware.run(rootSaga)\n  } else {\n    // Create the store with the plugins (excl. sagas) and with the configuration as the initial state.\n    store = createStore(combineReducers(reducers), composeMiddleware(applyMiddleware(...middlewares)))\n  }\n\n  // setup the API\n  var selectState = function (state) {\n    var exposedState = {}\n\n    // Determine what state should be exposed to an application.\n    plugins.forEach(function (plugin) {\n      let name = plugin.name\n      // If the plugin designates a selector to filter publuc state, use it.\n      if (selectors[name]) {\n        exposedState[name] = selectors[name](state[name])\n      } else if (state[name]) {\n        // Otherwise, just expose the state directly, but\n        //      only expose state if there actually is state.\n        exposedState[name] = state[name]\n      }\n    })\n    return exposedState\n  }\n  selectState = memoize(selectState)\n\n  const publicAPI = {\n    ...context.api,\n    state: {\n      get: function () {\n        return selectState(store.getState())\n      },\n      subscribe: function (...args) {\n        return store.subscribe(...args)\n      }\n    },\n    getCapabilities () {\n      return context.capabilities\n    },\n    getVersion () {\n      return version\n    }\n  }\n\n  // Return the public API.\n  return publicAPI\n}\n","// Groups plugin.\nimport { api, reducer } from '../interface'\nimport * as sagas from './sagas'\nimport events from '../interface/events'\n\n// Other plugins.\nimport { mapEvents } from '../../events/interface/actions'\n\n// Libraries.\nimport { put } from 'redux-saga/effects'\nimport { values } from 'lodash/fp'\n\nconst name = 'groups'\n\nconst capabilities = ['groups']\n\nexport default () => {\n  return {\n    name,\n    capabilities,\n    api: api,\n    reducer,\n    init: () => [put(mapEvents(events))],\n    sagas: values(sagas)\n  }\n}\n","// Helpers.\nimport request from '../../../request/effects'\nimport { handleRequestError } from '../../../common/helpers'\nimport { marshallGroup } from '../../utils'\n\n/**\n * REST request to create a new group.\n * @method create\n * @param  {Object} params\n * @param  {Array} [params.participants] List of participants to add to group when created.\n * @param  {string} params.name Name of the group chat session.\n * @param  {string} params.type Closed group indicates this is an invitation-based closed chat group. Only Closed is supported.\n * @param  {Object} requestInfo Info needed to perform the request.\n * @param  {string} [params.subject] Subject of the group chat session.\n * @param  {string} [params.image]  HTTP URL of the image that is assigned to the grpup chat session avatar\n * @return {group}\n */\nexport function * createRequest (params, requestInfo) {\n  // Add the group owner (current user) to list of group participants\n  const groupOwner = {\n    address: params.currentUser.identity,\n    'x-isAdmin': true\n  }\n  const participants = [groupOwner, ...params.participants]\n\n  const requestBody = {\n    groupChatSessionInformation: {\n      participant: participants,\n      subject: params.subject,\n      'x-image': params['image'],\n      'x-name': params['name'],\n      'x-type': params['type']\n    }\n  }\n\n  const url = `${requestInfo.baseURL}/cpaas/chat/${requestInfo.version}/${requestInfo.username}/group`\n  const requestOptions = {\n    method: 'POST',\n    url,\n    body: JSON.stringify(requestBody)\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Create group')\n    }\n  } else {\n    // re-map group objects to a more workable structure\n    const group = marshallGroup(response.payload.body.groupChatSessionInformation)\n    return group\n  }\n}\n\n/**\n * Request to delete a specified group.\n * @method deleteRequest\n * @param  {string} groupId The ID of the group to delete.\n * @param  {Object} requestInfo Info needed to perform the request.\n * @return {Object} obj\n * @return {Object} [obj.error] The error message if the group delete was unsuccessful\n */\nexport function * deleteRequest (groupId, requestInfo) {\n  const url = `${requestInfo.baseURL}/cpaas/chat/${requestInfo.version}/${requestInfo.username}/group/${groupId}`\n  const requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url\n  }\n  const response = yield request(requestOptions, requestInfo.options)\n\n  // handle errors if they occur, otherwise response will be No Content.\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Delete Group')\n    }\n  } else {\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * REST request to add a participant to a specified group.\n * @method addParticipantRequest\n * @param  {Object} payload\n * @param  {string} payload.groupId The ID of the group to remove the participant from.\n * @param  {string} payload.participant The participant address.\n * @param  {Object} requestInfo Info needed to perform the request.\n */\nexport function * addParticipantRequest ({ groupId, participant }, requestInfo) {\n  const requestBody = {\n    participantInformation: {\n      address: participant,\n      'x-isAdmin': false\n    }\n  }\n\n  const url = `${requestInfo.baseURL}/cpaas/chat/${requestInfo.version}/${\n    requestInfo.username\n  }/group/${groupId}/participants`\n  const requestOptions = {\n    method: 'POST',\n    url,\n    body: JSON.stringify(requestBody)\n  }\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Add Participant')\n    }\n  } else {\n    const { 'x-isAdmin': isAdmin, status, address } = response.payload.body.participantInformation\n\n    return { address, status, isAdmin }\n  }\n}\n\n/**\n * REST request to remove a participant from a specified group.\n * @method removeParticipantRequest\n * @param  {Object} payload\n * @param  {string} payload.groupId The ID of the group.\n * @param  {string} payload.participant The participant to remove from the group.\n * @param  {Object} requestInfo Info needed to perform the request.\n * @return {Object}\n */\nexport function * removeParticipantRequest ({ groupId, participant }, requestInfo) {\n  const url = `${requestInfo.baseURL}/cpaas/chat/${requestInfo.version}/${\n    requestInfo.username\n  }/group/${groupId}/participants/${participant}`\n  const requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url\n  }\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Remove participant')\n    }\n  } else {\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * REST request to leave a specified group.\n * @method leaveGroupRequest\n * @param  {string} groupId The ID of the group to leave.\n * @param  {Object} requestInfo Info needed to perform the request.\n * @param  {Object} userInfo Info needed about the current user.\n * @return {Object}\n */\nexport function * leaveGroupRequest (groupId, requestInfo, userInfo) {\n  const url =\n    `${requestInfo.baseURL}/cpaas/chat/${requestInfo.version}` +\n    `/${requestInfo.username}/group/${groupId}/participants/${userInfo.identity}`\n\n  const requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url\n  }\n  const response = yield request(requestOptions, requestInfo.options)\n\n  // handle errors if they occur, otherwise response will be No Content.\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Leave group')\n    }\n  } else {\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * REST request to fetch groups from server.\n * @method fetchRequest\n * @param  {Object} requestInfo Info needed to perform the request.\n * @return {Array} An array of Groups.\n */\nexport function * fetchRequest (requestInfo) {\n  const url = `${requestInfo.baseURL}/cpaas/chat/${requestInfo.version}/${requestInfo.username}/group`\n  const requestOptions = {\n    method: 'GET',\n    url\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Fetch groups')\n    }\n  } else {\n    const groupSessions = response.payload.body.groupChatSessionInformationList.groupChatSessionInformation\n\n    // re-map group objects to a more workable structure\n    const groups = groupSessions.map(group => marshallGroup(group))\n    return groups\n  }\n}\n\n/**\n * REST request to fetch a group with a specific groupId from server.\n * @method fetchRequestByGroupId\n * @param  {string} groupId The ID of the group to fetch.\n * @param  {Object} requestInfo Info needed to perform the request.\n * @return {Object}\n */\nexport function * fetchRequestByGroupId (groupId, requestInfo) {\n  const url = `${requestInfo.baseURL}/cpaas/chat/${requestInfo.version}/${requestInfo.username}/group/${groupId}`\n  const requestOptions = {\n    method: 'GET',\n    url\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Fetch group by groupId')\n    }\n  } else {\n    // re-map group objects to a more workable structure\n    const group = marshallGroup(response.payload.body.groupChatSessionInformation)\n    return group\n  }\n}\n\n/**\n * Request to accept an invitation to a specified group.\n * @method acceptInvitationRequest\n * @param  {string} groupId The ID of the group to accept invitation to.\n * @param  {Object} requestInfo Info needed to perform the request.\n * @param  {Object} userInfo Info needed about the current user.\n * @return {Object}\n */\nexport function * acceptInvitationRequest (groupId, requestInfo, userInfo) {\n  const requestBody = {\n    participantSessionStatus: {\n      status: 'Connected'\n    }\n  }\n  const url =\n    `${requestInfo.baseURL}/cpaas/chat/${requestInfo.version}/` +\n    `${requestInfo.username}/group/${groupId}/participants/${userInfo.identity}/status`\n  const requestOptions = {\n    method: 'PUT',\n    url,\n    body: JSON.stringify(requestBody)\n  }\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Accept Invitation')\n    }\n  } else {\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * Request to reject an invitation to a specified group.\n * @method rejectInvitationRequest\n * @param  {string} groupId The ID of the group to reject invitation to.\n * @param  {Object} requestInfo Info needed to perform the request.\n * @param  {Object} userInfo Info needed about the current user.\n * @return {Object}\n */\nexport function * rejectInvitationRequest (groupId, requestInfo, userInfo) {\n  const url =\n    `${requestInfo.baseURL}/cpaas/chat/${requestInfo.version}/` +\n    `${requestInfo.username}/group/${groupId}/participants/${userInfo.identity}`\n  const requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url\n  }\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Reject Invitation')\n    }\n  } else {\n    return {\n      error: false\n    }\n  }\n}\n","// groups plugin.\nimport {\n  createRequest,\n  deleteRequest,\n  fetchRequest,\n  addParticipantRequest,\n  removeParticipantRequest,\n  acceptInvitationRequest,\n  rejectInvitationRequest,\n  leaveGroupRequest,\n  fetchRequestByGroupId\n} from '../requests/groups'\nimport * as actions from '../../interface/actions'\n\n// Other plugins.\nimport { getRequestInfo, getUserInfo } from '../../../auth/interface/selectors'\nimport BasicError, { groupsCodes } from '../../../errors'\n\n// Helpers.\nimport { getLogManager } from '../../../logs'\n\n// Constants\nimport { platforms } from '../../../constants'\n\n// Libraries.\nimport { call, put, select } from 'redux-saga/effects'\nimport { remapParticipants } from '../../utils'\n\nconst log = getLogManager().getLogger('GROUPS')\n\n/**\n * Create a group.\n * @method create\n * @param  {Object} action An action of type `CREATE`.\n */\nexport function * createGroup ({ payload }) {\n  const { params } = payload\n  log.info(`Creating group ${params.name}.`)\n\n  // Verify that name has been supplied\n  if (!params['name']) {\n    log.info('name value is mandatory.')\n    yield put(\n      actions.createFinish(\n        {},\n        new BasicError({\n          code: groupsCodes.MISSING_PARAMETERS,\n          message: 'Failed to create group. No name value was provided.'\n        })\n      )\n    )\n    return\n  }\n\n  // add the provided participants to the createListFinish\n  let participantInvites = []\n  if (params.participants) {\n    participantInvites = params.participants.map(participant => {\n      // TODO: Why is participant an object and not a string? The docs say it\n      //    should be a string.\n      return { address: participant.address, 'x-isAdmin': false }\n    })\n  }\n  const currentUser = yield select(getUserInfo)\n  const requestParams = { ...params, participants: participantInvites, currentUser }\n\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const newGroup = yield call(createRequest, requestParams, requestInfo)\n  log.debug('Received response from create group request:', newGroup)\n\n  if (!newGroup.error) {\n    yield put(actions.createFinish(newGroup))\n  } else {\n    yield put(actions.createFinish({}, newGroup.error))\n  }\n}\n\n/**\n * Delete a group.\n * @method deleteGroup\n * @param  {Object} payload Information about the group to be deleted.\n * @return {Object}\n */\nexport function * deleteGroup ({ payload }) {\n  const { groupId } = payload\n  log.info(`Deleting group ${groupId}.`)\n\n  // verify that a groupId was supplied\n  if (!groupId) {\n    log.info('groupId parameter is required for delete group operation.')\n    yield put(\n      actions.deleteGroupFinish({\n        error: new BasicError({\n          code: groupsCodes.MISSING_PARAMETERS,\n          message: 'Failed to delete group. groupId parameter is required.'\n        })\n      })\n    )\n    return\n  }\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const deletedGroup = yield call(deleteRequest, groupId, requestInfo)\n  log.debug('Received response from deleteGroup request:', deletedGroup)\n\n  if (!deletedGroup.error) {\n    yield put(actions.deleteGroupFinish({ groupId }))\n  } else {\n    yield put(actions.deleteGroupFinish({ error: deletedGroup.error }))\n  }\n}\n\n/**\n * Add a participant to a specified group.\n * @method addParticipant\n * @param  {Object} payload Information about the group and participant.\n * @return {Object}\n */\nexport function * addParticipant ({ payload }) {\n  const { groupId, participant } = payload\n  log.info(`Adding participant ${participant} to group ${groupId}.`)\n\n  // verify that a groupId was supplied\n  if (!groupId) {\n    log.info('groupId parameter is required for add participant operation.')\n    yield put(\n      actions.addParticipantFinish({\n        error: new BasicError({\n          code: groupsCodes.MISSING_PARAMETERS,\n          message: 'Failed to add participant. groupId parameter is required.'\n        })\n      })\n    )\n    return\n  }\n\n  // verify that a participant was supplied\n  if (!participant) {\n    log.info('participant parameter is required for add participant operation.')\n    yield put(\n      actions.addParticipantFinish({\n        error: new BasicError({\n          code: groupsCodes.MISSING_PARAMETERS,\n          message: 'Failed to add participant. Participant parameter is required.'\n        })\n      })\n    )\n    return\n  }\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const newParticipant = yield call(addParticipantRequest, payload, requestInfo)\n  log.debug('Received response from addParticipant request:', newParticipant)\n\n  if (!newParticipant.error) {\n    yield put(\n      actions.addParticipantFinish({\n        groupId,\n        participant: newParticipant\n      })\n    )\n  } else {\n    yield put(actions.addParticipantFinish({ error: newParticipant.error }))\n  }\n}\n\n/**\n * Remove a participant to a group.\n * @method removeParticipant\n * @param  {Object} payload Information about the group modified.\n * @return {Object}\n */\nexport function * removeParticipant ({ payload }) {\n  const { groupId, participant } = payload\n  log.info(`Removing participant ${participant} from group ${groupId}.`)\n  // verify that a groupId was supplied\n  if (!groupId) {\n    log.info('groupId parameter is required for remove participant operation.')\n    yield put(\n      actions.removeParticipantFinish({\n        error: new BasicError({\n          code: groupsCodes.MISSING_PARAMETERS,\n          message: 'Failed to remove participant. groupId parameter is required.'\n        })\n      })\n    )\n    return\n  }\n  // verify that a participant was supplied\n  if (!participant) {\n    log.info('participant parameter is required for remove participant operation.')\n    yield put(\n      actions.removeParticipantFinish({\n        error: new BasicError({\n          code: groupsCodes.MISSING_PARAMETERS,\n          message: 'Failed to remove participant. Participant parameter is required.'\n        })\n      })\n    )\n    return\n  }\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const response = yield call(removeParticipantRequest, payload, requestInfo)\n  log.debug('Received response from removeParticipant request:', response)\n\n  if (!response.error) {\n    yield put(\n      actions.removeParticipantFinish({\n        groupId,\n        participant\n      })\n    )\n  } else {\n    yield put(actions.removeParticipantFinish({ error: response.error }))\n  }\n}\n\n/**\n * Leave a specified group.\n * @method leaveGroup\n * @param  {Object} payload Information about the group modified.\n * @return {Object}\n */\nexport function * leaveGroup ({ payload }) {\n  const { groupId } = payload\n  log.info('leaveGroup saga called: ', groupId)\n\n  // verify that a groupId was supplied\n  if (!groupId) {\n    log.info('groupId parameter is required for leave group operation.')\n    yield put(\n      actions.leaveGroupFinish({\n        error: new BasicError({\n          code: groupsCodes.MISSING_PARAMETERS,\n          message: 'Failed to leave group. groupId parameter is required.'\n        })\n      })\n    )\n    return\n  }\n\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const userInfo = yield select(getUserInfo, platforms.CPAAS)\n  const response = yield call(leaveGroupRequest, groupId, requestInfo, userInfo)\n  log.debug('Received response from leave group request:', response)\n\n  if (!response.error) {\n    yield put(actions.leaveGroupFinish({ groupId, participant: userInfo.identity }))\n  } else {\n    yield put(actions.leaveGroupFinish({ error: response.error }))\n  }\n}\n\n/**\n * Fetches all existing groups from the server.\n * @method fetch\n */\nexport function * fetch () {\n  log.info(`Fetching groups.`)\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const groups = yield call(fetchRequest, requestInfo)\n\n  if (!groups.error) {\n    yield put(actions.fetchGroupsFinish({ groups }))\n  } else {\n    yield put(actions.fetchGroupsFinish({ error: groups.error }))\n  }\n\n  log.debug('Received response from fetch request:', groups)\n}\n\n/**\n * Accept invitation to a group.\n * @method acceptInvitation\n * @param  {Object} payload Information about the group to accept an invitation to.\n * @return {Object}\n */\nexport function * acceptInvitation ({ payload }) {\n  log.info('accept invitation saga called: ', payload)\n  const { groupId } = payload\n\n  // verify that a groupId was supplied\n  if (!groupId) {\n    log.info('groupId parameter is required for accepting invitation operation.')\n    yield put(\n      actions.acceptInvitationFinish({\n        error: new BasicError({\n          code: groupsCodes.MISSING_PARAMETERS,\n          message: 'Failed to accept invitation. groupId parameter is required.'\n        })\n      })\n    )\n    return\n  }\n\n  // Need to accept the invitation before you can fetch the group. Otherewise, The\n  // request will fail with a 404 because you are not actually in the chat group yet.\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const userInfo = yield select(getUserInfo, platforms.CPAAS)\n  const response = yield call(acceptInvitationRequest, groupId, requestInfo, userInfo)\n\n  if (response.error) {\n    yield put(actions.acceptInvitationFinish({ error: response.error }))\n    return\n  }\n\n  // Before accepting an invitation, we need to have the current state of\n  // the group in state.\n  const group = yield call(fetchRequestByGroupId, groupId, requestInfo)\n\n  if (group.error) {\n    yield put(actions.acceptInvitationFinish({ error: group.error }))\n    return\n  }\n\n  if (!response.error && !group.error) {\n    yield put(actions.acceptInvitationFinish({ groupId, group }))\n  }\n}\n\n/**\n * Reject invitation to a group.\n * @method rejectInvitation\n * @param  {Object} payload Information about the group to reject an invitation to.\n * @param  {Object} payload.groupId the Group ID for referencing this group\n * @return {Object}\n */\nexport function * rejectInvitation ({ payload }) {\n  log.info('reject invitation saga called: ', payload)\n  const { groupId } = payload\n\n  // verify that a groupId was supplied\n  if (!groupId) {\n    log.info('groupId parameter is required for rejecting invitation operation.')\n    yield put(\n      actions.rejectInvitationFinish({\n        error: new BasicError({\n          code: groupsCodes.MISSING_PARAMETERS,\n          message: 'Failed to reject invitation. groupId parameter is required.'\n        })\n      })\n    )\n    return\n  }\n\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const userInfo = yield select(getUserInfo, platforms.CPAAS)\n  const response = yield call(rejectInvitationRequest, groupId, requestInfo, userInfo)\n  if (!response.error) {\n    yield put(actions.rejectInvitationFinish({ groupId }))\n  } else {\n    yield put(actions.rejectInvitationFinish({ error: response.error }))\n  }\n}\n\n/**\n * Handle incoming 'groupChatSessionInvitationNotification' websocket messages.\n * @method handleInvitationNotification\n * @param {Object} wsAction An Object received on the websocket\n */\nexport function * handleInvitationNotification (wsAction) {\n  const { 'x-name': name, link, participant } = wsAction.payload.groupChatSessionInvitationNotification\n\n  // parse the href to get the groupId and add to invitation\n  const linkInfo = link.find(link => link.rel === 'groupChatSessionInformation')\n  const groupId = linkInfo.href.substring(linkInfo.href.lastIndexOf('/') + 1)\n\n  // map out resourceURL and rename x-isAdmin\n  const participants = remapParticipants(participant)\n\n  const invitation = {\n    groupId,\n    participants,\n    name\n  }\n  yield put(actions.invitationReceived({ invitation }))\n}\n\n/**\n * Handle incoming 'chatParticipantStatusNotification' websocket messages.\n * @method handleParticipantStatusNotification\n * @param {Object} wsAction An Object received on the websocket\n * @param {Array}  wsAction.link A list of session information objects\n * @param {Array}  wsAction.participant a list of participants for the group\n * @param {number} wsAction.dateTime the time the notification was sent\n * @param {string} wsAction.id an ID (NOT the same as groupId) for the group\n * @param {string} wsAction['x-name'] the name of the group\n */\nexport function * handleParticipantStatusNotification (wsAction) {\n  const notification = wsAction.payload.chatParticipantStatusNotification\n  const link = notification.link.find(link => link.rel === 'groupChatSessionInformation')\n  const groupId = link.href.substring(link.href.lastIndexOf('/') + 1)\n\n  // map out resourceURL and rename x-isAdmin\n  notification.participants = remapParticipants(notification.participant)\n  delete notification.participant\n\n  yield put(actions.statusNotificationReceived({ groupId, notification }))\n}\n\n/**\n * Handle incoming 'chatEventNotification' websocket messages.\n * @method handleEventNotification\n * @param {Object} wsAction An Object received on the websocket\n * @param {Array}  wsAction.link A list of session information objects\n * @param {number} wsAction.dateTime the time the notification was sent\n * @param {string} wsAction.id an ID (NOT the same as groupId) for the group\n * @param {string} wsAction['x-name'] the name of the group\n */\nexport function * handleEventNotification (wsAction) {\n  const notification = wsAction.payload.chatEventNotification\n  const link = notification.link.find(link => link.rel === 'groupChatSessionInformation')\n  const groupId = link.href.substring(link.href.lastIndexOf('/') + 1)\n\n  yield put(actions.eventNotificationReceived({ groupId, notification }))\n}\n","/**\n * Groups saga index.\n * Defines which actions trigger which sagas.\n */\n\n// groups plugin.\nimport * as groupSagas from './groups'\nimport * as actionTypes from '../../interface/actionTypes'\n\n// Libraries.\nimport { takeEvery } from 'redux-saga/effects'\n\n// Other plugins.\nimport { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\n\n/**\n * Create group.\n * @method processCreateGroup\n */\nexport function * processCreateGroup () {\n  yield takeEvery(actionTypes.CREATE_GROUP, groupSagas.createGroup)\n}\n\n/**\n * Delete group.\n * @method processDeleteGroup\n */\nexport function * processDeleteGroup () {\n  yield takeEvery(actionTypes.DELETE_GROUP, groupSagas.deleteGroup)\n}\n\n/**\n * Add a participant to a group.\n * @method processAddParticipant\n */\nexport function * processAddParticipant () {\n  yield takeEvery(actionTypes.ADD_PARTICIPANT, groupSagas.addParticipant)\n}\n\n/**\n * Remove a participant from a group.\n * @method processRemoveParticipant\n */\nexport function * processRemoveParticipant () {\n  yield takeEvery(actionTypes.REMOVE_PARTICIPANT, groupSagas.removeParticipant)\n}\n\n/**\n * Leave group.\n * @method leaveGroup\n */\nexport function * leaveGroup () {\n  yield takeEvery(actionTypes.LEAVE_GROUP, groupSagas.leaveGroup)\n}\n\n/**\n * Fetch groups.\n * @method fetch\n */\nexport function * fetch () {\n  yield takeEvery(actionTypes.FETCH_GROUPS, groupSagas.fetch)\n}\n\n/**\n * Accept invitation.\n * @method acceptInvitation\n */\nexport function * acceptInvitation () {\n  yield takeEvery(actionTypes.ACCEPT_INVITATION, groupSagas.acceptInvitation)\n}\n\n/**\n * Reject invitation.\n * @method rejectInvitation\n */\nexport function * rejectInvitation () {\n  yield takeEvery(actionTypes.REJECT_INVITATION, groupSagas.rejectInvitation)\n}\n\n/**\n * Receive invitation. (groupChatSessionInvitationNotification)\n * @method receiveInvitationNotification\n */\nexport function * receiveInvitationNotification () {\n  yield takeEvery(\n    action => action.type === NOTIFICATION_RECEIVED && action.payload.groupChatSessionInvitationNotification,\n    groupSagas.handleInvitationNotification\n  )\n}\n\n/**\n * Receive participant status. (chatParticipantStatusNotification)\n * @method receiveParticipantStatusNotification\n */\nexport function * receiveParticipantStatusNotification () {\n  yield takeEvery(\n    action => action.type === NOTIFICATION_RECEIVED && action.payload.chatParticipantStatusNotification,\n    groupSagas.handleParticipantStatusNotification\n  )\n}\n\n/**\n * Receive chat event notification. (chatEventNotification)\n * @method receiveEventNotification\n */\nexport function * receiveEventNotification () {\n  yield takeEvery(\n    action => action.type === NOTIFICATION_RECEIVED && action.payload.chatEventNotification,\n    groupSagas.handleEventNotification\n  )\n}\n","const prefix = '@@KANDY/GROUPS/'\n\n// Admin actions\nexport const ADD_PARTICIPANT = prefix + 'ADD_PARTICIPANT'\nexport const ADD_PARTICIPANT_FINISH = prefix + 'ADD_PARTICIPANT_FINISH'\nexport const REMOVE_PARTICIPANT = prefix + 'REMOVE_PARTICIPANT'\nexport const REMOVE_PARTICIPANT_FINISH = prefix + 'REMOVE_PARTICIPANT_FINISH'\nexport const DELETE_GROUP = prefix + 'DELETE_GROUP'\nexport const DELETE_GROUP_FINISH = prefix + 'DELETE_GROUP_FINISH'\n\n// User actions\nexport const FETCH_GROUPS = prefix + 'FETCH_GROUPS'\nexport const FETCH_GROUPS_FINISH = prefix + 'FETCH_GROUPS_FINISH'\nexport const CREATE_GROUP = prefix + 'CREATE_GROUP'\nexport const CREATE_GROUP_FINISH = prefix + 'CREATE_GROUP_FINISH'\nexport const LEAVE_GROUP = prefix + 'LEAVE_GROUP'\nexport const LEAVE_GROUP_FINISH = prefix + 'LEAVE_GROUP_FINISH'\n\n// Invitations\nexport const ACCEPT_INVITATION = prefix + 'ACCEPT_INVITATION'\nexport const ACCEPT_INVITATION_FINISH = prefix + 'ACCEPT_INVITATION_FINISH'\nexport const REJECT_INVITATION = prefix + 'REJECT_INVITATION'\nexport const REJECT_INVITATION_FINISH = prefix + 'REJECT_INVITATION_FINISH'\n\n// event notification actions\nexport const INVITATION_RECEIVED = prefix + 'INVITATION_RECEIVED'\nexport const STATUS_NOTIFICATION_RECEIVED = prefix + 'STATUS_NOTIFICATION_RECEIVED'\nexport const EVENT_NOTIFICATION_RECEIVED = prefix + 'EVENT_NOTIFICATION_RECEIVED'\n","// Groups plugin.\nimport * as actionTypes from './actionTypes'\n\n/**\n * Helper function for formatting actions.\n * Ensures that actions follow an expectable format.\n * @method actionFormatter\n * @param  {string}  actionType  The type of action\n * @param  {Object} [payload={}] The action payload.\n * @param  {BasicError} [payload.error] For an error action, the error should be provided.\n * @param  {Object} [meta={}] The action meta data.\n * @return {Object}\n */\nfunction actionFormatter (actionType, payload = {}, meta = {}) {\n  return {\n    type: actionType,\n    payload: {\n      ...payload\n    },\n    error: !!payload.error,\n    meta: {\n      ...meta\n    }\n  }\n}\n\n/**\n * Fetches existing groups from the server\n * @method fetchGroups\n * @return {Object} A Flux Standard Action.\n */\nexport function fetchGroups () {\n  return {\n    type: actionTypes.FETCH_GROUPS\n  }\n}\n\n/**\n * A notice that fetchGroups has finished.\n * @method fetchGroupsFinish\n * @param {Object} params\n * @param {[Object]} params.groups Array of groups.\n * @param {Object} [params.error] An error object.\n * @return {Object} A flux standard action.\n */\nexport function fetchGroupsFinish ({ groups, error }) {\n  return actionFormatter(actionTypes.FETCH_GROUPS_FINISH, { groups, error })\n}\n\n/**\n * Create a new group\n * @method create\n * @param {Object} params\n * @param {string} params.userId The Id of the current user.\n * @param {string[]} params.users Array of users to add to group upon creation.\n * @param {string} params.image The image for the group.\n * @param {string} params.type Type of group: ie 'Open', 'Closed'. //ToDo Verify this\n * @return {Object} A Flux Standard Action.\n */\nexport function create (params = {}) {\n  return actionFormatter(actionTypes.CREATE_GROUP, { params })\n}\n\n/**\n * @method createFinish\n * @param {Object} group The group that was created.\n * @param {Object} [error] An error object.\n * @return {Object} A flux standard action.\n */\nexport function createFinish (group, error) {\n  return actionFormatter(actionTypes.CREATE_GROUP_FINISH, { group, error })\n}\n\n/**\n * Leave a group\n * @method leave\n * @param {string} groupId The ID of the group to leave.\n * @return {Object} A Flux Standard Action.\n */\nexport function leave (groupId) {\n  return actionFormatter(actionTypes.LEAVE_GROUP, { groupId })\n}\n\n/**\n * Leave a specified group\n /**\n * @param {Object} params\n * @param {string} params.groupId The ID of the group that id being left.\n * @param {string} params.participant The participant that is leaving.\n * @param {Object} [params.error] An error object.\n * @return {Object} A Flux Standard Action.\n */\nexport function leaveGroupFinish ({ groupId, participant, error }) {\n  return actionFormatter(actionTypes.LEAVE_GROUP_FINISH, { groupId, participant, error })\n}\n\n/**\n * Accept a group invitation\n * @method acceptInvitation\n * @param {string} groupId The ID of the group to retrieve.\n * @return {Object} A Flux Standard Action.\n */\nexport function acceptInvitation (groupId) {\n  return actionFormatter(actionTypes.ACCEPT_INVITATION, { groupId })\n}\n\n/**\n * Accept a group invitation\n * @param {Object} params\n * @param {Object} params.group Information about the group.\n * @param {string} params.status status of the invitation\n * @param {string} [params.error] An error object.\n * @return {Object} A Flux Standard Action\n */\nexport function acceptInvitationFinish ({ groupId, group, status, error }) {\n  return actionFormatter(actionTypes.ACCEPT_INVITATION_FINISH, { groupId, group, status, error })\n}\n\n/**\n * Reject a group invitation\n * @method rejectInvitation\n * @param {string} groupId The ID of the group to reject.\n * @return {Object} A Flux Standard Action.\n */\nexport function rejectInvitation (groupId) {\n  return actionFormatter(actionTypes.REJECT_INVITATION, { groupId })\n}\n\n/**\n * Reject a group invitation\n * @param {Object} params\n * @param {string} params.groupId GroupId to reject invitation from.\n * @param {Object} params.status status of the invitation\n * @param {string} [params.error] An error object.\n * @return {Object} A Flux Standard Action\n */\nexport function rejectInvitationFinish ({ groupId, status, error }) {\n  return actionFormatter(actionTypes.REJECT_INVITATION_FINISH, { groupId, status, error })\n}\n\n/**\n * Add a participant to a group\n * @method addParticipant\n * @param {string} groupId The ID of the group to add a participant to.\n * @param {string} participant Participant to add to the group.\n * @return {Object} A Flux Standard Action.\n */\nexport function addParticipant (groupId, participant) {\n  return actionFormatter(actionTypes.ADD_PARTICIPANT, { groupId, participant })\n}\n\n/**\n * A notice that addParticipant has finished.\n * @method addParticipantFinish\n * @param {Object} params\n * @param  {string} params.groupId The ID of the group to be modified.\n * @param  {Object} params.participant Participant to add to the group.\n * @param  {Object} [params.error] An error object.\n * @return {Object} A flux standard action.\n */\nexport function addParticipantFinish ({ groupId, participant, error }) {\n  return actionFormatter(actionTypes.ADD_PARTICIPANT_FINISH, { groupId, participant, error })\n}\n\n/**\n * Remove a participant from a group\n * @method removeParticipant\n * @param {string} groupId The ID of the group to remove a participant from.\n * @param {Object} participant Participant to remove from the group.\n * @return {Object} A Flux Standard Action.\n */\nexport function removeParticipant (groupId, participant) {\n  return actionFormatter(actionTypes.REMOVE_PARTICIPANT, { groupId, participant })\n}\n\n/**\n * A notice that removeParticipant has finished.\n * @method removeParticipantFinish\n * @param {Object} params\n * @param  {string} params.groupId The ID of the group to be modified.\n * @param  {Object} params.participant Participant to remove from the group.\n * @param  {Object} [params.error] An error object.\n * @return {Object} A flux standard action.\n */\nexport function removeParticipantFinish ({ groupId, participant, error }) {\n  return actionFormatter(actionTypes.REMOVE_PARTICIPANT_FINISH, { groupId, participant, error })\n}\n\n/**\n * A request to delete a group.\n * @method deleteGroup\n * @param {string} groupId The ID of the the group to delete.\n * @return {Object} A Flux Standard Action.\n */\nexport function deleteGroup (groupId) {\n  return actionFormatter(actionTypes.DELETE_GROUP, { groupId })\n}\n\n/**\n * A notice that deleteGroup has finished.\n * @method deleteGroupFinish\n * @param {Object} params\n * @param {string} params.groupId The ID of the group that was deleted.\n * @param {Object} [params.error] An error object.\n * @return {Object} A flux standard action.\n */\nexport function deleteGroupFinish ({ groupId, error }) {\n  return actionFormatter(actionTypes.DELETE_GROUP_FINISH, { groupId, error })\n}\n\n/**\n  Notification handlers\n  */\n\n/**\n * A notice that a 'groupChatSessionInvitationNotification' has been recieved.\n * @method invitationReceived\n * @param {Object} params\n * @param  {Object} params.invitation Invitation.\n * @param  {Object} [params.error] An error object.\n * @return {Object} A flux standard action.\n */\nexport function invitationReceived ({ invitation, error }) {\n  return actionFormatter(actionTypes.INVITATION_RECEIVED, { invitation, error })\n}\n\n/**\n * A notice that a 'chatParticipantStatusNotification' has been recieved.\n * @method statusNotificationReceived\n * @param {Object} params\n * @param  {Object} params.groupId Id of the group that the notification is for.\n * @param  {Object} params.notification Notification.\n * @param  {Object} [params.error] An error object.\n * @return {Object} A flux standard action.\n */\nexport function statusNotificationReceived ({ groupId, notification, error }) {\n  return actionFormatter(actionTypes.STATUS_NOTIFICATION_RECEIVED, { groupId, notification, error })\n}\n\n/**\n * A notice that a 'chatEventNotification' has been received.\n * @method eventNotificationReceived\n * @param {Object} params\n * @param  {Object} params.groupId Id of the group that the notification is for.\n * @param  {Object} params.notification Information.\n * @param  {Object} [params.error] An error object.\n * @return {Object} A flux standard action.\n */\nexport function eventNotificationReceived ({ groupId, notification, error }) {\n  return actionFormatter(actionTypes.EVENT_NOTIFICATION_RECEIVED, { groupId, notification, error })\n}\n","/**\n * The 'groups' namespace provides an interface for an application to create and\n *    manage Groups for a User. Groups are used in conjuction with the\n *    {@link conversation Messaging} feature to allow for group conversations.\n *\n * Groups are persisted by the server. When the SDK is initialized, there will\n *    be no Group information available, but the {@link groups.fetch}\n *    API is used to make available any Groups that were created\n *    previously.\n *\n * The creator of a Group is the Group's administrator.\n *\n * @public\n * @requires groups\n * @namespace groups\n */\n\nimport * as actions from './actions'\nimport * as selectors from './selectors'\n\nimport { getLogManager, API_LOG_TAG } from '../../logs'\n\nconst log = getLogManager().getLogger('GROUPS')\n\nexport default function (context) {\n  const groupsApi = {\n    /**\n     * Creates a Group.\n     *\n     * The SDK will emit a {@link groups.event:group:new group:new} event locally\n     *    when the operation completes. This event will include a Group ID that\n     *    is used to uniquely identify the group.\n     *\n     * Remote users added to the Group during creation will receive a\n     *    `group:invitation_received` event, which will include information\n     *    about the Group. Group participants can be managed after creation\n     *    using the {@link groups.addParticipant} and\n     *    {@link groups.removeParticipant} APIs.\n     *\n     * Group information will become available after the operation completes\n     *    using the {@link groups.get} and {@link groups.getAll} APIs.\n     *\n     * @public\n     * @static\n     * @memberof groups\n     * @method create\n     * @param {Object} params\n     * @param {Array<string>} [params.participants] List of participants to\n     *    invite to the group as part of creation. A participant's address\n     *    should be in the form of their User ID.\n     * @param {string} [params.subject] Subject of the Group.\n     * @param {string} params.name Name of the Group.\n     * @param {string} [params.image] HTTP URL of the image to be used as the\n     *    Group's avatar.\n     * @param {string} params.type Closed group indicates this is an\n     *    invitation-based closed chat group. Only Closed supported.\n     */\n    create (params) {\n      log.debug(API_LOG_TAG + 'groups.create: ', params)\n      context.dispatch(actions.create(params))\n    },\n\n    /**\n     * Fetches information about all Groups that the current user is a member\n     *    of. This will refresh the available Groups with any new information\n     *    from the server.\n     *\n     * The SDK will emit a {@link groups.event:group:refresh group:refresh} event\n     *    when the operation completes.\n     *\n     * Information about an available Group can be retrieved using the\n     *    {@link groups.getAll} or {@link groups.get} APIs.\n     *\n     * @public\n     * @static\n     * @memberof groups\n     * @method fetch\n     */\n    fetch () {\n      log.debug(API_LOG_TAG + 'groups.fetch')\n      context.dispatch(actions.fetchGroups())\n    },\n\n    /**\n     * Retrieves information about all available Groups.\n     *\n     * @public\n     * @static\n     * @memberof groups\n     * @method getAll\n     * @return {Array<Group>} The list of all available Groups.\n     */\n    getAll () {\n      log.debug(API_LOG_TAG + 'groups.getAll')\n      return selectors.getAllGroups(context.getState())\n    },\n\n    /**\n     * Retrieves information about a single Group, if available.\n     *\n     * @public\n     * @static\n     * @memberof groups\n     * @method get\n     * @param {string} groupId The ID uniquely identifying the Group.\n     * @return {Group} The specified Group.\n     */\n    get (groupId) {\n      log.debug(API_LOG_TAG + 'groups.get: ', groupId)\n      return selectors.getGroup(context.getState(), groupId)\n    },\n\n    /**\n     * Retrieves the list of particpants from an available Group.\n     *\n     * @public\n     * @memberof groups\n     * @method getParticipants\n     * @param {string} groupId The ID of the Group to get participants.\n     * @return {Array<string>} The list of Group participants.\n     */\n    getParticipants (groupId) {\n      log.debug(API_LOG_TAG + 'groups.getParticipants: ', groupId)\n      return selectors.getParticipants(context.getState(), groupId)\n    },\n\n    /**\n     * Retrieves information about all Group invitations available.\n     *\n     * The {@link groups.event:group:invitation_received group:invitation_received}\n     *    event indicates that a new Group invitation is available.\n     *\n     * @public\n     * @static\n     * @memberof groups\n     * @method getInvitations\n     * @return {Array<Invitations>} The list of Group invitations.\n     */\n    getInvitations () {\n      return selectors.getInvitations(context.getState())\n    },\n\n    /**\n     * Leaves a Group.\n     *\n     * The SDK will emit a {@link groups.event:group:change group:change} event\n     *    when the operation completes.\n     *\n     * @public\n     * @memberof groups\n     * @method leave\n     * @param {string} groupId The ID of the Group to leave.\n     */\n    leave (groupId) {\n      log.debug(API_LOG_TAG + 'groups.leave: ', groupId)\n      context.dispatch(actions.leave(groupId))\n    },\n\n    /**\n     * Accepts an invitation to a Group.\n     *\n     * The SDK will emit a {@link groups.event:group:change group:change} event\n     *    when the operation completes.\n     *\n     * @public\n     * @memberof groups\n     * @method acceptInvitation\n     * @param {string} groupId The ID of the Group to accept an invitation to.\n     */\n    acceptInvitation (groupId) {\n      log.debug(API_LOG_TAG + 'groups.acceptInvitation: ', groupId)\n      context.dispatch(actions.acceptInvitation(groupId))\n    },\n\n    /**\n     * Rejects an invitation to a Group.\n     *\n     * The SDK will emit a {@link groups.event:group:change group:change} event\n     *    when the operation completes.\n     *\n     * @public\n     * @memberof groups\n     * @method rejectInvitation\n     * @param {string} groupId The ID of the Group to reject an invitation to.\n     */\n    rejectInvitation (groupId) {\n      log.debug(API_LOG_TAG + 'groups.rejectInvitation: ', groupId)\n      context.dispatch(actions.rejectInvitation(groupId))\n    },\n\n    /**\n     * Adds participant to a Group.\n     *\n     * The SDK will emit a {@link groups.event:group:change group:change} event\n     *    when the operation completes. The participant being added will receive\n     *    a {@link groups.event:group:invitation_received group:invitation_received}\n     *    event.\n     *\n     * @public\n     * @static\n     * @memberof groups\n     * @method addParticipant\n     * @param {string} groupId The ID of the Group to add participant to.\n     * @param {string} participant The User ID of the participant to add.\n     */\n    addParticipant (groupId, participant) {\n      log.debug(API_LOG_TAG + 'groups.addParticipant: ', groupId, participant)\n      context.dispatch(actions.addParticipant(groupId, participant))\n    },\n\n    /**\n     * Removes a participant from a Group.\n     *\n     * The SDK will emit a {@link groups.event:group:change group:change} event\n     *    when the operation completes.\n     *\n     * @public\n     * @static\n     * @memberof groups\n     * @method removeParticipant\n     * @param {string} groupId The ID of the Group to remove participant from.\n     * @param {string} participant The User ID of the participant to remove.\n     */\n    removeParticipant (groupId, participant) {\n      log.debug(API_LOG_TAG + 'groups.removeParticipant: ', groupId, participant)\n      context.dispatch(actions.removeParticipant(groupId, participant))\n    },\n\n    /**\n     * Deletes a Group.\n     *\n     * The Group will no longer be available using the {@link groups.get}\n     *    and {@link groups.getAll} APIs.\n     *\n     * The SDK will emit a {@link groups.event:group:delete group:delete} event\n     *    for all participants in the Group.\n     *\n     * @public\n     * @memberof groups\n     * @method delete\n     * @param {string} groupId The ID of the Group to delete.\n     */\n    delete (groupId) {\n      log.debug(API_LOG_TAG + 'groups.delete: ', groupId)\n      context.dispatch(actions.deleteGroup(groupId))\n    }\n  }\n  return { groups: groupsApi }\n}\n","/**\n * A new Group has been created and its information is now available.\n *\n * Information about an available Group can be retrieved using the\n *    {@link groups.getAll} or {@link groups.get} APIs.\n *\n * @public\n * @static\n * @memberof groups\n * @event group:new\n * @param {Object} params\n * @param {string} params.id The ID of the newly available Group.\n * @example\n * // Set an event listener for new Groups being created.\n * client.on('group:new', params => {\n *    const group = client.groups.get(params.groupId)\n *    // Use the new group.\n * })\n */\nexport const GROUP_NEW = 'group:new'\n\n/**\n * An existing Group has been modified and the new information is available.\n *\n * @public\n * @memberof groups\n * @event group:change\n * @param {Object} params\n * @param {string} params.id The ID of the Group that has changed.\n */\nexport const GROUP_CHANGE = 'group:change'\n\n/**\n * A Group has been deleted and is no longer available.\n *\n * The latest information about the Group is provided as part of the event.\n *\n * @public\n * @memberof groups\n * @event group:delete\n * @param {Object} params\n * @param {Object} params.group The information about the Group that was deleted.\n * @param {string} params.group.id the Group ID of the deleted group\n * @param {string} params.group.image the group image of the deleted group\n * @param {string} params.group.name the group name of the deleted group\n * @param {Array} params.group.participants the participants of the group of the deleted group\n * @param {string} params.group.subject the subject for the group of the deleted group\n */\nexport const GROUP_DELETE = 'group:delete'\n\n/**\n * The list of Groups has been refreshed.\n *\n * Any previously available Groups may have had their information updated, and\n *    any otherwise unknown Groups may now be available.\n *\n * Information about an available Group can be retrieved using the\n *    {@link groups.getAll} or {@link groups.get} APIs.\n *\n * @public\n * @memberof groups\n * @event group:refresh\n */\nexport const GROUP_REFRESH = 'group:refresh'\n\n/**\n * An invitation to a Group has been received.\n *\n * Information about a Group invitation can be retrieved using the\n *    {@link groups.getInvitations} API.\n *\n * @public\n * @static\n * @memberof groups\n * @event group:invitation_received\n * @param {Object} params\n * @param {Object} params.invitation contains information about the group invitation\n * @param {string} params.invitation.id Group ID used to locate and join the group\n * @param {Array} params.invitation.participants a list of participants in the group\n * @param {string} params.invitation.name the group name\n */\nexport const GROUP_INVITATION_RECEIVED = 'group:invitation_received'\n\n/**\n * An error occured with a Group operation.\n *\n * @public\n * @memberof groups\n * @event group:error\n * @param {Object} params\n * @param {BasicError} params.error The Basic error object.\n */\nexport const GROUP_ERROR = 'group:error'\n","import * as actionTypes from './actionTypes'\nimport * as eventTypes from './eventTypes'\n\nlet events = {}\n\nconst groupChangedEvent = function (action) {\n  if (action.error) {\n    return {\n      type: eventTypes.GROUP_CHANGE,\n      args: { error: action.payload }\n    }\n  } else {\n    const { groupId } = action.payload\n    return {\n      type: eventTypes.GROUP_CHANGE,\n      args: { id: groupId }\n    }\n  }\n}\n\nevents[actionTypes.CREATE_GROUP_FINISH] = function (action) {\n  if (action.error) {\n    return {\n      type: eventTypes.GROUP_NEW,\n      args: { error: action.payload }\n    }\n  } else {\n    const { groupId } = action.payload.group\n    return {\n      type: eventTypes.GROUP_NEW,\n      args: { id: groupId }\n    }\n  }\n}\n\nevents[actionTypes.DELETE_GROUP_FINISH] = function (action, { prevState }) {\n  if (action.error) {\n    return {\n      type: eventTypes.GROUP_DELETE,\n      args: { error: action.payload }\n    }\n  } else {\n    const group = prevState.groups.groups.find(group => group.id === action.payload.groupId)\n    return {\n      type: eventTypes.GROUP_DELETE,\n      args: { group }\n    }\n  }\n}\n\nevents[actionTypes.ADD_PARTICIPANT_FINISH] = groupChangedEvent\nevents[actionTypes.REMOVE_PARTICIPANT_FINISH] = groupChangedEvent\nevents[actionTypes.LEAVE_GROUP_FINISH] = groupChangedEvent\nevents[actionTypes.ACCEPT_INVITATION_FINISH] = groupChangedEvent\nevents[actionTypes.REJECT_INVITATION_FINISH] = groupChangedEvent\nevents[actionTypes.STATUS_NOTIFICATION_RECEIVED] = groupChangedEvent\nevents[actionTypes.EVENT_NOTIFICATION_RECEIVED] = groupChangedEvent\n\nevents[actionTypes.INVITATION_RECEIVED] = function (action) {\n  if (action.error) {\n    return {\n      type: eventTypes.GROUP_INVITATION_RECEIVED,\n      args: { error: action.payload }\n    }\n  } else {\n    // replace groupId with id\n    const invitation = { ...action.payload.invitation, id: action.payload.invitation.groupId }\n    delete invitation.groupId\n\n    return {\n      type: eventTypes.GROUP_INVITATION_RECEIVED,\n      args: { invitation }\n    }\n  }\n}\n\nevents[actionTypes.FETCH_GROUPS_FINISH] = function (action) {\n  if (action.error) {\n    return {\n      type: eventTypes.GROUP_REFRESH,\n      args: { error: action.payload }\n    }\n  } else {\n    return {\n      type: eventTypes.GROUP_REFRESH,\n      args: {}\n    }\n  }\n}\n\nexport default events\n","export { default as api } from './api'\nexport { default as reducer } from './reducers'\n","import * as actionTypes from './actionTypes'\n\n// Libraries\nimport { handleActions } from 'redux-actions'\n\nconst reducers = {}\n\nreducers[actionTypes.CREATE_GROUP_FINISH] = {\n  next (state, action) {\n    // rename groupId to id\n    const newGroup = { ...action.payload.group, id: action.payload.group.groupId }\n    delete newGroup.groupId\n\n    return { ...state, groups: [...state.groups, newGroup] }\n  }\n}\n\n/*\n * Removes the specified group from state.\n */\nreducers[actionTypes.DELETE_GROUP_FINISH] = {\n  next (state, action) {\n    const { groupId } = action.payload\n\n    return {\n      ...state,\n      groups: state.groups.filter(group => group.id !== groupId)\n    }\n  }\n}\n\n/*\n * Adds a participant to the specified group.\n */\nreducers[actionTypes.ADD_PARTICIPANT_FINISH] = {\n  next (state, action) {\n    const { groupId, participant } = action.payload\n\n    return {\n      ...state,\n      groups: state.groups.map(group => {\n        if (group.id === groupId) {\n          return {\n            ...group,\n            participants: [...group.participants, participant]\n          }\n        }\n        return group\n      })\n    }\n  }\n}\n\n/*\n * Removes a participant from the specified group.\n */\nreducers[actionTypes.REMOVE_PARTICIPANT_FINISH] = {\n  next (state, action) {\n    const { groupId, participant } = action.payload\n    return {\n      ...state,\n      groups: state.groups.map(group => {\n        if (group.id === groupId) {\n          return {\n            ...group,\n            participants: group.participants.filter(member => member.address !== participant)\n          }\n        }\n        return group\n      })\n    }\n  }\n}\n\n/*\n * Leave a specified group and remove invitation in state if it exists.\n */\nreducers[actionTypes.LEAVE_GROUP_FINISH] = {\n  next (state, action) {\n    const { groupId } = action.payload\n\n    return {\n      ...state,\n      groups: state.groups.filter(group => group.id !== groupId),\n      invitations: state.invitations.filter(invite => invite.id !== groupId)\n    }\n  }\n}\n\n/*\n * Fetch list of groups from server and update state.\n */\nreducers[actionTypes.FETCH_GROUPS_FINISH] = {\n  next (state, action) {\n    // rename groupId to id\n    const groups = action.payload.groups.map(group => {\n      const groupWithId = { ...group, id: group.groupId }\n      delete groupWithId.groupId\n      return groupWithId\n    })\n\n    return {\n      ...state,\n      groups\n    }\n  }\n}\n\n/*\n * Accept the invitation and update the state.\n */\nreducers[actionTypes.ACCEPT_INVITATION_FINISH] = {\n  next (state, action) {\n    const { group } = action.payload\n    const newGroup = { ...group, id: group.groupId }\n    delete newGroup.groupId\n\n    // remove the invitation and replace the group in state.\n    return {\n      ...state,\n      groups: [...state.groups.filter(group => group.id !== newGroup.id), newGroup],\n      invitations: state.invitations.filter(invite => invite.id !== newGroup.id)\n    }\n  }\n}\n\n/*\n * Reject the invitation and update the state.\n */\nreducers[actionTypes.REJECT_INVITATION_FINISH] = {\n  next (state, action) {\n    const { groupId } = action.payload\n\n    // remove the invitation and the group from state.\n    return {\n      ...state,\n      groups: state.groups.filter(group => group.id !== groupId),\n      invitations: state.invitations.filter(invite => invite.id !== groupId)\n    }\n  }\n}\n\n/*\n * Invitation has been received.\n */\nreducers[actionTypes.INVITATION_RECEIVED] = {\n  next (state, action) {\n    const invitation = { ...action.payload.invitation, id: action.payload.invitation.groupId }\n    delete invitation.groupId\n\n    return {\n      ...state,\n      invitations: [...state.invitations, invitation]\n    }\n  }\n}\n\n/*\n * A group that you belong to has been deleted.\n */\nreducers[actionTypes.EVENT_NOTIFICATION_RECEIVED] = {\n  next (state, action) {\n    const { groupId, notification } = action.payload\n\n    // if the eventType is 'SessionInvited' (ie you have an unaccepted invitation),\n    // remove the group and invitation from state.\n    if (notification.eventType === 'SessionCancelled') {\n      return {\n        ...state,\n        groups: state.groups.filter(group => group.id !== groupId),\n        invitations: state.invitations.filter(invite => invite.id !== groupId)\n      }\n      // otherwise, just remove the group\n    } else if (notification.eventType === 'SessionEnded') {\n      return {\n        ...state,\n        groups: state.groups.filter(group => group.id !== groupId)\n      }\n    }\n  }\n}\n/*\n * A group that you belong to has been modified.\n */\nreducers[actionTypes.STATUS_NOTIFICATION_RECEIVED] = {\n  next (state, action) {\n    // need to update the state.... if the group exists in state, update this participants\n    const { groupId, notification } = action.payload\n    const changedParticipant = notification.participants[0]\n    const newState = {\n      ...state,\n      groups: state.groups.map(group => {\n        if (group.id === groupId) {\n          let newGroup = {\n            ...group,\n            participants: group.participants.filter(participant => participant.address !== changedParticipant.address)\n          }\n          newGroup.participants.push(changedParticipant)\n          return {\n            ...newGroup\n          }\n        }\n        return group\n      })\n    }\n    return newState\n  }\n}\n\nconst reducer = handleActions(reducers, { groups: [], invitations: [] })\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\n/**\n * Retrieves all the groups in state.\n * @method getAllGroups\n * @param  {Object} state Redux state.\n * @return {[Object]}  List of groups.\n */\nexport function getAllGroups (state) {\n  return cloneDeep(state.groups.groups)\n}\n\n/**\n * Retrieves group information for a specified group in state.\n * @method get\n * @param  {Object} state Redux state.\n * @return {Object}  Group information of specified group.\n */\nexport function getGroup (state, groupId) {\n  const group = state.groups.groups.find(group => group.id === groupId)\n  if (group) {\n    return cloneDeep(group)\n  }\n}\n\n/**\n * Retrieves list of participants from a specified group in state.\n * @method getParticipants\n * @param  {Object} state Redux state.\n * @return {[Object]}  List of participants in specified group.\n */\nexport function getParticipants (state, groupId) {\n  const group = state.groups.groups.find(group => group.id === groupId)\n  if (group) {\n    return cloneDeep(group.participants)\n  }\n}\n\n/**\n * Retrieves all the invitations in state.\n * @method getInvitations\n * @param  {Object} state Redux state.\n * @return {[Object]}  List of invitations.\n */\nexport function getInvitations (state, groupId) {\n  return cloneDeep(state.groups.invitations)\n}\n","/**\n * Remaps/renames some properties on the participants array passed in\n *\n * @param {Array} participants a list of participant objects\n * @return {Array}\n */\nexport function remapParticipants (participants) {\n  return participants.map(participant => {\n    const remappedParticipant = { ...participant, isAdmin: participant['x-isAdmin'] }\n    delete remappedParticipant.resourceURL\n    delete remappedParticipant['x-isAdmin']\n    return remappedParticipant\n  })\n}\n\n/**\n * Normalizes server group notifications into a more usable object structure for front end development.\n *\n * @param {Object} groupNotification\n * @returns {Object} group\n * @returns {string} group.name The group name\n * @returns {Array} group.participants A list of participant objects\n * @returns {string} group.subject The group subject\n * @returns {string} group.groupId An ID for looking up the group\n * @returns {string} group.image The image for the group\n */\nexport function marshallGroup (groupNotification) {\n  // pull out and rename properties\n  const { 'x-name': name, 'x-image': image, subject, resourceURL, participant } = groupNotification\n\n  // re-map all participants on each group\n  const participants = remapParticipants(participant)\n\n  // parse the Group ID out of resourceURL\n  const groupId = resourceURL.substring(resourceURL.lastIndexOf('/') + 1)\n  return { name, participants, subject, groupId, image }\n}\n","// Disabling eslint for the next comment as we want to be able to use a disallowed word\n// eslint-disable-next-line no-warning-comments\n/**\n * The SDK creation factory. Create an instance of the SDK by calling this factory with the desired configurations.\n * The SDK instance will be refered as 'api' throughout the rest of the documentation content.\n * @public\n * @method create\n * @param {config} config The configuration object.\n * @return {api} The SDK instance.\n * @example\n * // Instantiate the SDK.\n * import { create } from 'kandy'\n * const client = create({\n *     authentication: { ... },\n *     logs: { ... },\n *     ...\n * });\n * // Use the SDK's API.\n * client.on( ... );\n */\n\n/**\n * The 'api' is the type returned by the create function.\n * It contains various top-level functions that pertain to SDK global instance\n * as well as several nested namespaces that pertain to various features (e.g. call, contacts, presence, etc).\n *\n * @public\n * @module api\n */\n\n/**\n * The configuration object. This object defines what different configuration\n * values you can use when instantiating the SDK using the {@link create} function.\n * @public\n * @module config\n */\n\n// Disabling eslint for the next comment as we want to be able to use a disallowed word\n// eslint-disable-next-line no-warning-comments\n/**\n * A set of {@link call.SdpHandlerFunction SdpHandlerFunction}s for manipulating SDP information.\n * These handlers are used to customize low-level call behaviour for very specific\n * environments and/or scenarios. They can be provided during SDK instantiation\n * to be used for all calls.\n *\n * @public\n * @namespace sdpHandlers\n * @example\n * import { create, sdpHandlers } from 'kandy';\n * const codecRemover = sdpHandlers.createCodecRemover(['VP8', 'VP9'])\n * const client = create({\n *   call: {\n *     sdpHandlers: [ <Your-SDP-Handler-Function>, ...]\n *   }\n * })\n */\n\n// Disabling eslint for the next comment as we want to be able to use a disallowed word\n// eslint-disable-next-line no-warning-comments\n/**\n * In some scenarios it's necessary to remove certain codecs being offered by the SDK to the remote party.\n * While creating an SDP handler would allow a user to perform this type of manipulation, it is a non-trivial task that requires in-depth knowledge of WebRTC SDP.\n *\n * To facilitate this common task, the SDK provides a codec removal handler creator that can be used for this purpose.\n *\n * The SDP handlers are exposed on the entry point of the SDK. They need to be added to the list of SDP handlers via configuration on creation of an instance of the SDK.\n *\n * @public\n * @memberof sdpHandlers\n * @method createCodecRemover\n * @param {Array<string>} codecs A list of codec names to remove from the SDP.\n * @returns {SdpHandlerFunction} The resulting SDP handler that will remove the codec.\n * @example\n * import { create, sdpHandlers } from 'kandy';\n * const codecRemover = sdpHandlers.createCodecRemover(['VP8', 'VP9'])\n * const client = create({\n *   call: {\n *     sdpHandlers: [codecRemover]\n *   }\n * })\n *\n */\n\n/*\n * Index template file that is used to create pre-defined version of the SDK.\n */\nimport { factory } from './factory'\nimport { map, _ } from 'lodash/fp'\n\n// This is a hack to fix an issue where Lodash will add itself to\n// the window scope even if it's loaded via ES6. You can remove this when\n// we have an answer to https://github.com/lodash/lodash/issues/1798 .\n// eslint-disable-next-line\nif (_) _.noConflict()\n\nexport default function commonIndex (options = {}, plugins = []) {\n  const pluginInstances = map(function (plugin) {\n    return plugin.fn(options[plugin.name])\n  }, plugins)\n\n  return factory(pluginInstances, options.common)\n}\n","import commonIndex from './index.common'\n\n// Plugins\nimport basePlugins from './basePlugins'\nimport auth from './auth/cpaas'\nimport webrtc from './webrtc'\nimport call from './call/cpaas'\nimport connectivity from './connectivity/cpaas'\nimport messaging from './messaging/cpaas'\nimport notifications from './notifications/cpaas'\nimport presence from './presence/cpaas'\nimport groups from './groups/cpaas'\nimport subscription from './subscription/cpaas'\nimport createCodecRemover from '../../fcs/src/js/sdp/codecRemover'\nimport users from './users/cpaas'\nimport './docs/docs'\n\nconst defaultPlugins = [\n  ...basePlugins,\n  { name: 'authentication', fn: auth },\n  { name: 'webrtc', fn: webrtc },\n  { name: 'call', fn: call },\n  { name: 'connectivity', fn: connectivity },\n  { name: 'messaging', fn: messaging },\n  { name: 'notifications', fn: notifications },\n  { name: 'presence', fn: presence },\n  { name: 'groups', fn: groups },\n  { name: 'subscription', fn: subscription },\n  { name: 'users', fn: users }\n]\n\nfunction root (options = {}, plugins = []) {\n  return commonIndex(options, [...defaultPlugins, ...plugins])\n}\n\n// Alias 'create' to be equal to the root function\nroot.create = root\n\nroot.sdpHandlers = {\n  createCodecRemover\n}\n\n// Export this way as a work-around, so it can be used as `<export>();`.\n// See: https://github.com/webpack/webpack/issues/706\nmodule.exports = root\n","// Logs plugin.\nimport setupTransformers from './transformers'\nimport api from './interface/api'\n\n// Other plugins.\nimport { update as updateConfig } from '../config/interface/actions'\n\n// Libraries.\nimport { put } from 'redux-saga/effects'\nimport { mergeValues } from '../common/utils'\n\n// Log manager, log levels and redux-logger options\nimport LogManager, { logLevels } from './logManager'\nimport { titleFormatter } from './utils'\n\n// Redux Logger middleware\nimport { createLogger } from 'redux-logger'\n\n// Default logging options\nconst defaultOptions = {\n  // Possible levels: trace, debug, info, warn, error, silent.\n  logLevel: 'debug',\n  // Flatten the log entries into a string, rather than logging more complex data types.\n  flatten: false,\n  // Configuration options relevant to the logging of actions\n  logActions: {\n    // Only show action out of prevState, action, newState.\n    actionOnly: true,\n    // Collapse prevState, action, nextState objects by default.\n    collapsed: false,\n    // Log the diff for each action.\n    diff: false,\n    // set redux-logger's level to debug\n    level: 'debug',\n    // Allow action payloads to be exposed in the logs, potentially displaying sensitive information\n    exposePayloads: false\n  },\n  enableFcsLogs: true\n}\n\n// Logs generated as a result of invoking the public API will contain this tag\nexport const API_LOG_TAG = 'API invoked: '\n\n// Instantiate the log manager\nconst logMgr = getLogManager(defaultOptions)\n\n/**\n * Configuration options for the Logs feature.\n * @public\n * @static\n * @name config.logs\n * @memberof config\n * @requires logs\n * @instance\n * @param {Object} logs Logs configs.\n * @param  {string} [logs.logLevel='debug'] Log level to be set. See {@link logger.levels}.\n * @param  {boolean} [logs.flatten=false] Whether all logs should be output in a string-only format.\n * @param  {Object} [logs.logActions] Options specifically for action logs when logLevel is at DEBUG+ levels. Set this to false to not output action logs.\n * @param  {boolean} [logs.logActions.actionOnly=true] Only output information about the action itself. Omits the SDK context for when it occurred.\n * @param  {boolean} [logs.logActions.collapsed=false] Whether logs should be minimized when initially output. The full log is still output and can be inspected on the console.\n * @param  {boolean} [logs.logActions.diff=false] Include a diff of what SDK context was changed by the action.\n * @param {boolean} [logs.logActions.exposePayloads=false] Allow action payloads to be exposed in the logs, potentially displaying sensitive information\n * @param  {boolean} [logs.enableFcsLogs=true] Enable the detailed call logger.\n * @param  {boolean} [logs.enableGrouping=true] Whether to group information about an action log together in the console.\n */\n\n/**\n * Logger Plugin.\n * @method logger\n * @param  {Object} [options] Plugin configurations. See above.\n * @return {Object} plugin A plugin object.\n */\nexport default function logger (options = {}) {\n  const name = 'logs'\n  // Backwards compatibility: flatten replaced logActions.flattenActions\n  // TODO: Remove this after awhile.\n  if (options.logActions && options.logActions.flattenActions && options.flatten === undefined) {\n    logMgr\n      .getLogger('LOGS')\n      .warn(\n        'The Logs plugin config \"logActions.flattenActions\" has been ' +\n          'deprecated in favour of \"flatten\", and will be removed in a future build.'\n      )\n    options.flatten = options.logActions.flattenActions\n  }\n  options = mergeValues(defaultOptions, options)\n  // Now that plugins are being called, we can update the log manager with our desired configuration options\n  logMgr.updateManager(options)\n\n  function * init () {\n    // Send the provided options to the store.\n    // This will be `state.config[name]`.\n    yield put(updateConfig(options, name))\n  }\n\n  var components = {\n    name,\n    capabilities: ['logs'],\n    init,\n    api\n  }\n  // Consider actions to be at the INFO log level.\n  // Only export a middleware (for actions) at the appropriate levels.\n  if (logMgr.getLevel() <= logLevels.INFO && options.logActions !== false) {\n    let actionOptions = {}\n    // Use different options for redux-logger depending on log level.\n    if (logMgr.getLevel() === logLevels.INFO) {\n      // At the INFO level, hide everything except the action name.\n      actionOptions.level = false\n      actionOptions.diff = false\n    } else {\n      // At the DEBUG+ levels, use the configs.\n      actionOptions = {\n        ...options.logActions\n      }\n    }\n\n    if (options.logActions.actionOnly) {\n      // Hide prevState and nextState.\n      // Log action and error at info level, so the browser won't hide it by default.\n      actionOptions.level = {\n        prevState: false,\n        action: 'info',\n        error: 'info',\n        nextState: false\n      }\n    }\n\n    if (options.logActions.excludeActions) {\n      actionOptions.predicate = excludeActions(options.logActions.excludeActions)\n    }\n\n    // ALWAYS use our own logger\n    actionOptions.logger = logMgr.getLogger('ACTION')\n    // ALWAYS remove theming/styling from the action log messages\n    actionOptions.titleFormatter = titleFormatter\n    actionOptions.colors = false\n    // Setup the transformers based on the options.\n    let transformers = setupTransformers(options.logActions)\n    // Create the logger middleware.\n    components.middleware = createLogger({\n      ...actionOptions,\n      ...transformers\n    })\n  }\n  return components\n}\n\n/**\n * Getter checks to see if an instance of logManager exists, instantiates it if it does not, and returns\n * the instance of LogManager\n * @param {Object} [options]\n * @param {string} [options.logLevel] The logging level, as per options found in logManager.levels\n * @param {boolean} [options.flatten] Stringifies the output\n * @param {boolean} [options.enableGrouping] Group log messages together\n * @returns {LogManager} an instance of our LogManager\n *\n * TODO:Fix this ugly singleton.\n */\nexport function getLogManager (options) {\n  if (!getLogManager.instance) {\n    getLogManager.instance = new LogManager(options)\n  }\n  return getLogManager.instance\n}\n\n/**\n * Logger predicate function that will take an array of action types\n * and exclude them from logs\n * @param {Array} actions An array of action types to exclude from logs\n * @returns {function} A predicate function\n */\nfunction excludeActions (actions) {\n  return (getState, action) => !actions.includes(action.type)\n}\n","/**\n * The internal logger is used to provide information about the SDK's behaviour.\n * The logger can provide two types of logs: basic logs and action logs. Basic\n * logs are simple lines of information about what the SDK is doing during operations.\n * Action logs are complete information about a specific action that occurred\n * within the SDK, providing debug information describing it.\n * The amount of information logged can be configured as part of the SDK configuration.\n * See {@link #configconfiglogs config.logs} .\n *\n * @public\n * @namespace logger\n * @requires logs\n */\n\nexport default function api () {\n  let api = {\n    /**\n     * Possible levels for the SDK logger.\n     * @public\n     * @static\n     * @memberof logger\n     * @property {string} SILENT Log nothing.\n     * @property {string} ERROR Log only unhandled errors.\n     * @property {string} WARN Log issues that may cause problems or unexpected behaviour.\n     * @property {string} INFO Log useful information and messages to indicate the SDK's internal operations.\n     * @property {string} DEBUG Log information to help diagnose problematic behaviour.\n     */\n    levels: {\n      SILENT: 'silent',\n      ERROR: 'error',\n      WARN: 'warn',\n      INFO: 'info',\n      DEBUG: 'debug'\n    }\n  }\n\n  return {\n    logger: api\n  }\n}\n","import log from 'loglevel'\n\n/**\n * Exposed logLevels object describes the level hierarchy\n *\n * @type {{TRACE: number, DEBUG: number, INFO: number, WARN: number, ERROR: number, SILENT: number}}\n */\nexport const logLevels = {\n  TRACE: 0,\n  DEBUG: 1,\n  INFO: 2,\n  WARN: 3,\n  ERROR: 4,\n  SILENT: 5\n}\n\n/**\n * Creates a log manager to provision loggers and coordinate processing of log entries\n * @method LogManager\n * @param {Object} [options]\n * @param {string} [options.logLevel='INFO']\n * @param {boolean} [options.flatten=false]\n * @param {boolean} [options.enableGrouping=true]\n */\nexport default function LogManager ({ logLevel = 'INFO', flatten = false, enableGrouping = true }) {\n  // Create a property to reference the master logger\n  this._log = log\n  // Always convert the logLevel string to upper case for consistency\n  this.level = logLevels[logLevel.toUpperCase()]\n  this._log.setLevel(this.level, false)\n  // Setting flatten to true will result in stringified output\n  this.flatten = flatten\n\n  const loggers = {}\n  const _logMgr = this\n\n  _logMgr._log.info('Creating Log Manager')\n\n  /**\n   * Logger getter function to be used to retrieve all loggers in the SDK\n   * @method getLogger\n   * @param {string} name, The name of the logger to be created/retrieved\n   * @returns {Logger}\n   */\n  this.getLogger = function getLogger (name) {\n    var logger\n\n    if (loggers[name]) {\n      logger = loggers[name]\n    } else {\n      logger = new Logger(name)\n      loggers[logger.getName()] = logger\n    }\n\n    return logger\n  }\n\n  /**\n   * Log handler to compose a log message and determine the appropriate console logging function to\n   * print log entry\n   * @method logHandler\n   * @param {string} name Name of the logger.\n   * @param {LogItem} logItem\n   */\n  this.logHandler = function logHandler (name, logItem) {\n    const msg = parseLogMessage(name, logItem)\n\n    if (logLevels[logItem.level] >= _logMgr.level) {\n      switch (logLevels[logItem.level]) {\n        case logLevels.TRACE:\n          _logMgr._log.trace(msg, ...logItem.args)\n          break\n        case logLevels.DEBUG:\n          _logMgr._log.debug(msg, ...logItem.args)\n          break\n        case logLevels.INFO:\n          _logMgr._log.info(msg, ...logItem.args)\n          break\n        case logLevels.WARN:\n          _logMgr._log.warn(msg, ...logItem.args)\n          break\n        case logLevels.ERROR:\n          _logMgr._log.error(msg, ...logItem.args)\n          break\n        case logLevels.SILENT:\n          /* TODO we should implement a secondary logging mechanism, which would save the logs on a private server this secondary mechanism would also include messages that were created while logging level was set to SILENT */\n          break\n        default:\n          _logMgr._log.info(msg, ...logItem.args)\n          break\n      }\n    } else {\n      /* Log level is not sufficiently Low to allow message to be visible */\n    }\n  }\n\n  /**\n   * Creates a new logger which can be identified by name for subsequent retrieval\n   * @param name\n   * @constructor\n   */\n  function Logger (name) {\n    this.name = name\n    /**\n     * Logger name getter function\n     * @returns {string} name - The name of the logger\n     */\n    this.getName = () => {\n      return this.name\n    }\n\n    /**\n     * Log function to instantiate a log item and send to handler\n     * for processing\n     * @param {string} level - The log function level which was used to create the log message\n     * @param {string} message - The unparsed log message\n     * @param {*} args - The arguments provided along the message\n     */\n    function log (level, message, args) {\n      const logItem = new LogItem(level, message, args)\n      if (_logMgr) {\n        _logMgr.logHandler(name, logItem)\n      }\n    }\n\n    this.error = (msg, ...args) => {\n      return log('ERROR', msg, args)\n    }\n\n    this.warn = (msg, ...args) => {\n      return log('WARN', msg, args)\n    }\n\n    this.info = (msg, ...args) => {\n      return log('INFO', msg, args)\n    }\n\n    this.debug = (msg, ...args) => {\n      return log('DEBUG', msg, args)\n    }\n\n    this.trace = (msg, ...args) => {\n      return log('TRACE', msg, args)\n    }\n\n    // Treat `logger.log` as a special case for now. Pass it straight through\n    //   to the logger (without parsing/formatting). Prevents logs that aren't\n    //   setup to work with the logger from being double-formatted (eg. FCS).\n    // TODO: Remove `logger.log` when FCS logs work well with this log manager.\n    this.log = (msg, ...args) => {\n      _logMgr._log.log(msg, ...args)\n    }\n\n    /**\n     * Handle group-related console functions\n     * @param data\n     */\n    this.group = data => {\n      if (_logMgr.enableGrouping === false) {\n        return\n      }\n      window.console.group(data)\n    }\n\n    this.groupCollapsed = data => {\n      if (_logMgr.enableGrouping === false) {\n        return\n      }\n      window.console.groupCollapsed(data)\n    }\n\n    this.groupEnd = () => {\n      if (_logMgr.enableGrouping === false) {\n        return\n      }\n      window.console.groupEnd()\n    }\n  }\n\n  /**\n   * Update the configuration of the log manager after it has been instantiated\n   *\n   * This is necessary as the log manager needs to be created prior to initializing each\n   * of the plugins in the SDK.\n   * @method updateManager\n   * @param {Object} [options]\n   * @param {string} [options.logLevel] the logging level, as per options found in logManager.levels\n   * @param {Boolean} [options.flatten]\n   */\n  this.updateManager = ({ logLevel, flatten, enableGrouping }) => {\n    // Update the manager's options _if_ they were provided.\n    _logMgr.level = logLevel ? logLevels[logLevel.toUpperCase()] : _logMgr.level\n    _logMgr._log.setLevel(this.level, false)\n    _logMgr.flatten = flatten || _logMgr.flatten\n    _logMgr.enableGrouping = enableGrouping\n  }\n\n  /**\n   * Getter to return the current level set in the log manager\n   * @method getLevel\n   * @returns {string}\n   */\n  this.getLevel = () => {\n    return _logMgr.level\n  }\n\n  /**\n   * Helper function to check if verbose mode is enabled\n   * @returns {boolean}\n   */\n  function isVerboseEnabled () {\n    return _logMgr.flatten\n  }\n\n  /**\n   * Determines type of log entry being recorded and composes an appropriate message\n   * @param {string} name - The name of the logger for which this message is being parsed\n   * @param {Object} logItem - The log entry\n   * @returns {string} logMessage - The fully composed log message\n   */\n  function parseLogMessage (name, logItem) {\n    let logMessage\n    switch (name) {\n      case 'ACTION':\n        logMessage = parseActionMessage(name, logItem)\n        break\n\n      case 'GENERAL':\n        logMessage = parseMessage(name, logItem)\n        break\n\n      default:\n        logMessage = parseMessage(name, logItem)\n        break\n    }\n    return logMessage\n  }\n\n  /**\n   * Determines the specific type of action if the log entry is of messageTypes.ACTION\n   * @param actionArgs\n   * @param message\n   * @returns {*}\n   */\n  function getActionType (actionArgs, message) {\n    if (actionArgs.length > 0 && 'type' in actionArgs[0]) {\n      return actionArgs[0].type\n    }\n    return message.indexOf('prev') !== -1 ? 'PREV STATE' : 'NEXT STATE'\n  }\n\n  /**\n   * Parses a general purpose log message\n   * @param {string} name\n   * @param {Object} logItem\n   * @returns {string}\n   */\n  function parseMessage (name, logItem) {\n    if (typeof logItem !== 'undefined' && logItem.hasOwnProperty('message')) {\n      if (isVerboseEnabled()) {\n        // TODO: Improve the stringification process to mitigate circular JSON errors\n        return `${logItem.timestamp} - ${name} - ${logItem.level} - MESSAGE - ${JSON.stringify(\n          logItem.message\n        )} - ARGS - ${JSON.stringify(logItem.args)}`\n      }\n      return `${logItem.timestamp} - ${name} - ${logItem.level} - ${logItem.message}`\n    }\n  }\n\n  /**\n   * Parses log items containing actions and composes an informative log message\n   * @param name\n   * @param logItem\n   * @returns {string}\n   */\n  function parseActionMessage (name, logItem) {\n    var actionType = getActionType(logItem.args, logItem.message)\n\n    if (isVerboseEnabled()) {\n      return `${logItem.timestamp} - ${name} - ${logItem.level} - MESSAGE - ${JSON.stringify(\n        logItem.message\n      )} - ARGS - ${JSON.stringify(logItem.args)}`\n    }\n\n    return `${logItem.timestamp} - ${name} - ${logItem.level} - ${actionType}`\n  }\n}\n\n/**\n * Base structure for a log entry\n *\n * @constructor\n *\n * @property {string} message - The visible message being displayed by the log entry, undefined at instantiation\n * @property {string} level - The logging level\n * @property {*} args - The arguments supplied with the log entry, if supplied\n * @property {string} timestamp - The time of the log entry\n *\n * @param level\n * @param msg\n * @param [args]\n\n * @returns {LogItem}\n */\nfunction LogItem (level, msg, args) {\n  this.level = level\n  this.timestamp = Date.now()\n  this.message = msg\n\n  if (typeof args !== 'undefined') {\n    // Always return args as an array, as this produces a consistent behaviour wherein we maintain the option to add a stack trace to the log message\n    this.args = typeof args !== 'undefined' ? args : []\n  } else {\n    delete this.args\n  }\n  return this\n}\n","// Libraries\nimport { omit } from 'lodash/fp'\n\n/**\n * Determines which redux-logger transformers we need based on options.\n * @method setupTransformers\n * @param  {Object} options\n * @return {Object} An object of transformers to be provided to redux-logger.\n */\nexport default function setupTransformers (options) {\n  // A \"pipeline\" of all redux-logger action transformers.\n  function actionPipeline (transformers) {\n    return function (action) {\n      transformers.forEach(function (transformer) {\n        action = transformer(action)\n      })\n      return action\n    }\n  }\n\n  const transformers = {}\n  const actionTransformers = []\n  if (!options.exposePayloads) {\n    // If exposePayloads is disabled, include the removePayloads transformer\n    actionTransformers.push(removePayloads)\n  } else {\n    // Otherwise, we should still hide passwords\n    actionTransformers.push(passwordHider)\n  }\n  // Create the actionTransformer pipeline with the included transformers.\n  transformers.actionTransformer = actionPipeline(actionTransformers)\n\n  return transformers\n}\n\n// Redux-logger actionTransformer to prevent passwords from being logged.\nfunction passwordHider (action) {\n  if (action.meta && action.meta.isSensitive) {\n    // Only log the action name for actions that have sensitive data in them.\n    return omit('payload', action)\n  }\n  return action\n}\n\n/**\n * Helper function removes secure data if secure mode is enabled\n * @param {Object} action\n */\nfunction removePayloads (action) {\n  if (!(action.meta && action.meta.isSafe)) {\n    return omit('payload', action)\n  }\n  return action\n}\n","/**\n * Standard title formatter function is almost identical to the defaultTitleFormatter found in redux-logger\n * but removes placeholder characters previously used for styling, which is not being used in the logging\n * configuration\n *\n * @param action\n * @param time\n * @param took\n * @returns {string}\n */\nexport function titleFormatter (action, time, took) {\n  var parts = ['action']\n  parts.push(action.type)\n  parts.push('@ ' + time)\n  parts.push('(in ' + took.toFixed(2) + ' ms)')\n\n  return parts.join(' ')\n}\n","// Messaging plugin.\nimport pluginInterface from './interface'\nimport * as sagas from './sagas'\nimport eventsMap from './interface/events'\n\n// Other plugins.\nimport { mapEvents } from '../../events/interface/actions'\nimport { update as updateConfig } from '../../config/interface/actions'\n\n// Libraries.\nimport { put } from 'redux-saga/effects'\nimport { defaults, values } from 'lodash/fp'\n\n/**\n * Factory function for the CPaaS messaging plugin.\n * @method cpaasMessaging\n * @param  {Object} [options={}]\n * @return {Object} A plugin object.\n */\nexport default function cpaasMessaging (options = {}) {\n  const defaultOptions = {\n    features: ['base', 'history', 'rich', 'parts', 'isTyping']\n  }\n  options = defaults(defaultOptions, options)\n\n  function * init () {\n    yield put(updateConfig(options, pluginInterface.name))\n    yield put(mapEvents(eventsMap))\n  }\n\n  const capabilities = [\n    'sms',\n    'chat',\n    'parts',\n    'history',\n    'internalAndSmsMessaging',\n    'isTyping',\n    'richMessagingWithoutLocation',\n    'fetchConversations'\n  ]\n\n  return {\n    capabilities,\n    api: pluginInterface.api,\n    name: pluginInterface.name,\n    reducer: pluginInterface.reducer,\n    mixins: pluginInterface.mixins,\n    sagas: values(sagas),\n    init\n  }\n}\n","const PREFIX = '@@KANDY/'\n\nexport const CREATE_CONVERSATION = PREFIX + 'CREATE_CONVERSATION'\nexport const SEND_MESSAGE = PREFIX + 'SEND_MESSAGE'\nexport const SEND_MESSAGE_FINISH = PREFIX + 'SEND_MESSAGE_FINISH'\nexport const MESSAGE_RECEIVED = PREFIX + 'MESSAGE_RECEIVED'\nexport const INCOMING_MESSAGE_READ = PREFIX + 'INCOMING_MESSAGE_READ'\nexport const SEND_MESSAGE_READ = PREFIX + 'SEND_MESSAGE_READ'\nexport const SEND_MESSAGE_READ_FINISH = PREFIX + 'SEND_MESSAGE_READ_FINISH'\n\nexport const CLEAR_MESSAGES = PREFIX + 'CLEAR_MESSAGES'\nexport const CLEAR_MESSAGES_FINISH = PREFIX + 'CLEAR_MESSAGES_FINISH'\n\nexport const DELETE_CONVERSATION = PREFIX + 'DELETE_CONVERSATION'\nexport const DELETE_CONVERSATION_FINISH = PREFIX + 'DELETE_CONVERSATION_FINISH'\n\nexport const DELETE_MESSAGE = PREFIX + 'DELETE_MESSAGES'\nexport const DELETE_MESSAGE_FINISH = PREFIX + 'DELETE_MESSAGES_FINISH'\n\nexport const FETCH_CONVERSATIONS = PREFIX + 'FETCH_CONVERSATIONS'\nexport const FETCH_CONVERSATIONS_FINISHED = PREFIX + 'FETCH_CONVERSATIONS_FINISHED'\n\nexport const UPDATE_CONVERSATION = PREFIX + 'UPDATE_CONVERSATION'\n\nexport const FETCH_MESSAGES = PREFIX + 'FETCH_MESSAGES'\nexport const FETCH_MESSAGES_FINISHED = PREFIX + 'FETCH_MESSAGES_FINISHED'\n\nexport const RECEIVE_DELIVERY_RECEIPT = PREFIX + 'RECEIVE_DELIVERY_RECEIPT'\n\nexport const FILE_UPLOAD_FAIL = PREFIX + 'FILE_UPLOAD_FAIL'\n\nexport const SET_IS_TYPING = PREFIX + 'SET_IS_TYPING'\nexport const SET_IS_TYPING_FINISHED = PREFIX + 'SET_IS_TYPING_FINISHED'\n\nexport const GET_IMAGE_LINKS = PREFIX + 'GET_IMAGE_LINKS'\nexport const GET_IMAGE_LINKS_FINISH = PREFIX + 'GET_IMAGE_LINKS_FINISH'\n","import * as actionTypes from '../actionTypes'\n\n/**\n * Conversation actions.\n * Actions relating to the creation/management of conversation objects.\n */\n\n/**\n * Creates a create conversation action. Triggered when the user creates a new conversation object.\n *\n * @method createConversation\n * @param {Array<string>} destination An array of destinations for messages created in this conversation.\n * @param {Object} options The options object can contain any keys an app may want passed along into the conversation object in the store.\n * @returns {Object} A flux standard action representing the create conversation action.\n */\nexport function createConversation (destination, options) {\n  return {\n    type: actionTypes.CREATE_CONVERSATION,\n    payload: {\n      destination: destination,\n      messages: [],\n      isTypingList: [],\n      ...options\n    }\n  }\n}\n\n/**\n * Creates a fetch conversations action. This is dispatched by the API directly.\n * @param {Object} [options] An optional configuration object to query for more specific results. If no object is passed, all conversations will be retrieved\n * @method fetchConversations\n * @returns {Object} A flux standard action representing the fetch conversations action.\n */\nexport function fetchConversations (options) {\n  return {\n    type: actionTypes.FETCH_CONVERSATIONS,\n    payload: {\n      ...options\n    }\n  }\n}\n\n/**\n * Creates a fetch conversations finished action.\n * @method fetchConversationsFinished\n * @param {Object} params\n * @param {Array<conversation>} [params.conversations] An array of conversation objects, if fetch was successful\n * @param {Object} [params.error] An error object, only included if fetchConversations implementation had an error.\n * @returns {Object} A flux standard action representing the fetch conversations finished action.\n */\nexport function fetchConversationsFinished ({ conversations, error }) {\n  return {\n    type: actionTypes.FETCH_CONVERSATIONS_FINISHED,\n    payload: error || { conversations },\n    error: Boolean(error)\n  }\n}\n\n/**\n * Creates an update conversation action.\n *\n * @method updateConversation\n * @param {Object} conversation The conversation object\n * @param {Array<string>} conversation.destination An array of strings representing the destinations for messages that are sent from this conversation object. This property is always required, as it is the primary property by which conversations are organized in messaging plugin\n * @param {number} [conversation.id] The conversation object's corresponding ID\n * @param {string} [conversation.type] The conversation type, which is expected to be one of: \"chat-oneToOne\", \"chat-group\", \"sms\".\n * @returns {Object} A flux standard action representing the update conversation action.\n */\nexport function updateConversation (conversation) {\n  return {\n    type: actionTypes.UPDATE_CONVERSATION,\n    payload: conversation\n  }\n}\n\n/**\n * Deletes all the messages from a conversation.\n * @method deleteConversation\n * @param  {Array<string>} destination An array of destinations for messages created in this conversation.\n * @param {string} type The type of conversation: can be one of \"chat-oneToOne\", \"chat-group\" or \"sms\".\n * @returns {Object} A flux standard action representing the delete conversation action.\n */\nexport function deleteConversation (destination, type) {\n  return {\n    type: actionTypes.DELETE_CONVERSATION,\n    payload: {\n      destination: destination,\n      type: type\n    }\n  }\n}\n\n/**\n * Creates a delete conversations finished action.\n * @method deleteConversationFinish\n * @param {Object} params\n * @param {Array<string>} params.destination An array of destinations for messages created in this conversation.\n * @param {string} params.type The type of conversation: can be one of \"chat-oneToOne\", \"chat-group\" or \"sms\".\n * @param {Object} [params.error] An error object, only present if an error occurred.\n * @returns {Object} A flux standard action representing the delete conversation finished action.\n */\nexport function deleteConversationFinish ({ destination, type, error }) {\n  return {\n    type: actionTypes.DELETE_CONVERSATION_FINISH,\n    payload: error || { destination, type },\n    error: !!error\n  }\n}\n\n/**\n *\n * @param {Object} params\n * @param {string} params.state (active/idle) state of the typing user\n * @param {string} params.destination the target user to send the notification to\n * @returns {Object} A flux standard action representing the setIsTyping action.\n */\nexport function setIsTyping ({ state, destination, type }) {\n  return {\n    type: actionTypes.SET_IS_TYPING,\n    payload: { state, destination, type }\n  }\n}\n\n/**\n *\n * @param {Object} params\n * @param {string} params.state (active/idle) state of the typing user\n * @param {string} params.senderAddress the username of the user who sent the notification\n * @param {string} params.destination the target user to send the notification to\n * @param {string} params.type a standard error object\n * @param {BasicError} params.error a standard error object\n * @returns {Object} A flux standard action representing the setIsTyping finished action.\n */\nexport function setIsTypingFinished ({ state, senderAddress, destination, type, error }) {\n  return {\n    type: actionTypes.SET_IS_TYPING_FINISHED,\n    payload: error || { state, senderAddress, destination, type },\n    error: !!error\n  }\n}\n","import * as messageActionsImport from './messages'\nimport * as convoActionsImport from './conversations'\n// Apparently the following doesn't work:\n//      export * as newName from './place';\n// So import everything from each file, then re-export.\n\n/**\n * The messaging plugin's actions are organized into two types:\n *  - message actions: those which act on message object,\n *  - convo actions: those which act on conversation objects,\n */\nexport const messageActions = messageActionsImport\nexport const convoActions = convoActionsImport\n","import * as actionTypes from '../actionTypes'\nimport { chatTypes } from '../../../mappings'\n\n/**\n * Action helper functions.\n */\n\nfunction sendMessageHelper (actionType, destination, parts, timestamp, type, id) {\n  return {\n    type: actionType,\n    payload: {\n      destination,\n      id: id,\n      message: {\n        timestamp,\n        isPending: true,\n        read: false,\n        parts,\n        type\n      }\n    }\n  }\n}\n\nfunction messageReadHelper (actionType, messageId, participant) {\n  return {\n    type: actionType,\n    payload: { messageId, participant }\n  }\n}\n\n/**\n * Message actions.\n * Actions about the CRUD of message objects.\n */\n\n/**\n * An action fired when a delivery receipt is received\n *\n * @method deliveryReceiptReceived\n * @param {string} messageId the id of the sent message\n * @param {string} deliveryStatus the status of sent message\n * @param {Array<string>} destination An array of destinations for messages created in this conversation.\n * @param {string} type Type of message. 'chat-oneToOne', 'chat-group' or 'sms'.\n * @returns {Object} A flux standard action representing the send message action.\n */\nexport const deliveryReceiptReceived = (messageId, deliveryStatus, destination, type) => {\n  return {\n    type: actionTypes.RECEIVE_DELIVERY_RECEIPT,\n    payload: { messageId, deliveryStatus, destination, type }\n  }\n}\n\n/**\n * Creates a send message action. Triggered when the user initiates the send message process.\n *\n * @method sendMessage\n * @param {Array<string>} destination An array of destinations for messages created in this conversation.\n * @param {Array<part>} parts The message parts, as a formatted object.\n * @param {number} timestamp A timestamp for the sent message.\n * @param {string} type Type of message. 'chat-oneToOne', 'chat-group' or 'sms'.\n * @param {number} id The ID of the conversation as it exists in the back end.\n * @returns {Object} A flux standard action representing the send message action.\n */\nexport const sendMessage = (destination, parts, timestamp, type, id) =>\n  sendMessageHelper(actionTypes.SEND_MESSAGE, destination, parts, timestamp, type, id)\n\n/**\n * Creates a send message finished action. Trigged when a message send function has received a success response.\n *\n * @method sendMessageFinish\n * @param {Object} params\n * @param {Array<string>} params.destination An array of destinations for messages created in this conversation.\n * @param {string} params.sender The sender of the outgoing message.\n * @param {string} params.type The type of conversation: can be one of 'chat-oneToOne', 'chat-group' or 'sms'\n * @param {Array<part>} params.parts The message parts.\n * @param {number} params.timestamp A timestamp for the sent message.\n * @param {string} [params.messageId] The returned messageId of the message if sent successfully.\n * @param {string} [params.deliveryStatus] The status of sent message\n * @param {Object} [params.error] A basic error object\n * @returns {Object} A flux standard action representing the send message finished action.\n */\nexport const sendMessageFinish = ({\n  destination,\n  sender,\n  type,\n  parts,\n  timestamp,\n  messageId,\n  deliveryStatus,\n  error\n}) => {\n  return {\n    type: actionTypes.SEND_MESSAGE_FINISH,\n    payload: { destination, sender, type, parts, timestamp, messageId, deliveryStatus, error },\n    error: Boolean(error)\n  }\n}\n\n/**\n * Creates a message received action. Triggered when the websocket receives a chat message.\n *\n * @method messageReceived\n * @param {Array<string>} destination An array of destinations for messages created in this conversation.\n * @param {Array<part>} parts The message parts.\n * @param {string} messageId The messageId of the message that has been received.\n * @param {string} sender The user who sent the message. This is the user who the conversation is with.\n * @param {number} timestamp A timestamp for the sent message.\n * @param {Object} meta - A meta object.\n * @param {string} meta.type The type of conversation: can be one of \"chat-oneToOne\", \"chat-group\" or \"sms\".\n * @param {boolean} meta.newConversation - A boolean value indicating whether the message corresponds to a conversation not yet in the store.\n * @returns {Object} A flux standard action representing the message received action.\n */\nexport function messageReceived (\n  destination,\n  parts,\n  messageId,\n  sender,\n  timestamp,\n  meta = { type: chatTypes.ONETOONE, newConversation: false }\n) {\n  return {\n    type: actionTypes.MESSAGE_RECEIVED,\n    meta: meta,\n    payload: {\n      destination: destination,\n      message: {\n        timestamp: timestamp,\n        isPending: false,\n        read: false,\n        parts: parts,\n        sender: sender,\n        messageId: messageId\n      }\n    }\n  }\n}\n\n/**\n * Creates an incoming message read action. This triggers when we receive a \"Message Read\" notification over the websocket.\n *\n * @method incomingMessageRead\n * @param {string} messageId The unique id of the message being marked as read.\n * @param {string} participant The other pariticipant of the conversation.\n * @returns {Object} A flux standard action representing the incoming message read action.\n */\nexport const incomingMessageRead = (messageId, participant) =>\n  messageReadHelper(actionTypes.INCOMING_MESSAGE_READ, messageId, participant)\n\n/**\n * Creates a send message read action. This should send a \"mark message as read\" request to the server.\n *\n * @method sendMessageRead\n * @param {string} messageId The unique id of the message being marked as read.\n * @param {string} participant The other pariticipant of the conversation.\n * @returns {Object} A flux standard action representing the send message read action.\n */\nexport const sendMessageRead = (messageId, participant) =>\n  messageReadHelper(actionTypes.SEND_MESSAGE_READ, messageId, participant)\n\n/**\n * Creates a send message read finish action. This triggers on server response when attempting to mark a message read.\n *\n * @method sendMessageReadFinish\n * @param {Object} params\n * @param {string} params.messageId The unique id of the message being marked as read.\n * @param {string} params.participant The other participant of the conversation.\n * @param {Object} params.error A Basic error object.\n * @returns {Object} A flux standard action representing the send message read finish action.\n */\nexport function sendMessageReadFinish ({ messageId, participant, error }) {\n  return {\n    type: actionTypes.SEND_MESSAGE_READ_FINISH,\n    payload: error || { messageId, participant },\n    error: Boolean(error)\n  }\n}\n\n/**\n * Creates a fetch messages action. This is dispatched by the API directly.\n * @method fetchMessages\n * @param {Array<string>} destination An array of destinations for messages created in this conversation.\n * @param {number} amount A number representing the amount of messages to fetch.\n * @returns {Object} A flux standard action representing the fetch messages action.\n */\nexport function fetchMessages (destination, amount, type) {\n  return {\n    type: actionTypes.FETCH_MESSAGES,\n    payload: { destination, amount, type }\n  }\n}\n\n/**\n * Creates a fetch messages finished action.\n * @method fetchMessagesFinished\n * @param {Array<string>} destination An array of destinations for messages created in this conversation.\n * @param {string} type The type of conversation: can be one of \"chat-oneToOne\", \"chat-group\" or \"sms\".\n * @param {Array<message>} messages An array of formatted messages to put into the store.\n * @param {Object} [error] An error object, only present if an error occurred.\n * @returns {Object} A flux standard action representing the fetch messages finished action.\n */\nexport function fetchMessagesFinished (destination, type, messages, error) {\n  return {\n    type: actionTypes.FETCH_MESSAGES_FINISHED,\n    payload: error || { destination, type, messages },\n    error: !!error\n  }\n}\n\n/**\n * Request to clear messages from a conversation's state.\n * @method clearMessages\n * @param  {string} destination The destination for messages created in this conversation.\n * @param {string} type The type of conversation: can be one of 'chat-OneToOne', 'chat-group' or 'sms'.\n * @returns {Object} A flux standard action.\n */\nexport function clearMessages (destination, type) {\n  return {\n    type: actionTypes.CLEAR_MESSAGES,\n    payload: {\n      destination: destination,\n      type: type\n    }\n  }\n}\n\n/**\n * Request to delete all the messages from a conversation.\n * @method deleteMessage\n * @param  {string} destination The destination for messages created in this conversation.\n * @param {string} type The type of conversation: can be one of \"chat-oneToOne\", \"chat-group\" or \"sms\".\n * @param {string} messageId The ID of the message targeted for deletion\n * @returns {Object} A flux standard action.\n */\nexport function deleteMessage (destination, type, messageId) {\n  return {\n    type: actionTypes.DELETE_MESSAGE,\n    payload: {\n      destination: destination,\n      type: type,\n      messageId: messageId\n    }\n  }\n}\n\n/**\n * Creates a fetch messages finished action.\n * @method deleteMessageFinish\n * @param {Object} params\n * @param {Array} params.destination An array of destinations for messages created in this conversation.\n * @param {string} params.type The type of conversation: can be one of \"chat-oneToOne\", \"chat-group\" or \"sms\".\n * @param {string} params.messageId The ID of the message that was targeted for deletion\n * @param {Object} [params.error] An error object, only present if an error occurred.\n * @returns {Object} A flux standard action representing the fetch messages finished action.\n */\nexport function deleteMessageFinish ({ destination, type, messageId, error }) {\n  return {\n    type: actionTypes.DELETE_MESSAGE_FINISH,\n    payload: error || { destination, type, messageId },\n    error: !!error\n  }\n}\n\n/**\n * Returns a get image links action\n * @method getImageLinks\n * @param {Object} params\n * @param {Array} params.parts the different parts of the message\n * @param {string} params.destination the destination address(es)\n * @param {string} params.type The type of conversation: can be one of \"chat-oneToOne\", \"chat-group\" or \"sms\".\n * @param {string} params.messageId id for looking up the message\n * @returns {Object}\n */\nexport function getImageLinks ({ parts, destination, type, messageId }) {\n  return {\n    type: actionTypes.GET_IMAGE_LINKS,\n    payload: { parts, destination, type, messageId }\n  }\n}\n\n/**\n * Returns a get image links finish action\n * @method getImageLinksFinish\n * @param {Object} params\n * @param {string} params.url the url that returns an attachment\n * @param {string} params.rawURL the url returned when we upload an image\n * @param {Array} params.destination the destination address(es)\n * @param {string} params.type The type of conversation: can be one of \"chat-oneToOne\", \"chat-group\" or \"sms\".\n * @param {string} params.messageId id for looking up the message\n * @param {Object} [params.error] a standard error object\n * @returns {Object}\n */\nexport function getImageLinksFinish ({ url, rawURL, destination, type, messageId, error }) {\n  return {\n    type: actionTypes.GET_IMAGE_LINKS_FINISH,\n    payload: error || { url, rawURL, destination, type, messageId },\n    error: !!error\n  }\n}\n","/**\n * The messaging feature revolves around a 'conversation' namespace. It is responsible for storing the conversations\n * and its messages, and returning conversation objects when requested.\n *\n * See the \"Conversation\" and \"Message\" sections of the documentation for more details.\n *\n * Available conversations can be retrieved using the {@link conversation.get}\n *    or {@link conversation.getAll} APIs.\n *\n * Messaging functions are all part of the 'conversation' namespace. Ex: {@link messaging.getAll client.conversation.getAll}\n *\n * @public\n * @namespace conversation\n */\n\nimport { convoActions } from './actions'\nimport { getConversations as selectConversations, findConversation } from './selectors'\nimport { getLogManager, API_LOG_TAG } from '../../../logs'\nimport { chatTypes, chatTypeAliases } from '../../mappings'\n// Retrieve logger\nconst log = getLogManager().getLogger('Messaging')\n\nexport default function api (context) {\n  const messagingApi = {\n    /**\n     * Fetches chat conversations that the current user is part of. This will refresh\n     * the available information with any new information from the server.\n     *\n     * If successful, the event {@link conversation.event:conversations:change conversations:change} will be emitted.\n     *\n     * Available conversation information can be retrieved using the\n     *    {@link conversation.get} or {@link conversation.getAll} Messaging\n     *    APIs.\n     *\n     * @public\n     * @static\n     * @method fetch\n     * @memberof conversation\n     * @param {Object} [options] A configuration object to query for more specific results.\n     * @param {string} [options.type='chat-oneToOne'] The type of conversation to fetch. See {@link conversation.chatTypes} for valid types.\n     */\n    fetch: function (options = {}) {\n      log.debug(API_LOG_TAG + 'conversation.fetch: ', options)\n      // convert chat chatTypes to CPaaS values\n      if (options.type) {\n        options.type = chatTypeAliases[options.type]\n      }\n      context.dispatch(convoActions.fetchConversations(options))\n    },\n    /**\n     * Retrieves a conversation object matching the User ID and Type provided if available.\n     *\n     * Conversations are made availble using the {@link conversation.fetch} or\n     *    {@link conversation.create} Messaging APIs.\n     *\n     * @public\n     * @static\n     * @method get\n     * @memberof conversation\n     * @param {string} recipient The User ID of the remote user with which the current user had a conversation.\n     * @param {Object} [options] Options used to query for more specific results.\n     * @param {string} [options.type='chat-oneToOne'] The type of conversation to get. See {@link conversation.chatTypes} for valid types.\n     * @returns {Conversation} A Conversation object.\n     */\n    get: function (recipient, options = { type: chatTypes.ONETOONE }) {\n      log.debug(API_LOG_TAG + 'conversation.get: ', recipient, options)\n      // convert chat chatTypes to CPaaS values\n      options.type = chatTypeAliases[options.type]\n      let destination = Array.isArray(recipient) ? [...recipient] : [recipient]\n      let description = 'Conversation'\n      let messages\n      let id\n      const conversation = findConversation(context.getState(), destination, options.type)\n      if (conversation) {\n        if (options.type === conversation.type) {\n          description = conversation.description\n          messages = conversation.messages\n          id = conversation.id\n\n          return context.primitives.Conversation({\n            destination,\n            type: options.type,\n            id: id,\n            description,\n            messages: messages,\n            isTypingList: conversation.isTypingList,\n            lastReceived: conversation ? conversation.lastReceived : undefined,\n            lastPull: conversation ? conversation.lastPull : undefined\n          })\n        } else {\n          log.info(\n            'Conversation found with matching destination, but conversation type does not match the type requested. Please specify the appropriate type, or call client.conversation.create() for a new type of conversation'\n          )\n        }\n      } else {\n        log.info(\n          'Requested conversation not in state. Please use the create function if you would like a new conversation object'\n        )\n      }\n      return undefined\n    },\n    /**\n     * Creates and return a new conversation object. Any messages being sent through this Conversation\n     * object will be sent to the destination provided.\n     *\n     * If successful, the event {@link conversation.event:conversations:new conversations:new} will be emitted.\n     *\n     * @public\n     * @static\n     * @method create\n     * @memberof conversation\n     * @param {string} recipient The ID of the remote user to create a conversation with. The ID will be changed to lowercase.\n     * @param {Object} [options] Options to use when creating a new conversation object.\n     * @param {string} [options.type='chat-oneToOne'] The type of conversation to create. See {@link conversation.chatTypes} for valid types.\n     * @returns {Conversation} A Conversation object.\n     */\n    create: function (recipient, options = { type: chatTypes.ONETOONE }) {\n      log.debug(API_LOG_TAG + 'conversation.create')\n      // convert chat chatTypes to CPaaS values\n      options.type = chatTypeAliases[options.type]\n\n      const recipients = Array.isArray(recipient) ? recipient : [recipient]\n\n      const destination = recipients.map(recipient => recipient.toLowerCase())\n\n      const prevConv = findConversation(context.getState(), destination, options.type)\n\n      if (!prevConv) {\n        context.dispatch(convoActions.createConversation(destination, options))\n      }\n\n      return context.primitives.Conversation({\n        destination,\n        type: options.type\n      })\n    },\n    /**\n     * Retrieves all available conversations for the current user.\n     *\n     * Conversations are made availble using the {@link conversation.fetch} or\n     *    {@link conversation.create} Messaging APIs.\n     *\n     * @public\n     * @static\n     * @method getAll\n     * @memberof conversation\n     * @returns {Array<Conversation>} An array of Conversation objects.\n     */\n    getAll: function () {\n      log.debug(API_LOG_TAG + 'conversation.getAll')\n      const conversations = selectConversations(context.getState())\n\n      // Map conversation Objects to Conversation-Mixin Objects\n      return conversations.map(conversation => context.primitives.Conversation(conversation))\n    },\n\n    /**\n     * Possible types of conversations.\n     * @public\n     * @static\n     * @typedef {Object} chatTypes\n     * @memberof conversation\n     * @type {Object}\n     * @property {string} ONETOONE A simple chat between two users.\n     * @property {string} GROUP A chat between groups of users\n     * @property {string} SMS A chat using SMS.\n     * @example\n     * // Use the chat types to fetch group conversations.\n     * client.conversation.fetch({type: client.conversation.chatTypes.GROUP}) {\n     */\n    chatTypes\n  }\n  return { conversation: messagingApi }\n}\n","/**\n * A new conversation has been created.\n *\n * @public\n * @memberof conversation\n * @event conversations:new\n * @param {Array<Object>} params An array containing one object with information about the newly created conversation.\n * @param {Array<string>} params.destination An array of destinations for messages created in this conversation.\n * @param {string} params.type The type of conversation created. See {@link conversation.chatTypes} for valid types.\n */\nexport const CONVERSATIONS_NEW = 'conversations:new'\n\n/**\n * A change has occurred in the conversation list.\n *\n * @public\n * @memberof conversation\n * @event conversations:change\n * @param {Array<Object>} params An array of objects containing information about the conversations that have changed.\n * @param {Array<string>} params.destination An array of destinations for messages in this conversation.\n * @param {string} params.type The type of conversation changed. See {@link conversation.chatTypes} for valid types.\n */\nexport const CONVERSATIONS_CHANGE = 'conversations:change'\n\n/**\n * A change has occurred in a specific conversation's message list.\n * If a single message was created/edited, `messageId` will be present.\n *\n * @public\n * @memberof conversation\n * @event messages:change\n * @param {Object} params\n * @param {Array<string>} params.destination An array of destinations for the message affected.\n * @param {string} params.type The type of conversation. See {@link conversation.chatTypes} for valid types.\n * @param {string} [params.messageId] The ID of the message affected.\n * @param {string} [params.sender] The username of the sender.\n */\nexport const MESSAGES_CHANGE = 'messages:change'\n\n/**\n * An error occurred with messaging.\n *\n * @public\n * @memberof conversation\n * @event messages:error\n * @param {Object} params\n * @param {BasicError} params.error The Basic error object.\n */\nexport const MESSAGES_ERROR = 'messages:error'\n\n/**\n * The list of users that are currently typing has changed.\n *\n * @public\n * @requires isTyping\n * @memberof conversation\n * @event isTypingList:change\n * @param {Object} params\n * @param {Array<string>} params.destination An array of destinations in this conversation.\n * @param {string} params.sender The username of the sender that caused the event to fire.\n * @param {string} params.type The type of conversation. See {@link conversation.chatTypes} for valid types.\n * @param {string} params.state (active/idle) The current state of the sender that caused the event to fire.\n */\nexport const IS_TYPING_LIST_CHANGE = 'isTypingList:change'\n","import * as actionTypes from './actionTypes'\nimport * as eventTypes from './eventTypes'\nimport { isEqual } from 'lodash/fp'\n\nconst eventsMap = {}\n\neventsMap[actionTypes.CREATE_CONVERSATION] = function (action) {\n  return {\n    type: eventTypes.CONVERSATIONS_NEW,\n    args: {\n      destination: action.payload.destination,\n      type: action.payload.type\n    }\n  }\n}\n\neventsMap[actionTypes.SEND_MESSAGE_FINISH] = function (action) {\n  return {\n    type: eventTypes.MESSAGES_CHANGE,\n    args: {\n      destination: action.payload.destination,\n      type: action.payload.type,\n      messageId: action.payload.messageId,\n      sender: action.payload.sender\n    }\n  }\n}\n\neventsMap[actionTypes.MESSAGE_RECEIVED] = function (action) {\n  let { meta, payload } = action\n  if (meta.newConversation) {\n    return {\n      type: eventTypes.CONVERSATIONS_CHANGE,\n      args: {\n        destination: payload.destination,\n        type: meta.type,\n        messageId: payload.message.messageId\n      }\n    }\n  }\n  return {\n    type: eventTypes.MESSAGES_CHANGE,\n    args: {\n      destination: payload.destination,\n      messageId: payload.message.messageId,\n      type: meta.type\n    }\n  }\n}\n\neventsMap[actionTypes.FETCH_CONVERSATIONS_FINISHED] = function (action) {\n  if (action.error) {\n    return {\n      type: eventTypes.MESSAGING_ERROR,\n      args: { error: action.payload }\n    }\n  } else {\n    return {\n      type: eventTypes.CONVERSATIONS_CHANGE,\n      args: action.payload.conversations.map(conversation => {\n        return {\n          destination: conversation.destination,\n          type: conversation.type\n        }\n      })\n    }\n  }\n}\n\neventsMap[actionTypes.DELETE_CONVERSATION_FINISH] = function (action, { state }) {\n  if (action.error) {\n    return {\n      type: eventTypes.MESSAGES_ERROR,\n      args: { error: action.payload }\n    }\n  } else {\n    return {\n      type: eventTypes.CONVERSATIONS_CHANGE,\n      args: state.messaging.conversations.map(conversation => {\n        if (\n          !(isEqual(conversation.destination, action.payload.destination) && conversation.type === action.payload.type)\n        ) {\n          return {\n            destination: conversation.destination,\n            type: conversation.type\n          }\n        }\n      })\n    }\n  }\n}\n\neventsMap[actionTypes.FETCH_MESSAGES_FINISHED] = function (action) {\n  if (action.error) {\n    return {\n      type: eventTypes.MESSAGING_ERROR,\n      args: action.payload\n    }\n  } else {\n    return {\n      type: eventTypes.MESSAGES_CHANGE,\n      args: {\n        destination: action.payload.destination,\n        type: action.payload.type\n      }\n    }\n  }\n}\n\neventsMap[actionTypes.CLEAR_MESSAGES] = function (action) {\n  return {\n    type: eventTypes.MESSAGES_CHANGE,\n    args: action.payload\n  }\n}\n\neventsMap[actionTypes.DELETE_MESSAGE_FINISH] = function (action) {\n  if (action.error) {\n    return {\n      type: eventTypes.MESSAGES_ERROR,\n      args: action.payload\n    }\n  } else {\n    return {\n      type: eventTypes.MESSAGES_CHANGE,\n      args: {\n        destination: action.payload.destination,\n        messageId: action.payload.messageId,\n        type: action.payload.type\n      }\n    }\n  }\n}\n\neventsMap[actionTypes.RECEIVE_DELIVERY_RECEIPT] = function (action) {\n  return {\n    type: eventTypes.MESSAGES_CHANGE,\n    args: {\n      destination: action.payload.destination,\n      messageId: action.payload.messageId,\n      type: action.payload.type\n    }\n  }\n}\n\neventsMap[actionTypes.SET_IS_TYPING_FINISHED] = function (action) {\n  return {\n    type: eventTypes.IS_TYPING_LIST_CHANGE,\n    args: {\n      destination: action.payload.destination,\n      sender: action.payload.senderAddress,\n      type: action.payload.type,\n      state: action.payload.state\n    }\n  }\n}\n\neventsMap[actionTypes.GET_IMAGE_LINKS_FINISH] = function (action) {\n  return {\n    type: eventTypes.MESSAGES_CHANGE,\n    args: {\n      destination: action.payload.destination,\n      type: action.payload.type\n    }\n  }\n}\n\nexport default eventsMap\n","// Import the components of the interface.\nimport api from './api'\nimport reducer from './reducers'\nimport mixins from './mixins'\n\n/**\n * This interface is for a messaging plugin.\n * @type {string}\n */\nconst name = 'messaging'\n\nexport default {\n  name,\n  api,\n  reducer,\n  mixins\n}\n","/**\n * A Conversation object represents a conversation either between two users, or between a\n * user and a group. A user can create a Conversation using {@link conversation.create client.conversation.create} Messaging API.\n *\n * A Conversation can be used to create messages to send using the Conversation and Messaging APIs\n * {@link #conversationcreatemessage Conversation.createMessage} and {@link #messagesendersend Message.send} functions.\n *\n *\n * Once a sender sends the initial message (within a conversation) to a recipient, there will be a\n * conversation object saved in both sender and recipient's state.\n *\n * @property {string} destination The ID/group ID of the remote user with which the current user is having a conversation.\n * @property {string} address The ID of the current user who is having a conversation.\n * @property {number} lastReceived The timestamp (milliseconds since epoch) of when a message was last received in this conversation.\n * This property applies only to conversation object stored in recipient's state.\n * @property {string} type The type of conversation. See {@link conversation.chatTypes} for valid types.\n * @property {string} lastMessage The last message received.\n * @property {Array<Message>} messages The array of message objects.\n * @property {Array<string>} isTypingList The array indentifying the User IDs of the users who are currently typing.\n *\n * @public\n * @module Conversation\n * @typedef {Object} Conversation\n * @memberof conversation\n */\n// `features` and `lastPull` are not documented because they're intended to be internal\n\n/**\n * A Part is a custom object representing a section of the payload of a message. Messages can have one or many Parts.\n *\n * @property {string} type The payload type. Can be `text`, `json`, or `file`.\n * @property {string} text The text of the message. Messages with file or json attachments are still required to have text associated to it.\n * @property {Object} [json] The object corresponding to a json object to attach to a message. A `Part` cannot have both json and a file.\n * @property {File} [file] The file to attach to a message. A `Part` cannot have both json and a file.\n *\n * @public\n * @module Part\n * @typedef {Object} Part\n * @memberof conversation\n */\n\n/**\n * A Message sender object is a means by which a sender can deliver information to a recipient.\n *\n * This sender object can be obtained through the {@link #conversationcreatemessage conversation.createMessage} API on an existing conversation.\n *\n * Once all the desired parts have been added to it using the {@link #messagesenderaddpart MessageSender.addPart},\n * the message can then be sent using the send function.\n *\n * @public\n * @module MessageSender\n * @typedef {Object} MessageSender\n * @memberof conversation\n */\n\n/**\n * A Message object represents an individual message that was delivered to a recipient and it is\n * obtained through the {@link #conversationgetmessages Conversation.getMessages} or {@link #conversationgetmessage Conversation.getMessage} API on an existing conversation.\n *\n * Messages have Parts which represent pieces of a message, such as a text part, a json object part or a file part.\n *\n * Once the sender sends a message, this message is saved in sender's state as an object.\n *\n * Similarly, once the recipient gets a message, this message is saved in recipient's state.\n *\n * Below are the properties pertaining to this saved message object in either sender or recipient's state.\n *\n * @property {number} timestamp A Unix timestamp in seconds marking the time when the message was created by sender.\n * @property {boolean} isPending Whether the message is in pending state or not (delivered by server or not).\n * @property {boolean} read Whether the message was read by recipient user or not.\n * @property {Array<Part>} parts An array of Part Objects.\n * @property {string} sender The primary contact address of the sender.\n * @property {string} messageId The unique id of the message. The message object (stored in sender's state) has a different id\n * than the one associated with the message object stored in recipient's state.\n * @property {string} type The type of message that was sent. See {@link conversation.chatTypes} for valid types.\n * This property applies only to message objects stored in sender's state.\n * @property {string} deliveryStatus Tracks the status of the outgoing message ('Pending', 'Delivered', 'Failed', 'Unknown', etc).\n * This property applies only to the message object stored in sender's state.\n * @public\n * @module Message\n * @typedef {Object} Message\n * @memberof conversation\n */\n\nimport { find, includes } from 'lodash/fp'\nimport { convoActions, messageActions } from './actions'\nimport { chatTypes } from '../../mappings'\n\nimport { getMessagingConfig, findConversation } from './selectors'\nimport { getUserInfo } from '../../../auth/interface/selectors'\nimport compose from 'stampit/compose'\n// Events\nimport { emitEvent } from '../../../events/interface/actions'\nimport { MESSAGING_ERROR } from './eventTypes'\n\nimport { getLogManager } from '../../../logs'\nconst log = getLogManager().getLogger('MESSAGING')\n\n/**\n * Base conversation stamp\n *\n * @param {Array<string>} destination The destination(s) for messages being sent through\n * this conversation in this instance of the SDK. This should be an Array with any number of user IDs.\n * @param {string} [type='chat-oneToOne'] The message type. See {@link conversation.chatTypes} for valid types.\n * @param {string} [id=undefined] id The unique identifier for the conversation.\n * @param {string} [description=''] The description associated with the conversation.\n * @param {Array<Message>} [messages=[]] An array containing the conversation's messages.\n * @param {Array<string>} [isTypingList=[]] A array that represents the list of usings who are currently typing.\n * @param {number} lastReceived The timestamp associated with the last received message.\n */\nconst conversationBase = {\n  initializers: [\n    function ({\n      destination,\n      type = chatTypes.ONETOONE,\n      id = undefined,\n      description = '',\n      messages = [],\n      isTypingList = [],\n      lastReceived,\n      lastPull\n    }) {\n      this.destination = destination\n      this.type = type\n      this.description = description\n      this.messages = messages\n      this.isTypingList = isTypingList\n      this.id = id\n      const features = getMessagingConfig(this.context.getState()).features\n      if (this.destination.length === 1) {\n        const groupIndex = features.indexOf('group')\n        if (groupIndex > -1) {\n          features.splice(groupIndex, 1)\n        }\n      }\n      this.features = features\n      this.lastReceived = lastReceived\n      this.lastPull = lastPull\n      this.isPending = false\n    }\n  ],\n\n  methods: {\n    /**\n     * Creates and return a message object. You must specify a part. If this is a simple text message, provide a `text` part as demonstrated in the example below.\n     *\n     * If successful, the event {@link conversation.event:messages:change messages:change} will be emitted.\n     *\n     * @public\n     * @static\n     * @memberof conversation.Conversation\n     * @method createMessage\n     * @constructs Message\n     * @param {Part} part The Part to add to the message.\n     * @returns {Message} The newly created Message object.\n     *\n     * @example\n     * conversation.createMessage({type: 'text', text: 'This is the message'});\n     */\n    createMessage (part) {\n      if (typeof part === 'string') {\n        part = { type: 'text', text: part }\n      }\n      let parts = Array.isArray(part) ? part : [part]\n\n      const messageContext = {\n        features: this.features,\n        isGroup: this.destination.length > 1,\n        id: this.id,\n        type: this.type\n      }\n      return this.context.primitives.Message({\n        destination: this.destination,\n        parts: parts,\n        context: messageContext,\n        type: this.type\n      })\n    },\n\n    /**\n     * Clears all messages in this conversation from local state.\n     *\n     * If successful, the event {@link conversation.event:messages:change messages:change} will be emitted.\n     *\n     * @public\n     * @static\n     * @memberof conversation.Conversation\n     * @method clearMessages\n     */\n    clearMessages () {\n      this.context.dispatch(messageActions.clearMessages(this.destination, this.type))\n    },\n\n    /**\n     * Gets all messages from this conversation.\n     *\n     * @public\n     * @static\n     * @memberof conversation.Conversation\n     * @method getMessages\n     * @return {Array<Message>} An array of messages.\n     */\n    getMessages: function () {\n      const conversation = findConversation(this.context.getState(), this.destination, this.type)\n\n      return conversation.messages.map(message => {\n        if (!message.parts) {\n          log.debug('no message parts found on message, skipping message')\n          return\n        }\n        return this.getMessage(message.messageId)\n      })\n    },\n\n    /**\n     * Gets a specific message from this conversation.\n     *\n     * @public\n     * @static\n     * @method getMessage\n     * @memberof conversation.Conversation\n     * @param {string} messageId The ID of the message to retrieve.\n     * @return {Message} A message object.\n     */\n    getMessage (messageId) {\n      const convo = findConversation(this.context.getState(), this.destination, this.type)\n      const message = find(message => message.messageId === messageId)(convo.messages)\n\n      if (!message) {\n        log.debug(`Message (${messageId}) not found in conversation (${this.destination}).`)\n        return\n      }\n\n      const { parts, sender, timestamp, isFetchingLinks } = message\n      const { type, features, destination, id } = this\n      let mixinMessage = this.context.primitives.Message({\n        parts,\n        sender,\n        timestamp,\n        isFetchingLinks,\n        destination,\n        type,\n        messageId,\n        context: {\n          features,\n          id,\n          type,\n          isGroup: destination.length > 1\n        }\n      })\n\n      // TODO: Have these functions as proper mixin functions, instead of adding them manually afterwards.\n      mixinMessage.forward = participant => {\n        this.context.dispatch(\n          messageActions.sendMessage(participant, mixinMessage.parts, Date.now(), this.type, this.id)\n        )\n      }\n      // Only allow the end user to markRead on message that were incoming.\n      const userInfo = getUserInfo(this.context.getState())\n      if (mixinMessage.sender !== userInfo.username) {\n        // TODO: Have these functions as proper mixin functions, instead of adding them manually afterwards.\n        mixinMessage.markRead = () => {\n          this.context.dispatch(messageActions.sendMessageRead(mixinMessage.messageId, this.destination))\n        }\n      }\n      return mixinMessage\n    },\n\n    /**\n     * Deletes specified messages from this conversation.\n     * Provide an array of message IDs for the messages to be deleted.\n     *\n     * If successful, the event {@link conversation.event:messages:change messages:change} will be emitted.\n     *\n     * @public\n     * @static\n     * @memberof conversation.Conversation\n     * @method deleteMessages\n     * @param {Array<string>} [messageIds=[]] An array of message IDs for the messages to be deleted\n     */\n    deleteMessages: function (messageIds = []) {\n      messageIds.forEach(messageId => {\n        this.context.dispatch(messageActions.deleteMessage(this.destination, this.type, messageId))\n      })\n    },\n\n    /**\n     * Delete the conversation.\n     *\n     * If successful, the event {@link conversation.event:messages:change messages:change} will be emitted.\n     *\n     * @public\n     * @static\n     * @memberof conversation.Conversation\n     * @method delete\n     */\n    delete: function () {\n      this.context.dispatch(convoActions.deleteConversation(this.destination, this.type))\n    },\n\n    /**\n     * Subscribe to this conversation's messages list to receive notification of changes.\n     *\n     * @public\n     * @static\n     * @memberof conversation.Conversation\n     * @param {Function} subscriber A subscriber function to be triggered when the messages array of this conversation is updated.\n     * @param {string} subscriber.conversationId The conversation participant.\n     * @param {string} subscriber.messageId The ID of the message that caused the event.\n     * @return {Function} The unsubscribe function.\n     */\n    subscribe: function (subscriber) {\n      if (subscriber) {\n        // Create a subscriber wrapper to properly determine if this messages:change event is relevant to this convo\n        // TODO: we might need to change the name of `conversationId` as it is used here. Conversations have actual IDs in the backend, which are an integer value rather than an array of strings, as is the case with destination. We track conversation IDs, as they exist in the back end, as we are required to identify the conversation by `id` when performing actions in the backend on a Group Conversation.\n        const subscriberWrapper = ({ conversationId, messageId }) => {\n          if (conversationId === this.destination) {\n            subscriber({ conversationId, messageId })\n          }\n        }\n        // Subscribe to the messages:change event with the wrapped subscriber\n        this.context.api.on('messages:change', subscriberWrapper)\n\n        // Return the unsubscribe function\n        return () => {\n          this.context.api.off('messages:change', subscriberWrapper)\n        }\n      }\n    }\n  }\n}\n\n/*\n * Conversation history stamp. Handles any functions that retrieve history from the server concerning conversations.\n */\nconst conversationHistory = {\n  initializers: [\n    function () {\n      const features = getMessagingConfig(this.context.getState()).features\n      if (!includes('history', features)) {\n        const prototype = Object.getPrototypeOf(this)\n        delete prototype.fetchMessages\n      }\n      return this\n    }\n  ],\n  methods: {\n    /**\n     * Allows the user to fetch messages associated with a specific conversation to make them available.\n     * When the operation is complete, a `messages:change` event will be emitted.\n     * Messages can then be retrieved using {@link #conversationgetmessages Conversation.getMessages}.\n     *\n     * If successful, the event {@link conversation.event:messages:change messages:change} will be emitted.\n     *\n     * @public\n     * @static\n     * @memberof conversation.Conversation\n     * @method fetchMessages\n     * @param {number} [amount=50] An amount of messages to fetch.\n     */\n    fetchMessages: function (amount = 50) {\n      this.context.dispatch(messageActions.fetchMessages(this.destination, amount, this.type))\n    }\n  }\n}\n/*\n * Conversation is Typing. Responsible for updating the state of who is idling or actively typing.\n */\nconst conversationIsTyping = {\n  initializers: [\n    function () {\n      const features = getMessagingConfig(this.context.getState()).features\n      if (!includes('isTyping', features)) {\n        const prototype = Object.getPrototypeOf(this)\n        delete prototype.setIsTyping\n      }\n      return this\n    }\n  ],\n  methods: {\n    /**\n     * Sets the typing status of the conversation for the current user.\n     * Other participants will be notified of changes to the conversation's typing status.\n     *\n     * If successful, the event {@link conversation.event:isTypingList:change isTypingList:change} will be emitted.\n     *\n     * @public\n     * @static\n     * @memberof conversation.Conversation\n     * @method setIsTyping\n     * @param {boolean} isTyping Whether the user is typing or not\n     */\n    setIsTyping: function (isTyping) {\n      const typingState = isTyping ? 'active' : 'idle'\n      this.context.dispatch(\n        convoActions.setIsTyping({ state: typingState, destination: this.destination, type: this.type })\n      )\n    }\n  }\n}\n\n/*\n * Base Message stamp\n * @param {string} destination The Destination for messages being sent through\n * this conversation in this instance of the SDK. This can be one or many users,\n * separated by commas `,`\n * @param  {Object} parts Initial part to the message.\n * @param  {Object} context Information and capabilities for how the message will act with regard to the conversation.\n * @param  {Array} context.features Array of features the conversation supports.\n * @param  {string} type The type of conversation ('chat-onToOne', 'chat-group' or 'sms')\n * @param  {Function} context.send Function for sending the message.\n * @param  {number} timestamp unix timestamp in seconds\n * @param  {boolean} isFetchingLinks\n * @param  {string} sender The author of the message\n * @param  {string} messageId a unique ID for looking up the message\n * @param  {string} [type='chat-oneToOne'] The message type. See {@link conversation.chatTypes} for valid types.\n */\nconst messageBase = {\n  initializers: [\n    function ({\n      destination,\n      parts,\n      context,\n      timestamp,\n      isFetchingLinks,\n      sender,\n      messageId,\n      type = chatTypes.ONETOONE\n    }) {\n      this.destination = Array.isArray(destination) ? destination : [destination]\n      this.convoContext = context\n      this.type = type\n      this.messageId = messageId\n      this.sender = sender\n      this.timestamp = timestamp\n      this.isFetchingLinks = isFetchingLinks\n      this.parts = parts\n    }\n  ],\n  methods: {\n    /**\n     * Sends the message.\n     *\n     * @public\n     * @static\n     * @method send\n     * @memberof conversation.MessageSender\n     */\n    send () {\n      log.debug('Send message', this)\n      const dateInSeconds = (Date.now() / 1000) | 0\n      this.context.dispatch(\n        messageActions.sendMessage(this.destination, this.parts, dateInSeconds, this.type, this.convoContext.id)\n      )\n    }\n  }\n}\n\n/**\n * stamp to add message parts capabilities to a Message primitive\n * @name withParts\n * @param  {Object} context - Information and capabilities for how the message will act with regard to the conversation.\n * @param  {Array<string>} context.features - Array of features the conversation supports.\n */\nconst withParts = {\n  initializers: [\n    function ({ context: { features = [] } }) {\n      if (!includes('parts', features)) {\n        const prototype = Object.getPrototypeOf(this)\n        delete prototype.addPart\n      }\n      return this\n    }\n  ],\n  methods: {\n    /**\n     * Add an additional `Part` to a message.\n     *\n     * @public\n     * @static\n     * @memberof conversation.MessageSender\n     * @param {Part} part The `Part` to add to the message.\n     */\n    addPart (part) {\n      // Validate the part. If not valid, returns an error.\n      const validationResponse = validatePart(part, this.convoContext.features)\n      if (validationResponse instanceof Error) {\n        this.context.dispatch(emitEvent(MESSAGING_ERROR, { error: validationResponse.message }))\n      }\n      this.parts.push(part)\n    }\n  }\n}\n\n/**\n * stamp to allow creation of multimedia links\n * @name multimediaLinks\n * @param  {Object} context - Information and capabilities for how the message will act with regard to the conversation.\n * @param  {Array<string>} context.features - Array of features the conversation supports.\n */\nconst multimediaLinks = {\n  initializers: [\n    function ({ context: { features = [] } }) {\n      if (!includes('rich', features)) {\n        const prototype = Object.getPrototypeOf(this)\n        delete prototype.createImageLinks\n      }\n      return this\n    }\n  ],\n  methods: {\n    /**\n     * Creates a usable image link for the message in this `MessageSender`.\n     *\n     * @public\n     * @static\n     * @memberof conversation.MessageSender\n     */\n    createImageLinks () {\n      const { parts, destination, type, messageId } = this\n      this.context.dispatch(messageActions.getImageLinks({ parts, destination, type, messageId }))\n    }\n  }\n}\n\n/*\n * A helper function to validate inputs. Will be progressively updated as we\n * allow for more and more input types.\n */\nlet validatePart = function (part, features) {\n  if (part.hasOwnProperty('type')) {\n    let validTypeFlag = false\n    switch (part.type) {\n      case 'text':\n        validTypeFlag = true\n        break\n      case 'file':\n        validTypeFlag = features.indexOf('rich') !== -1\n        break\n      case 'location':\n        validTypeFlag = features.indexOf('rich') !== -1\n        break\n      case 'json':\n        validTypeFlag = features.indexOf('rich') !== -1\n    }\n    return validTypeFlag || new Error(`Part of type \"${part.type}\" is not supported`)\n  } else {\n    return new Error('A message part must have a type. Options are: [text, file, location, json]')\n  }\n}\n\nexport default {\n  Conversation: compose(\n    conversationBase,\n    conversationHistory,\n    conversationIsTyping\n  ),\n  Message: compose(\n    messageBase,\n    withParts,\n    multimediaLinks\n  )\n}\n","import * as actionTypes from './actionTypes'\nimport { handleActions } from 'redux-actions'\nimport { unionBy, unionWith, sortBy, isEqual } from 'lodash/fp'\n\nconst reducers = {}\n\nreducers[actionTypes.CREATE_CONVERSATION] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: [...state.conversations, { ...action.payload }]\n    }\n  }\n}\n\nreducers[actionTypes.FETCH_CONVERSATIONS_FINISHED] = {\n  next (state, action) {\n    // TODO: does not persist conversations unique to local state\n    return {\n      ...state,\n      conversations: unionWith(\n        (a, b) => isEqual(a.destination, b.destination) && a.type === b.type, // Comparator\n        action.payload.conversations,\n        state.conversations // Conversation arrays\n      )\n    }\n  }\n}\n\nreducers[actionTypes.UPDATE_CONVERSATION] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return { ...conversation, ...action.payload }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.FETCH_MESSAGES] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            isPending: true\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.FETCH_MESSAGES_FINISHED] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: sortBy('timestamp', unionBy('messageId', action.payload.messages, conversation.messages)),\n            isTypingList: [],\n            isPending: false\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.SEND_MESSAGE] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.message.type\n        ) {\n          return {\n            ...conversation,\n            messages: [...conversation.messages, action.payload.message]\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.INCOMING_MESSAGE_READ] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: conversation.messages.map(message => {\n              if (message.messageId === action.payload.messageId) {\n                return { ...message, read: true }\n              }\n              return message\n            })\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.SEND_MESSAGE_READ_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: conversation.messages.map(message => {\n              if (message.messageId === action.payload.messageId) {\n                return { ...message, read: true }\n              }\n              return message\n            })\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.MESSAGE_RECEIVED] = {\n  next (state, action) {\n    if (action.meta.newConversation) {\n      return {\n        ...state,\n        conversations: [\n          ...state.conversations,\n          {\n            destination: action.payload.destination,\n            messages: [action.payload.message],\n            type: action.meta.type,\n            lastReceived: action.payload.message.timestamp,\n            isTypingList: []\n          }\n        ]\n      }\n    } else {\n      return {\n        ...state,\n        conversations: state.conversations.map(conversation => {\n          if (isEqual(conversation.destination, action.payload.destination) && conversation.type === action.meta.type) {\n            return {\n              ...conversation,\n              messages: [...conversation.messages, action.payload.message],\n              lastReceived: action.payload.message.timestamp\n            }\n          }\n          return conversation\n        })\n      }\n    }\n  }\n}\n\nreducers[actionTypes.SEND_MESSAGE_FINISH] = (state, action) => {\n  return {\n    ...state,\n    conversations: state.conversations.map(conversation => {\n      if (isEqual(conversation.destination, action.payload.destination) && conversation.type === action.payload.type) {\n        return {\n          ...conversation,\n          messages: conversation.messages.map(message => sendMessageFinishHelper(message, action))\n        }\n      }\n      return conversation\n    })\n  }\n}\n\n// Remove all messages from the specified conversation.\nreducers[actionTypes.CLEAR_MESSAGES] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: []\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.DELETE_MESSAGE_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: conversation.messages.filter(message => message.messageId !== action.payload.messageId)\n          }\n        }\n        return conversation\n      })\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.DELETE_CONVERSATION_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.filter(\n        conversation =>\n          !(isEqual(conversation.destination, action.payload.destination) && conversation.type === action.payload.type)\n      )\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.RECEIVE_DELIVERY_RECEIPT] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: conversation.messages.map(message => {\n              if (message.messageId === action.payload.messageId) {\n                return {\n                  ...message,\n                  deliveryStatus: action.payload.deliveryStatus\n                }\n              }\n              return message\n            })\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.SET_IS_TYPING_FINISHED] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          let isTypingList = [...conversation.isTypingList]\n          if (action.payload.state === 'active') {\n            if (!conversation.isTypingList.includes(action.payload.senderAddress)) {\n              isTypingList = conversation.isTypingList.concat([action.payload.senderAddress])\n            }\n          } else if (action.payload.state === 'idle') {\n            if (conversation.isTypingList.includes(action.payload.senderAddress)) {\n              isTypingList = conversation.isTypingList.filter(username => action.payload.senderAddress !== username)\n            }\n          }\n          return {\n            ...conversation,\n            isTypingList\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.GET_IMAGE_LINKS] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: conversation.messages.map(message => {\n              // iterate over messages find ours using messageId\n              if (isEqual(message.messageId, action.payload.messageId)) {\n                return {\n                  ...message,\n                  isFetchingLinks: true\n                }\n              }\n              return message\n            })\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.GET_IMAGE_LINKS_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: conversation.messages.map(message => {\n              // iterate over messages find ours using messageId\n              if (isEqual(message.messageId, action.payload.messageId)) {\n                return {\n                  ...message,\n                  isFetchingLinks: false,\n                  parts: message.parts.map(part => {\n                    // iterate over message parts and find ours using oldURL\n                    if (isEqual(part.rawURL, action.payload.rawURL)) {\n                      return {\n                        ...part,\n                        url: action.payload.url\n                      }\n                    }\n                    return part\n                  })\n                }\n              }\n              return message\n            })\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\n/*\n * Combine all of reducers into a single reducer, with\n *      a default state of an empty array.\n */\nconst reducer = handleActions(reducers, { conversations: [], errors: [] })\nexport default reducer\n\n/**\n * sendMessageFinishHelper\n *\n * A helper function to make dealing with the messages array in SEND_MESSAGE_FINISH\n * a little bit easier.\n *\n * @param {Object} message\n * @param {Object} action\n */\nfunction sendMessageFinishHelper (message, action) {\n  if (message.timestamp === action.payload.timestamp) {\n    if (action.payload.error) {\n      message = {\n        ...message,\n        sender: action.payload.sender,\n        isPending: false,\n        messageId: null,\n        error: action.payload.error\n      }\n    } else {\n      message = {\n        ...message,\n        sender: action.payload.sender,\n        isPending: false,\n        messageId: action.payload.messageId,\n        parts: action.payload.parts\n      }\n    }\n    if (action.payload.deliveryStatus) {\n      message.deliveryStatus = action.payload.deliveryStatus\n    }\n  } else {\n    message = { ...message }\n  }\n  return message\n}\n","import { cloneDeep, isEqual } from 'lodash/fp'\nimport { chatTypes } from '../../mappings'\n\n/*\n * Redux-saga selector functions.\n * Used with the `select` effect in sagas to retrieve\n *      specific portions of the state.\n */\n\n/**\n * Retrieves the config options provided by the messaging plugin.\n * @method getMessagingConfig\n * @param  {Object} state Redux state.\n * @return {Object} config\n */\nexport function getMessagingConfig (state) {\n  return cloneDeep(state.config.messaging)\n}\n\n/**\n * Retrieves conversations from the store pertaining to messaging.\n * @method getConversations\n * @param  {Object} state Redux state.\n * @return {Array} A list of conversation objects.\n */\nexport function getConversations (state) {\n  return cloneDeep(state.messaging.conversations)\n}\n\n/**\n * Retrieves the messages from the store pertaining to a specific messaging\n * conversation.\n * @method getMessages\n * @param  {Object} state Redux state.\n * @param  {string} conversationId The conversation identifier.\n * @return {Array}  A list of message objects.\n */\nexport function getMessages (state, conversationId) {\n  return cloneDeep(state.messaging.conversations[conversationId].messages)\n}\n\n/**\n * Searches for a conversation by its destination and type. The destination represents\n * the destination for all messages being sent to this conversation from this instance of the SDK\n *\n * @method findConversation\n * @param  {Object} state Redux state.\n * @param {Array} destination A subscriber handle or a comma-separated list\n * of subscriber handles\n * @param {string} type The type of conversation: can be one of 'chat-oneToOne', 'chat-group' or 'sms'\n * @returns {Object} A conversation object.\n */\nexport function findConversation (state, destination, type = chatTypes.ONETOONE) {\n  return cloneDeep(\n    state.messaging.conversations.find(conversation => {\n      return isEqual(conversation.destination, destination) && conversation.type === type\n    })\n  )\n}\n\n/**\n * Searches for a member in a conversation and returns their name\n *\n * @method findMember\n * @param  {Object} state Redux state.\n * @param {string} destination A subscriber handle or a comma-separated list\n * of subscriber handles\n * @param id {number} User ID for the specific conversation member for whom we are searching\n * @returns {Object} A member object.\n */\nexport function findMember (state, destination, id) {\n  const conv = state.messaging.conversations.find(conversation => conversation.destination[0] === destination)\n  if (conv) {\n    return cloneDeep(conv.members.find(member => member.id === id))\n  }\n}\n","// Helpers.\nimport request from '../../request/effects'\nimport BasicError, { messagingCodes, subscriptionCodes } from '../../errors'\nimport { handleRequestError } from '../../common/helpers'\nimport { chatTypes } from '../mappings'\n\n// Libraries.\nimport log from 'loglevel'\nimport { cloneDeep, property } from 'lodash/fp'\n\n/**\n * Maps values from a nested object structure to a single object for easy use\n * assumes that each object in the list has a name and value property\n * @method _marshalData\n * @param {Array<Object>} attributes an list of objects with attributes\n * @return {Object} a remapped object that is easier to work with\n */\nfunction _marshalData (attributes) {\n  return attributes.reduce((accum, current, index) => {\n    accum[current.name] = attributes[index].value\n    return accum\n  }, {})\n}\n\n/**\n * Makes a REST request to notify other users that the user is typing\n * @method setIsTypingRequest\n * @param {Object} requestInfo\n * @param {string} destination to send the notification to\n * @param {string} state (idle/active) the state of the user typing\n * @param {string} type The type of conversation. Can be one of \"chat-oneToOne\" or \"chat-group\"\n * @param {string} [refresh='60'] a string integer representing in seconds how long before the server refreshes the state\n * @returns {Object}\n */\nexport function * setIsTypingRequest (requestInfo, destination, state, type, refresh = '60') {\n  let url\n  if (type === chatTypes.ONETOONE) {\n    url = `${requestInfo.baseURL}/cpaas/chat/v1/${requestInfo.username}/oneToOne/${destination}/adhoc/messages`\n  } else if (type === chatTypes.GROUP) {\n    url = `${requestInfo.baseURL}/cpaas/chat/v1/${requestInfo.username}/group/${destination[0]}/messages`\n  }\n  const requestOptions = {\n    url: url,\n    method: 'POST',\n    body: JSON.stringify({\n      isComposing: {\n        contenttype: 'text/plain',\n        refresh: refresh,\n        state: state,\n        lastactive: Date.now()\n      }\n    })\n  }\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: new BasicError({\n        code: messagingCodes.SET_IS_TYPING_FAIL,\n        message: 'setIsTypingRequest has failed'\n      })\n    }\n  } else {\n    return {\n      ...response.payload.body.isComposing,\n      error: false\n    }\n  }\n}\n\n/**\n * Makes a REST request to a file upload API, storing images for use later\n * @method uploadFile\n * @param {Object} requestInfo data used to make the request\n * @param {Object} file contains file data to be uploaded\n */\nexport function * uploadFile (requestInfo, file) {\n  const formData = new FormData()\n  const reqInfo = cloneDeep(requestInfo)\n\n  const placeholderData = {\n    object: {\n      attributes: { attribute: [] },\n      flags: { flag: [] }\n    }\n  }\n  formData.append('root-fields', JSON.stringify(placeholderData))\n  formData.append('raw', file, file.name)\n  const requestOptions = {\n    url: `${reqInfo.baseURL}/cpaas/nms/v1/chat/${reqInfo.username}/objects`,\n    body: formData,\n    method: 'POST'\n  }\n\n  // FormData autopopulates Content-Type with a unique Boundry\n  // we need to make sure that don't have one when we make the request\n  // request merges requestInfo and request options so delete it\n  delete reqInfo.options.headers['Content-Type'] // Needed to prevent request helper from assuming request is application/json\n  const response = yield request(requestOptions, reqInfo.options)\n\n  if (response.error) {\n    return {\n      error: new BasicError({\n        code: messagingCodes.FILE_UPLOAD_FAIL,\n        message: 'Failed to upload file'\n      })\n    }\n  } else {\n    const responseData = _marshalData(response.payload.body.object.attributes.attribute)\n    return {\n      attachment: responseData,\n      error: false\n    }\n  }\n}\n\n/**\n * Used to send Simple Chat messages\n * sends a chat message to another user (can include attachments)\n * @method sendChatMessageRequest\n * @param {Object} requestInfo\n * @param {Object} payload\n * @param {Object} payload.destination a target destination for the message\n * @param {Object} payload.textParts text parts of the message\n * @param {Object} payload.fileParts parts of the message required for sending files\n * @returns {Object}\n */\nexport function * sendChatMessageRequest (requestInfo, destination, textParts, fileParts) {\n  const url = `${requestInfo.baseURL}/cpaas/chat/${requestInfo.version}/${\n    requestInfo.username\n  }/oneToOne/${destination}/adhoc/messages`\n\n  const requestOptions = {\n    method: 'POST',\n    url: url,\n    body: JSON.stringify({\n      chatMessage: {\n        text: textParts,\n        attachment: fileParts\n      }\n    })\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Send chat message')\n    }\n  } else {\n    // Success scenario.\n    return {\n      ...response.payload.body.chatMessage,\n      error: false\n    }\n  }\n}\n\n/**\n * Used to send Group Chat messages\n * sends a chat message to another user (can include attachments)\n * @method sendGroupChatMessageRequest\n * @param {Object} requestInfo\n * @param {Object} payload\n * @param {Object} payload.destination a target destination for the message\n * @param {Object} payload.textParts text parts of the message\n * @param {Object} payload.fileParts parts of the message required for sending files\n * @returns {Object}\n */\nexport function * sendGroupChatMessageRequest (requestInfo, destination, textParts, fileParts) {\n  const url = `${requestInfo.baseURL}/cpaas/chat/${requestInfo.version}/${\n    requestInfo.username\n  }/group/${destination}/messages`\n\n  const requestOptions = {\n    method: 'POST',\n    url: url,\n    body: JSON.stringify({\n      chatMessage: {\n        text: textParts,\n        attachment: fileParts\n      }\n    })\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Send group chat message')\n    }\n  } else {\n    // Success scenario.\n    return {\n      ...response.payload.body.chatMessage,\n      error: false\n    }\n  }\n}\n\n/**\n * Used to delete chat conversation\n * @method deleteChatConversationRequest\n * @param {Object} requestInfo\n * @param {string} destination Destination associated with the conversation to delete\n * @param {string} type Type of conversation. Can be one of \"chat-oneToOne\" or \"chat-group\"\n * @returns {Object}\n */\nexport function * deleteChatConversationRequest (requestInfo, destination, type) {\n  let url\n  if (type === chatTypes.ONETOONE) {\n    url = `${requestInfo.baseURL}/cpaas/chat/v1/${requestInfo.username}/oneToOne/${destination}/adhoc/messages`\n  } else if (type === chatTypes.GROUP) {\n    url = `${requestInfo.baseURL}/cpaas/chat/v1/${requestInfo.username}/group/${destination}`\n  } else if (type === chatTypes.SMS) {\n    url = `${requestInfo.baseURL}/cpaas/smsmessaging/v1/${\n      requestInfo.username\n    }/remoteAddresses/${destination}/localAddresses/${requestInfo.senderAddress}`\n  }\n\n  const requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url: url\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  // a 404 error results when the conversation has no messages and we try to delete it\n  // there is a mismatch between the CPaaS backend and how the SDK treats conversations.\n  // See KAA-1984 for more info\n  const legitError = response => response.error && property('payload.result.code')(response) !== 404\n\n  if (legitError(response)) {\n    return {\n      error: handleRequestError(response, 'Delete conversation')\n    }\n  } else {\n    // Success scenario.\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * Used to delete chat message\n * @method deleteChatMessageRequest\n * @param {Object} requestInfo\n * @param {Object} destination Destination associated with the conversation\n * @param {Object} messageId MessageId of message to delete\n * @param {Object} type Type of conversation. Can be one of \"chat-oneToOne\" or \"chat-group\"\n * @returns {Object}\n */\nexport function * deleteChatMessageRequest (requestInfo, destination, messageId, type) {\n  let url\n  if (type === chatTypes.ONETOONE) {\n    url = `${requestInfo.baseURL}/cpaas/chat/v1/${\n      requestInfo.username\n    }/oneToOne/${destination}/adhoc/messages/${messageId}`\n  } else if (type === chatTypes.GROUP) {\n    url = `${requestInfo.baseURL}/cpaas/chat/v1/${requestInfo.username}/group/${destination}/messages/${messageId}`\n  } else if (type === chatTypes.SMS) {\n    url = `${requestInfo.baseURL}/cpaas/smsmessaging/v1/${\n      requestInfo.username\n    }/remoteAddresses/${destination}/localAddresses/${requestInfo.senderAddress}/messages/${messageId}`\n  }\n\n  const requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url: url\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Delete message')\n    }\n  } else {\n    // Success scenario.\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * Performs a REST request for a chat subscription.\n * @method chatSubscribe\n * @param  {Object} requestInfo Info needed to perform the request.\n * @param  {Object} channel\n * @return {Object}\n */\nexport function * chatSubscribe (requestInfo, channel) {\n  const requestOptions = {}\n  requestOptions.method = 'POST'\n  requestOptions.url = `${requestInfo.baseURL}/cpaas/chat/${requestInfo.version}/${requestInfo.username}/subscriptions`\n\n  requestOptions.body = JSON.stringify({\n    chatNotificationSubscription: {\n      callbackReference: {\n        notifyURL: channel.callbackURL\n      },\n      clientCorrelator: requestInfo.clientCorrelator\n    }\n  })\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: new BasicError({\n        message: 'Failed to subscribe for chat notifications.',\n        code: subscriptionCodes.CPAAS_SERVICE_SUB_FAIL\n      })\n    }\n  } else {\n    return {\n      error: false,\n      subscription: response.payload.body.chatNotificationSubscription\n    }\n  }\n}\n\n/**\n * Performs a REST request for a chat unsubscription.\n * @method chatUnsubscribe\n * @param  {Object} requestInfo Info needed to perform the request.\n * @param  {Object} subInfo Info about the subscription being ..unsubscribed.\n * @return {Object}\n */\nexport function * chatUnsubscribe (requestInfo, subInfo) {\n  const requestOptions = {}\n  requestOptions.method = 'DELETE'\n  requestOptions.responseType = 'none'\n\n  requestOptions.url =\n    `${requestInfo.baseURL}/cpaas/` +\n    `chat/${requestInfo.version}/${requestInfo.username}/` +\n    `subscriptions/${subInfo.subscriptionId}`\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: new BasicError({\n        message: 'Failed to unsubscribe from chat notifications.',\n        code: subscriptionCodes.CPAAS_SERVICE_UNSUB_FAIL\n      })\n    }\n  } else {\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * Makes a REST request to the 'Send SMS' CPaaS endpoint.\n * @method sendSMSRequest\n * @param  {Object} connection Information needed for the request.\n * @param  {Object} payload Information needed for the SMS.\n * @return {Object} Formatted response object.\n */\nexport function * sendSMSRequest (requestInfo, destination, message) {\n  let requestOptions = {}\n  requestOptions.method = 'POST'\n\n  requestOptions.url =\n    `${requestInfo.baseURL}` +\n    `/cpaas/smsmessaging/v1/${requestInfo.username}` +\n    `/outbound/${requestInfo.senderAddress}/requests`\n\n  requestOptions.body = JSON.stringify({\n    outboundSMSMessageRequest: {\n      address: [destination],\n      clientCorrelator: requestInfo.clientCorrelator,\n      outboundSMSTextMessage: {\n        message: message\n      }\n    }\n  })\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    // Request error.\n    log.debug('Failed to send SMS message.', response.error)\n    return {\n      error: new BasicError({\n        code: messagingCodes.SEND_MESSAGE_FAIL,\n        message: 'Failed to send SMS message.'\n      })\n    }\n  } else if (response.payload.error) {\n    // Server error.\n    log.debug('Failed to send SMS message.', response.payload.error)\n    return {\n      error: new BasicError({\n        code: messagingCodes.SEND_MESSAGE_FAIL,\n        message: 'Failed to send SMS message.'\n      })\n    }\n  } else {\n    // Success scenario.\n    return {\n      ...response.payload.body.outboundSMSMessageRequest,\n      error: false\n    }\n  }\n}\n\n/**\n * Performs a REST request for inbound SMS subscription.\n * @method smsInboundSubscribe\n * @param  {Object} requestInfo Info needed to perform the request.\n * @param  {Object} channelInfo\n * @return {Object}\n */\nexport function * smsInboundSubscribe (requestInfo, channelInfo) {\n  const requestOptions = {\n    method: 'POST',\n    url:\n      `${requestInfo.baseURL}/cpaas/` +\n      `smsmessaging/${requestInfo.version}/${requestInfo.username}/` +\n      `inbound/subscriptions`,\n    body: JSON.stringify({\n      subscription: {\n        callbackReference: {\n          notifyURL: channelInfo.callbackURL\n        },\n        clientCorrelator: requestInfo.clientCorrelator,\n\n        // TODO: Shouldn't this be sender address?\n        destinationAddress: requestInfo.destinationAddress\n      }\n    })\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: new BasicError({\n        message: 'Failed to subscribe for inbound SMS notifications.',\n        code: subscriptionCodes.CPAAS_SERVICE_SUB_FAIL\n      })\n    }\n  } else {\n    return {\n      error: false,\n      subscription: response.payload.body.subscription\n    }\n  }\n}\n\n/**\n * Performs a REST request for a inbound SMS unsubscription.\n * @method smsInboundUnsubscribe\n * @param  {Object} requestInfo Info needed to perform the request.\n * @param  {Object} subInfo Info about the subscription being ..unsubscribed.\n * @return {Object}\n */\nexport function * smsInboundUnsubscribe (requestInfo, subInfo) {\n  const requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url:\n      `${requestInfo.baseURL}/cpaas/` +\n      `smsmessaging/${requestInfo.version}/${requestInfo.username}/` +\n      `inbound/subscriptions/${subInfo.subscriptionId}`\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: new BasicError({\n        message: 'Failed to unsubscribe from inbound SMS notifications.',\n        code: subscriptionCodes.CPAAS_SERVICE_UNSUB_FAIL\n      })\n    }\n  } else {\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * Performs a REST request for outbound SMS subscription.\n * @method smsOutboundSubscribe\n * @param  {Object} requestInfo Info needed to perform the request.\n * @param  {Object} channelInfo\n * @return {Object}\n */\nexport function * smsOutboundSubscribe (requestInfo, channelInfo) {\n  const requestOptions = {\n    method: 'POST',\n    url:\n      `${requestInfo.baseURL}/cpaas/` +\n      `smsmessaging/${requestInfo.version}/${requestInfo.username}/` +\n      `outbound/${requestInfo.username}/subscriptions`,\n    body: JSON.stringify({\n      deliveryReceiptSubscription: {\n        callbackReference: {\n          notifyURL: channelInfo.callbackURL\n        },\n        clientCorrelator: requestInfo.clientCorrelator\n      }\n    })\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: new BasicError({\n        message: 'Failed to subscribe for outbound SMS notifications.',\n        code: subscriptionCodes.CPAAS_SERVICE_SUB_FAIL\n      })\n    }\n  } else {\n    return {\n      error: false,\n      subscription: response.payload.body.deliveryReceiptSubscription\n    }\n  }\n}\n\n/**\n * Performs a REST request for a outbound SMS unsubscription.\n * @method smsOutboundUnsubscribe\n * @param  {Object} requestInfo Info needed to perform the request.\n * @param  {Object} subInfo Info about the subscription being ..unsubscribed.\n * @return {Object}\n */\nexport function * smsOutboundUnsubscribe (requestInfo, subInfo) {\n  const requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url:\n      `${requestInfo.baseURL}/cpaas/` +\n      `smsmessaging/${requestInfo.version}/${requestInfo.username}/` +\n      `outbound/${requestInfo.username}/subscriptions/${subInfo.subscriptionId}`\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: new BasicError({\n        message: 'Failed to unsubscribe from outbound SMS notifications.',\n        code: subscriptionCodes.CPAAS_SERVICE_SUB_FAIL\n      })\n    }\n  } else {\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * Performs a REST request to fetch a list of chat sessions\n * @method fetchConversationsRequest\n * @param {Object} requestInfo\n * @return {Object} a list of chat sessions\n */\n\nexport function * fetchConversationsRequest (requestInfo, type) {\n  let url\n  if (type === chatTypes.GROUP) {\n    url = `${requestInfo.baseURL}/cpaas/chat/v1/${requestInfo.username}/group/sessions`\n  } else {\n    url = `${requestInfo.baseURL}/cpaas/chat/v1/${requestInfo.username}/oneToOne/sessions`\n  }\n\n  const requestOptions = {\n    method: 'GET',\n    url: url\n  }\n  const response = yield request(requestOptions, requestInfo.options)\n  if (response.error) {\n    return {\n      error: new BasicError({\n        message: 'Failed to fetch conversations.',\n        code: messagingCodes.FETCH_CONVERSATIONS_FAIL\n      })\n    }\n  } else {\n    // return a list of conversations\n    return {\n      chatSession: response.payload.body.chatSessionList.chatSession,\n      error: false\n    }\n  }\n}\n\n/**\n * Performs a REST request to fetch a list of messages for a particular chat conversation\n * @method fetchMessagesRequest\n * @param {Object} requestInfo\n * @param {Object} params\n * @param {string} params.destination a target email or groupId to send the message to\n * @param {string} [params.type='chat-onToOne'] The type of messages to fetch. See {@link conversation.chatTypes} for valid types.\n * @return {Object}\n */\nexport function * fetchMessagesRequest (requestInfo, { destination, type = chatTypes.ONETOONE } = {}) {\n  let url\n  if (type === chatTypes.GROUP) {\n    url = `${requestInfo.baseURL}/cpaas/chat/v1/${requestInfo.username}/group/${destination}/messages`\n  } else if (type === chatTypes.ONETOONE) {\n    url = `${requestInfo.baseURL}/cpaas/chat/v1/${requestInfo.username}/oneToOne/${destination}/adhoc/messages`\n  } else {\n    return {\n      error: new BasicError({\n        message: 'Unrecognized chat type, ensure the chat type is either \"chat-group\" or \"chat-oneToOne\"',\n        code: subscriptionCodes.FETCH_MESSAGES_FAIL\n      })\n    }\n  }\n\n  const requestOptions = { method: 'GET', url }\n\n  const response = yield request(requestOptions, requestInfo.options)\n  if (response.error) {\n    return {\n      error: new BasicError({\n        message: 'Failed to fetch chat messages.',\n        code: subscriptionCodes.FETCH_MESSAGES_FAIL\n      })\n    }\n  } else {\n    return {\n      ...response.payload.body.chatMessageList,\n      error: false\n    }\n  }\n}\n\n/**\n * Used to fetch links for images with authentication,\n * url is passed as a parameter because it is a unique url\n * returned via the uploadFile API\n * @method fetchImageLinks\n * @param {Object} requestInfo\n * @param {string} url where we get the image blob\n * @return {Object}\n */\nexport function * fetchImageLinks (requestInfo, url) {\n  const response = yield request({ url, method: 'GET', responseType: 'blob' }, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: new BasicError({\n        message: 'Failed to fetch image link.',\n        code: messagingCodes.FETCH_IMAGE_LINKS_FAIL\n      })\n    }\n  } else {\n    return {\n      blob: response.payload.body,\n      error: false\n    }\n  }\n}\n","import * as messagingSagas from './messaging'\nimport * as subsSagas from './subscriptions'\nimport * as actionTypes from '../interface/actionTypes'\nimport { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\nimport { platforms } from '../../../constants'\nimport { registerService } from '../../../subscription/interface/effects'\nimport { chatTypes } from '../../mappings'\n\n// Libraries.\nimport { takeEvery } from 'redux-saga/effects'\nimport { get, has } from 'lodash/fp'\n\n/**\n * Register For Services\n */\n\n/**\n * Saga to register the chat service with the subscription plugin.\n * Runs immediately.\n * @method registerChat\n */\nexport function * registerChat () {\n  yield registerService('chat', subsSagas.chatSubscription, subsSagas.chatUnsubscription)\n}\n\n/**\n * Saga to register the SMS service with the subscription plugin.\n * Runs immediately.\n * @method registerInboundSMS\n */\nexport function * registerInboundSMS () {\n  yield registerService('smsinbound', subsSagas.smsInboundSubscription, subsSagas.smsInboundUnsubscription)\n}\n\n/**\n * Saga to register the SMS service with the subscription plugin.\n * Runs immediately.\n * @method registerOutboundSMS\n */\nexport function * registerOutboundSMS () {\n  /*\n   * smsoutbound subscriptions are disabled because they are not supported by\n   *    the backend yet.\n   * See: KAA-1925\n   */\n  // yield registerService('smsoutbound', subsSagas.smsOutboundSubscription, subsSagas.smsOutboundUnsubscription)\n}\n\n/**\n * Chat Operations\n */\n\n/**\n * Send an outgoing Simple Chat Message\n * @method sendChatMessage\n */\nexport function * sendChatMessage () {\n  function sendChatPattern (action) {\n    return (\n      action.type === actionTypes.SEND_MESSAGE &&\n      (action.payload.message.type === chatTypes.ONETOONE || action.payload.message.type === chatTypes.GROUP)\n    )\n  }\n\n  yield takeEvery(sendChatPattern, messagingSagas.sendChatMessage)\n}\n\n/**\n * Delete a Conversation\n * @method deleteConversation\n */\nexport function * deleteConversation () {\n  yield takeEvery(actionTypes.DELETE_CONVERSATION, messagingSagas.deleteConversation)\n}\n\n/**\n * Delete a Message\n * @method deleteMessage\n */\nexport function * deleteMessage () {\n  yield takeEvery(actionTypes.DELETE_MESSAGE, messagingSagas.deleteMessage)\n}\n\n/**\n * Handle an incoming Simple Chat Message\n * @method receiveChatMessage\n */\nexport function * receiveChatMessageNotification () {\n  function incomingChatMessagePattern (action) {\n    return (\n      action.type === NOTIFICATION_RECEIVED &&\n      action.payload.chatMessageNotification &&\n      action.payload.chatMessageNotification.chatMessage &&\n      action.payload.chatMessageNotification.chatMessage['x-type'] === 'inbound'\n    )\n  }\n\n  yield takeEvery(incomingChatMessagePattern, messagingSagas.handleChatMessageNotification)\n}\n\n/**\n * SMS Operations\n */\n\n/**\n * Waits for SMS send message actions and triggers sendSMS saga\n * @method sendSMS\n */\nexport function * sendSMS () {\n  function sendSMSPattern (action) {\n    return action.type === actionTypes.SEND_MESSAGE && action.payload.message.type === chatTypes.SMS\n  }\n\n  yield takeEvery(sendSMSPattern, messagingSagas.sendSMS)\n}\n\n/**\n * Waits for incoming SMS notification actions and triggers handleIncomingSMS saga\n * @method receiveSMS\n */\nexport function * receiveSMS () {\n  // Redux-saga take() pattern.\n  function incomingSMSPattern (action) {\n    return action.type === NOTIFICATION_RECEIVED && action.payload.inboundSMSMessageNotification\n  }\n\n  yield takeEvery(incomingSMSPattern, messagingSagas.handleIncomingSMS)\n}\n\n/**\n * Waits for delivery receipts notification actions and triggers handleDeliveryReceipts saga\n * @method receiveDeliveryReceipt\n */\nexport function * receiveDeliveryReceipt () {\n  function deliveryReceiptPattern (action) {\n    return (\n      action.type === NOTIFICATION_RECEIVED &&\n      action.meta.platform === platforms.CPAAS &&\n      has('payload.deliveryInfoNotification.deliveryInfo.deliveryStatus', action)\n    )\n  }\n\n  yield takeEvery(deliveryReceiptPattern, messagingSagas.handleDeliveryReceipts)\n}\n\n/**\n * Waits for fetch conversation actions and triggers fetchChatConversations saga\n * @method fetchChatConversations\n */\nexport function * fetchConversations () {\n  function fetchConversationPattern (action) {\n    return action.type === actionTypes.FETCH_CONVERSATIONS\n  }\n  yield takeEvery(fetchConversationPattern, messagingSagas.fetchConversations)\n}\n\n/**\n * Waits for fetch message actions and triggers fetchChatMessages saga\n * @method fetchChatMessages\n */\nexport function * fetchChatMessages () {\n  function fetchConversationPattern (action) {\n    return action.type === actionTypes.FETCH_MESSAGES\n  }\n  yield takeEvery(fetchConversationPattern, messagingSagas.fetchChatMessages)\n}\n\n/**\n * Waits for isTyping notifications and triggers up[dateIsTyping saga\n * @method setIsTyping\n */\nexport function * setIsTyping () {\n  function isTypingPattern (action) {\n    return action.type === actionTypes.SET_IS_TYPING\n  }\n  yield takeEvery(isTypingPattern, messagingSagas.setIsTyping)\n}\n\n/**\n * Waits for isTyping notifications and triggers up[dateIsTyping saga\n * @method receiveIsTypingNotification\n */\nexport function * receiveIsTypingNotification () {\n  function isTypingPattern (action) {\n    return (\n      action.type === NOTIFICATION_RECEIVED &&\n      has('payload.chatMessageNotification.isComposing', action) &&\n      get('payload.chatMessageNotification.isComposing[\"x-type\"]', action) === 'inbound'\n    )\n  }\n  yield takeEvery(isTypingPattern, messagingSagas.receiveIsTypingNotification)\n}\n\n/**\n * Waits for get image links notifications and triggers getImageLinks saga\n * @method getImageLinks\n */\nexport function * getImageLinks () {\n  function getImageLinksPattern (action) {\n    return action.type === actionTypes.GET_IMAGE_LINKS\n  }\n  yield takeEvery(getImageLinksPattern, messagingSagas.getImageLinks)\n}\n","// Messaging plugin.\nimport { messageActions, convoActions } from '../interface/actions'\nimport {\n  sendSMSRequest,\n  sendChatMessageRequest,\n  sendGroupChatMessageRequest,\n  fetchConversationsRequest,\n  deleteChatConversationRequest,\n  deleteChatMessageRequest,\n  fetchMessagesRequest,\n  uploadFile,\n  setIsTypingRequest,\n  fetchImageLinks\n} from '../requests'\n\n// Other plugins.\nimport { findConversation, getMessagingConfig } from '../interface/selectors'\nimport { getRequestInfo } from '../../../auth/interface/selectors'\n\nimport { platforms } from '../../../constants'\nimport { DeliveryStatuses, chatTypes } from '../../mappings'\n\n// Libraries.\nimport { call, put, select, all } from 'redux-saga/effects'\n\n// Logging\nimport { getLogManager } from '../../../logs'\nimport BasicError, { messagingCodes } from 'kandy/src/errors'\nconst log = getLogManager().getLogger('MESSAGING')\n\n/**\n * Handles isTypingNotifications and sets isTypingList in redux state\n * @method receiveIsTypingNotification\n * @param {Object} action A 'NOTIFICATION_RECEIVED' action.\n */\nexport function * receiveIsTypingNotification (action) {\n  const {\n    state,\n    senderAddress,\n    'x-destinationAddress': destinationAddress\n  } = action.payload.chatMessageNotification.isComposing\n\n  // use helper function to get sessionType from notifications\n  const sessionType = getNotificationType(action.payload.chatMessageNotification, 'chatSession')\n  if (sessionType !== chatTypes.GROUP && sessionType !== chatTypes.ONETOONE) {\n    yield put(\n      convoActions.setIsTypingFinished({\n        error: new BasicError({\n          message: `Invalid chat type. Type must be ${chatTypes.GROUP} or ${chatTypes.ONETOONE}.`,\n          code: messagingCodes.SET_IS_TYPING_FAIL\n        })\n      })\n    )\n  }\n  // For group chat, we need to use the destinationAddress (groupId)\n  const destination = sessionType === chatTypes.ONETOONE ? senderAddress : destinationAddress\n\n  yield put(\n    convoActions.setIsTypingFinished({\n      state,\n      senderAddress: senderAddress,\n      destination: [destination],\n      type: sessionType\n    })\n  )\n}\n\n/**\n * Sets the typing status of the current user in redux state\n * @method setIsTyping\n * @param {Object} action A 'SET_IS_TYPING' action.\n */\nexport function * setIsTyping (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const type = action.payload.type\n  const response = yield call(setIsTypingRequest, requestInfo, action.payload.destination, action.payload.state, type)\n  const { state, senderAddress, 'x-destinationAddress': destination, error } = response\n\n  if (error) {\n    yield put(\n      convoActions.setIsTypingFinished({\n        error: error\n      })\n    )\n  } else {\n    yield put(\n      convoActions.setIsTypingFinished({\n        state,\n        senderAddress: senderAddress,\n        destination: [destination],\n        type: type\n      })\n    )\n  }\n}\n\n/**\n * Sends chat messages via POST request\n * @method sendChatMessage\n * @param  {Object} action A `SEND_MESSAGE` action\n */\nexport function * sendChatMessage (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  let chatResponse\n  const chatType = action.payload.message.type\n\n  let textParts = []\n  let fileParts = []\n  action.payload.message.parts.forEach(part => {\n    if (part.type === 'text') {\n      textParts = textParts.concat([part])\n    } else if (part.type === 'file') {\n      fileParts = fileParts.concat([part])\n    } else {\n      log.info('Unknown part type: ' + part.type)\n    }\n  })\n\n  // TODO: when the backend API expands its functionality this log/error should be removed\n  if (fileParts.length > 1) {\n    log.info('Too many fileParts to upload, API  doesnt currently support multiple fileParts.')\n    yield put(\n      messageActions.sendMessageFinish({\n        error: new BasicError({\n          message: 'Too many fileParts to upload, API  doesnt currently support multiple fileParts.',\n          code: messagingCodes.INVALID_FILE_PARTS\n        })\n      })\n    )\n  }\n\n  let attachmentParts = []\n  if (fileParts.length > 0) {\n    const uploadResponseList = yield all(fileParts.map(filePart => call(uploadFile, requestInfo, filePart.file)))\n\n    attachmentParts = uploadResponseList.map(response => {\n      return { ...response.attachment, type: 'file', rawURL: response.attachment.link }\n    })\n    // multimedia messaging requires a specific format for each uploaded file\n    const chatMediaParts = attachmentParts.map(part => {\n      return { name: part.name, 'x-id': part['x-id'] }\n    })\n\n    if (chatType === chatTypes.ONETOONE) {\n      chatResponse = yield call(\n        sendChatMessageRequest,\n        requestInfo,\n        action.payload.destination[0],\n        textParts[0].text,\n        chatMediaParts\n      )\n    } else if (chatType === chatTypes.GROUP) {\n      chatResponse = yield call(\n        sendGroupChatMessageRequest,\n        requestInfo,\n        action.payload.destination[0],\n        textParts[0].text,\n        chatMediaParts\n      )\n    }\n  } else {\n    // hardcoding textParts because API only allows sending one text part\n    if (chatType === chatTypes.ONETOONE) {\n      chatResponse = yield call(sendChatMessageRequest, requestInfo, action.payload.destination[0], textParts[0].text)\n    } else if (chatType === chatTypes.GROUP) {\n      chatResponse = yield call(\n        sendGroupChatMessageRequest,\n        requestInfo,\n        action.payload.destination[0],\n        textParts[0].text\n      )\n    }\n  }\n  const allParts = textParts.concat(attachmentParts)\n  let finishInfo = {\n    type: chatType,\n    destination: action.payload.destination,\n    sender: chatResponse.senderAddress,\n    deliveryStatus: chatResponse.status,\n    parts: allParts,\n    timestamp: action.payload.message.timestamp\n  }\n\n  if (chatResponse.error) {\n    yield put(\n      messageActions.sendMessageFinish({\n        ...finishInfo,\n        error: chatResponse.error\n      })\n    )\n  } else {\n    const messageId = chatResponse.resourceURL.split('/messages/')[1]\n    yield put(\n      messageActions.sendMessageFinish({\n        ...finishInfo,\n        messageId\n      })\n    )\n  }\n}\n\n/**\n * Deletes a conversation via DELETE request\n * @method deleteConversation\n * @param  {Object} action A `DELETE_CONVERSATION` action\n */\nexport function * deleteConversation (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  let deleteResponse\n  const chatType = action.payload.type\n\n  if (chatType === chatTypes.SMS) {\n    // sms delete requires originators phone number\n    const messagingConfig = yield select(getMessagingConfig)\n    requestInfo.senderAddress = messagingConfig.smsFrom || 'default'\n  }\n  deleteResponse = yield call(deleteChatConversationRequest, requestInfo, action.payload.destination[0], chatType)\n\n  if (deleteResponse.error) {\n    yield put(\n      convoActions.deleteConversationFinish({\n        type: chatType,\n        destination: action.payload.destination,\n        error: deleteResponse.error\n      })\n    )\n  } else {\n    yield put(\n      convoActions.deleteConversationFinish({\n        type: chatType,\n        destination: action.payload.destination\n      })\n    )\n  }\n}\n\n/**\n * Deletes a message via DELETE request\n * @method deleteMessage\n * @param  {Object} action A `DELETE_MESSAGE` action\n */\nexport function * deleteMessage (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  let deleteResponse\n  const chatType = action.payload.type\n  if (chatType === chatTypes.SMS) {\n    // sms delete requires originators phone number\n    const messagingConfig = yield select(getMessagingConfig)\n    requestInfo.senderAddress = messagingConfig.smsFrom || 'default'\n  }\n  deleteResponse = yield call(\n    deleteChatMessageRequest,\n    requestInfo,\n    action.payload.destination[0],\n    action.payload.messageId,\n    chatType\n  )\n\n  if (deleteResponse.error) {\n    yield put(\n      messageActions.deleteMessageFinish({\n        type: chatType,\n        destination: action.payload.destination,\n        messageId: action.payload.messageId,\n        error: deleteResponse.error\n      })\n    )\n  } else {\n    yield put(\n      messageActions.deleteMessageFinish({\n        type: chatType,\n        destination: action.payload.destination,\n        messageId: action.payload.messageId\n      })\n    )\n  }\n}\n\n/**\n * Handles incoming chat message notifications\n * @method handleChatMessageNotification\n * @param  {Object} action A `NOTIFICATION_RECEIVED` action.\n */\nexport function * handleChatMessageNotification (action) {\n  const {\n    dateTime,\n    senderAddress,\n    text,\n    attachment,\n    'x-destinationAddress': destinationAddress\n  } = action.payload.chatMessageNotification.chatMessage\n\n  // use helper function to get message type from notification\n  const messageType = getNotificationType(action.payload.chatMessageNotification, 'chatMessage')\n\n  // Grab the messageId from the end of link.href\n  const messageId = action.payload.chatMessageNotification.link[0].href.split('/messages/')[1]\n\n  let destination\n  if (messageType === chatTypes.GROUP) {\n    destination = [destinationAddress]\n  } else {\n    destination = [senderAddress]\n  }\n\n  const existingConversation = yield select(findConversation, destination, messageType)\n  const newConversation = !existingConversation\n\n  let parts = []\n  if (text) {\n    const textPart = [{ type: 'text', text }]\n    parts = parts.concat(textPart)\n  }\n\n  if (attachment) {\n    const fileParts = attachment.map(file => {\n      return {\n        type: 'file',\n        rawURL: file.link,\n        name: file.name,\n        size: file.size,\n        'x-id': file['x-id']\n      }\n    })\n    parts = parts.concat(fileParts)\n  }\n\n  yield put(\n    messageActions.messageReceived(destination, parts, messageId, senderAddress, dateTime, {\n      type: messageType,\n      newConversation: newConversation\n    })\n  )\n}\n\n/**\n * Handles delivery receipts for SMS messages via websocket messages\n * @method handleDeliveryReceipts\n * @param  {Object} action A `NOTIFICATION_RECEIVED` action representing a deliveryReceipt.\n */\nexport function * handleDeliveryReceipts (action) {\n  const deliveryInfo = action.payload.deliveryInfoNotification.deliveryInfo\n  let deliveryStatus = null\n  if (DeliveryStatuses[deliveryInfo.deliveryStatus]) {\n    deliveryStatus = DeliveryStatuses[deliveryInfo.deliveryStatus]\n  } else {\n    log.info(`Invalid deliveryStatus: ${deliveryInfo.deliveryStatus}, defaulting to Unknown`)\n    deliveryStatus = DeliveryStatuses['Unknown']\n  }\n  const messageId = deliveryInfo.messageId\n  const destination = `${deliveryInfo.address}`\n  yield put(messageActions.deliveryReceiptReceived(messageId, deliveryStatus, [destination], chatTypes.SMS))\n}\n\n/**\n * Handles \"send message\" actions specifically for SMS.\n * @method sendSMS\n * @param  {Object} action A `SEND_MESSAGE` action representing a SMS Message.\n */\nexport function * sendSMS (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  // TODO: Remove this big workaround ---\n  const messagingConfig = yield select(getMessagingConfig)\n  requestInfo.senderAddress = messagingConfig.smsFrom || 'default'\n  // END Workaround\n\n  const { destination, message } = action.payload\n  const response = yield call(sendSMSRequest, requestInfo, destination[0], message.parts[0].text)\n\n  // TODO: Do something with the rest of the information from the response?\n  //      The finish action is specific for pre-CPaaS messages, so its\n  //      awkward to pass on/store all the new information.\n  let finishInfo = {\n    sender: requestInfo.username,\n    destination: destination,\n    parts: message.parts,\n    timestamp: message.timestamp,\n    type: message.type\n  }\n\n  if (response.error) {\n    yield put(\n      messageActions.sendMessageFinish({\n        ...finishInfo,\n        deliveryStatus: DeliveryStatuses['DeliveryImpossible'],\n        error: response.error\n      })\n    )\n  } else {\n    // the ID is in the end of a string (`.../messages/<ID>`), so get it.\n    const messageId = response.resourceURL.split('/messages/')[1]\n    yield put(\n      messageActions.sendMessageFinish({\n        ...finishInfo,\n        deliveryStatus: DeliveryStatuses[response.deliveryInfoList.deliveryInfo[0].deliveryStatus],\n        messageId\n      })\n    )\n  }\n}\n\n/**\n * Saga for receiving an incoming SMS message.\n * @method handleIncomingSMS\n * @param  {Object} action A `NOTIFICATION_RECEIVED` action representing an inbound SMS.\n */\n// TODO: Have a single \"handleIncoming\" saga that handles both IM and SMS?\nexport function * handleIncomingSMS (action) {\n  const notification = action.payload.inboundSMSMessageNotification\n  let { message, messageId, senderAddress } = notification.inboundSMSMessage\n  const { dateTime } = notification\n\n  if (!senderAddress) {\n    // Incorrect property name: AEB-2485\n    senderAddress = notification.inboundSMSMessage.senderAdress\n  }\n\n  const existingConversation = yield select(findConversation, [senderAddress], chatTypes.SMS)\n  const newConversation = !existingConversation\n\n  yield put(\n    messageActions.messageReceived(\n      [senderAddress],\n      [{ type: 'text', text: message }],\n      messageId,\n      senderAddress,\n      dateTime,\n      {\n        newConversation: newConversation,\n        type: chatTypes.SMS\n      }\n    )\n  )\n}\n\n/**\n * Saga that fetches a list of Chat Conversations\n * @method fetchConversations\n * @param {Object} action A 'FETCH_CONVERSATIONS' action.\n */\nexport function * fetchConversations (action) {\n  const type = action.payload.type\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const response = yield call(fetchConversationsRequest, requestInfo, type)\n\n  if (response.error) {\n    yield put(\n      convoActions.fetchConversationsFinished({\n        error: response.error\n      })\n    )\n  } else {\n    const chatSessions = response.chatSession.map(chatSession => {\n      const { sessionId, sessionType, remoteAddress, localAddress, sessionDetails } = chatSession\n      const { lastText, lastPullTime, lastMessageTime } = sessionDetails\n\n      return {\n        id: sessionId,\n        destination: [remoteAddress],\n        address: localAddress,\n        type: chatTypes[sessionType.toUpperCase()],\n        lastMessage: lastText,\n        lastReceived: lastMessageTime,\n        lastPull: lastPullTime,\n        isTypingList: [],\n        messages: []\n      }\n    })\n\n    yield put(\n      convoActions.fetchConversationsFinished({\n        conversations: chatSessions,\n        error: false\n      })\n    )\n  }\n}\n\n/**\n * Saga that fetches all chat messages for a particular conversation\n * @method fetchChatMessages\n * @param {Object} action A 'FETCH_MESSAGES' action.\n */\nexport function * fetchChatMessages (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const response = yield call(fetchMessagesRequest, requestInfo, {\n    destination: action.payload.destination[0],\n    type: action.payload.type\n  })\n\n  const messageList = response.chatMessage.map(message => {\n    let parts = []\n    if (message.text) {\n      parts = parts.concat({ type: 'text', text: message.text })\n    }\n    if (message.attachment) {\n      parts = parts.concat(\n        message.attachment.map(attachment => {\n          return {\n            type: 'file',\n            ...attachment,\n            rawURL: attachment.link,\n            name: attachment.name\n          }\n        })\n      )\n    }\n\n    return {\n      parts: parts,\n      sender: message.senderAddress,\n      destination: message['x-destinationAddress'],\n      timestamp: message.dateTime,\n      messageId: message.resourceURL.split('/messages/')[1] // messageID is after /messages/ in the resourceURL\n    }\n  })\n\n  if (response.error) {\n    yield put(\n      messageActions.fetchMessagesFinished(action.payload.destination, action.payload.type, null, response.error)\n    )\n  } else {\n    yield put(messageActions.fetchMessagesFinished(action.payload.destination, action.payload.type, messageList, null))\n  }\n}\n\n/**\n * Creates URLs for multimedia attachments and dispatches an action to update the store with the new url\n * @param {Object} action A 'GET_IMAGE_LINKS' action.\n */\nexport function * getImageLinks (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const { parts, destination, type, messageId } = action.payload\n  const fileParts = parts.filter(part => part.type === 'file')\n  const responseList = yield all(fileParts.map(filePart => call(fetchImageLinks, requestInfo, filePart.rawURL)))\n\n  yield all(\n    responseList.map((response, index) => {\n      if (response.error) {\n        return put(messageActions.getImageLinksFinish({ error: response.error }))\n      } else {\n        // create a url from the blob and save it to the store.\n        const url = URL.createObjectURL(response.blob)\n        return put(\n          messageActions.getImageLinksFinish({\n            url,\n            rawURL: fileParts[index].rawURL,\n            destination,\n            type,\n            messageId\n          })\n        )\n      }\n    })\n  )\n}\n\n/**\n * Helper function to determine the session or message type from the notification.\n * @param {Object} notification\n * @param {string} notificationType\n * @return {string} resourceType\n */\nfunction getNotificationType (notification, notificationType) {\n  // determine type of resource by parsing the notification link\n  const link = notification.link.find(link => link.rel === notificationType)\n  let resourceType\n  if (link) {\n    resourceType = getResourceType(link.href)\n  }\n  return resourceType\n}\n\n/**\n * Helper function to determine the resource type from the resourceURL.\n * @param {string} resourceURL\n * @return {string} resourceType\n */\nfunction getResourceType (resourceURL) {\n  // determine type of resource by looking for '/group/' or '/oneToOne' in the string\n  // determine if the href is for a group type resource by searching for\n  // '/path-string/path-string/path-string/group/' in the link's href\n  let resourceType\n  if (resourceURL.search(/\\/\\S*\\/\\S*\\/\\S*\\/group\\//) !== -1) {\n    resourceType = chatTypes.GROUP\n    // determine if the href is for a chat type resource by searching for\n    // '/path-string/path-string/path-string/oneToOne/' in the link's href\n  } else if (resourceURL.search(/\\/\\S*\\/\\S*\\/\\S*\\/oneToOne\\//) !== -1) {\n    resourceType = chatTypes.ONETOONE\n  } else {\n    log.info('Unknown chat type.')\n  }\n  return resourceType\n}\n","// Messaging plugin.\nimport {\n  chatSubscribe,\n  chatUnsubscribe,\n  smsOutboundSubscribe,\n  smsOutboundUnsubscribe,\n  smsInboundSubscribe,\n  smsInboundUnsubscribe\n} from '../requests'\nimport { getMessagingConfig } from '../interface/selectors'\n\n// Other plugins.\nimport { getRequestInfo } from '../../../auth/interface/selectors'\nimport { getNotificationChannels } from '../../../subscription/interface/selectors'\nimport { reportSubscriptionFinished, reportUnsubscriptionFinished } from '../../../subscription/interface/actions'\n\nimport BasicError, { subscriptionCodes } from '../../../errors'\nimport { platforms } from '../../../constants'\n// Libraries.\nimport { call, put, select } from 'redux-saga/effects'\nimport log from 'loglevel'\n\n/**\n * Plugin chat subscription saga.\n * Handles subscribing to the chat service needed for the messaging plugin.\n * @method chatSubscription\n */\nexport function * chatSubscription (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const channels = yield select(getNotificationChannels)\n  const channel = channels.notificationChannels[action.payload.type]\n\n  log.info(`Subscribing to chat service on ${action.payload.type} channel.`)\n\n  const response = yield call(chatSubscribe, requestInfo, channel)\n\n  if (response.error) {\n    yield put(\n      // TODO: Create a subscription effect for this?\n      reportSubscriptionFinished({\n        service: 'chat',\n        type: action.payload.type,\n        error: response.error\n      })\n    )\n  } else {\n    yield put(\n      reportSubscriptionFinished({\n        service: 'chat',\n        type: action.payload.type,\n        subscription: response.subscription\n      })\n    )\n  }\n}\n\n/**\n * Plugin chat unsubscription saga.\n * Handles unsubscribing from chat service needed for the messaging plugin.\n * @method chatUnsubscription\n */\nexport function * chatUnsubscription (action) {\n  const { subscriptions } = yield select(getNotificationChannels)\n  let chatSubscription = subscriptions.filter(sub => {\n    return sub.service === 'chat' && sub.channelType === action.payload.type\n  })\n\n  if (chatSubscription.length === 0) {\n    // This scenario should not occur because we should not be able to subscribe\n    //    to an already subscribed-to service.\n    log.debug(`No chat subscription on ${action.payload.type} channel found to unsubscribe.`)\n    yield put(\n      reportUnsubscriptionFinished({\n        error: new BasicError({\n          message: 'Multiple chat subscriptions found. Cannot unsubscribe.',\n          code: subscriptionCodes.CPAAS_UNSUBSCRIBE_FAIL\n        }),\n        service: 'chat',\n        type: action.payload.type\n      })\n    )\n    return\n  } else if (chatSubscription.length > 1) {\n    // \"Error\" scenario, why are there more than 1 chat subscriptions?\n    // TODO: Report ...something.\n    yield put(reportUnsubscriptionFinished())\n    return\n  } else {\n    chatSubscription = chatSubscription[0]\n  }\n\n  log.info(`Unsubcribing from chat service on ${action.payload.type} channel.`)\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  const response = yield call(chatUnsubscribe, requestInfo, chatSubscription)\n\n  yield put(\n    reportUnsubscriptionFinished({\n      ...response,\n      service: 'chat',\n      type: action.payload.type\n    })\n  )\n}\n\n/**\n * Subscription saga for inbound SMS notifications.\n * @method smsInboundSubscription\n * @param  {Object} action\n */\nexport function * smsInboundSubscription (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const channels = yield select(getNotificationChannels)\n  const channel = channels.notificationChannels[action.payload.type]\n\n  // TODO: Remove this workaround -----\n  const messagingConfig = yield select(getMessagingConfig)\n  requestInfo.destinationAddress = messagingConfig.smsFrom\n  // END Workaround -----\n\n  log.debug(`Subscribing to SMS inbound service on ${action.payload.type} channel.`)\n  const response = yield call(smsInboundSubscribe, requestInfo, channel)\n\n  yield put(\n    reportSubscriptionFinished({\n      ...response,\n      service: 'smsinbound',\n      type: action.payload.type\n    })\n  )\n}\n\n/**\n * Unsubscription saga for inbound SMS notifications.\n * @method smsInboundUnsubscription\n * @param  {Object} action\n */\nexport function * smsInboundUnsubscription (action) {\n  const { subscriptions } = yield select(getNotificationChannels)\n  let smsSubscription = subscriptions.filter(sub => {\n    return sub.service === 'smsinbound' && sub.channelType === action.payload.type\n  })\n\n  if (smsSubscription.length === 1) {\n    smsSubscription = smsSubscription[0]\n\n    log.debug(`Unsubscribing from inbound SMS service on ${action.payload.type} channel.`)\n    const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n    const response = yield call(smsInboundUnsubscribe, requestInfo, smsSubscription)\n\n    yield put(\n      reportUnsubscriptionFinished({\n        ...response,\n        service: 'smsinbound',\n        type: action.payload.type\n      })\n    )\n  } else {\n    // \"Error\" scenario: Should only be one subscription like this.\n  }\n}\n\n/**\n * Subscription saga for outbound SMS notifications.\n * @method smsOutboundSubscription\n * @param  {Object} action\n */\nexport function * smsOutboundSubscription (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const channels = yield select(getNotificationChannels)\n  const channel = channels.notificationChannels[action.payload.type]\n\n  log.debug(`Subscribing to SMS outbound service on ${action.payload.type} channel.`)\n  const response = yield call(smsOutboundSubscribe, requestInfo, channel)\n\n  yield put(\n    reportSubscriptionFinished({\n      ...response,\n      service: 'smsoutbound',\n      type: action.payload.type\n    })\n  )\n}\n\n/**\n * Unsubscription saga for outbound SMS notifications.\n * @method smsOutboundUnsubscription\n * @param  {Object} action\n */\nexport function * smsOutboundUnsubscription (action) {\n  const { subscriptions } = yield select(getNotificationChannels)\n  let smsSubscription = subscriptions.filter(sub => {\n    return sub.service === 'smsoutbound' && sub.channelType === action.payload.type\n  })\n\n  if (smsSubscription.length === 1) {\n    smsSubscription = smsSubscription[0]\n\n    log.debug(`Unsubscribing from outbound SMS service on ${action.payload.type} channel.`)\n    const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n    const response = yield call(smsOutboundUnsubscribe, requestInfo, smsSubscription)\n\n    yield put(\n      reportUnsubscriptionFinished({\n        ...response,\n        service: 'smsoutbound',\n        type: action.payload.type\n      })\n    )\n  } else {\n    // \"Error\" scenario: Should only be one subscription like this.\n  }\n}\n","// Statuses we receive from the REST responses/websocket messages\nexport const DeliveryStatuses = {\n  DeliveredToNetwork: 'Pending',\n  DeliveredToTerminal: 'Delivered',\n  DeliveryImpossible: 'Failed',\n  Unknown: 'Unknown'\n}\n\n/**\n * Chat types\n * Chat types used in the cpaas messaging plugin\n * @name chatTypes\n */\nexport const chatTypes = {\n  SMS: 'sms',\n  ONETOONE: 'chat-oneToOne',\n  GROUP: 'chat-group'\n}\n\n// Aliases for chatTypes to allow previous chat types such as 'im', and 'group'\n// to be used as well as 'chat-oneToOne' and 'chat-group'.\nexport const chatTypeAliases = {\n  sms: chatTypes.SMS,\n  'chat-oneToOne': chatTypes.ONETOONE,\n  im: chatTypes.ONETOONE,\n  'chat-group': chatTypes.GROUP,\n  group: chatTypes.GROUP\n}\n","// Notification plugin.\nimport { api, reducer, name } from '../../notifications/interface'\nimport events from '../../notifications/interface/events'\nimport * as sagas from './sagas'\n\n// Other plugins.\nimport { mapEvents } from '../../events/interface/actions'\nimport { update as updateConfig } from '../../config/interface/actions'\n\n// Libraries.\nimport { put } from 'redux-saga/effects'\nimport { defaultsDeep, values } from 'lodash/fp'\n\n/**\n * Configuration options for the notification feature.\n * @public\n * @name config.notifications\n * @memberof config\n * @instance\n * @param {Object} notifications - The notifications configuration object.\n * @param {number} [notifications.idCacheLength=100] - Default amount of event ids to remember for de-duplication purposes.\n */\n\n/**\n * CPaaS Notifications plugin factory.\n * @method notifications\n * @param {configs.notifications} options - Configuration options for authentication.\n * @return {Object} plugin - A notifications plugin.\n */\nexport default function notifications (options = {}) {\n  const defaultOptions = {\n    idCacheLength: 100\n  }\n  const pluginOptions = defaultsDeep(defaultOptions, options)\n\n  function * init () {\n    yield put(updateConfig(pluginOptions, name))\n    yield put(mapEvents(events))\n  }\n\n  const capabilities = []\n\n  return {\n    name,\n    capabilities,\n    init,\n    api,\n    reducer,\n    sagas: values(sagas)\n  }\n}\n","// Notification plugin.\nimport * as actions from '../../notifications/interface/actions'\nimport * as actionTypes from '../../notifications/interface/actionTypes'\nimport { getNotificationsInfo, getNotificationConfig } from '../../notifications/interface/selectors'\n\n// Logs\nimport { getLogManager } from '../../logs'\nimport { put, select, take } from 'redux-saga/effects'\n\n// Get the logger\nconst log = getLogManager().getLogger('NOTIFICATION')\n\n/**\n * Tries to find the id of the notification.\n *\n * CPaaS notifications do not have a consistent path to their ID.\n * The ID is one level down in the object, but we need to dynamically\n * find the key that its in.\n *\n * @param {Object} notification\n * @returns The notification id if it finds one, undefined otherwise.\n */\nfunction findNotificationId (notification) {\n  for (let key in notification) {\n    if (notification[key].id) {\n      return notification[key].id\n    }\n  }\n}\n\nexport function * processNotifications () {\n  const config = yield select(getNotificationConfig)\n  const idCache = []\n\n  /**\n   * Checks whether a notification has already been received,\n   *      judging by its event ID.\n   * @method isDuplicate\n   * @param  {string} id\n   * @return {boolean}\n   */\n  function isDuplicate (id) {\n    if (idCache.indexOf(id) !== -1) {\n      return true // duplicate.\n    } else {\n      // Not a duplicate.\n      idCache.push(id)\n      if (idCache.length > config.idCacheLength) {\n        idCache.shift()\n      }\n\n      return false\n    }\n  }\n\n  while (true) {\n    const { payload: notification, meta } = yield take(actionTypes.PROCESS_NOTIFICATION)\n\n    // Only process notifications from enabled channels, ie. \"silence\" the channel.\n    let channel = yield select(getNotificationsInfo, meta.channel)\n    if (!channel.channelEnabled) {\n      log.debug('Notification received on disabled channel. Ignoring it.', meta.channel)\n      continue\n    }\n\n    // Find the unique ID of the received notification.\n    const notificationId = findNotificationId(notification)\n    if (!notificationId) {\n      log.error('Received notification without a findable ID.', Object.keys(notification))\n      continue\n    }\n\n    if (!isDuplicate(notificationId)) {\n      // Notify others (plugins) that a new notification was receive.\n      yield put(actions.notificationReceived(notification, meta.platform))\n\n      // Finish processing the notification.\n      yield put(actions.processNotificationFinish(notification))\n    } else {\n      const error = new Error(`Notification id ${notificationId} is duplicate.`)\n      yield put(actions.processNotificationFinish(error))\n    }\n  }\n}\n","const prefix = '@@KANDY/'\n\nexport const PROCESS_NOTIFICATION = prefix + 'PROCESS_NOTIFICATION'\nexport const PROCESS_NOTIFICATION_FINISH = prefix + 'PROCESS_NOTIFICATION_FINISH'\nexport const NOTIFICATION_RECEIVED = prefix + 'NOTIFICATION_RECEIVED'\n\nexport const ENABLE_NOTIFICATION_CHANNEL = prefix + 'ENABLE_NOTIFICATION_CHANNEL'\nexport const ENABLE_NOTIFICATION_CHANNEL_FINISH = prefix + 'ENABLE_NOTIFICATION_CHANNEL_FINISH'\n","import * as actionTypes from './actionTypes'\n// Constants\nimport { platforms } from '../../constants'\n\n/**\n * Helper function for funneling all notification types into a single action.\n * @method notificationHelper\n * @param  {string} channel - The channel that the notification came from.\n * @param  {Object} notification\n * @param  {string} platform\n * @return {Object} A flux standard action.\n */\nfunction notificationHelper (channel, notification, platform) {\n  return {\n    type: actionTypes.PROCESS_NOTIFICATION,\n    payload: notification,\n    meta: {\n      platform,\n      channel\n    }\n  }\n}\n\n/**\n * Represents an application request to process a websocket notification.\n * @method websocketNotification\n * @param  {Object} notification\n * @param  {string} platform\n * @return {Object} A flux standard action.\n */\nexport function websocketNotification (notification, platform = platforms.LINK) {\n  return notificationHelper('WEBSOCKET', notification, platform)\n}\n\n/**\n * Represents an application request to process an external notification.\n * @method externalNotification\n * @param  {Object} notification\n * @param  {string} [channel='EXTERNAL'] - The channel that the notification came from.\n * @return {Object} A flux standard action.\n */\nexport function externalNotification (notification, channel = 'EXTERNAL', platform) {\n  // TODO: Are external notifications _only_ for Link?\n  return notificationHelper(channel.toUpperCase(), notification, platform)\n}\n\n/**\n * Represents a received notification.\n * @method notificationReceived\n * @param  {Object} notification\n * @param  {string} platform\n * @return {Object} A flux standard action.\n */\nexport function notificationReceived (notification, platform) {\n  return {\n    type: actionTypes.NOTIFICATION_RECEIVED,\n    payload: notification,\n    error: notification instanceof Error,\n    meta: {\n      platform\n    }\n  }\n}\n\n/**\n * Represents a received notification.\n * @method processNotificationFinish\n * @param  {Object} notification\n * @param  {string} platform\n * @return {Object} A flux standard action.\n */\nexport function processNotificationFinish (notification, platform) {\n  return {\n    type: actionTypes.PROCESS_NOTIFICATION_FINISH,\n    payload: notification,\n    error: notification instanceof Error,\n    meta: {\n      platform\n    }\n  }\n}\n\n/**\n * Represents a request to change a notification channel status.\n * @method enableNotificationChannel\n * @param  {string} channel - The notification channel being affected.\n * @param  {Object} params\n * @param  {boolean} params.channelEnabled - Whether to enable the channel or not.\n * @return {Object} A flux standard action.\n */\nexport function enableNotificationChannel (channel, params = {}) {\n  return {\n    type: actionTypes.ENABLE_NOTIFICATION_CHANNEL,\n    payload: {\n      ...params\n    },\n    meta: {\n      channel\n    }\n  }\n}\n\n/**\n * Represents the response of a change in a notification channel status.\n * @method enableNotificationChannelFinish\n * @param  {string} channel - The notification channel being affected.\n * @param  {Object} $1\n * @param  {Object} $1.params - Information about the channel change.\n * @param  {Object} $1.params.channelEnabled - Whether the channel was enabled or not.\n * @param  {Object} $1.error - Error object, in the case of an error.\n * @return {Object} A flux standard action.\n */\nexport function enableNotificationChannelFinish (channel, { params, error } = {}) {\n  var action = {\n    type: actionTypes.ENABLE_NOTIFICATION_CHANNEL_FINISH,\n    meta: {\n      channel\n    }\n  }\n\n  if (error) {\n    action.error = true\n    action.payload = new Error(error)\n    action.payload.channelEnabled = params.channelEnabled\n  } else {\n    action.payload = {\n      ...params\n    }\n  }\n\n  return action\n}\n","/**\n * The 'notification' namespace allows user to register/deregister for/from push notifications as well as\n * enabling/disabling the processing of websocket notifications.\n *\n * @public\n * @requires externalNotifications\n * @namespace notification\n */\n\nimport * as actions from './actions'\nimport { platforms } from '../../constants'\n\nimport { getLogManager, API_LOG_TAG } from '../../logs'\n\nconst log = getLogManager().getLogger('NOTIFICATION')\n\n/**\n * Notifications API.\n * @method api\n * @param {Function} dispatch The redux store's dispatch function.\n * @return {Object} api  The notifications API object.\n */\nexport default function api ({ dispatch }) {\n  const notificationApi = {\n    /**\n     * Provides an external notification to the system for processing.\n     *\n     * @public\n     * @requires externalNotifications\n     * @memberof notification\n     * @method process\n     * @param {Object} notification\n     * @param {string} [channel] - The channel that the notification came from.\n     */\n    process (notification, channel, platform = platforms.LINK) {\n      log.debug(API_LOG_TAG + 'notification.process: ', notification, channel, platform)\n      dispatch(actions.externalNotification(notification, channel, platform))\n    },\n\n    /**\n     * Registers a device token for push notifications.\n     *\n     * @public\n     * @requires push\n     * @memberof notification\n     * @method registerPush\n     * @param {Object} params\n     * @param {string} params.deviceToken - The device token to be registered.\n     * @param {string[]} params.services - Array of services to register for.\n     * @param {string} params.pushProvider - The push provider, can be either 'apple' or 'google'.\n     * @param {string} params.clientCorrelator - Unique identifier for a client device.\n     */\n    registerPush (params) {\n      log.debug(API_LOG_TAG + 'notification.registerPush', params)\n      dispatch(\n        actions.enableNotificationChannel('PUSH', {\n          ...params,\n          channelEnabled: true\n        })\n      )\n    },\n\n    /**\n     * Deregisters for push notifications.\n     *\n     * @public\n     * @requires push\n     * @memberof notification\n     * @method deregisterPush\n     */\n    deregisterPush () {\n      log.debug(API_LOG_TAG + 'notification.deregisterPush')\n      dispatch(\n        actions.enableNotificationChannel('PUSH', {\n          channelEnabled: false\n        })\n      )\n    },\n\n    /**\n     * Enables, or disables, the processing of websocket notifications.\n     *\n     * @public\n     * @requires push\n     * @memberof notification\n     * @method enableWebsocket\n     * @param {boolean} enable - Whether the websocket channel should be enabled.\n     */\n    enableWebsocket (enable) {\n      log.debug(API_LOG_TAG + 'notification.enableWebsocket: ', enable)\n      dispatch(\n        actions.enableNotificationChannel('WEBSOCKET', {\n          channelEnabled: enable\n        })\n      )\n    }\n  }\n\n  return { notification: notificationApi }\n}\n","/**\n * Push notifications registration state has changed.\n *\n * @public\n * @requires push\n * @memberof notification\n * @event notifications:change\n * @param {Object} params\n * @param {string} params.channel The channel for the notification.\n */\nexport const NOTI_CHANGE = 'notifications:change'\n\n/**\n * An error occured with push notifications.\n *\n * @public\n * @requires push\n * @memberof notification\n * @event notifications:error\n * @param {Object} params\n * @param {BasicError} params.error The Basic error object.\n * @param {string} params.channel The channel for the notification.\n */\nexport const NOTI_ERROR = 'notifications:error'\n\n/**\n * A notification was received by the SDK.\n *\n * @private This is an undocumented feature.\n *\n * @event notification:received\n * @param {Object} params Object that has information about the notification.\n * @param {Object} params.payload The payload of the notification.\n */\nexport const NOTI_RECEIVED = 'notification:received'\n","import * as eventTypes from './eventTypes'\nimport * as actionTypes from './actionTypes'\n\nvar events = {}\n\nevents[actionTypes.ENABLE_NOTIFICATION_CHANNEL_FINISH] = function (action) {\n  if (action.error) {\n    return {\n      type: eventTypes.NOTI_ERROR,\n      args: { channel: action.meta.channel, error: action.payload }\n    }\n  } else {\n    return {\n      type: eventTypes.NOTI_CHANGE,\n      args: { channel: action.meta.channel }\n    }\n  }\n}\n\nevents[actionTypes.NOTIFICATION_RECEIVED] = function (action) {\n  if (!action.error) {\n    return {\n      type: eventTypes.NOTI_RECEIVED,\n      args: { payload: action.payload }\n    }\n  }\n}\n\nexport default events\n","import reducer from './reducers'\nimport api from './api'\n\nconst name = 'notifications'\n\nexport { name, api, reducer }\n","import * as actionTypes from './actionTypes'\nimport { WS_CONNECT_FINISHED } from '../../connectivity/interface/actionTypes'\nimport { handleActions } from 'redux-actions'\n\nconst reducers = {}\n\nreducers[actionTypes.ENABLE_NOTIFICATION_CHANNEL_FINISH] = {\n  next (state, action) {\n    let channel = action.meta.channel\n    let enabled = action.payload.channelEnabled\n\n    let newChannelState\n    if (enabled) {\n      newChannelState = {\n        ...state[channel],\n        ...action.payload\n      }\n    } else {\n      // If the channel is being disabled, clear old state.\n      newChannelState = {\n        ...action.payload\n      }\n    }\n\n    return {\n      ...state,\n      [channel]: newChannelState\n    }\n  }\n}\n\n/*\n * The websocket channel is assumed to be enabled when the\n *      websocket is opened.\n */\nreducers[WS_CONNECT_FINISHED] = {\n  next (state) {\n    // TODO: Link WS only?\n    return {\n      ...state,\n      WEBSOCKET: {\n        ...state.WEBSOCKET,\n        channelEnabled: true\n      }\n    }\n  }\n}\n\n// Default notifications sub-state.\nconst defaultState = {\n  WEBSOCKET: {\n    channelEnabled: false\n  },\n  PUSH: {\n    channelEnabled: false\n  },\n  EXTERNAL: {\n    channelEnabled: true\n  }\n}\n\n/**\n * Notifications reducer.\n * @method reducer\n * @param  {Object}  state - The current redux state.\n * @param  {Object}  action - A flux standard action.\n * @return {Object}  - The new redux state.\n */\nconst reducer = handleActions(reducers, defaultState)\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\n\n/**\n * Retrieves the notifications state.\n * @method getNotificationsInfo\n * @param  {String} [channel] - Specific notification channel information to retrieve.\n * @return {Object}\n */\nexport function getNotificationsInfo (state, channel = undefined) {\n  if (channel) {\n    return state.notifications[channel]\n  } else {\n    return state.notifications\n  }\n}\n\n/**\n * Retrieves notification config.\n * @method getNotificationConfig\n * @return {Object}\n */\nexport function getNotificationConfig (state) {\n  return cloneDeep(state.config.notifications)\n}\n","/**\n * The valid status values\n * @name STATUS\n * @type {Object}\n */\nexport const STATUS = {\n  OPEN: 'Open',\n  CLOSED: 'Closed'\n}\n\n/**\n * The valid activities values\n * @name ACTIVITY\n * @type {Object}\n */\nexport const ACTIVITY = {\n  AVAILABLE: 'Available',\n  BUSY: 'Busy',\n  LUNCH: 'Lunch',\n  VACATION: 'Vacation',\n  ON_THE_PHONE: 'OnThePhone',\n  ACTIVITIES_UNKNOWN: 'ActivitiesUnknown',\n  ACTIVITIES_OTHER: 'ActivitiesOther'\n}\n","// Presence plugin.\nimport { api, reducer } from '../interface'\nimport * as sagas from './sagas'\nimport events from '../interface/events'\nimport { STATUS, ACTIVITY } from './constants'\n\n// Other plugins.\nimport { mapEvents } from '../../events/interface/actions'\n\n// Libraries.\nimport { put } from 'redux-saga/effects'\nimport { values } from 'lodash/fp'\n\nconst name = 'presence'\n\nconst capabilities = ['presence']\n\nexport default () => {\n  // Add plugin-specific things to the API.\n  function augmentedApi (context) {\n    const newApi = api(context)\n    /**\n     * Possible presence status values.\n     * @public\n     * @static\n     * @memberof presence\n     * @type {Object}\n     * @property {string} OPEN\n     * @property {string} CLOSED\n     * @example\n     * const { statuses, activities } = client.presence\n     * // Use the values when updating presence.\n     * client.presence.update(statuses.OPEN, activities.AVAILABLE)\n     */\n    newApi.presence.statuses = STATUS\n    /**\n     * Possible presence activity values.\n     * @public\n     * @static\n     * @memberof presence\n     * @type {Object}\n     * @property {string} AVAILABLE\n     * @property {string} BUSY\n     * @property {string} LUNCH\n     * @property {string} VACATION\n     * @property {string} ON_THE_PHONE\n     * @property {string} ACTIVITIES_UNKNOWN\n     * @property {string} ACTIVITIES_OTHER\n     * @example\n     * const { statuses, activities } = client.presence\n     * // Use the values when updating presence.\n     * client.presence.update(statuses.OPEN, activities.AVAILABLE)\n     */\n    newApi.presence.activities = ACTIVITY\n    return newApi\n  }\n\n  return {\n    name,\n    capabilities,\n    api: augmentedApi,\n    reducer,\n    init: () => [put(mapEvents(events))],\n    sagas: values(sagas)\n  }\n}\n","// Presence plugin.\nimport { ACTIVITY } from '../constants'\n\n// Helpers.\nimport request from '../../../request/effects'\nimport { handleRequestError } from '../../../common/helpers'\n\n/**\n * REST request to create a new presence source with initial presence state.\n * @method publish\n * @param  {Object} userPresence\n * @param  {string} userPresence.status - user presence status\n * @param  {string} userPresence.activity - user presence activity\n * @param  {string} userPresence.note - user presence note\n * @param  {Object} requestInfo\n * @return {Object}\n */\nexport function * publish ({ status, activity, note }, requestInfo) {\n  let requestBody = {\n    presenceSource: {\n      clientCorrelator: requestInfo.clientCorrelator,\n      presence: {\n        person: {\n          'overriding-willingness': {\n            overridingWillingnessValue: status\n          },\n          activities: {\n            activityValue: activity\n          }\n        }\n      }\n    }\n  }\n  if (note && activity === ACTIVITY.ACTIVITIES_OTHER) {\n    requestBody.presenceSource.presence.person.activities.other = note\n  }\n\n  const requestOptions = {\n    method: 'POST',\n    url: `${requestInfo.baseURL}/cpaas/presence/${requestInfo.version}/` + `${requestInfo.username}/presenceSources`,\n    body: JSON.stringify(requestBody)\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Presence publish')\n    }\n  } else {\n    return response.payload.body.presenceSource\n  }\n}\n\n/**\n * REST request to create a new presence list.\n * @method createList\n * @param  {string} user User ID of presentity\n * @param  {Object} requestInfo\n * @return {Object}\n */\nexport function * createList (user, requestInfo) {\n  let requestBody = {\n    presenceList: {\n      'x-listName': 'myList',\n      presenceContact: user\n    }\n  }\n\n  const requestOptions = {\n    method: 'POST',\n    url: `${requestInfo.baseURL}/cpaas/presence/${requestInfo.version}/${requestInfo.username}/presenceLists`,\n    body: JSON.stringify(requestBody)\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Create presence list')\n    }\n  } else {\n    return response.payload.body.presenceList\n  }\n}\n/**\n * REST request to delete a presence list.\n * @method deleteList\n * @param  {string} presenceListId Resource ID of the presenceList\n * @param  {Object} requestInfo\n * @return {Object}\n */\nexport function * deleteList (presenceListId, requestInfo) {\n  const requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url:\n      `${requestInfo.baseURL}/cpaas/presence/${requestInfo.version}/` +\n      `${requestInfo.username}/presenceLists/${presenceListId}`\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Delete presence list')\n    }\n  } else {\n    return response\n  }\n}\n\n/**\n * REST request to retrieve a presence list.\n * @method getList\n * @param  {string} presenceListId Resource ID of the presenceList\n * @param  {Object} requestInfo\n * @return {Object}\n */\nexport function * getList (presenceListId, requestInfo) {\n  const requestOptions = {\n    method: 'GET',\n    url:\n      `${requestInfo.baseURL}/cpaas/presence/${requestInfo.version}/` +\n      `${requestInfo.username}/presenceLists/${presenceListId}`\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Get presence list')\n    }\n  } else {\n    return response\n  }\n}\n/**\n * REST request to retrieve all presence lists.\n * @method getPresenceLists\n * @param  {Object} requestInfo\n * @return {Object}\n */\nexport function * getPresenceLists (requestInfo) {\n  const requestOptions = {\n    method: 'GET',\n    url: `${requestInfo.baseURL}/cpaas/presence/${requestInfo.version}/` + `${requestInfo.username}/presenceLists`\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Get presence lists')\n    }\n  } else {\n    return response.payload.body.presenceListCollection\n  }\n}\n\n/**\n * REST request to retrieve presence states of requested presentities.\n * @method retrievePresence\n * @param  {Array} users Array of userId's\n * @param  {Object} requestInfo\n * @return {Object}\n */\nexport function * retrievePresence (users, requestInfo) {\n  let adhocPresenceList = {\n    adhocPresenceList: {\n      presentityUserId: users\n    }\n  }\n\n  const requestOptions = {\n    method: 'POST',\n    url: `${requestInfo.baseURL}/cpaas/presence/${requestInfo.version}/` + `${requestInfo.username}/adhocPresenceList`,\n    body: JSON.stringify(adhocPresenceList)\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Fetch users presence')\n    }\n  } else {\n    return response.payload.body.presenceList\n  }\n}\n/**\n * REST request to add a new presentity to the presence list.\n * @method addUser\n * @param  {string} user userId\n * @param  {string} presenceListId Resource ID of the presenceList\n * @param  {Object} requestInfo\n * @return {Object}\n */\nexport function * addUser (userId, presenceListId, requestInfo) {\n  let presenceContact = {\n    presenceContact: {\n      presentityUserId: userId\n    }\n  }\n\n  const requestOptions = {\n    method: 'PUT',\n    url:\n      `${requestInfo.baseURL}/cpaas/presence/${requestInfo.version}/` +\n      `${requestInfo.username}/presenceLists/${presenceListId}/` +\n      `presenceContacts/${userId}`,\n    body: JSON.stringify(presenceContact)\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Add presence user')\n    }\n  } else {\n    return response.payload.body.presenceContact\n  }\n}\n/**\n * REST request to delete a presentity from a presence list.\n * @method removeUser\n * @param  {string} user userId\n * @param  {string} presenceListId Resource ID of the presenceList\n * @param  {Object} requestInfo\n * @return {Object}\n */\nexport function * removeUser (userId, presenceListId, requestInfo) {\n  const requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url:\n      `${requestInfo.baseURL}/cpaas/presence/${requestInfo.version}/` +\n      `${requestInfo.username}/presenceLists/${presenceListId}/` +\n      `presenceContacts/${userId}`\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Remove presence user')\n    }\n  } else {\n    return response.payload.result\n  }\n}\n","// Presence plugin.\n\n// Helpers.\nimport request from '../../../request/effects'\nimport { handleRequestError } from '../../../common/helpers'\n\n/**\n * REST request to create a presence list subscription.\n * @method subscribe\n * @param  {string} presenceListId Resource ID of the presenceList\n * @param  {string} callbackURL Callback URL of websocket channel\n * @param  {Object} requestInfo\n * @return {Object}\n */\nexport function * subscribe (presenceListId, callbackURL, requestInfo) {\n  let presenceListSubscription = {\n    presenceListSubscription: {\n      callbackReference: {\n        notifyURL: callbackURL\n      },\n      clientCorrelator: requestInfo.clientCorrelator,\n      duration: 86400\n    }\n  }\n\n  let requestOptions = {\n    method: 'POST',\n    url:\n      `${requestInfo.baseURL}/cpaas/presence/${requestInfo.version}/` +\n      `${requestInfo.username}/subscriptions/presenceListSubscriptions/` +\n      `${presenceListId}`,\n    body: JSON.stringify(presenceListSubscription)\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Subscribe to presence list')\n    }\n  } else {\n    return response.payload.body\n  }\n}\n\n/**\n * REST request to delete a subscription against a presence list.\n * @method unsubscribe\n * @param  {string} presenceListId Resource ID of the presenceList\n * @param  {string} subscriptionId Resource ID of the subscription\n * @param  {Object} requestInfo\n * @return {Object}\n */\nexport function * unsubscribe (presenceListId, subscriptionId, requestInfo) {\n  let requestOptions = {\n    method: 'DELETE',\n    responseType: 'none',\n    url:\n      `${requestInfo.baseURL}/cpaas/presence/${requestInfo.version}/` +\n      `${requestInfo.username}/subscriptions/presenceListSubscriptions/` +\n      `${presenceListId}/${subscriptionId}`\n  }\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    return {\n      error: handleRequestError(response, 'Unsubscribe from presence list')\n    }\n  } else {\n    return response.payload.body\n  }\n}\n","/**\n * Presence saga index.\n * Defines which actions trigger which sagas.\n */\n\n// Presence plugin.\nimport * as subscriptionSagas from './subscriptions'\nimport * as presenceSagas from './presence'\nimport * as actionTypes from '../../interface/actionTypes'\n\n// Other plugins.\nimport { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\n\n// Libraries.\nimport { takeEvery } from 'redux-saga/effects'\nimport { registerService } from '../../../subscription/interface/effects'\n\n/**\n * Register the presence service for subscriptions.\n * @method registerPresence\n */\nexport function * registerPresence () {\n  yield registerService('presence', subscriptionSagas.presenceSubscribe, subscriptionSagas.presenceUnsubscribe)\n}\n\n/**\n * Presence operations.\n */\n\n/**\n * Subscribe user presence.\n * @method subscribePresence\n */\nexport function * subscribePresence () {\n  yield takeEvery(actionTypes.SUBSCRIBE, presenceSagas.subscribePresence)\n}\n\n/**\n * Unsubscribe user presence.\n * @method unsubscribePresence\n */\nexport function * unsubscribePresence () {\n  yield takeEvery(actionTypes.UNSUBSCRIBE, presenceSagas.unsubscribePresence)\n}\n\n/**\n * Update user presence.\n * @method updatePresence\n */\nexport function * updatePresence () {\n  yield takeEvery(actionTypes.UPDATE, presenceSagas.updatePresence)\n}\n\n/**\n * Fetch user(s) presence.\n * @method fetchPresence\n */\nexport function * fetchPresence () {\n  yield takeEvery(actionTypes.GET, presenceSagas.fetchPresence)\n}\n\nexport function * receivePresence () {\n  yield takeEvery(\n    action => action.type === NOTIFICATION_RECEIVED && action.payload.presenceNotification,\n    presenceSagas.handleIncomingPresence\n  )\n}\n","// Presence plugin.\nimport { publish, retrievePresence, addUser, removeUser } from '../requests/presence'\nimport * as actions from '../../interface/actions'\n\n// Other plugins.\nimport { getRequestInfo } from '../../../auth/interface/selectors'\nimport { getLogManager } from '../../../logs'\nimport { getNotificationChannels } from '../../../subscription/interface/selectors'\n\n// Helpers.\nimport { platforms } from '../../../constants'\nimport { STATUS, ACTIVITY } from '../constants'\nimport BasicError, { presenceCodes } from '../../../errors'\n\n// Libraries.\nimport { call, put, select } from 'redux-saga/effects'\n\nconst log = getLogManager().getLogger('PRESENCE')\n\n/**\n * Map of old presence activity values to new values.\n * @type {Object}\n */\nconst activityMapUcToCPaaS = {\n  active: ACTIVITY.AVAILABLE,\n  idle: ACTIVITY.BUSY,\n  away: ACTIVITY.BUSY,\n  lunch: ACTIVITY.LUNCH,\n  other: ACTIVITY.ACTIVITIES_OTHER,\n  busy: ACTIVITY.BUSY,\n  vacation: ACTIVITY.VACATION,\n  'on-the-phone': ACTIVITY.ON_THE_PHONE,\n  unknown: ACTIVITY.ACTIVITIES_UNKNOWN\n}\n\n/*\n * Map of old presence status values to new values.\n * @type {Object}\n */\nconst statusMapUcToCPaaS = {\n  open: STATUS.OPEN,\n  closed: STATUS.CLOSED\n}\n\n/**\n * Update presence.\n * @method updatePresence\n * @param  {Object} action An action of type `PUBLISH_PRESENCE`.\n */\nexport function * updatePresence ({ payload }) {\n  // Convert the status to the CPaaS value (if required)\n  if (payload.status in statusMapUcToCPaaS) {\n    payload.status = statusMapUcToCPaaS[payload.status]\n  }\n\n  // Convert the activity to the CPaaS value (if required)\n  if (payload.activity in activityMapUcToCPaaS) {\n    payload.activity = activityMapUcToCPaaS[payload.activity]\n  }\n\n  // Verify that the status value is a valid CPaaS values\n  if (Object.values(STATUS).indexOf(payload.status) === -1) {\n    log.info('Could not update presence: Invalid status.')\n    yield put(\n      actions.updatePresenceFinish(\n        new BasicError({\n          code: presenceCodes.INVALID_STATUS,\n          message: 'Invalid status in presence update request.'\n        })\n      )\n    )\n    return\n  }\n\n  // Verify that the activity value is a valid CPaaS value\n  if (Object.values(ACTIVITY).indexOf(payload.activity) === -1) {\n    log.info('Could not update presence: Invalid activity.')\n    yield put(\n      actions.updatePresenceFinish(\n        new BasicError({\n          code: presenceCodes.INVALID_ACTIVITY,\n          message: 'Invalid activity in presence update request.'\n        })\n      )\n    )\n    return\n  }\n\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const response = yield call(publish, payload, requestInfo)\n  log.debug('Received response from getRequestInfo request:', response)\n\n  if (!response.error) {\n    let presenceValues = {}\n    presenceValues.status = response.presence.person['overriding-willingness'].overridingWillingnessValue\n    presenceValues.activity = response.presence.person.activities.activityValue\n    presenceValues.note = response.presence.person.activities.other\n\n    yield put(actions.updatePresenceFinish(presenceValues))\n  } else {\n    yield put(actions.updatePresenceFinish(response.error))\n  }\n}\n\n/**\n * fetchPresence.\n * @method fetchPresence\n * @param  {Array<string>|string} users A single userId or array of userIds\n */\nexport function * fetchPresence ({ payload }) {\n  const users = payload\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  const response = yield call(retrievePresence, users, requestInfo)\n  log.debug('Received response from retrievePresence request:', response)\n\n  if (!response.error) {\n    yield put(actions.getPresenceFinish(response))\n  } else {\n    yield put(actions.getPresenceFinish(response.error))\n  }\n}\n\n/**\n * subscribePresence.\n * @method subscribePresence\n * @param  {string} userId userId\n */\nexport function * subscribePresence ({ payload }) {\n  const userId = payload\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  // get current presenceListId\n  const subscriptions = yield select(getNotificationChannels)\n  var presenceSubscription = subscriptions.subscriptions.filter(function (sub) {\n    return sub.service === 'presence'\n  })\n  const presenceListId = presenceSubscription[0].presenceListId\n  const response = yield call(addUser, userId, presenceListId, requestInfo)\n  log.debug('Received response from addUser request:', response)\n\n  if (!response.error) {\n    yield put(actions.subscribePresenceFinish(response))\n  } else {\n    yield put(actions.subscribePresenceFinish(response.error))\n  }\n}\n/**\n * unsubscribePresence.\n * @method unsubscribePresence\n * @param  {string} userId userId\n */\nexport function * unsubscribePresence ({ payload }) {\n  const userId = payload\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  // get current presenceListId\n  const subscriptions = yield select(getNotificationChannels)\n  var presenceSubscription = subscriptions.subscriptions.filter(function (sub) {\n    return sub.service === 'presence'\n  })\n  const presenceListId = presenceSubscription[0].presenceListId\n\n  const response = yield call(removeUser, userId, presenceListId, requestInfo)\n  log.debug('Received response from removeUser request:', response)\n\n  if (!response.error) {\n    yield put(actions.unsubscribePresenceFinish(userId))\n  } else {\n    yield put(actions.unsubscribePresenceFinish(response.error))\n  }\n}\n\n/**\n * handle incoming presence notification.\n * @method handleIncomingPresence\n * @param  {string} userId userId\n */\nexport function * handleIncomingPresence (wsAction) {\n  const notification = wsAction.payload.presenceNotification\n  //\n  if (notification.presence) {\n    let presence = {}\n    presence.userId = notification.presentityUserId\n    presence.activity = notification.presence.person.activities.activityValue\n    presence.status = notification.presence.person['overriding-willingness'].overridingWillingnessValue\n    presence.note = notification.presence.person.activities.other\n    yield put(actions.presenceReceived(presence))\n  }\n}\n","// Presence plugin.\nimport { getPresenceLists, createList } from '../requests/presence'\nimport { subscribe, unsubscribe } from '../requests/subscriptions'\n\n// Other plugins.\nimport { reportSubscriptionFinished, reportUnsubscriptionFinished } from '../../../subscription/interface/actions'\nimport { getRequestInfo } from '../../../auth/interface/selectors'\nimport { getLogManager } from '../../../logs'\nimport { getNotificationChannels } from '../../../subscription/interface/selectors'\n\n// Helpers.\nimport { platforms } from '../../../constants'\n\n// Libraries.\nimport { call, put, select } from 'redux-saga/effects'\n\nconst log = getLogManager().getLogger('PRESENCE')\n\n/**\n * Subscription saga. Creates a new presence subscription channel.\n * @method presenceSubscribe\n */\nexport function * presenceSubscribe () {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const channels = yield select(getNotificationChannels)\n\n  const callbackURL = channels.notificationChannels.websocket.callbackURL\n\n  // either use an existing presence list, or create a new one\n  const presenceListResponse = yield call(getPresenceLists, requestInfo)\n  log.debug('Received presenceLists response:', presenceListResponse)\n\n  // check if there is a presence list already\n  let presenceListId, newListResponse\n  if (!presenceListResponse.error) {\n    // check if there is an existing presenceList\n    if (presenceListResponse.presenceList.length > 0) {\n      const url = presenceListResponse.presenceList[0].resourceURL\n      if (url) {\n        let lastIndex = url.lastIndexOf('/')\n        presenceListId = url.slice(lastIndex + 1)\n      }\n    } else {\n      //  create a new presenceList\n      newListResponse = yield call(createList, [], requestInfo)\n\n      if (newListResponse.error) {\n        yield put(\n          reportSubscriptionFinished({\n            service: 'presence',\n            type: 'websocket',\n            error: newListResponse.error\n          })\n        )\n        return\n      }\n\n      const resourceURL = newListResponse.resourceURL\n      if (resourceURL) {\n        presenceListId = resourceURL.substring(resourceURL.lastIndexOf('/') + 1)\n      }\n    }\n  } else {\n    yield put(\n      reportSubscriptionFinished({\n        service: 'presence',\n        type: 'websocket',\n        error: presenceListResponse.error\n      })\n    )\n    return\n  }\n\n  // Subscribe to the presence list subscription\n  const response = yield call(subscribe, presenceListId, callbackURL, requestInfo)\n  log.debug('Received subscribe presence response:', response)\n\n  if (response.error) {\n    yield put(\n      reportSubscriptionFinished({\n        service: 'presence',\n        type: 'websocket',\n        error: response.error\n      })\n    )\n  } else {\n    yield put(\n      reportSubscriptionFinished({\n        service: 'presence',\n        type: 'websocket',\n        subscription: response.presenceListSubscription\n      })\n    )\n  }\n}\n\n/**\n * Unsubscription saga. Deletes an existing presence subscription.\n * @method presenceUnsubscribe\n */\nexport function * presenceUnsubscribe (action) {\n  const { subscriptions } = yield select(getNotificationChannels)\n  let presenceSubscription = subscriptions.filter(sub => {\n    return sub.service === 'presence' && sub.channelType === action.payload.type\n  })\n\n  if (presenceSubscription.length === 0) {\n    // \"Error\" scenario: Can't unsubscribe to a service\n    //    that we don't have.\n  } else if (presenceSubscription.length > 1) {\n    // \"Error\" scenario: There shouldn't be able to have\n    //    more than 1 of the same service.\n  } else {\n    presenceSubscription = presenceSubscription[0]\n  }\n  const presenceListId = presenceSubscription.presenceListId\n  const subscription = presenceSubscription.subscriptionId\n  const subscriptionId = subscription.substring(subscription.lastIndexOf('/') + 1)\n\n  log.info(`Unsubscribing from presence service on ${action.payload.type} channel.`)\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n  // Unsubscribe from the presence list subscription\n  const response = yield call(unsubscribe, presenceListId, subscriptionId, requestInfo)\n\n  yield put(\n    reportUnsubscriptionFinished({\n      ...response,\n      service: 'presence',\n      type: action.payload.type\n    })\n  )\n}\n","const prefix = '@@KANDY/PRESENCE/'\n\nexport const UPDATE = prefix + 'UPDATE'\nexport const UPDATE_FINISH = prefix + 'UPDATE_FINISH'\nexport const GET = prefix + 'GET'\nexport const GET_FINISH = prefix + 'GET_FINISH'\nexport const SUBSCRIBE = prefix + 'SUBSCRIBE'\nexport const SUBSCRIBE_FINISH = prefix + 'SUBSCRIBE_FINISH'\nexport const UNSUBSCRIBE = prefix + 'UNSUBSCRIBE'\nexport const UNSUBSCRIBE_FINISH = prefix + 'UNSUBSCRIBE_FINISH'\nexport const RECEIVED = prefix + 'RECEIVED'\nexport const CREATE_PRESENCE_LIST = prefix + 'CREATE_PRESENCE_LIST'\nexport const CREATE_PRESENCE_LIST_FINISH = prefix + 'CREATE_PRESENCE_LIST_FINISH'\nexport const DELETE_PRESENCE_LIST = prefix + 'DELETE_PRESENCE_LIST'\nexport const GET_PRESENCE_LIST = prefix + 'GET_PRESENCE_LIST'\n","// Presence plugin.\nimport * as actionTypes from './actionTypes'\n\n// Other plugins.\nimport BasicError from '../../errors'\n\n/**\n * Update the presence for the current user\n * @param  {string} status   The status of the presence state\n * @param  {string} activity The activity to be shown as presence state\n * @param  {string} note     The note to be shown as alternative presence state\n *                           which is determined by the user. The note entry is\n *                           effective on the remote sip client when the\n *                           activity is other.\n * @return {Object}          A Flux Standard Action for UPDATE_PRESENCE\n */\nexport function updatePresence (status, activity, note) {\n  return {\n    type: actionTypes.UPDATE,\n    payload: {\n      status,\n      activity,\n      note\n    }\n  }\n}\n\nexport function updatePresenceFinish (payload) {\n  return {\n    type: actionTypes.UPDATE_FINISH,\n    error: payload instanceof Error || payload instanceof BasicError,\n    payload\n  }\n}\n\n/**\n * Get the presence for the given user(s)\n * @param  {string} users  A user id or an array of user ids.\n * @return {Object}        A Flux Standard Action for GET_PRESENCE\n */\nexport function getPresence (users) {\n  return {\n    type: actionTypes.GET,\n    payload: users\n  }\n}\n\nexport function getPresenceFinish (payload) {\n  return {\n    type: actionTypes.GET_FINISH,\n    error: payload instanceof Error || payload instanceof BasicError,\n    payload\n  }\n}\n\n/**\n * Subscribe to the presence for the given user(s)\n * @param  {string} users  A user id or an array of user ids.\n * @return {Object}        A Flux Standard Action for SUBSCRIBE_PRESENCE\n */\nexport function subscribePresence (users) {\n  return {\n    type: actionTypes.SUBSCRIBE,\n    payload: users\n  }\n}\n\nexport function subscribePresenceFinish (payload) {\n  return {\n    type: actionTypes.SUBSCRIBE_FINISH,\n    error: payload instanceof Error || payload instanceof BasicError,\n    payload\n  }\n}\n\n/**\n * Unsubscribe from the presence for the given user(s)\n * @param  {string} users  A user id or an array of user ids.\n * @return {Object}        A Flux Standard Action for UNSUBSCRIBE_PRESENCE\n */\nexport function unsubscribePresence (users) {\n  return {\n    type: actionTypes.UNSUBSCRIBE,\n    payload: users\n  }\n}\n\nexport function unsubscribePresenceFinish (payload) {\n  return {\n    type: actionTypes.UNSUBSCRIBE_FINISH,\n    error: payload instanceof Error || payload instanceof BasicError,\n    payload\n  }\n}\n\n/**\n * Create a new presence list\n * @param  {string} users  A user id or an array of user ids.\n * @return {Object}        A Flux Standard Action for UNSUBSCRIBE_PRESENCE\n */\nexport function createPresenceList (users) {\n  return {\n    type: actionTypes.CREATE_PRESENCE_LIST,\n    payload: users\n  }\n}\n\n/**\n * Delete a presence list\n * @param  {string} presenceListId  The ID of the presence list to delete.\n * @return {Object}                 A Flux Standard Action for UNSUBSCRIBE_PRESENCE\n */\nexport function deletePresenceList (presenceListId) {\n  return {\n    type: actionTypes.DELETE_PRESENCE_LIST,\n    payload: presenceListId\n  }\n}\n\n/**\n * Retrieve a presence list\n * @param  {string} presenceListId  The ID of the presence list to delete.\n * @return {Object}                 A Flux Standard Action for UNSUBSCRIBE_PRESENCE\n */\nexport function getPresenceList (presenceListId) {\n  return {\n    type: actionTypes.GET_PRESENCE_LIST,\n    payload: presenceListId\n  }\n}\n\nexport function createListFinish (payload) {\n  return {\n    type: actionTypes.CREATE_LIST_FINISH,\n    error: payload instanceof Error || payload instanceof BasicError,\n    payload\n  }\n}\n\nexport function presenceReceived (presence) {\n  return {\n    type: actionTypes.RECEIVED,\n    payload: presence\n  }\n}\n","/**\n * The 'presence' namespace provides an interface for an application to set the\n *    User's presence information and to track other Users' presence\n *    information.\n *\n * Presence information is persisted by the server. When the SDK is initialized,\n *    there will be no information available. Presence information will become\n *    available either by using {@link presence.fetch} or by subscribing for\n *    updates about other Users, using {@link presence.subscribe}.\n *\n * Available presence information can be retrieved using {@link presence.get} or\n *    {@link presence.getAll}.\n *\n * @public\n * @requires presence\n * @namespace presence\n */\n\nimport * as actions from './actions'\nimport * as selectors from './selectors'\n\nimport { getLogManager, API_LOG_TAG } from '../../logs'\n\nconst log = getLogManager().getLogger('PRESENCE')\n\nexport default function (context) {\n  const presenceApi = {\n    /**\n     * Updates the presence information for the current user.\n     *\n     * See {@link presence.statuses} and {@link presence.activities} for valid\n     *    values.\n     *\n     * The SDK will emit a\n     *    {@link presence.event:presence:selfChange presence:selfChange} event\n     *    when the operation completes. The updated presence information is\n     *    available and can be retrieved with {@link presence.getSelf}.\n     *\n     * Other users subscribed for this user's presence will receive a\n     *    {@link presence.event:presence:change presence:change} event.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method update\n     * @param  {string} status The status of the presence state.\n     * @param  {string} activity The activity to be shown as presence state\n     * @param  {string} [note] An additional note to be provided when the activity is `presence.activities.ACTIVITIES_OTHER`.\n     */\n    update (status, activity, note) {\n      log.debug(API_LOG_TAG + 'presence.update: ', status, activity, note)\n      context.dispatch(actions.updatePresence(status, activity, note))\n    },\n\n    /**\n     * Retrieves the presence information for specified users, if available.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method get\n     * @param  {Array<string>|string} user A User ID or an array of User IDs.\n     * @return {Array<Object>|Object} List of user presence information.\n     */\n    get (user) {\n      log.debug(API_LOG_TAG + 'presence.get: ', user)\n      const users = Array.isArray(user) ? user : [user]\n      const storedUsers = selectors.getPresence(context.getState(), users)\n      // return something sensible based on the input\n      if (!Array.isArray(users)) {\n        if (storedUsers.length) {\n          return storedUsers[0]\n        }\n        return undefined\n      }\n      return storedUsers\n    },\n\n    /**\n     * Retrieves the presence information for all available users.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method getAll\n     * @return {Array<Object>} List of user presence information.\n     */\n    getAll () {\n      log.debug(API_LOG_TAG + 'presence.getAll')\n      return selectors.getAllPresence(context.getState())\n    },\n\n    /**\n     * Retrieves the presence information for the current user.\n     *\n     * This information is set using the {@link presence.update} API.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method getSelf\n     * @return {Object} Presence information for the current user.\n     */\n    getSelf () {\n      log.debug(API_LOG_TAG + 'presence.getSelf')\n      return selectors.getSelfPresence(context.getState())\n    },\n\n    /**\n     * Fetches presence information for the given users. This will refresh the\n     *    available information with any new information from the server.\n     *\n     * Available presence information an be retrieved using the\n     *    {@link presence.get} or {@link presence.getAll} APIs.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method fetch\n     * @param {Array<string>|string} user A User ID or an array of User IDs.\n     */\n    fetch (user) {\n      log.debug(API_LOG_TAG + 'presence.fetch: ', user)\n      const users = Array.isArray(user) ? user : [user]\n      context.dispatch(actions.getPresence(users))\n    },\n\n    /**\n     * Subscribe to another User's presence updates.\n     *\n     * When the User updates their presence information, the SDK will emit a\n     *    {@link presence.event:presence:change presence:change} event.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method subscribe\n     * @param {Array<string>|string} users A User ID or an array of User IDs.\n     */\n    subscribe (users) {\n      log.debug(API_LOG_TAG + 'presence.subscribe: ', users)\n      context.dispatch(actions.subscribePresence(users))\n    },\n\n    /**\n     * Unsubscribe from another User's presence updates.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method unsubscribe\n     * @param {Array<string>|string} users A User ID or an array of User IDs.\n     */\n    unsubscribe (users) {\n      log.debug(API_LOG_TAG + 'presence.unsubscribe: ', users)\n      context.dispatch(actions.unsubscribePresence(users))\n    }\n  }\n  return { presence: presenceApi }\n}\n","/**\n * A presence update about a subscribed user has been received.\n *\n * @public\n * @memberof presence\n * @requires presence\n * @event presence:change\n * @param {Object} params A presence object containing data.\n * @param {string} params.userId The ID of the user.\n * @param {string} params.status The presence status of the user.\n * @param {string} params.activity The activity of the user.\n * @param {string} params.note A custom note provided by the user.\n */\nexport const RECEIVED = 'presence:change'\n\n/**\n * The current user's presence information has changed.\n *\n * The changed information can be retrieved using the {@link presence.getSelf}\n *    API.\n *\n * @public\n * @memberof presence\n * @requires presence\n * @event presence:selfChange\n */\nexport const SELF_CHANGE = 'presence:selfChange'\n\n/**\n * An error occurred with presence.\n *\n * @public\n * @memberof presence\n * @requires presence\n * @event presence:error\n * @param {Object} params\n * @param {BasicError} params.error The Basic error object.\n */\nexport const ERROR = 'presence:error'\n","import * as actionTypes from './actionTypes'\nimport * as eventTypes from './eventTypes'\n\n// Helper function for error events.\nfunction presenceError (action) {\n  if (action.error) {\n    return {\n      type: eventTypes.ERROR,\n      args: { error: action.payload }\n    }\n  }\n}\n\nconst eventsMap = {}\n\neventsMap[actionTypes.RECEIVED] = action => ({\n  type: eventTypes.RECEIVED,\n  args: {\n    userId: action.payload.userId,\n    status: action.payload.status,\n    activity: action.payload.activity,\n    note: action.payload.note\n  }\n})\n\neventsMap[actionTypes.UPDATE_FINISH] = action => {\n  if (action.error) {\n    return presenceError(action)\n  } else {\n    return {\n      type: eventTypes.SELF_CHANGE\n    }\n  }\n}\n\n// TODO: Should have events to notifiy of successful operations for these actions.\neventsMap[actionTypes.GET_FINISH] = presenceError\neventsMap[actionTypes.SUBSCRIBE_FINISH] = presenceError\neventsMap[actionTypes.UNSUBSCRIBE_FINISH] = presenceError\neventsMap[actionTypes.CREATE_PRESENCE_LIST_FINISH] = presenceError\n\nexport default eventsMap\n","export { default as api } from './api'\nexport { default as reducer } from './reducers'\n","import * as actionTypes from './actionTypes'\n\n// Libraries\nimport { handleActions } from 'redux-actions'\nimport { omit } from 'lodash/fp'\nconst reducers = {}\n\nreducers[actionTypes.UPDATE] = {\n  next (state) {\n    return {\n      ...state,\n      self: {\n        ...state.self,\n        loading: true,\n        error: false\n      }\n    }\n  }\n}\n\nreducers[actionTypes.UPDATE_FINISH] = {\n  next (state, action) {\n    let result = {\n      ...state,\n      self: {\n        loading: false,\n        error: false,\n        status: action.payload.status,\n        activity: action.payload.activity\n      }\n    }\n    if (action.payload.note) {\n      result.self.note = action.payload.note\n    }\n    return result\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      self: {\n        ...state.self,\n        loading: false,\n        error: action.payload\n      }\n    }\n  }\n}\n\nreducers[actionTypes.GET] = {\n  next (state, { payload: userIds }) {\n    const users = { ...state.users }\n    for (let userId of userIds) {\n      users[userId] = {\n        userId,\n        loading: true\n      }\n    }\n    return { ...state, users }\n  }\n}\n\nreducers[actionTypes.GET_FINISH] = {\n  next (state, { payload }) {\n    if (!payload.presenceContact) {\n      return { ...state }\n    }\n\n    let users = {}\n    for (let contact of payload.presenceContact) {\n      let presenceObject = {}\n      presenceObject.userId = contact.presentityUserId\n      presenceObject.activity = contact.presence.person.activities.activityValue\n      presenceObject.status = contact.presence.person['overriding-willingness'].overridingWillingnessValue\n      presenceObject.note = contact.presence.person.activities.other\n      presenceObject.loading = false\n      users[contact.presentityUserId] = presenceObject\n    }\n    return {\n      ...state,\n      users: {\n        ...state.users,\n        ...users\n      }\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state\n    }\n  }\n}\n\nreducers[actionTypes.RECEIVED] = {\n  next (state, { payload }) {\n    return {\n      ...state,\n      users: {\n        ...state.users,\n        [payload.userId]: {\n          userId: payload.userId, // optimize for filtering by userId\n          status: payload.status,\n          activity: payload.activity,\n          note: payload.note,\n          loading: false\n        }\n      }\n    }\n  }\n}\n\nreducers[actionTypes.UNSUBSCRIBE_FINISH] = {\n  next (state, { payload }) {\n    return {\n      ...state,\n      users: omit(payload, state.users)\n    }\n  }\n}\n\nconst reducer = handleActions(reducers, { self: {}, users: {} })\nexport default reducer\n","export function getPresence (state, users) {\n  // If no users specified, return them all\n  if (!users) {\n    return state.presence.users\n  }\n\n  // Grab all users that match the passed in IDs, return\n  return Object.values(state.presence.users).filter(user => users.indexOf(user.userId) !== -1)\n}\n\n/**\n * Retrieves presence information for all users.\n * @method getAllPresence\n * @param  {Object} state Redux state.\n * @return {Array}  List of presence information for users.\n */\nexport function getAllPresence (state) {\n  return Object.values(state.presence.users)\n}\n\n/**\n * Retrieves the current user's self presence.\n * @method getSelfPresence\n * @param  {Object} state Redux state.\n * @return {Object} Self-presence information.\n */\nexport function getSelfPresence (state) {\n  return state.presence.self\n}\n","// Requests plugin.\nimport { RESPONSE } from './interface/actionTypes'\nimport * as actions from './interface/actions'\n\n// Libraries.\nimport { mergeValues } from '../common/utils'\nimport { get } from 'lodash/fp'\nimport { put, take, call } from 'redux-saga/effects'\n\n/**\n * Creates an effect description that instructs the middleware to perform a request with the provided options.\n * This effect is blocking and will yield a RESPONSE action on completion.\n *\n * @param {Object} options See https://developer.mozilla.org/en-US/docs/Web/API/Request/Request\n * @param {string} options.url The url to perform the request on.\n * @param {string} options.method The HTTP method to use for the request.\n * @param {Object} options.headers Object literal of headers you want to add to the request.\n * @param {Object} [options.queryParams] The parameters to be added to the query string\n * @param {string} [options.responseType] The data type assumed to be received in the response body\n * @param {Blob|BufferSource|FormData|UrlSearchParams|string} [options.body] Any body that you want to add to your request.\n * @return A blocking redux-saga effect that will instruct the middleware to wait for the request to be fullfilled or until it fails.\n */\nexport default function request (options, commonOptions) {\n  return call(requestSaga, options, commonOptions)\n}\n\n/*\n * The saga backing the request effect.\n */\nexport function * requestSaga (options, commonOptions) {\n  // Merge any extra request options into the provided options\n  //      for this request. Priority is for the passed-in options.\n  options = mergeValues(commonOptions, options)\n\n  const requestAction = yield put(actions.request(options))\n  const responseAction = yield take(\n    action => action.type === RESPONSE && get('meta.requestId', action) === requestAction.meta.requestId\n  )\n\n  return responseAction\n}\n","import * as actionTypes from './interface/actionTypes'\nimport * as actions from './interface/actions'\n\nimport { call, put, takeEvery } from 'redux-saga/effects'\nimport fetchPonyfill from 'fetch-ponyfill'\nimport { toQueryString } from '../common/utils'\nimport { getLogManager } from '../logs'\n\nconst { fetch } = fetchPonyfill({ Promise })\nconst log = getLogManager().getLogger('REQUEST')\n\n/**\n * Enum declaring the valid request response data types that are available to be handled\n */\nconst responseTypes = Object.freeze({\n  json: 'json',\n  blob: 'blob',\n  text: 'text',\n  none: 'none'\n})\n\nconst contentTypes = Object.freeze({\n  jsonType: 'application/json',\n  vdnJsonType: 'application/vdn.kandy.json',\n  plainTextType: 'text/plain',\n  xmlTextType: 'text/xml',\n  octetStream: 'application/octet-stream'\n})\n\n/*\n * HTTP request plugin.\n */\nexport default function request () {\n  return {\n    sagas: [watchRequests],\n    name: 'requests'\n  }\n}\n\n/*\n * Saga to watch for every request action.\n */\nfunction * watchRequests () {\n  yield takeEvery(actionTypes.REQUEST, handleRequest)\n}\n\n/*\n * Generator that handles a request action with standard HTTP handling features and reports\n * a requestFinished action when the request is done.\n *\n * @param {FluxStandardAction} action The action to handle.\n */\nfunction * handleRequest (action) {\n  // Make the request based on the action\n  var result = yield call(makeRequest, action.payload, action.meta.requestId)\n  yield put(actions.response(action.meta.requestId, result, !!result.error))\n}\n\n/**\n * Make a request with the specified options. The options is very similar to the options passed to the GlobalFetch\n * method except that is also accepts the url as part of the options.\n *\n * Currently this processes the request and assumes nothing about the response.\n * - If the response has a body, it will always be parsed and forwarded on.\n *      - If no body, then an empty object in its place.\n * - If the fetch succeded, the response \"results\" will always be forwarded on,\n *      even if the response is outside of the 200-299 range.\n *      - Because some backends provide more detailed error info (that a saga\n *        may need) as part of the body, rather than just the response status.\n *\n * @param {Object} options Options to make the request with.\n * @param {string} options.url The URL to make the request to.\n * @param {Object} [options.queryParams] The parameters to be added to the query string\n * @param {string} [options.responseType] The data type assumed to be received in the response body\n * @param {Blob|BufferSource|FormData|UrlSearchParams|string} [options.body] The request body\n * @return {Promise} A promise that resolves with a custom response object.\n */\nasync function makeRequest (options, requestId) {\n  // Extract and remove the url property.\n  const { url, queryParams, responseType = 'json', ...fetchOptions } = options\n\n  if (!responseTypes.hasOwnProperty(responseType)) {\n    // Invalid data type requested\n    log.debug('responseType value was invalid')\n    return {\n      body: undefined,\n      error: 'RESPONSE_TYPE',\n      message: 'Requested invalid data type for response'\n    }\n  }\n  let response\n  let contentType\n  try {\n    response = await fetch(url + toQueryString(queryParams), fetchOptions)\n  } catch (err) {\n    log.debug(`Fetch request ${requestId} failed: ${err.message}.`)\n    return {\n      body: false,\n      error: 'FETCH',\n      result: {\n        ok: false,\n        code: err.name,\n        message: err.message\n      }\n    }\n  }\n  try {\n    contentType = await response.headers.get('content-type')\n  } catch (err) {\n    log.debug(`Failed to get content-type:${err.message}.`)\n  }\n\n  try {\n    let result = {\n      ok: response.ok,\n      code: response.status,\n      message: response.statusText\n    }\n    let responseBody\n    let error = !response.ok\n\n    if (error) {\n      log.debug(`Response indicates that request ${requestId} failed`)\n      /*\n       * Handle a special-case error where the response body is a HTML page...\n       * Throw away the body and so it is simply reported as 'Forbidden'.\n       * TODO: Handle responses based on their type rather than checking for\n       *    individual special cases...\n       */\n      if (response.status === 403 && contentType.includes('html')) {\n        return {\n          body: false,\n          error: 'REQUEST',\n          result\n        }\n      }\n\n      /*\n       * If the response indicates an error and has a body, resolve the body as JSON\n       * but no body return an empty object then return a `REQUEST` error\n       */\n      const isJson = contentType && contentType.includes(contentTypes.jsonType)\n      responseBody = isJson ? await response.json() : {}\n      return {\n        body: responseBody,\n        error: 'REQUEST',\n        result\n      }\n    } else if (response.status === 204) {\n      /*\n       * A `204 (No Content)` response indicates a success, but with no content to return.\n       * Avoid parsing the response because there isn't one.\n       */\n      responseBody = {}\n      return {\n        body: responseBody,\n        error: false,\n        result\n      }\n    } else {\n      /**\n       * The SDK should only be parsing the responses as is expected without checking the content type of the response.\n       * This is deterministic depending on the `responseType` passed in to the request through the request options.\n       * However, if parsing with the expected responseType does fail, attempt parsing using the response's content-type\n       * header before returning a parse error.\n       */\n      responseBody = {}\n      try {\n        switch (responseType) {\n          case responseTypes.json:\n            responseBody = await response.json()\n            break\n          case responseTypes.blob:\n            responseBody = await response.blob()\n            break\n          case responseTypes.text:\n            responseBody = await response.text()\n            break\n          case responseTypes.none:\n            // Do not parse the response\n            break\n          default:\n            // Should never reach here\n            log.warn('Unexepected response type: ', responseType)\n        }\n      } catch (e) {\n        log.warn(`Failed to parse with response type: ${responseType}. Error: ${e}`)\n\n        // \"Fallback\" to try response parsing using the Content-Type header of the response\n        log.debug('Attempting to parse with the response content-type')\n        if (contentType) {\n          // Need to clone the response as the response body can only be read/attempted to be read once.\n          const responseClone = response.clone()\n          if (contentType.includes(contentTypes.jsonType) || contentType.includes(contentTypes.vdnJsonType)) {\n            responseBody = await responseClone.json()\n          } else if (\n            contentType.includes(contentTypes.plainTextType) ||\n            contentType.includes(contentTypes.xmlTextType)\n          ) {\n            responseBody = await responseClone.text()\n          } else if (contentType.includes(contentTypes.octetStream)) {\n            responseBody = await responseClone.blob()\n          } else {\n            log.warn('Unexepected content-type of response: ', contentType)\n          }\n        } else {\n          log.debug('No content-type set in response, returning an empty object as the body')\n        }\n      }\n\n      return {\n        body: responseBody,\n        error: false,\n        result\n      }\n    }\n  } catch (err) {\n    log.debug(`Error parsing response. Response for request ${requestId}: \"${err.message}\"`)\n    return {\n      body: false,\n      error: 'REQUEST',\n      result: {\n        ok: false,\n        code: err.name,\n        message: err.message\n      }\n    }\n  }\n}\n\n// begin-test-code\nexport const __testonly__ = { makeRequest, watchRequests, handleRequest }\n// end-test-code\n","const PREFIX = '@@KANDY/'\n\nexport const REQUEST = PREFIX + 'REQUEST'\nexport const RESPONSE = PREFIX + 'RESPONSE'\n","import * as actionTypes from './actionTypes'\n\nvar nextRequestId = 0\nfunction generateRequestId () {\n  return nextRequestId++\n}\n\n/**\n * Creates a request action.\n * @param {Object} options\n * @param {string} options.url The url for the request\n * @param {Object} [options.queryParams] Query parameters to be added to the url string\n * @param {string} [options.responseType] The data type assumed to be received in the response body\n * @param {Blob|BufferSource|FormData|UrlSearchParams|string} [options.body] The request body\n */\nexport function request (options) {\n  return {\n    type: actionTypes.REQUEST,\n    payload: options,\n    meta: {\n      requestId: generateRequestId()\n    }\n  }\n}\n\n/**\n * Creates a response action.\n */\nexport function response (requestId, result, error = false) {\n  return {\n    type: actionTypes.RESPONSE,\n    payload: result,\n    error,\n    meta: {\n      requestId: requestId\n    }\n  }\n}\n","// Subscription plugin.\nimport { api, reducer, name } from '../interface'\nimport eventsMap from '../interface/events'\nimport { subscriptionFlow, onConnectionLostEntry } from './sagas'\n\n// Other plugins.\nimport { update as updateConfig } from '../../config/interface/actions'\nimport { mapEvents } from '../../events/interface/actions'\n\n// Libraries.\nimport { put } from 'redux-saga/effects'\n\n// Helpers.\nimport { mergeValues } from '../../common/utils'\n\n/**\n * Configuration options for the Subscription feature.\n * @public\n * @name config.subscription\n * @memberof config\n * @instance\n * @param {Object} subscription Subscription configs.\n * @param {number} [subscription.channelLifetime=3600] The amount of time (in seconds) for which to keep subscription channels up and alive.\n * @param {number} [subscription.timeout=20] The amount of time (in seconds) allowed for the subscription/unsubscription process to take place before timing out.\n */\n\n/**\n * CPaaS subscription implementation factory.\n * @method createSubcriptionPlugin\n * @param {Object} options - Configuration options for subscription. See above.\n * @return {Object} plugin - A subscription plugin.\n */\nexport default function createSubcriptionPlugin (options = {}) {\n  const defaultOptions = {\n    channelLifetime: 3600, // sec\n    timeout: 20 // sec\n  }\n\n  options = mergeValues(defaultOptions, options)\n\n  function * init () {\n    // Send the provided options to the store.\n    // This will be `state.config[name]`.\n    yield put(updateConfig(options, name))\n    yield put(mapEvents(eventsMap))\n  }\n\n  return {\n    sagas: [subscriptionFlow, onConnectionLostEntry],\n    init,\n    api,\n    reducer,\n    name\n  }\n}\n","// Other plugins.\nimport request from '../../request/effects'\nimport BasicError, { subscriptionCodes } from '../../errors'\nimport { getLogManager } from '../../logs'\n\nconst log = getLogManager().getLogger('AUTH')\n\n/**\n * This function requests a websocket to connect to the backend.\n * @method requestWebsocket\n * @param  {Object}    requestInfo\n * @param  {Object}    subscriptionInfo\n * @return {Object} Returns an object containing the websocket connection information, most importantly a URL to connect to a websocket.\n */\n\nexport function * requestWebsocket (requestInfo, subscriptionInfo, connectivityInfo) {\n  const req = {}\n  req.method = 'POST'\n  req.url = `${requestInfo.baseURL}/cpaas/notificationchannel/${requestInfo.version}/${requestInfo.username}/channels`\n  req.body = JSON.stringify({\n    notificationChannel: {\n      channelLifetime: subscriptionInfo.expires,\n      channelType: 'Websockets',\n      clientCorrelator: requestInfo.clientCorrelator,\n      'x-connCheckRole': connectivityInfo.method.responsibleParty\n    }\n  })\n\n  const response = yield request(req, requestInfo.options)\n\n  if (response.error) {\n    if (response.payload.body) {\n      log.debug('Websocket request failed.', response.payload.body)\n      // Handle errors from the server.\n      return {\n        // TODO: Better error; more info.\n        error: new BasicError({\n          message: 'Failed to retrieve a websocket.',\n          code: subscriptionCodes.CPAAS_WSREQUEST_FAIL\n        })\n      }\n    } else {\n      log.debug('Failed requesting a websocket.', response.payload.result.message)\n      // Handle errors from the request plugin.\n      return {\n        // TODO: Better error; more info.\n        error: new BasicError({\n          message: 'Retrieve websocket request failed.',\n          // TODO: Shared error codes.\n          code: subscriptionCodes.CPAAS_WSREQUEST_FAIL\n        })\n      }\n    }\n  } else {\n    // Request was successful.\n    return {\n      error: false,\n      ...response.payload.body\n    }\n  }\n}\n/**\n * Request to delete a specified notification channel.\n * @method deleteChannel\n * @param  {string} channelId The ID of the channel to delete.\n * @param  {Object} requestInfo\n * @return {Object}\n */\nexport function * deleteChannel (channelId, requestInfo) {\n  const requestOptions = {}\n  requestOptions.method = 'DELETE'\n  requestOptions.responseType = 'none'\n  requestOptions.url =\n    `${requestInfo.baseURL}` +\n    `/cpaas/notificationchannel/${requestInfo.version}/${requestInfo.username}` +\n    `/channels/${channelId}`\n\n  const response = yield request(requestOptions, requestInfo.options)\n\n  if (response.error) {\n    if (response.payload.body) {\n      // Handle errors from the server.\n      // TODO: Better error; more info.\n      return {\n        error: new BasicError({\n          message: 'Failed to delete notification channel.',\n          code: subscriptionCodes.CPAAS_UNSUBSCRIBE_FAIL\n        })\n      }\n    } else {\n      // Handle errors from the request helper.\n      // TODO: Better error; more info.\n      return {\n        error: new BasicError({\n          message: 'Delete channel request failed',\n          code: subscriptionCodes.CPAAS_UNSUBSCRIBE_FAIL\n        })\n      }\n    }\n  } else {\n    // Request was successful.\n    return {\n      error: false,\n      ...response.payload.body\n    }\n  }\n}\n\n/**\n * Revoke a websocket connection.\n * @method revokeWebsocket\n * @param  {Object}    connection Server information for the service in use.\n * @param  {string}    connection.server Server information for generating the URL.\n * @param  {string}    connection.requestOptions Common request options to be added.\n * @param  {string}    subscriptionURL URL of the user's websocket instance.\n * @return {Object}    Revoke websocket response.\n */\nexport function * revokeWebsocket (connection, subscriptionURL, credentials) {\n  // Build the revokeWebsocket request.\n  let requestOptions = {}\n  requestOptions.method = 'DELETE'\n  requestOptions.responseType = 'none'\n\n  requestOptions.url =\n    `${connection.server.protocol}://${connection.server.server}:${connection.server.port}` + subscriptionURL\n\n  requestOptions.headers = {\n    Accept: 'application/json',\n    'Content-Type': 'application/json',\n    Authorization: `Bearer ${credentials.accessToken}`\n  }\n\n  // Send the revokeWebsocket request.\n  const response = yield request(requestOptions)\n\n  // Handle the response and any possible errors.\n  if (response.error) {\n    if (response.payload.body) {\n      // Handle errors from the server.\n      return {\n        // TODO: Better error; more info.\n        error: new BasicError({\n          message: 'Failed to revoke websocket.',\n          code: subscriptionCodes.CPAAS_WSREVOKE_FAIL\n        })\n      }\n    } else {\n      // Handle errors from the request helper.\n      return {\n        // TODO: Better error; more info.\n        error: new BasicError({\n          message: 'Revoke websocket request failed.',\n          // TODO: Shared error codes.\n          code: subscriptionCodes.CPAAS_WSREVOKE_FAIL\n        })\n      }\n    }\n  } else {\n    // Request was successful.\n    return {\n      error: false\n    }\n  }\n}\n\n/**\n * CPaaS refreshWebsocket. All this call does is ask the backend to extend the lifetime\n * of the websocket.\n * @method refreshWebsocket\n * @param  {Object}    connection Server information for the service in use.\n * @param  {string}    connection.server Server information for generating the URL.\n * @param  {string}    connection.requestOptions Common request options to be added.\n * @param  {Object}    subscription Information about the subscription instance.\n * @param  {string}    subscription.expires - The time (in seconds) until subscription expiry.\n * @param  {Array}     subscription.service - The services to resubscribe to.\n * @param  {Array}     subscription.url - The URL of the user's subscription instance.\n * @return {Object}    Resubscription response.\n */\nexport function * refreshWebsocket (connection, subscription, credentials) {\n  let requestOptions = {}\n  requestOptions.method = 'PUT'\n\n  requestOptions.url =\n    `${connection.server.protocol}://${connection.server.server}:${connection.server.port}` +\n    subscription.url +\n    '/channelLifetime'\n\n  requestOptions.headers = {\n    Accept: 'application/json',\n    'Content-Type': 'application/json',\n    Authorization: `Bearer ${credentials.accessToken}`\n  }\n\n  requestOptions.body = JSON.stringify({\n    notificationChannelLifetime: {\n      channelLifetime: subscription.channelLifetime\n    }\n  })\n\n  const response = yield request(requestOptions)\n\n  if (response.error) {\n    if (response.payload.body) {\n      // Handle errors from the server.\n      return {\n        // TODO: Better error; more info.\n        error: new BasicError({\n          message: 'Failed to refresh websocket connection.',\n          code: subscriptionCodes.CPAAS_WSREFRESH_FAIL\n        })\n      }\n    } else {\n      // Handle errors from the request helper.\n      return {\n        // TODO: Better error; more info.\n        error: new BasicError({\n          message: 'Refresh websocket request failed.',\n          // TODO: Shared error codes.\n          code: subscriptionCodes.CPAAS_WSREFRESH_FAIL\n        })\n      }\n    }\n  } else {\n    // Request was successful.\n    const extendResponse = response.payload.body\n    log.debug('Websocket lifetime extended.')\n\n    // Success.\n    return {\n      error: false,\n      ...extendResponse\n    }\n  }\n}\n","// Subscription plugin.\nimport { requestWebsocket, deleteChannel } from '../requests'\nimport * as actions from '../../interface/actions'\nimport { getSubscriptionConfig, getNotificationChannels } from '../../interface/selectors'\n\n// Other plugins.\nimport { getRequestInfo, getAuthConfig } from '../../../auth/interface/selectors'\nimport { connectWebsocket, disconnectWebsocket } from '../../../connectivity/interface/effects'\nimport { getLogManager } from '../../../logs'\n\nimport { getConnectivityConfig, getConnectionState } from '../../../connectivity/interface/selectors'\n// Helpers.\nimport BasicError, { subscriptionCodes } from '../../../errors'\nimport { notificationTypes, platforms } from '../../../constants'\n\n// Libraries.\nimport { call, put, select } from 'redux-saga/effects'\n\nconst platform = platforms.CPAAS\nconst log = getLogManager().getLogger('SUBSCRIPTION')\n\n/**\n * Ensures that a notification channel of `type` is open.\n * If already open, does nothing. If not open, requests/opens it.\n * @method ensureChannel\n * @param {string} type The type of notification channel.\n * @return {Object} The result containing a boolean property: success.\n *                  If success property is false, an extra error property will also be present.\n */\nexport function * ensureChannelOpen (type) {\n  /**\n   * Assumed format of the subInfo object:\n   * @param {Object} subInfo\n   * @param {Object} subInfo.notificationChannels A mapping of types to the channel info.\n   * @param {Array} subInfo.subscriptions A list of active subscriptions.\n   */\n  const subInfo = yield select(getNotificationChannels)\n\n  // If there is no open notification channel for `type`, request it.\n  if (!subInfo.notificationChannels[type]) {\n    let channelResponse\n    if (type === notificationTypes.WEBSOCKET) {\n      channelResponse = yield call(openWebsocketChannel, platform)\n    } else if (type === notificationTypes.PUSH) {\n      // TODO: CPaaS Push subscription here.\n    } else {\n      // Bad scenario.\n    }\n\n    if (channelResponse.error) {\n      // Error scenario: Could not open websocket channel.\n      return { success: false, error: channelResponse.error }\n    }\n\n    // Save newly opened channel info in state.\n    yield put(\n      actions.channelOpened(\n        {\n          ...channelResponse.notificationChannel,\n          channelId: channelResponse.notificationChannel.resourceURL.split('/channels/')[1]\n        },\n        type\n      )\n    )\n    return { success: true }\n  } else {\n    // If there is already a channel, use it.\n    return { success: true }\n  }\n}\n\n/**\n * This wsSubscribe function makes a request to the CPAAS gateway for a subscription.\n * If successful it triggers a subscribeFinished action containing subscription information.\n * @method openWebsocketChannel\n */\nexport function * openWebsocketChannel (platform) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const subscriptionInfo = yield select(getSubscriptionConfig)\n  const connectivityInfo = yield select(getConnectivityConfig)\n\n  // Request a websocket to subscribe to.\n  const response = yield call(requestWebsocket, requestInfo, subscriptionInfo, connectivityInfo)\n\n  if (response.error) {\n    return response\n  }\n\n  const subscription = {\n    ...response.notificationChannel,\n    service: 'CPaaS',\n    url: response.notificationChannel.channelData.channelURL\n  }\n\n  const connectionInfo = yield select(getAuthConfig)\n  // Format the response to pass off to the connectivity plugin.\n  const websocketInfo = {\n    protocol: 'wss',\n    server: connectionInfo.server.base,\n    port: connectionInfo.server.port,\n    url: subscription.url,\n    params: {\n      access_token: requestInfo.token\n    }\n  }\n\n  // Request the websocket connection.\n  const wsOpenOrError = yield connectWebsocket(websocketInfo, platform)\n\n  if (wsOpenOrError.error) {\n    // TODO: the connectivity plugin should be creating (and passing on) the websocket errors.\n    throw new BasicError({\n      message: 'Failed to connect to the websocket.',\n      code: subscriptionCodes.WS_CONNECTION_ERROR\n    })\n  } else {\n    // We're connected. Finish subscription process.\n    // TODO: Once auth is complete, fill the data.\n    return {\n      // We will only ever have one of each notificationChannel type. So this should be the only websocket channel in state.\n      notificationChannel: response.notificationChannel,\n      type: notificationTypes.WEBSOCKET\n    }\n  }\n}\n/**\n * Close the specified channel by cleaning up its resources then deleting it.\n * @method closeChannel\n * @param  {Object} channel Information about the channel to be closed.\n * @param  {string} platform\n * @return {Object}\n */\nexport function * closeChannel (channel, platform) {\n  const { channelId, channelType } = channel\n\n  // TODO: Don't hardcode a constant.\n  if (channelType === 'websockets') {\n    // Ask the connectivity plugin to disconnect this platform's websocket if it exists\n    const wsState = yield select(getConnectionState, platform)\n    if (wsState.connected) {\n      const closeAction = yield disconnectWebsocket(undefined, platform)\n\n      if (closeAction.error) {\n        log.debug('Failed to close websocket. Continuing anyway.')\n      }\n    }\n\n    const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n\n    // Delete the notification channel resource.\n    const response = yield call(deleteChannel, channelId, requestInfo)\n    return response\n  } else {\n    // TODO: Handle closing other channel types.\n  }\n}\n","// Subscription plugin.\nimport * as actionTypes from '../../interface/actionTypes'\nimport * as actions from '../../interface/actions'\n\nimport { ensureChannelOpen, closeChannel } from './channels'\n\nimport { refreshWebsocket } from '../requests'\nimport {\n  getRegisteredServices,\n  getSubscribedServices,\n  getNotificationChannels,\n  getSubscriptionConfig\n} from '../../interface/selectors'\n\n// Other plugins\nimport * as connectivityActionTypes from '../../../connectivity/interface/actionTypes'\nimport { getSubscriptionInfo, getConnectionInfo, getUserInfo } from '../../../auth/interface/selectors'\nimport { DISCONNECT_REASONS } from '../../../auth/constants'\n\n// Helpers.\nimport { getLogManager } from '../../../logs'\nimport BasicError from '../../../errors'\nimport { waitFor } from '../../../common/effects'\n\n// Libraries.\nimport { call, put, select, take, actionChannel, race, delay, takeEvery } from 'redux-saga/effects'\nimport { intersection, difference, compact } from 'lodash/fp'\n\n// Constants\nimport { platforms } from '../../../constants'\n\nconst platform = platforms.CPAAS\nconst log = getLogManager().getLogger('SUBSCRIPTION')\n\n/**\n * Entry point for ALL subscription change actions.\n * Queues all subscription changes (ie. subscribe, unsubscribe) to avoid async\n * scenarios. This ensures channels and subscriptions are not duplicated\n * and that resources are created/clean-up when needed.\n * @method subscriptionFlow\n */\nexport function * subscriptionFlow () {\n  // Use a channel to queue ALL subscription change requests.\n  const subscriptionChannel = yield actionChannel([actionTypes.SUBSCRIBE, actionTypes.UNSUBSCRIBE])\n\n  while (true) {\n    const action = yield take(subscriptionChannel)\n\n    // Handle the action appropriately.\n    if (action.type === actionTypes.SUBSCRIBE) {\n      if (!action.payload.services || action.payload.services.length === 0) {\n        // Error scenario: No services specified.\n        // TODO: Better error.\n        yield put(actions.subscribeFinished({ error: true }))\n        continue\n      }\n\n      // Open the notification channel if it isn't already.\n      const result = yield call(ensureChannelOpen, action.payload.type)\n      if (!result.success) {\n        // Error scenario: Could not open channel.\n        yield put(actions.subscribeFinished({ error: result.error }))\n        continue\n      }\n\n      // Subscribe to the services and retrieve a list of their responses.\n      const subResponses = yield call(subscribeForServices, action)\n\n      // Report that the subscription flow has finished.\n      if (subResponses.error) {\n        yield put(\n          actions.subscribeFinished({\n            error: subResponses.error,\n            type: action.payload.type\n          })\n        )\n      } else {\n        yield put(\n          actions.subscribeFinished({\n            subscriptions: subResponses,\n            type: action.payload.type\n          })\n        )\n      }\n    } else {\n      // TODO: How to do a \"unsubscribe all\" services?\n      // ie. not need the application to specify them all individually.\n      // Might be simpler for the API to be sub/unsub(type, services).\n\n      // Unsubscribe the services.\n      const unsubResponses = yield call(unsubscribeServices, action)\n      if (unsubResponses.error) {\n        yield put(\n          actions.unsubscribeFinished({\n            error: unsubResponses.error,\n            type: action.payload.type\n          })\n        )\n        continue\n      }\n\n      // Get the channel information of the channel to be closed.\n      const { notificationChannels } = yield select(getNotificationChannels)\n      const channel = notificationChannels[action.payload.type]\n\n      // If there are no longer any subscribed services for this channel (and\n      //    the channel is open), close it.\n      const subscribedServices = yield select(getSubscribedServices, action.payload.type)\n      if (subscribedServices.length === 0 && channel) {\n        const closeResponse = yield call(closeChannel, channel, platform)\n\n        if (closeResponse.error) {\n          // TODO: Error scenario?\n        } else {\n          // TODO: Parameters.\n          yield put(actions.channelClosed(action.payload.type))\n        }\n      }\n\n      // Report that the unsubscription flow has finished.\n      yield put(\n        actions.unsubscribeFinished({\n          type: action.payload.type\n        })\n      )\n    }\n  }\n}\n\n/**\n * This function handles the flow of subscribing for CPaaS services.\n * This means it dispatches a command action to tell other plugins to subscribe.\n * Once all plugins have done their subscription (if they need one), we return\n * the subscription response information.\n * @method subscribeForServices\n * @param  {Object} action A subscription action.\n * @return {Object}\n */\nfunction * subscribeForServices (action) {\n  const registeredServices = yield select(getRegisteredServices)\n\n  // Get the list of services that were requested, but plugins did not register.\n  const notRegistered = difference(registeredServices, action.payload.services)\n  if (notRegistered.length > 0) {\n    log.debug(`Not registered for requested services: ${notRegistered}.`)\n  }\n\n  // TODO: Don't allow subscribing for services with existing subscription.\n  // Get the list of services that were requested, and plugins did register.\n  const validServices = intersection(registeredServices, action.payload.services)\n  log.info(`Requesting subscriptions for services: ${validServices}.`)\n\n  if (validServices.length === 0) {\n    // TODO: Proper error / return.\n    return {\n      error: new BasicError({\n        message: 'Failed to subscribe: No valid services provided.',\n        // TODO: Proper error code.\n        code: 'BAD_INPUT'\n      })\n    }\n  }\n\n  const subscriptionConfig = yield select(getSubscriptionConfig, platform)\n\n  // Announce to all plugins that subscriptions should happen.\n  yield put(actions.doPluginSubscriptions(validServices, action.payload.type))\n\n  // What we're waiting for.\n  const waitPatterns = validServices.map(service => action =>\n    action.type === actionTypes.PLUGIN_SUBSCRIPTION_FINISHED && action.payload.service === service\n  )\n\n  // Wait for a response from each plugin.\n  const { results } = yield waitFor(subscriptionConfig.timeout * 1000, waitPatterns)\n\n  // TODO: Would it be better to handle partial results here?\n  return compact(results)\n}\n\n/**\n * This function handles the flow of unsubscribing for CPaaS services.\n * This means it dispatches a command action to tell other plugins to unsubscribe.\n * Once all plugins have done their unsubscription (if they need one), we return\n * the unsubscription response information.\n * The logic in this saga is a copy from the `subscribeForServices` saga.\n * @method unsubscribeServices\n * @param  {Object} action An unsubscription action.\n * @return {Object}\n */\nfunction * unsubscribeServices (action) {\n  const subscribedServices = yield select(getSubscribedServices, action.payload.type)\n\n  // Get the list of services we want to unsubscribe, but aren't subscribed.\n  const notSubscribed = action.payload.services.filter(service => {\n    return subscribedServices.indexOf(service) === -1\n  })\n  if (notSubscribed.length > 0) {\n    log.debug(`Not subscribed for services for unsubscription: ${notSubscribed}.`)\n  }\n\n  // Get the list of subscribed services we want to unsubscribe.\n  const validServices = intersection(subscribedServices, action.payload.services)\n  log.info(`Unsubscribing from services: ${validServices}.`)\n\n  if (validServices.length === 0) {\n    // TODO: Proper error / return.\n    return {\n      error: new BasicError({\n        message: 'Failed to unsubscribe: No valid services provided.',\n        // TODO: Proper error code.\n        code: 'BAD_INPUT'\n      })\n    }\n  }\n\n  const subscriptionConfig = yield select(getSubscriptionConfig, platform)\n\n  // Announce to all plugins that unsubscriptions should happen\n  yield put(actions.doPluginUnsubscriptions(validServices, action.payload.type))\n\n  // What we're waiting for.\n  const waitPatterns = validServices.map(service => action =>\n    action.type === actionTypes.PLUGIN_UNSUBSCRIPTION_FINISHED && action.payload.service === service\n  )\n\n  // Wait for a response from each plugin.\n  const { results } = yield waitFor(subscriptionConfig.timeout * 1000, waitPatterns)\n\n  // Get the service from each of the unsubscribed actions\n  let resultServices = results\n  if (Array.isArray(results)) {\n    resultServices = results.map(resultAction => resultAction.payload.service)\n  }\n\n  return compact(resultServices)\n}\n\n/**\n * Saga for extending a websocket subscription.\n * When triggered, make a resub request to CPaaS.\n * @method refreshWebsocketSaga\n */\nexport function * refreshWebsocketSaga () {\n  const resubTriggers = yield actionChannel([actionTypes.SUBSCRIBE_FINISHED, actionTypes.RESUBSCRIPTION_FINISHED])\n  while (true) {\n    const action = yield take(resubTriggers)\n\n    // If the action was an error, ignore it.\n    if (action.error) {\n      continue\n    }\n\n    const subscription = yield select(getSubscriptionInfo, platform)\n\n    const resubDelay = (subscription.channelLifetime * 1000) / 2\n\n    // Wait for either the resub delay or a unsubscribe action.\n    const { expiry } = yield race({\n      expiry: delay(resubDelay),\n      unsubscribe: take(actionTypes.UNSUBSCRIBE_FINISHED)\n    })\n\n    // If the resubDelay has elapsed, resubscribe.\n    if (expiry) {\n      log.info('Extending user subscription.')\n      const connection = yield select(getConnectionInfo, platform)\n      const subscription = yield select(getSubscriptionInfo, platform)\n      const credentials = yield select(getUserInfo)\n\n      const response = yield call(refreshWebsocket, connection, subscription, credentials)\n\n      if (response.error) {\n        yield put(actions.resubscribeFinished(response, platform))\n      } else {\n        yield put(actions.resubscribeFinished({}, platform))\n      }\n    }\n  }\n}\n\n/**\n * Triggers onConnectionLost saga when a WS_RECONNECT_FAILED actionType occurs\n * @method onConnectionLostEntry\n */\nexport function * onConnectionLostEntry () {\n  yield takeEvery(connectivityActionTypes.WS_RECONNECT_FAILED, onConnectionLost)\n}\n\n/**\n * Handles lost connections from the connectivity plugin\n * @method onConnectionLost\n */\nexport function * onConnectionLost () {\n  yield put(\n    actions.unsubscribeFinished({\n      reason: DISCONNECT_REASONS.LOST_CONNECTION\n    })\n  )\n}\n","const prefix = '@@KANDY/'\n\nexport const SUBSCRIBE = prefix + 'SUBSCRIBE'\nexport const SUBSCRIBE_FINISHED = prefix + 'SUBSCRIBE_FINISHED'\n\nexport const UNSUBSCRIBE = prefix + 'UNSUBSCRIBE'\nexport const UNSUBSCRIBE_FINISHED = prefix + 'UNSUBSCRIBE_FINISHED'\n\nexport const REGISTER_SUB_SERVICE = prefix + 'REGISTER_SUB_SERVICE'\nexport const PLUGIN_SUBSCRIPTION = prefix + 'PLUGIN_SUBSCRIPTION'\nexport const PLUGIN_SUBSCRIPTION_FINISHED = prefix + 'PLUGIN_SUBSCRIPTION_FINISHED'\nexport const PLUGIN_UNSUBSCRIPTION = prefix + 'PLUGIN_UNSUBSCRIPTION'\nexport const PLUGIN_UNSUBSCRIPTION_FINISHED = prefix + 'PLUGIN_UNSUBSCRIPTION_FINISHED'\n\nexport const CHANNEL_OPENED = prefix + 'CHANNEL_OPENED'\nexport const CHANNEL_CLOSED = prefix + 'CHANNEL_CLOSED'\n","import * as actionTypes from './actionTypes'\n\n/**\n * Helper function for formatting actions.\n * Ensures that actions follow an expectable format.\n * @method actionFormatter\n * @param  {string}  actionType   [description]\n * @param  {Object} [payload={}] The action payload.\n * @param  {BasicError} [payload.error] For an error action, the error should be provided.\n * @param  {Object} [meta={}] The action meta data.\n * @return {Object}\n */\nfunction actionFormatter (actionType, payload = {}, meta = {}) {\n  return {\n    type: actionType,\n    payload: {\n      ...payload\n    },\n    error: !!payload.error,\n    meta: {\n      ...meta\n    }\n  }\n}\n\n/**\n * Represents a request to subscribe to services and connect to a notification\n * channel.\n * @method subscribe\n * @param  {Array}   services  An array containing the request services.\n * @param  {string}  type      The type of notification channel to connect to.\n * @return {Object}            A flux standard action.\n */\nexport function subscribe (services = [], type) {\n  return actionFormatter(actionTypes.SUBSCRIBE, { services, type })\n}\n\n/**\n * Indicates that the subscription process has finished.\n * @method subscribeFinished\n * @param  {Object}  subscriptions  An object representing the subscriptions.\n * @param  {string}  type                 The type of notificaitonChannel for this subscription.\n * @param  {Object}  error                An error object.\n * @return {Object}                       A flux standard action.\n */\nexport function subscribeFinished ({ subscriptions, type, error }) {\n  return actionFormatter(actionTypes.SUBSCRIBE_FINISHED, { subscriptions, type, error })\n}\n\n/**\n * A request to unsubscribe from services.\n * @method unsubscribe\n * @param  {Array} services A list of services.\n * @param  {string} type The type of notificationChannel.\n * @return {Object} A flux standard action.\n */\nexport function unsubscribe (services = [], type) {\n  return actionFormatter(actionTypes.UNSUBSCRIBE, { services, type })\n}\n\n/**\n * A notice that unsubscription has finished.\n * @method unsubscribeFinished\n * @param  {string} type The type of notificationChannel.\n * @param  {Object} [error] An error object.\n * @param  {string} [reason] The reason for the unsubscribe, if abnormal.\n * @return {Object} A flux standard action.\n */\nexport function unsubscribeFinished ({ type, error, reason }) {\n  return actionFormatter(actionTypes.UNSUBSCRIBE_FINISHED, { type, error, reason })\n}\n\n/**\n * Signifies that a plugin has subscription logic for certain services.\n * @method registerService\n * @param  {Array}  [services=[]] A list of services.\n * @return {Object} A flux standard action.\n */\nexport function registerService (services = []) {\n  return actionFormatter(actionTypes.REGISTER_SUB_SERVICE, { services })\n}\n\n/**\n * Indicates that the subscription plugin expects plugins to subscribe\n * for the specified services.\n * @method doPluginSubscriptions\n * @param  {Array}  services The list of services that should be subscribed to.\n * @param  {string} type The type of notification channel for these subscriptions.\n * @return {Object} A flux standard action.\n */\nexport function doPluginSubscriptions (services, type) {\n  return actionFormatter(actionTypes.PLUGIN_SUBSCRIPTION, { services, type })\n}\n\n/**\n * Indicates that a plugin has finished a subscription for the specified service.\n * @method reportSubscriptionFinished\n * @param  {Object} params\n * @param  {string} params.service The service that the subscription was for.\n * @param  {string} params.type The type of notification channel for this subscription.\n * @param  {Object} params.subscription The subscription response from the backend.\n * @param  {BasicError} [params.error] An error object.\n * @return {Object} A flux standard action.\n */\nexport function reportSubscriptionFinished ({ service, type, subscription, error }) {\n  const subscriptionId = subscription ? subscription.resourceURL.split('/subscriptions/')[1] : null\n  return actionFormatter(actionTypes.PLUGIN_SUBSCRIPTION_FINISHED, {\n    ...subscription,\n    subscriptionId: subscriptionId,\n    service,\n    channelType: type,\n    error\n  })\n}\n\n/**\n * Indicates that the subscription plugin expects plugins to unsubscribe\n * for the specified services.\n * @method doPluginUnsubscriptions\n * @param  {Array}  services The list of services that should be unsubscribed.\n * @param  {string} type The type of notification channel for these unsubscriptions.\n * @return {Object} A flux standard action.\n */\nexport function doPluginUnsubscriptions (services, type) {\n  return actionFormatter(actionTypes.PLUGIN_UNSUBSCRIPTION, { services, type })\n}\n\n/**\n * Indicates that a plugin has finished an unsubscription for the specified service.\n * @method reportUnsubscriptionFinished\n * @param  {Object} params\n * @param  {string} params.service The service that the unsubscription was for.\n * @param  {string} params.type The type of notification channel for this unsubscription.\n * @param  {BasicError} [params.error] An error object.\n * @return {Object} A flux standard action.\n */\nexport function reportUnsubscriptionFinished ({ service, type, error }) {\n  return actionFormatter(actionTypes.PLUGIN_UNSUBSCRIPTION_FINISHED, {\n    service,\n    channelType: type,\n    error\n  })\n}\n\n/**\n * Indicates that a notification channel has been opened / created.\n * @method channelOpened\n * @param {Object} channelInfo Data about the notification channel.\n * @param {string} type The type of notification channel.\n * @return {Object} A flux standard action.\n */\nexport function channelOpened (channelInfo, type) {\n  return actionFormatter(actionTypes.CHANNEL_OPENED, { ...channelInfo }, { type })\n}\n\n/**\n * Indicates that a notification channel has been closed / deleted.\n * @method channelClosed\n * @param {string} type The type of notification channel.\n * @return {Object} A flux standard action.\n */\nexport function channelClosed (type) {\n  return actionFormatter(actionTypes.CHANNEL_CLOSED, {}, { type })\n}\n","/**\n * The 'services' namespace allows an application to manage how they wish the SDK to\n *    receive communications from the platform. An application can subscribe to\n *    services in order to receive updates about that service for the current\n *    user. A feature generally requires a subscription for its service to be\n *    fully functional.\n *\n * The services an application can subscribe to are based on the features\n *    included in the SDK. The list of available services can be retrieved\n *    using the {@link services.getSubscriptions} API. These values can be used\n *    with the {@link services.subscribe} API.\n *\n * The channel used for subscriptions is the method for receiving the service\n *    updates. The recommended channel is `websocket`, where the SDK is able to\n *    handle receiving the updates internally. Alternate channel methods, if a\n *    websocket cannot be used, will be available in the future.\n *\n * @public\n * @namespace services\n */\n\n// Subscription plugin.\nimport * as actions from './actions'\nimport { getSubscribedServices, getRegisteredServices } from './selectors'\n\n// Auth plugin.\nimport { getUserInfo as selectUserInfo } from '../../auth/interface/selectors'\n\nimport { notificationTypes } from '../../constants'\n\n// Logs\nimport { getLogManager, API_LOG_TAG } from '../../logs'\nconst log = getLogManager().getLogger('SUBSCRIPTION')\n\n/**\n * Service API. All functions in this plugin are part of the 'services' namespace.\n * @method api\n * @param  {Function} params\n * @param  {Function} params.dispatch - The redux store's dispatch function.\n * @param  {Function} params.getState - The redux store's getState function.\n * @return {Object} api - The subscription API object.\n */\nexport default function api ({ dispatch, getState }) {\n  const subscriptionApi = {\n    /**\n     * Subscribes to platform notifications for an SDK service.\n     *\n     * Subscriptions can only be made for services available to the SDK. See\n     *    {@link services.getSubscriptions} for information about services.\n     *\n     * The SDK currently only supports the `websocket` channel as a subscription\n     *    type.\n     *\n     * @public\n     * @static\n     * @memberof services\n     * @method subscribe\n     * @param {Array<string>} services A list of available services.\n     * @param {string} [type='websocket'] The method of how to receive service updates.\n     */\n    subscribe (services, type = notificationTypes.WEBSOCKET) {\n      log.debug(API_LOG_TAG + 'services.subscribe: ', services, type)\n      const userInfo = selectUserInfo(getState())\n      if (userInfo && userInfo.accessToken) {\n        services = services.map(service => service.toLowerCase())\n        dispatch(actions.subscribe(services, type))\n      } else {\n        // TODO: Directly emit error event\n      }\n    },\n\n    /**\n     * Cancels existing subscriptions for platform notifications.\n     *\n     * Existing subscriptions can be retrieved using the\n     *    {@link services.getSubscriptions} API. The `subscribed` values are the\n     *    services that can be unsubscribed from.\n     *\n     * @public\n     * @static\n     * @memberof services\n     * @method unsubscribe\n     * @param {Array<string>} services A list of subscribed services.\n     * @param {string} [type='websocket'] The method of how the service updates\n     *    are being received.\n     */\n    unsubscribe (services, type = notificationTypes.WEBSOCKET) {\n      log.debug(API_LOG_TAG + 'services.unsubscribe: ', services, type)\n      const userInfo = selectUserInfo(getState())\n      if (userInfo && userInfo.accessToken) {\n        services = services.map(service => service.toLowerCase())\n        dispatch(actions.unsubscribe(services, type))\n      } else {\n        // TODO: Directly emit error event\n      }\n    },\n\n    /**\n     * Resubscribe for notification subscriptions. ***NOT YET SUPPORTED***\n     * @memberof services\n     * @method resubscribe\n     * @param {Array<string>} services The subscribed services that should be unsubscribed.\n     * @param {string} [type='websocket'] The type of channel to be used for the notifications.\n     */\n    resubscribe (services, type = notificationTypes.WEBSOCKET) {\n      log.debug(API_LOG_TAG + 'services.resubscribe: ', services, type)\n      log.info(`THIS FUNCTIONALITY IS NOT YET SUPPORTED. Services: ${services}. Type: ${type}`)\n    },\n\n    /**\n     * Retrieves information about currently subscribed services and available services.\n     *\n     * The `available` values are the SDK's services that an application can\n     *    subscribe to receive notifications about. A feature generally\n     *    requires a subscription to its service in order to be fully functional.\n     *\n     * The `subscribed` values are the SDK's services that the application has\n     *    an active subscription for. Services are subscribed to using the\n     *    {@link services.subscribe} API.\n     *\n     * @public\n     * @static\n     * @memberof services\n     * @method getSubscriptions\n     * @return {Object} Lists of subscribed and available services.\n     * @example\n     * // Get the lists of services.\n     * const services = client.services.getSubscriptions()\n     *\n     * // Figure out which available services don't have a subscription.\n     * const notSubscribed = services.available.filter(service => {\n     *    return !services.subscribed.includes(service)\n     * })\n     *\n     * // Subscribe for all not-yet-subscribed services.\n     * client.services.subscribe(notSubscribed)\n     */\n    getSubscriptions () {\n      log.debug(API_LOG_TAG + 'services.getSubscriptions')\n      return {\n        subscribed: getSubscribedServices(getState()),\n        available: getRegisteredServices(getState()),\n        isPending: getState().subscription.isPending\n      }\n    }\n  }\n\n  return { services: subscriptionApi }\n}\n","// Subscription plugin.\nimport { registerService as registerServiceAction } from './actions'\nimport { PLUGIN_SUBSCRIPTION, PLUGIN_UNSUBSCRIPTION } from './actionTypes'\n\n// Helpers.\nimport { getLogManager } from '../../logs'\n\n// Libraries.\nimport { put, takeEvery } from 'redux-saga/effects'\nimport { isFunction } from 'lodash/fp'\n\nconst log = getLogManager().getLogger('SUBSCRIPTION')\n\n/**\n * Effect for plugins to register a service with the subscription plugin.\n * @method registerService\n * @param  {string} service The name of the service.\n * @param  {Saga} subscribe The saga to be called when subscription is requested.\n * @param  {Saga} unsubscribe The saga to be called when unsubscription is requested.\n */\nexport function * registerService (service, subscribeSaga, unsubscribeSaga) {\n  // \"Register\" the service with the subscription plugin, so it knows a plugin\n  //    has subscription/unsubscription logic for it.\n  yield put(registerServiceAction(service))\n\n  // Redux-saga take() pattern.\n  function serviceSubscribePattern (action) {\n    return action.type === PLUGIN_SUBSCRIPTION && action.payload.services.indexOf(service) !== -1\n  }\n  // Redux-saga take() pattern.\n  function serviceUnsubscribePattern (action) {\n    return action.type === PLUGIN_UNSUBSCRIPTION && action.payload.services.indexOf(service) !== -1\n  }\n\n  // Ensure that `takeEvery` is only called when an actual function/saga is provided.\n  //    Otherwise it may cause infinite loop error issues.\n  if (isFunction(subscribeSaga)) {\n    // Perform subscription logic when triggered by the action.\n    yield takeEvery(serviceSubscribePattern, subscribeSaga)\n  } else {\n    log.error(`Registering ${service} service without subscribe functionality.`)\n  }\n\n  if (isFunction(unsubscribeSaga)) {\n    // Perform unsubscription logic when triggered by the action.\n    yield takeEvery(serviceUnsubscribePattern, unsubscribeSaga)\n  } else {\n    log.error(`Registering ${service} service without unsubscribe functionality.`)\n  }\n}\n","/**\n * Subscription information has changed.\n *\n * The updated subscription information can be retrieved using the\n *    {@link services.getSubscriptions} API.\n * @public\n * @memberof services\n * @event subscription:change\n * @param {Object} params\n * @param {string} [params.reason] When unsolicited, the reason for the change.\n */\nexport const SUB_CHANGE = 'subscription:change'\n\n/**\n * An error occurred during a subscription operation.\n *\n * The subscription information can be retrieved using the\n *    {@link services.getSubscriptions} API.\n * @public\n * @memberof services\n * @event subscription:error\n * @param {Object} params\n * @param {Object} params.error A Basic error object, representing the error that occurred.\n */\nexport const SUB_ERROR = 'subscription:error'\n","import * as eventTypes from './eventTypes'\nimport * as actionTypes from './actionTypes'\n\nfunction subChangeEvent (action) {\n  return {\n    type: action.error ? eventTypes.SUB_ERROR : eventTypes.SUB_CHANGE,\n    args: action.error ? { error: action.payload.error } : { reason: action.payload.reason }\n  }\n}\n\nconst eventsMap = {}\n\n// Emit an event on start action for isPending change.\neventsMap[actionTypes.SUBSCRIBE] = subChangeEvent\neventsMap[actionTypes.UNSUBSCRIBE] = subChangeEvent\n\n// Emit an event on finish action for results.\neventsMap[actionTypes.SUBSCRIBE_FINISHED] = subChangeEvent\neventsMap[actionTypes.UNSUBSCRIBE_FINISHED] = subChangeEvent\n\nexport default eventsMap\n","import reducer from './reducers'\nimport name from './name'\nimport api from './api'\n\nexport { reducer, name, api }\n","/**\n * This interface is for an subscription plugin.\n * @type {string}\n */\nconst name = 'subscription'\nexport default name\n","import * as actionTypes from './actionTypes'\n\n// Other plugins.\nimport { DISCONNECT_REASONS } from '../../auth/constants'\n\n// Libraries.\nimport { handleActions } from 'redux-actions'\nimport { remove } from 'lodash/fp'\n\n/* State Structure\n    subscription: {\n        notificationChannels: { // An object with key values pairs for channelType -> channelInfo\n            [Websocket] : { ... }, // Channel Info taken directly from UC response.\n            [Push]      : { ... }\n        }\n    }\n */\n\nconst defaultState = {\n  // Information about the open notification channels.\n  notificationChannels: {},\n  // The list of active subscriptions.\n  subscriptions: [],\n  // The list of services that plugins can subscribe to.\n  registeredServices: [],\n  // Whether a subscription change is currently in progress.\n  isPending: false\n}\n\nconst reducers = {}\n\n// Helper function for changing the pending value.\nfunction pendingChange (value) {\n  return (state, action) => {\n    return { ...state, isPending: value }\n  }\n}\n// Change isPending depending on the start/finish of subscriptions.\nreducers[actionTypes.SUBSCRIBE] = pendingChange(true)\nreducers[actionTypes.SUBSCRIBE_FINISHED] = pendingChange(false)\nreducers[actionTypes.UNSUBSCRIBE] = pendingChange(true)\n\n/*\n * Remove subscriptions that are in the unsubscriptions list\n */\nreducers[actionTypes.UNSUBSCRIBE_FINISHED] = {\n  next (state, action) {\n    const newState = {\n      ...state,\n      isPending: false\n    }\n\n    /*\n     * If connectivity was lost, remove all subscriptions to reflect that we\n     *    aren't receiving anything from them.\n     * In \"normal\" scenarios, other reducers handle the subscriptions state.\n     */\n    if (action.payload.reason === DISCONNECT_REASONS.LOST_CONNECTION) {\n      newState.subscriptions = []\n    }\n\n    return newState\n  },\n  throw (state) {\n    return {\n      ...state,\n      isPending: false\n    }\n  }\n}\n\n/*\n * When a plugin reports a succesful subscription, store it in state.\n */\nreducers[actionTypes.PLUGIN_SUBSCRIPTION_FINISHED] = {\n  next (state, action) {\n    return {\n      ...state,\n      subscriptions: state.subscriptions.concat(action.payload)\n    }\n  }\n}\n\n/*\n * When a plugin reports a succesful unsubscription, remove it from state.\n */\nreducers[actionTypes.PLUGIN_UNSUBSCRIPTION_FINISHED] = {\n  next (state, action) {\n    function removeSubscription (subscription) {\n      return subscription.channelType === action.payload.channelType && subscription.service === action.payload.service\n    }\n\n    return {\n      ...state,\n      subscriptions: remove(removeSubscription)(state.subscriptions)\n    }\n  }\n}\n\n/*\n * Store the services that plugins can subscribe to in state.\n */\nreducers[actionTypes.REGISTER_SUB_SERVICE] = {\n  next (state, action) {\n    return {\n      ...state,\n      // TODO: Worry about duplicate services?\n      registeredServices: state.registeredServices.concat(action.payload.services)\n    }\n  }\n}\n\n/*\n * Store the new notifiction channel into state.\n * Assumption: A channel of the same type should NOT already exist.\n */\nreducers[actionTypes.CHANNEL_OPENED] = {\n  next (state, action) {\n    return {\n      ...state,\n      notificationChannels: {\n        ...state.notificationChannels,\n        [action.meta.type]: action.payload\n      }\n    }\n  }\n}\n\n/*\n * Remove the notification channel info when it has been closed.\n */\nreducers[actionTypes.CHANNEL_CLOSED] = {\n  next (state, action) {\n    return {\n      ...state,\n      notificationChannels: {\n        ...state.notificationChannels,\n        [action.meta.type]: undefined\n      }\n    }\n  }\n}\n\n/**\n * Subscription Interface reducer\n * @method reducer\n * @param  {Object}  state - The current redux state.\n * @param  {Object}  action - A flux standard action.\n * @return {Object}  - The new redux state.\n * @example\n * Subscription state structure example; connected.\n * subscriptionState = {\n *\n * }\n */\nconst reducer = handleActions(reducers, defaultState)\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\n\n/**\n * Retrieves the config options provided by the subscription plugin.\n * @method getSubscriptionConfig\n * @return {Object}\n */\nexport function getSubscriptionConfig (state) {\n  return cloneDeep(state.config.subscription)\n}\n\n/**\n * Retrieves the list of services that plugins have registered for.\n * @method getRegisteredServices\n * @return {Array}\n */\nexport function getRegisteredServices (state) {\n  return cloneDeep(state.subscription.registeredServices)\n}\n\n/**\n * Retrieves the open notifications channels' info and their active subscriptions.\n * @method getNotificationChannels\n * @return {Object}\n */\n// TODO: Rename this selector. It gets more than notification channels.\nexport function getNotificationChannels (state) {\n  return cloneDeep({\n    notificationChannels: state.subscription.notificationChannels,\n    subscriptions: state.subscription.subscriptions\n  })\n}\n\n/**\n * Retrieve the list of services with current subscriptions.\n * @method getSubscribedServices\n * @param {string} type the type of subscription we want to get specifically\n * @return {Array}\n */\nexport function getSubscribedServices (state, type) {\n  let subscriptions = state.subscription.subscriptions\n\n  // If a type was specified, filter out subscriptions of other types.\n  if (type) {\n    subscriptions = subscriptions.filter(subscription => subscription.channelType === type)\n  }\n\n  // Massage the subscriptions to be a list of service names.\n  subscriptions = subscriptions.map(subscription => subscription.service)\n  return cloneDeep(subscriptions)\n}\n","// Users plugin.\nimport pluginInterface from '../interface/index'\nimport * as sagas from './sagas'\nimport contactsEvents from '../interface/events/contacts'\nimport usersEvents from '../interface/events/users'\n\n// Other plugins.\nimport { mapEvents } from '../../events/interface/actions'\n\n// Libraries.\nimport { put } from 'redux-saga/effects'\n\nconst capabilities = ['addContactAsBuddy', 'selfInfoAsUserSearch']\n\nexport default function cpaasUsers () {\n  function * init () {\n    yield put(mapEvents({ ...contactsEvents, ...usersEvents }))\n  }\n\n  return {\n    name: pluginInterface.name,\n    sagas: Object.values(sagas),\n    api: pluginInterface.api,\n    reducer: pluginInterface.reducer,\n    capabilities,\n    init\n  }\n}\n","// Helpers.\nimport request from '../../../request/effects'\nimport { handleRequestError } from '../../../common/helpers/handleRequestError'\nimport BasicError from '../../../errors'\nimport { usersCodes } from '../../../errors/codes'\n\n/**\n * addContactRequest\n *\n * Perform an HTTP request to create one contact resource\n * @method addContactRequest\n * @param {Object} requestInfo Platform connection and user info for the request\n * @param {string} [body] The request body for a POST request\n */\nexport function * addContactRequest (requestInfo, body) {\n  const response = yield request(\n    {\n      url: `${requestInfo.baseURL}/cpaas/addressbook/v1/${requestInfo.username}/default/contacts`,\n      body: body,\n      method: 'POST',\n      headers: {}\n    },\n    requestInfo.options\n  )\n\n  if (response.error) {\n    // Handle errors from the server.\n    return {\n      error: handleRequestError(response, 'Add Contact Request')\n    }\n  } else if (response.payload.body) {\n    return { result: response.payload.body.contact }\n  } else {\n    // No error, but response does not contain a body\n    return { result: response.payload.result }\n  }\n}\n\n/**\n * updateContactRequest\n *\n * Perform an HTTP request to update one contact resource\n * @method updateContactRequest\n * @param {Object} requestInfo Platform connection and user info for the request\n * @param {string} [body] The request body for a POST request\n */\nexport function * updateContactRequest (requestInfo, contactId, body) {\n  const response = yield request(\n    {\n      url: `${requestInfo.baseURL}/cpaas/addressbook/v1/${requestInfo.username}/default/contacts/${contactId}`,\n      body: body,\n      method: 'PUT',\n      headers: {}\n    },\n    requestInfo.options\n  )\n\n  if (response.error) {\n    // Handle errors from the server.\n    return {\n      error: handleRequestError(response, 'Update Contact Request')\n    }\n  } else if (response.payload.body) {\n    return { result: response.payload.body.contact }\n  } else {\n    // No error, but no body in the response\n    return { result: response.payload.result }\n  }\n}\n\n/**\n * deleteContactRequest\n *\n * Send an HTTP DELETE request to delete one contact\n * @method deleteContactRequest\n * @param {Object} requestInfo Platform connection and user information necessary to create the request\n * @param {string} contactId The uniquely identifier for the contact\n */\nexport function * deleteContactRequest (requestInfo, contactId) {\n  const url = `${requestInfo.baseURL}/cpaas/addressbook/v1/${requestInfo.username}/default/contacts/${contactId}`\n\n  const options = {\n    method: 'DELETE',\n    responseType: 'none'\n  }\n\n  const response = yield request({ url, ...options }, requestInfo.options)\n\n  if (response.error) {\n    // Handle errors from the server.\n    return {\n      error: handleRequestError(response, 'Delete Contact Request')\n    }\n  } else {\n    // Successful DELETE requests sent to this endpoint do not return a body, thus we will return a boolean\n    return { result: true }\n  }\n}\n\n/**\n * fetchContactRequest\n *\n * Perform an HTTP request to retrieve one contact resource\n * @method fetchContactRequest\n * @param {Object} requestInfo Platform connection and user info for the request\n * @param {string} [contactId] The unique identifier of the contact\n */\nexport function * fetchContactRequest (requestInfo, contactId) {\n  const response = yield request(\n    {\n      url: `${requestInfo.baseURL}/cpaas/addressbook/v1/${requestInfo.username}/default/contacts/${contactId}`,\n      method: 'GET'\n    },\n    requestInfo.options\n  )\n\n  if (response.error) {\n    // Handle errors from the server.\n    return {\n      error: handleRequestError(response, 'Fetch Contact Request')\n    }\n  } else if (response.payload.body) {\n    return { result: response.payload.body.contact }\n  } else {\n    // No error, but response does not contain a body\n    return { result: true }\n  }\n}\n\n/**\n * refreshContactsRequest\n *\n * Perform an HTTP request to retrieve all of a user's address book contacts\n * @method refreshContactsRequest\n * @param {Object} requestInfo Platform connection and user info for the request\n */\nexport function * refreshContactsRequest (requestInfo) {\n  const url = `${requestInfo.baseURL}/cpaas/addressbook/v1/${requestInfo.username}/default/contacts`\n  const options = { method: 'GET' }\n\n  const response = yield request({ url, ...options }, requestInfo.options)\n\n  if (response.error) {\n    // Handle errors from the server.\n    return {\n      error: handleRequestError(response, 'Refresh Contact Request')\n    }\n  } else if (response.payload.body) {\n    return { result: response.payload.body.contactCollection.contact }\n  } else {\n    // Response does not contain an error, but no body was provided. As this request expects a body, we treat it as an error.\n    return {\n      error: new BasicError({\n        message: 'Request succeeded but no body was provided in the response',\n        code: usersCodes.UNKNOWN\n      })\n    }\n  }\n}\n","// Helpers.\nimport request from '../../../request/effects'\nimport { handleRequestError } from '../../../common/helpers/handleRequestError'\n\n// Libraries\nimport { getLogManager } from '../../../logs'\nimport { mapKeys, pick } from 'lodash/fp'\n\nconst log = getLogManager().getLogger('USERS')\n\n/**\n * directorySearch\n *\n * Composes and executes a REST request to the directory service\n * @method directorySearch\n * @param {Object} requestInfo\n * @param {Object} params\n */\nexport function * directorySearch (requestInfo, params = {}) {\n  const directoryId = params.directoryId || 'default'\n  const method = 'GET'\n  const url = `${requestInfo.baseURL}/cpaas/directory/v1/${requestInfo.username}/${directoryId}/search`\n  const queryParams = mapKeys(mapSearchKey, pick(validKeys, params))\n\n  const response = yield request({ url, queryParams, method }, requestInfo.options)\n\n  if (response.error) {\n    // Handle the error similarly regardless of whether or not the response has a body value\n    const error = handleRequestError(response, 'User Request')\n    log.debug('Error performing directorySearch request', error)\n    return {\n      error: error\n    }\n  } else if (response.payload.body) {\n    // Request was successful\n    return response.payload.body.directoryItemList\n  } else {\n    // Request was successful but no body was provided\n    return { result: true }\n  }\n}\n\n/**\n * valid directory search query keys\n *\n * @type {Array}\n */\nconst validKeys = [\n  'name',\n  'firstName',\n  'lastName',\n  'userId',\n  'userName',\n  'phoneNumber',\n  'order',\n  'sortBy',\n  'max',\n  'next'\n]\n\n/**\n * Helper function to return a validated parameter for directory searches\n * @param {string} key\n * @returns {string}\n */\nfunction mapSearchKey (key) {\n  switch (key) {\n    case 'userId':\n      return 'userName'\n    default:\n      return key\n  }\n}\n","// Users plugin\nimport * as actions from '../../interface/actions/contacts'\nimport {\n  addContactRequest,\n  updateContactRequest,\n  deleteContactRequest,\n  fetchContactRequest,\n  refreshContactsRequest\n} from '../requests/contacts'\n\n// Other plugins.\nimport { getRequestInfo } from '../../../auth/interface/selectors'\n\n// Helpers\nimport { remoteContactFromLocal, localContactFromRemote } from '../utils'\nimport BasicError from '../../../errors'\nimport { usersCodes } from '../../../errors/codes'\n\n// Libraries\nimport { call, put, select } from 'redux-saga/effects'\n\n/**\n * Add a contact to the Address Book\n * @method addContact\n * @param {Object} action an action of type ADD_CONTACT\n */\nexport function * addContact (action) {\n  const requestInfo = yield select(getRequestInfo, 'cpaas')\n  const contactBody = remoteContactFromLocal(action.payload, true)\n  const res = yield call(addContactRequest, requestInfo, JSON.stringify(contactBody))\n  if (res.error) {\n    yield put(actions.addContactFinish({ error: res.error }))\n  } else {\n    yield put(actions.addContactFinish({ contact: action.payload }))\n  }\n}\n\n/**\n * Update a contact in the address book\n * @method updateContact\n * @param {Object} action an action of type UPDATE_CONTACT\n */\nexport function * updateContact (action) {\n  // validate\n  if (!action.payload.contact.contactId) {\n    // contactId is a mandatory field\n    yield put(\n      actions.updateContactFinish({\n        error: new BasicError({\n          code: usersCodes.INVALID_PARAM,\n          message: 'Missing property: contactId'\n        })\n      })\n    )\n    return\n  }\n\n  const requestInfo = yield select(getRequestInfo, 'cpaas')\n  const contactBody = remoteContactFromLocal(action.payload.contact, false)\n  const res = yield call(\n    updateContactRequest,\n    requestInfo,\n    action.payload.contact.contactId,\n    JSON.stringify(contactBody)\n  )\n  if (res.error) {\n    yield put(actions.updateContactFinish({ error: res.error }))\n  } else {\n    yield put(actions.updateContactFinish({ contact: action.payload.contact }))\n  }\n}\n\n/**\n * Remove a contact from the address book\n * @method removeContact\n * @param {Object} action an action of type REMOVE_CONTACT\n */\nexport function * removeContact (action) {\n  const requestInfo = yield select(getRequestInfo, 'cpaas')\n  const res = yield call(deleteContactRequest, requestInfo, action.payload)\n  if (res.error) {\n    yield put(actions.removeContactFinish({ error: res.error }))\n  } else {\n    yield put(actions.removeContactFinish({ contactId: action.payload }))\n  }\n}\n\n/**\n * Fetch a contact from the personal address book of the subscribed user.\n * @method fetchContact\n * @param {Object} action an action of type FETCH_CONTACT\n */\nexport function * fetchContact (action) {\n  const requestInfo = yield select(getRequestInfo, 'cpaas')\n  const res = yield call(fetchContactRequest, requestInfo, action.payload)\n  if (res.error) {\n    yield put(actions.fetchContactFinish({ error: res.error }))\n  } else {\n    yield put(actions.fetchContactFinish({ contact: localContactFromRemote(res.result) }))\n  }\n}\n\n/**\n * Refresh the state's contacts by fetching the latest contacts from the user's address book\n * @method refreshContacts\n * @param {Object} action an action of type REFRESH_CONTACTS\n */\nexport function * refreshContacts (action) {\n  const requestInfo = yield select(getRequestInfo, 'cpaas')\n  const res = yield call(refreshContactsRequest, requestInfo)\n  if (res.error) {\n    yield put(actions.refreshContactsFinish({ error: res.error }))\n  } else {\n    yield put(actions.refreshContactsFinish({ contacts: res.result.map(localContactFromRemote) }))\n  }\n}\n","/**\n * Users saga index.\n * Defines which actions trigger which sagas.\n */\n\n// Users plugin.\nimport * as contactsSagas from './contacts'\nimport * as usersSagas from './users'\nimport * as actionTypes from '../../interface/actions/actionTypes'\n\n// Libraries.\nimport { takeEvery } from 'redux-saga/effects'\n\n// Contacts sagas\n\n/**\n * addContact\n *\n * Add a contact to the personal address book of the subscribed user.\n * @method addContact\n */\nexport function * addContact () {\n  yield takeEvery(actionTypes.ADD_CONTACT, contactsSagas.addContact)\n}\n\n/**\n * updateContact\n *\n * Update a contact to the personal address book of the subscribed user.\n * @method updateContact\n */\nexport function * updateContact () {\n  yield takeEvery(actionTypes.UPDATE_CONTACT, contactsSagas.updateContact)\n}\n\n/**\n * removeContact\n *\n * Remove a contact from the currently subscribed user's address book.\n * @method removeContact\n */\nexport function * removeContact () {\n  yield takeEvery(actionTypes.REMOVE_CONTACT, contactsSagas.removeContact)\n}\n\n/**\n * fetchContact\n *\n * Fetch a contact from the personal address book of the subscribed user.\n * @method fetchContact\n */\nexport function * fetchContact () {\n  yield takeEvery(actionTypes.FETCH_CONTACT, contactsSagas.fetchContact)\n}\n\n/**\n * refreshContacts\n *\n * Refresh the contacts of the currently subscribed user.\n * @method refreshContacts\n */\nexport function * refreshContacts () {\n  yield takeEvery(actionTypes.REFRESH_CONTACTS, contactsSagas.refreshContacts)\n}\n\n// Users sagas\n\n/**\n * searchDirectory\n *\n * Search the user directory.\n * @method searchDirectory\n */\nexport function * searchDirectory () {\n  yield takeEvery(actionTypes.SEARCH_DIRECTORY, usersSagas.searchDirectory)\n}\n\n/**\n * fetchUser\n *\n * Fetch a user from the directory service.\n * @method fetchUser\n */\nexport function * fetchUser () {\n  yield takeEvery(actionTypes.FETCH_USER, usersSagas.fetchUser)\n}\n\n/**\n * fetchSelfInfo\n *\n * Fetch user information for the currently logged in user.\n * @method fetchSelfInfo\n */\nexport function * fetchSelfInfo () {\n  yield takeEvery(actionTypes.FETCH_SELF_INFO, usersSagas.fetchSelfInfo)\n}\n","// Users plugin\nimport * as actions from '../../interface/actions/users'\nimport { directorySearch } from '../requests/users'\n\n// Other plugins.\nimport { getRequestInfo, getIdentity } from '../../../auth/interface/selectors'\nimport { getLogManager } from '../../../logs'\n\n// Helpers\nimport BasicError from '../../../errors'\nimport { usersCodes } from '../../../errors/codes'\n\n// Libraries\nimport { call, put, select } from 'redux-saga/effects'\nimport { localUserFromRemote } from '../utils'\n\n// Constants\nimport { platforms } from '../../../constants'\n\nconst log = getLogManager().getLogger('Users')\n\n/**\n * Search the directory for users\n * @method searchDirectory\n * @param {Object} action an action of type SEARCH_DIRECTORY\n */\nexport function * searchDirectory (action) {\n  const { filters, options } = action.payload\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const res = yield call(directorySearch, requestInfo, { ...filters, ...options })\n  if (res.error) {\n    const error = new BasicError({\n      code: usersCodes.DIRECTORY_REQUEST_FAIL,\n      message: 'Directory search request resulted in an error being returned from the server'\n    })\n    yield put(actions.searchDirectoryFinish({ error }))\n  } else {\n    const users = res.directoryItem.map(localUserFromRemote)\n    yield put(actions.searchDirectoryFinish({ users }))\n  }\n}\n\n/**\n * fetch one user by their userId\n * @method fetchUser\n * @param {Object} action an action of type FETCH_USER\n */\nexport function * fetchUser (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const res = yield call(directorySearch, requestInfo, { userId: action.payload, sortBy: 'name', order: 'asc' })\n  if (res.error) {\n    const error = new BasicError({\n      code: usersCodes.DIRECTORY_REQUEST_FAIL,\n      message: 'Directory search request resulted in an error being returned from the server'\n    })\n    yield put(actions.fetchUserFinish({ error }))\n  } else {\n    if (res.directoryItem.length > 0) {\n      if (res.directoryItem.length > 1) {\n        log.info('Fetch User request returned more than 1 user', res.directoryItem)\n      }\n      yield put(actions.fetchUserFinish(localUserFromRemote(res.directoryItem[0])))\n    }\n  }\n}\n\n/**\n * Fetch the user information from the directory for the current user.\n * This API is simply a shortcut for the {@link user.fetch user.fetch(getUserInfo().identity)} API.\n *\n * @method fetchSelfInfo\n * @param {Object} action an action of type FETCH_SELF_INFO\n */\nexport function * fetchSelfInfo (action) {\n  const requestInfo = yield select(getRequestInfo, platforms.CPAAS)\n  const identity = yield select(getIdentity)\n\n  const res = yield call(directorySearch, requestInfo, {\n    userName: identity.split('@')[0],\n    sortBy: 'name',\n    order: 'asc'\n  })\n  if (res.error) {\n    const error = new BasicError({\n      code: usersCodes.DIRECTORY_REQUEST_FAIL,\n      message: 'Directory search request resulted in an error being returned from the server'\n    })\n    yield put(actions.fetchSelfInfoFinish({ error }))\n  } else {\n    if (res.directoryItem.length > 0) {\n      if (res.directoryItem.length > 1) {\n        log.info('Fetch Self Info returned more than 1 user', res.directoryItem)\n      }\n      yield put(actions.fetchSelfInfoFinish(localUserFromRemote(res.directoryItem[0])))\n    }\n  }\n}\n","// Libraries\nimport { map, omit, reduce } from 'lodash/fp'\n\n/**\n * localContactFromRemote\n *\n * Convert a contact object from the back end format used in REST calls, to the local format maintained in the state.\n *\n * @param {Object} contact A remote contact object\n */\nexport function localContactFromRemote (contact) {\n  if (contact) {\n    const formattedContact = reduce(\n      (result, item) => ({ ...result, [item.name]: item.value }),\n      {},\n      contact.attributeList.attribute\n    )\n\n    formattedContact.contactId = contact.contactId\n    return formattedContact\n  }\n}\n\n/**\n * Helper function to restructure local contact data for use in a REST request.\n *\n * @param {Object} contact The contact object\n * @param {boolean} [newContact] Flag to indicate that the data being processed is for a new contact\n */\nexport function remoteContactFromLocal (contact, newContact = true) {\n  // Cloning the contact to facilitate the removal of `contactId` from the attributes portion of the REST body\n  const omittedKeys = newContact ? ['contactId'] : ['contactId', 'name']\n  const contactData = omit(omittedKeys, contact)\n  const attributes = map(([key, value]) => ({ name: key, value: String(value) }), Object.entries(contactData))\n\n  return {\n    contact: {\n      attributeList: {\n        attribute: attributes\n      },\n      contactId: contact.contactId\n    }\n  }\n}\n\n/**\n * Helper function to organize user information into an object structure for storage in state\n */\nexport function localUserFromRemote (data) {\n  const user = {}\n  for (let attribute of data.attribute) {\n    user[attribute.name] = attribute.value\n  }\n  if ('primaryContact' in user) {\n    user.userId = user.primaryContact\n    delete user.primaryContact\n  }\n  return user\n}\n","const prefix = '@@KANDY/'\n\n/**\n * Contact Actions\n *\n * Action types associated with the operations of methods on the contacts namespace\n */\nexport const ADD_CONTACT = prefix + 'ADD_CONTACT'\nexport const ADD_CONTACT_FINISH = prefix + 'ADD_CONTACT_FINISH'\n\nexport const REFRESH_CONTACTS = prefix + 'REFRESH_CONTACTS'\nexport const REFRESH_CONTACTS_FINISH = prefix + 'REFRESH_CONTACTS_FINISH'\n\nexport const REMOVE_CONTACT = prefix + 'REMOVE_CONTACT'\nexport const REMOVE_CONTACT_FINISH = prefix + 'REMOVE_CONTACT_FINISH'\n\nexport const UPDATE_CONTACT = prefix + 'UPDATE_CONTACT'\nexport const UPDATE_CONTACT_FINISH = prefix + 'UPDATE_CONTACT_FINISH'\n\nexport const FETCH_CONTACT = prefix + 'FETCH_CONTACT'\nexport const FETCH_CONTACT_FINISH = prefix + 'FETCH_CONTACT_FINISH'\n\n/**\n * User Actions\n *\n * Action types associated with the operations of methods on the users namespace\n */\nexport const FETCH_USER = prefix + 'FETCH_USER'\nexport const FETCH_USER_FINISH = prefix + 'FETCH_USER_FINISH'\n\nexport const FETCH_SELF_INFO = prefix + 'FETCH_SELF_INFO'\nexport const FETCH_SELF_INFO_FINISH = prefix + 'FETCH_SELF_INFO_FINISH'\n\nexport const SEARCH_DIRECTORY = prefix + 'SEARCH_DIRECTORY'\nexport const SEARCH_DIRECTORY_FINISH = prefix + 'SEARCH_DIRECTORY_FINISH'\n","import * as actionTypes from './actionTypes'\n\n/**\n * Refresh the contact list.\n * @returns {Object} A flux standard action representing the REFRESH_CONTACTS action.\n */\nexport function refreshContacts () {\n  return {\n    type: actionTypes.REFRESH_CONTACTS,\n    payload: null\n  }\n}\n\n/**\n * The finishing action which follows the REFRESH_CONTACTS action\n * @param {Object} $0\n * @param  {Array} [$0.contacts] An array of contact objects.\n * @param  {Object} [$0.error] An error object. Only present if an error occurred.\n * @returns {Object} A flux standard action representing the REFRESH_CONTACTS_FINISH action.\n */\nexport function refreshContactsFinish ({ contacts, error }) {\n  return {\n    type: actionTypes.REFRESH_CONTACTS_FINISH,\n    payload: error || contacts,\n    error: Boolean(error)\n  }\n}\n\n/**\n * Adds a contact to the Address Book\n * @param {Object} contact The contact object.\n * @returns {Object} A flux standard action representing the ADD_CONTACT action.\n */\nexport function addContact (contact) {\n  return {\n    type: actionTypes.ADD_CONTACT,\n    payload: contact\n  }\n}\n\n/**\n * The finishing action which follows the ADD_CONTACT action\n * @param {Object} $0\n * @param {Object} [$0.contact] The contact object.\n * @param {Object} [$0.error] An error object. Only present if an error occurred.\n * @returns {Object} A flux standard action representing the ADD_CONTACT_FINISH action.\n */\nexport function addContactFinish ({ contact, error }) {\n  return {\n    payload: error || contact,\n    error: Boolean(error),\n    type: actionTypes.ADD_CONTACT_FINISH\n  }\n}\n\n/**\n * Fetch a contact from the user's personal address book\n * @param {string} contactId The ID of the contact to be fetched\n * @returns {Object} A flux standard action representing the FETCH_CONTACT action.\n */\nexport function fetchContact (contactId) {\n  return {\n    type: actionTypes.FETCH_CONTACT,\n    payload: contactId\n  }\n}\n\n/**\n * The finishing action which follows a FETCH_CONTACT action\n * @param {Object} $0\n * @param {Object} [$0.contact] The contact object.\n * @param {Object} [$0.error] A Basic error object\n * @returns {Object} A flux standard action representing the FETCH_CONTACT_FINISH action.\n */\nexport function fetchContactFinish ({ contact, error }) {\n  return {\n    type: actionTypes.FETCH_CONTACT_FINISH,\n    payload: error || contact,\n    error: Boolean(error)\n  }\n}\n\n/**\n * Removes a contact from the Address Book\n * @param {string} contactId The id of the contact whom it has been requested to delete from the address book\n * @returns {Object} A flux standard action representing the REMOVE_CONTACT action.\n */\nexport function removeContact (contactId) {\n  return {\n    type: actionTypes.REMOVE_CONTACT,\n    payload: contactId\n  }\n}\n\n/**\n * The finishing action which follows a REMOVE_CONTACT action\n * @param {Object} $0\n * @param {string} [$0.contactId] The id of the contact whom it has been requested to delete from the address book\n * @param {Object} [$0.error] An error object. Only present if an error occurred.\n * @returns {Object} A flux standard action representing the REMOVE_CONTACT_FINISH action.\n */\nexport function removeContactFinish ({ contactId, error }) {\n  return {\n    type: actionTypes.REMOVE_CONTACT_FINISH,\n    payload: contactId || error,\n    error: !!error\n  }\n}\n\n/**\n * Updates the data for a contact in the Address Book\n * @param {Object} contact The contact object. The contact object must include the ID of the contact being targeted for an update action.\n * @returns {Object} A flux standard action representing the UPDATE_CONTACT action.\n */\nexport function updateContact (contact) {\n  return {\n    type: actionTypes.UPDATE_CONTACT,\n    payload: { contact }\n  }\n}\n\n/**\n * The finishing action which follows a UPDATE_CONTACT action\n * @param {Object} $0\n * @param {Object} [$0.contact] The contact object.\n * @param {Object} [$0.error] A Basic error object\n * @returns {Object} A flux standard action representing the UPDATE_CONTACT_FINISH action.\n */\nexport function updateContactFinish ({ contact, error }) {\n  return {\n    type: actionTypes.UPDATE_CONTACT_FINISH,\n    payload: error || contact,\n    error: !!error\n  }\n}\n","import * as actionTypes from './actionTypes'\n\n/**\n * Action for fetching the current user's profile data.\n * @returns {Object} A flux standard action\n */\nexport function fetchSelfInfo () {\n  return {\n    type: actionTypes.FETCH_SELF_INFO\n  }\n}\n\n/**\n * The finishing action to follow the FETCH_SELF_INFO action\n * @returns {Object} A flux standard action representing the FETCH_SELF_INFO_FINISH action\n */\nexport function fetchSelfInfoFinish (self, error) {\n  return {\n    type: actionTypes.FETCH_SELF_INFO_FINISH,\n    payload: error || self,\n    error: Boolean(error)\n  }\n}\n\n/**\n *\n * @param {string} userId The URI uniquely identifying the user.\n * @returns {Object} A flux standard action representing the FETCH_USER action\n */\nexport function fetchUser (userId) {\n  return {\n    type: actionTypes.FETCH_USER,\n    payload: userId\n  }\n}\n\n/**\n * Create a finish action to follow a FETCH_USER action.\n *\n * @param {Object} user A user object\n * @param {Object} [error] An error object.\n * @returns {Object} A flux standard action representing the USER_FETCH_FINISH action.\n */\nexport function fetchUserFinish (user, error) {\n  return {\n    type: actionTypes.FETCH_USER_FINISH,\n    payload: error || user,\n    error: Boolean(error)\n  }\n}\n\n/**\n * Create an action that searches the directory.\n *\n * @param {Object} filters Query filter options.\n * @param {string} [filters.name] Matches firstName or lastName.\n * @param {string} [filters.firstName] Matches firstName.\n * @param {string} [filters.lastName] Matches lastName.\n * @param {string} [filters.userName] Matches userName.\n * @param {string} [filters.phoneNumber] Matches phoneNumber.\n * @param {Object} [options] Sorting options\n * @param {string} [options.sortBy] The attribute upon which to sort results. This can be any of the above listed filters which describe a user attribute.\n * @param {string} [options.order] Order by which to return results. Can be one of \"asc\" or \"desc\".\n * @param {number} [options.max] The maximmum number of results to return.\n * @param {string} [options.next] The pointer for a chunk of results, which may be returned from other a previous query.\n * @returns {Object} A flux standard action representing the SEARCH_DIRECTORY action.\n */\nexport function searchDirectory (filters, options) {\n  return {\n    type: actionTypes.SEARCH_DIRECTORY,\n    payload: { filters, options }\n  }\n}\n\n/**\n * Create a finish action to follow the SEARCH_DIRECTORY action.\n *\n * @param {Object} $0 A dictionary object of parameters\n * @param {Array} [$0.users] The user objects\n * @param {Object} [$0.error] An error object.\n * @returns {Object} A flux standard action representing the DIRECTORY_CHANGED action.\n */\nexport function searchDirectoryFinish ({ users, error }) {\n  return {\n    type: actionTypes.SEARCH_DIRECTORY_FINISH,\n    payload: error || users,\n    error: Boolean(error)\n  }\n}\n","// Users plugin.\nimport * as actions from '../actions/contacts'\nimport { getContact, getContacts } from '../selectors'\n\nimport { getLogManager, API_LOG_TAG } from '../../../logs'\n\nconst log = getLogManager().getLogger('USERS')\n\nexport default function contactsAPI ({ dispatch, getState, primitives }) {\n  /**\n   * The 'contacts' namespace allows users to store personal contacts to their account.\n   *\n   * @public\n   * @namespace contacts\n   */\n\n  return {\n    /**\n     * Add a contact to a user's personal address book.\n     * Will trigger the `contacts:new` event.\n     *\n     * @public\n     * @memberof contacts\n     * @method add\n     * @requires addContactAsFriend\n     * @param {Object} contact The contact object.\n     * @param {string} contact.primaryContact The primary userId for the contact\n     * @param {string} contact.contactId The contact's unique contact ID\n     * @param {string} [contact.firstName] The contact's first name\n     * @param {string} [contact.lastName] The contact's last name\n     * @param {string} [contact.photoUrl] The URL address identifying location of user's picture\n     * @param {string} [contact.emailAddress] The contact's email address\n     * @param {string} [contact.homePhone] The contact's home phone number\n     * @param {string} [contact.workPhone] The contact's business phone number\n     * @param {string} [contact.mobilePhone] The contact's mobile phone number\n     * @param {string} [contact.conferenceURL] Conference URL and access code for this user's address book entry\n     * @param {string} [contact.fax] The user's fax number\n     * @param {string} [contact.pager] The user's pager number\n     * @param {string} [contact.groupList] The name of the contact list for which to add this contact to (\"friends\" by default)\n     * @param {boolean} [contact.friendStatus] Indicates whether or not the contact is a friend of the user\n     */\n    /**\n     * Add a contact to a user's personal address book.\n     * Will trigger the `contacts:new` event.\n     *\n     * @public\n     * @memberof contacts\n     * @method add\n     * @requires addContactAsBuddy\n     * @param {Object} contact The contact object.\n     * @param {string} contact.primaryContact The primary userId for the contact\n     * @param {string} contact.contactId The contact's unique contact ID\n     * @param {string} [contact.firstName] The contact's first name\n     * @param {string} [contact.lastName] The contact's last name\n     * @param {string} [contact.email] The contact's email address\n     * @param {string} [contact.homePhoneNumber] The contact's home phone number\n     * @param {string} [contact.businessPhoneNumber] The contact's business phone number\n     * @param {string} [contact.mobilePhoneNumber] The contact's mobile phone number\n     * @param {string} [contact.list] The name of the contact list for which to add this contact to (\"friends\" by default)\n     * @param {boolean} [contact.buddy] Indicates whether or not the contact is a friend of the user\n     */\n    add (contact) {\n      log.debug(API_LOG_TAG + 'contacts.add: ', contact)\n      dispatch(actions.addContact(contact))\n    },\n\n    /**\n     * Retrieves local information about a contact.\n     *\n     * @public\n     * @memberof contacts\n     * @method get\n     * @param {string} contactId The unique contact ID of the contact.\n     * @return {Object} Contact information.\n     */\n    get (contactId) {\n      log.debug(API_LOG_TAG + 'contacts.get: ', contactId)\n      return getContact(getState(), contactId)\n    },\n\n    /**\n     * Retrieves local information about all contacts.\n     *\n     * @public\n     * @memberof contacts\n     * @method getAll\n     * @return {Array} List of contact information.\n     */\n    getAll () {\n      log.debug(API_LOG_TAG + 'contacts.getAll')\n      return getContacts(getState())\n    },\n\n    /**\n     * Refreshes the local information about contacts. This will get new contacts from the platform.\n     * Will trigger the `contacts:change` event.\n     *\n     * @public\n     * @memberof contacts\n     * @method refresh\n     */\n    refresh () {\n      log.debug(API_LOG_TAG + 'contacts.refresh')\n      dispatch(actions.refreshContacts())\n    },\n\n    /**\n     * Remove a contact from a personal address book.\n     * Will trigger the `contacts:change` event.\n     *\n     * @public\n     * @memberof contacts\n     * @method remove\n     * @param  {string} id The Id of the contact that will be removed.\n     */\n    remove (id) {\n      log.debug(API_LOG_TAG + 'contacts.remove: ', id)\n      dispatch(actions.removeContact(id))\n    },\n\n    /**\n     * Update a contact from the user's personal address book.\n     * Will trigger the `contacts:change` event.\n     *\n     * @public\n     * @memberof contacts\n     * @method update\n     * @requires addContactAsFriend\n     * @param {Object} contact The contact object.\n     * @param {string} contact.primaryContact The primary userId for the contact\n     * @param {string} contact.contactId The contact's unique contact ID\n     * @param {string} [contact.firstName] The contact's first name\n     * @param {string} [contact.lastName] The contact's last name\n     * @param {string} [contact.photoUrl] The URL address identifying location of user's picture\n     * @param {string} [contact.emailAddress] The contact's email address\n     * @param {string} [contact.homePhone] The contact's home phone number\n     * @param {string} [contact.workPhone] The contact's business phone number\n     * @param {string} [contact.mobilePhone] The contact's mobile phone number\n     * @param {string} [contact.conferenceURL] Conference URL and access code for this user's address book entry\n     * @param {string} [contact.fax] The user's fax number\n     * @param {string} [contact.pager] The user's pager number\n     * @param {string} [contact.groupList] The name of the contact list for which to add this contact to (\"friends\" by default)\n     * @param {boolean} [contact.friendStatus] Indicates whether or not the contact is a friend of the user\n     */\n    /**\n     * Update a contact from the user's personal address book.\n     * Will trigger the `contacts:change` event.\n     *\n     * @public\n     * @memberof contacts\n     * @method update\n     * @requires addContactAsBuddy\n     * @param {Object} contact The contact object.\n     * @param {string} contact.primaryContact The primary userId for the contact\n     * @param {string} contact.contactId The contact's unique contact ID\n     * @param {string} [contact.firstName] The contact's first name\n     * @param {string} [contact.lastName] The contact's last name\n     * @param {string} [contact.email] The contact's email address\n     * @param {string} [contact.homePhoneNumber] The contact's home phone number\n     * @param {string} [contact.businessPhoneNumber] The contact's business phone number\n     * @param {string} [contact.mobilePhoneNumber] The contact's mobile phone number\n     * @param {string} [contact.list] The name of the contact list for which to add this contact to (\"friends\" by default)\n     * @param {boolean} [contact.buddy] Indicates whether or not the contact is a friend of the user\n     */\n    update (contact) {\n      let objectToUse\n      if (typeof contact === 'string' || contact instanceof String) {\n        log.warn(\n          API_LOG_TAG +\n            'contacts.update: Call to update(contactId, contact) has been deprecated and so it will be removed. Consider using: update(contact), instead.'\n        )\n        // second argument is supposed to be actual contact obj\n        objectToUse = arguments[1]\n      } else {\n        // Assume first param is the actual contact obj\n        objectToUse = contact\n      }\n      log.debug(API_LOG_TAG + 'contacts.update: ', objectToUse)\n      dispatch(actions.updateContact(objectToUse))\n    },\n\n    /**\n     * Fetch a contact from the user's personal address book.\n     * Will trigger the `contacts:change` event.\n     *\n     * @public\n     * @memberof contacts\n     * @method fetch\n     * @param  {string} contactId The unique contact ID of the contact.\n     */\n    fetch (contactId) {\n      log.debug(API_LOG_TAG + 'contacts.fetch: ', contactId)\n      dispatch(actions.fetchContact(contactId))\n    }\n  }\n}\n","import usersAPI from './users'\nimport contactsAPI from './contacts'\n\n/**\n * Users API index.\n * APIs are organized by their namespacing.\n * @method api\n * @param {Object} context\n * @param {Function} context.dispatch The redux store's dispatch function.\n * @param {Function} context.getState The redux store's getState function.\n * @param {Object} context.primitives Primitive types designed for use in the SDK\n * @return {Object} The plugin's API object.\n */\nexport default function api (context) {\n  return {\n    contacts: contactsAPI(context),\n    user: usersAPI(context)\n  }\n}\n","// Users plugin.\nimport * as actions from '../actions/users'\nimport { getUser, getUsers } from '../selectors'\n\nimport { getLogManager, API_LOG_TAG } from '../../../logs'\nconst log = getLogManager().getLogger('USERS')\n\nexport default function usersAPI ({ dispatch, getState, primitives }) {\n  /**\n   * The 'user' namespace allows access to user information for users within the same domain.\n   *\n   * @public\n   * @namespace user\n   */\n\n  /**\n   * The User data object.\n   *\n   * @public\n   * @module User\n   * @typedef {Object} User\n   * @memberof user\n   * @property {string} userId The User ID of the user.\n   * @property {string} emailAddress The email address of the user.\n   * @property {string} firstName The first name of the user.\n   * @property {string} lastName The last name of the user.\n   * @property {string} photoURL The URL to get the photo of the user.\n   * @property {string} buddy Whether the user is a \"buddy\". Values can be \"true\" or \"false\".\n   */\n\n  return {\n    /**\n     * Fetches information about a User.\n     *\n     * The SDK will emit a {@link user.event:directory:change directory:change}\n     *    event after the operation completes. The User's information will then\n     *    be available.\n     *\n     * Information about an available User can be retrieved using the\n     *    {@link user.get} API.\n     *\n     * @public\n     * @static\n     * @memberof user\n     * @method fetch\n     * @param {string} userId The User ID of the user.\n     */\n    fetch (userId) {\n      log.debug(API_LOG_TAG + 'user.fetch: ', userId)\n      dispatch(actions.fetchUser(userId))\n    },\n\n    /**\n     * Fetches information about the current User from directory.\n     * Compared to {@link user.fetch} API, this API retrieves additional user related information.\n     *\n     * The SDK will emit a {@link user.event:directory:change directory:change}\n     *    event after the operation completes. The User's information will then\n     *    be available.\n     *\n     * Information about an available User can be retrieved using the\n     *    {@link user.get} API.\n     *\n     * @public\n     * @static\n     * @memberof user\n     * @method fetchSelfInfo\n     * @requires selfInfoAsUserProfile\n     */\n    /**\n     * Fetches information about the current User from directory.\n     * This API is simply a shortcut for the {@link user.fetch user.fetch(getUserInfo().identity)} API.\n     *\n     * The SDK will emit a {@link user.event:directory:change directory:change}\n     *    event after the operation completes. The User's information will then\n     *    be available.\n     *\n     * Information about an available User can be retrieved using the\n     *    {@link user.get} API.\n     *\n     * @public\n     * @static\n     * @memberof user\n     * @method fetchSelfInfo\n     * @requires selfInfoAsUserSearch\n     */\n    fetchSelfInfo () {\n      log.debug(API_LOG_TAG + 'user.fetchSelfInfo')\n      dispatch(actions.fetchSelfInfo())\n    },\n\n    /**\n     * Retrieves information about a User, if available.\n     *\n     * See the {@link user.fetch} and {@link user.search} APIs for details about\n     *    making Users' information available.\n     *\n     * @public\n     * @memberof user\n     * @method get\n     * @param {string} userId The User ID of the user.\n     * @returns {User} The User object for the specified user.\n     */\n    get (userId) {\n      log.debug(API_LOG_TAG + 'user.get: ', userId)\n      return getUser(getState(), userId)\n    },\n\n    /**\n     * Retrieves information about all available Users.\n     *\n     * See the {@link user.fetch} and {@link user.search} APIs for details about\n     *    making Users' information available.\n     *\n     * @public\n     * @memberof user\n     * @method getAll\n     * @returns {Array<User>} An array of all the User objects.\n     */\n    getAll () {\n      log.debug(API_LOG_TAG + 'user.getAll')\n      return getUsers(getState())\n    },\n\n    /**\n     * Searches the domain's directory for Users.\n     *\n     * The SDK will emit a {@link user.event:directory:change directory:change}\n     *    event after the operation completes. The search results will be\n     *    provided as part of the event, and will also be available using the\n     *    {@link user.get} and {@link user.getAll} APIs.\n     *\n     * @public\n     * @static\n     * @memberof user\n     * @method search\n     * @param {Object} filters The filter options for the search.\n     * @param {string} [filters.userId] Matches the User ID of the user.\n     * @param {string} [filters.name] Matches the firstName or lastName.\n     * @param {string} [filters.firstName] Matches the firstName.\n     * @param {string} [filters.lastName] Matches the lastName.\n     * @param {string} [filters.userName] Matches the userName.\n     * @param {string} [filters.phoneNumber] Matches the phoneNumber.\n     * @param {Object} [options] Sorting options.\n     * @param {string} [options.sortBy] The User property to sort the results by. This can be any of the above listed filters.\n     * @param {string} [options.order] Order in which results are returned. Can be either \"asc\" or \"desc\".\n     * @param {number} [options.max] The maximum number of results to return.\n     * @param {string} [options.next] The pointer for a chunk of results, which may be returned from a previous query.\n     */\n    search (filters = {}, options = {}) {\n      log.debug(API_LOG_TAG + 'user.search: ', filters, options)\n      dispatch(actions.searchDirectory(filters, options))\n    }\n  }\n}\n","import * as actionTypes from '../actions/actionTypes'\nimport * as eventTypes from './eventTypes'\n\nconst eventsMap = {}\n\nconst contactNewEvent = action => {\n  return {\n    type: eventTypes.CONTACTS_CHANGE,\n    args: action.payload\n  }\n}\n\nconst contactsChangeEvent = action => {\n  if (action.error) {\n    return {\n      type: eventTypes.CONTACTS_ERROR,\n      args: { error: action.payload }\n    }\n  } else {\n    return {\n      type: eventTypes.CONTACTS_CHANGE\n    }\n  }\n}\n\nconst addContactFinishActions = action => {\n  if (action.error) {\n    return contactsChangeEvent(action)\n  }\n  return [contactNewEvent(action), contactsChangeEvent(action)]\n}\n\neventsMap[actionTypes.ADD_CONTACT_FINISH] = addContactFinishActions\neventsMap[actionTypes.REFRESH_CONTACTS_FINISH] = contactsChangeEvent\neventsMap[actionTypes.REMOVE_CONTACT_FINISH] = contactsChangeEvent\neventsMap[actionTypes.UPDATE_CONTACT_FINISH] = contactsChangeEvent\neventsMap[actionTypes.FETCH_CONTACT_FINISH] = contactsChangeEvent\n\nexport default eventsMap\n","// Contacts actions\n/**\n * A new contact has been added to the address book.\n * @public\n * @memberof contacts\n * @event contacts:new\n * @param {Object} contact The new contact.\n */\nexport const CONTACTS_NEW = 'contacts:new'\n\n/**\n * An error occurred while performing a contact operation.\n * @public\n * @memberof contacts\n * @event contacts:error\n * @param {Object} params\n * @param {Object} params.error The Basic error object.\n */\nexport const CONTACTS_ERROR = 'contacts:error'\n\n/**\n * The contacts list has changed.\n * @public\n * @memberof contacts\n * @event contacts:change\n * @example\n * client.on('contacts:change', function () {\n *    // Get the updated list of contacts.\n *    const contacts = client.contacts.getAll()\n *    ...\n * })\n */\nexport const CONTACTS_CHANGE = 'contacts:change'\n\n// Users actions\n/**\n * The directory has changed.\n * @public\n * @static\n * @memberof user\n * @event directory:change\n * @param {Object} params\n * @param {Array<User>} params.results The Users' information returned by the\n *    operation.\n */\nexport const DIRECTORY_CHANGE = 'directory:change'\n\n/**\n * An error occurred while performing a directory operation.\n * @public\n * @memberof user\n * @event directory:error\n * @param {Object} params\n * @param {Object} params.error The Basic error object.\n */\nexport const DIRECTORY_ERROR = 'directory:error'\n","import * as actionTypes from '../actions/actionTypes'\nimport * as eventTypes from './eventTypes'\n\nconst eventsMap = {}\n\neventsMap[actionTypes.SEARCH_DIRECTORY_FINISH] = function (action) {\n  if (action.error) {\n    return {\n      type: eventTypes.DIRECTORY_ERROR,\n      args: { error: action.payload }\n    }\n  } else {\n    return {\n      type: eventTypes.DIRECTORY_CHANGE,\n      args: { results: action.payload }\n    }\n  }\n}\n\neventsMap[actionTypes.FETCH_USER_FINISH] = eventsMap[actionTypes.FETCH_SELF_INFO_FINISH] = function (action) {\n  if (action.error) {\n    return {\n      type: eventTypes.DIRECTORY_ERROR,\n      args: { error: action.payload }\n    }\n  } else {\n    return {\n      type: eventTypes.DIRECTORY_CHANGE,\n      args: { results: [action.payload] }\n    }\n  }\n}\n\nexport default eventsMap\n","// Import the components of the interface.\nimport api from './api'\nimport reducer from './reducers'\n\n/**\n * This interface is for a users plugin.\n * @type {string}\n */\nconst name = 'users'\n\n// Export the interface as a single object.\nexport default { name, api, reducer }\n","import * as actionTypes from '../actions/actionTypes'\nimport { unset } from 'lodash/fp'\n\nconst reducers = {}\n\nconst contactsPendingReducer = {\n  next (state) {\n    return {\n      ...state,\n      isPending: true\n    }\n  }\n}\n\nreducers[actionTypes.ADD_CONTACT] = contactsPendingReducer\nreducers[actionTypes.REFRESH_CONTACTS] = contactsPendingReducer\nreducers[actionTypes.FETCH_CONTACT] = contactsPendingReducer\nreducers[actionTypes.UPDATE_CONTACT] = contactsPendingReducer\n\nreducers[actionTypes.ADD_CONTACT_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      contacts: {\n        ...state.contacts,\n        [action.payload.contactId]: action.payload\n      },\n      isPending: false\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.REFRESH_CONTACTS_FINISH] = {\n  next (state, action) {\n    const contacts = {}\n    for (let contact of action.payload) {\n      contacts[contact.contactId] = contact\n    }\n    return {\n      ...state,\n      contacts: contacts,\n      isPending: false\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.FETCH_CONTACT_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      contacts: {\n        ...state.contacts,\n        [action.payload.contactId]: action.payload\n      },\n      isPending: false\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.REMOVE_CONTACT_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      contacts: unset(action.payload, state.contacts), // Remove the property from state.contacts whose key is equal to action.payload\n      isPending: false\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.UPDATE_CONTACT_FINISH] = {\n  next (state, action) {\n    return {\n      ...state,\n      contacts: {\n        ...state.contacts,\n        [action.payload.contactId]: action.payload\n      },\n      isPending: false\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nexport default reducers\n","import contactsReducers from './contacts'\nimport usersReducers from './users'\nimport { handleActions } from 'redux-actions'\n\n/*\n * Combine all of reducers into a single reducer, defaulting to an empty Object for each\n * substate of contacts and users\n */\nconst reducer = handleActions(\n  { ...contactsReducers, ...usersReducers },\n  {\n    errors: [],\n    contacts: {},\n    users: {},\n    isPending: true\n  }\n)\nexport default reducer\n","import * as actionTypes from '../actions/actionTypes'\n\nconst reducers = {}\n\nreducers[actionTypes.FETCH_USER_FINISH] = {\n  next (state, action) {\n    const user = action.payload\n    return {\n      ...state,\n      users: {\n        ...state.users,\n        [user.userId]: user\n      }\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.FETCH_SELF_INFO_FINISH] = {\n  next (state, action) {\n    const self = action.payload\n    return {\n      ...state,\n      users: {\n        ...state.users,\n        [self.userId]: self\n      }\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.SEARCH_DIRECTORY_FINISH] = {\n  next (state, action) {\n    const users = {}\n    for (let user of action.payload) {\n      users[user.userId] = user\n    }\n    return {\n      ...state,\n      users: {\n        ...state.users,\n        ...users\n      },\n      isPending: false\n    }\n  },\n  throw (state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nexport default reducers\n","import { cloneDeep } from 'lodash/fp'\n\n/*\n * Redux-saga selector functions.\n * Used with the `select` effect in sagas to Retrieves\n *      specific portions of the state.\n */\n\n/**\n * Gets the contacts from state.\n * @method getContacts\n * @return {Object}\n */\nexport function getContacts (state) {\n  return cloneDeep(state.users.contacts)\n}\n\n/**\n * Gets a contact from the state whose ID matches the supplied parameter\n * @method getContact\n * @return {Object}\n */\nexport function getContact (state, id) {\n  return cloneDeep(state.users.contacts[id])\n}\n\n/**\n * Gets the users from state.\n * @method getUsers\n * @return {Array<User>} An array of all the User objects.\n */\nexport function getUsers (state) {\n  let allUsers = cloneDeep(state.users.users)\n  return Object.values(allUsers)\n}\n\n/**\n * Gets the users from state.\n * @method getUser\n * @return {Object}\n */\nexport function getUser (state, name) {\n  return cloneDeep(state.users.users[name])\n}\n","// Webrtc plugin.\nimport { deviceActions } from '../interface/actions'\n\n// Libraries.\nimport { put, takeEvery } from 'redux-saga/effects'\nimport { eventChannel } from 'redux-saga'\n\n/**\n * Listen for events emitted from the webRTC Device Manager.\n * @method watchDeviceEvents\n * @param  {Object} manager The webRTC Device Manager.\n */\nexport default function * watchDeviceEvents (manager) {\n  /**\n   * Create an event channel between the Device Manager and redux-saga.\n   * This pushes its events into the redux-saga context.\n   * */\n  const managerChannel = eventChannel(emit => {\n    return setListeners(manager, emit)\n  })\n\n  // managerChannel will emit the Manager's events as actions,\n  //  so they can be directly dispatched.\n  yield takeEvery(managerChannel, put)\n}\n\n/**\n * Function to set-up listeners for the Device Manager events.\n * Contains the logic for how a webRTC event should be parsed\n *    before being sent elsewhere. Split into a stand-alone\n *    function in order to be re-usable.\n * @method setListeners\n * @param  {Object}   manager The Device Manager.\n * @param  {Function} emit    Function that receives the parsed events.\n * @param  {Any}      [END='END'] The \"end of lifetime\" symbol.\n * @return {Function} The unsubscribe function.\n */\nexport function setListeners (manager, emit, END = 'END') {\n  // Manager event handlers.\n  const change = () => {\n    // Get the latest devices after they changed, then emit the device list\n    //  upwards.\n    manager.checkDevices().then(devices => {\n      emit(deviceActions.devicesChanged(devices))\n    })\n  }\n\n  manager.on('change', change)\n\n  // Return an unsubscribe function that removes all event listeners.\n  const unsubscribe = () => {\n    manager.off('change', change)\n  }\n\n  return unsubscribe\n}\n","// Libaries.\nimport { fork } from 'redux-saga/effects'\n\n// Manager channels.\nimport watchDeviceEvents from './devices'\nimport watchTrackManagerEvents from './trackManager'\nimport watchSessionManagerEvents from './sessionManager'\nimport watchMediaManagerEvents from './mediaManager'\n\n// Re-export each channel.\nexport { default as watchDeviceEvents } from './devices'\nexport { default as watchTrackManagerEvents } from './trackManager'\nexport { default as watchMediaManagerEvents } from './mediaManager'\n\n/**\n * Combine all of the manager channels into a single function.\n * @method watchManagers\n * @param  {Object} managers Webrtc stack managers.\n */\nexport default function * watchManagers (managers, webRTC) {\n  yield fork(watchDeviceEvents, managers.devices)\n  yield fork(watchTrackManagerEvents, managers.track)\n  yield fork(watchSessionManagerEvents, managers.sessionManager, webRTC)\n  yield fork(watchMediaManagerEvents, managers.media)\n}\n","// Webrtc plugin.\nimport { mediaActions } from '../interface/actions'\n\n// Libraries.\nimport { put, takeEvery } from 'redux-saga/effects'\nimport { eventChannel, END } from 'redux-saga'\n\n/**\n * Sets up event listeners for a Media's events.\n * The events are turned into actions and dispatched\n *    to be handled by redux elsewhere.\n * @method watchMediaEvents\n * @param  {Object} media A Media object.\n * @param  {Object} webRTC The webRTC stack.\n */\nexport default function * watchMediaEvents (media, webRTC) {\n  /**\n   * Create an event channel between the Media and redux-saga.\n   * This \"forces\" the Media events into a redux-saga context.\n   */\n  const mediaChannel = eventChannel(emit => {\n    return setListeners(media, emit, END)\n  })\n  yield takeEvery(mediaChannel, put)\n}\n\n/**\n * Function to set-up listeners for a Media object's events.\n * Contains the logic for how a webRTC event should be parsed\n *    before being sent elsewhere. Split into a stand-alone\n *    function in order to be re-usable.\n * @method setListeners\n * @param  {Object}   media A Media object.\n * @param  {Function} emit  Function that receives the parsed events.\n * @param  {Any}      [END='END'] The \"end of lifetime\" symbol.\n * @return {Function} The unsubscribe function.\n */\nexport function setListeners (media, emit, END = 'END') {\n  // Media received a new track.\n  const newTrack = ({ mediaId, trackId }) => {\n    /**\n     * When a new track has been added,\n     * update redux state's webrtc.media.tracks array with the new trackId.\n     */\n    emit(mediaActions.mediaNewTrack(mediaId, { trackId }))\n  }\n\n  // TODO: Handle media's 'track:removed' event here.\n  //  In unified-plan, when a track is removed this event is triggered.\n  const trackRemoved = trackId => {\n    emit(mediaActions.mediaTrackRemoved(media.id, { trackId }))\n  }\n\n  const trackEnded = ({ mediaId, trackId }) => {\n    /**\n     * When a track has ended,\n     * update redux state's webrtc.media.tracks array\n     * by removing the specified trackId.\n     */\n    emit(mediaActions.mediaTrackEnded(mediaId, { trackId }))\n  }\n  const mediaStopped = id => {\n    /**\n     * When the media is stopped, its channel should be ended (via `END`).\n     * The mediaManager channel will handle updating state for this event.\n     */\n    emit(END)\n  }\n\n  media.on('track:new', newTrack)\n  media.on('track:removed', trackRemoved)\n  media.on('track:ended', trackEnded)\n  media.on('media:stopped', mediaStopped)\n\n  const unsubscribe = () => {\n    media.off('track:new', newTrack)\n    media.off('track:removed', trackRemoved)\n    media.off('track:ended', trackEnded)\n    media.off('media:stopped', mediaStopped)\n  }\n  return unsubscribe\n}\n","// Webrtc plugin.\nimport { mediaActions } from '../interface/actions'\nimport * as actionTypes from '../interface/actionTypes'\nimport watchMediaEvents from './media'\n\n// Libraries.\nimport { put, takeEvery, fork } from 'redux-saga/effects'\nimport { eventChannel } from 'redux-saga'\n\n/**\n * Sets up event listeners for Media Manager events. The events are turned into\n *    actions and dispatched to be handled by redux elsewhere.\n * @method watchMediaManagerEvents\n * @param  {Object} manager The Media Manager.\n */\nexport default function * watchMediaManagerEvents (manager) {\n  /**\n   * Create an event channel between the Media Manager and redux-saga.\n   * This pushes its events into the redux-saga context.\n   */\n  const managerChannel = eventChannel(emit => {\n    return setListeners(manager, emit)\n  })\n\n  yield takeEvery(managerChannel, mediaManagerEventsHandler)\n}\n\nfunction * mediaManagerEventsHandler ({ media, action }) {\n  // If it is a new Media, watch for its events.\n  if (action.type === actionTypes.MEDIA_NEW) {\n    yield fork(watchMediaEvents, media)\n  }\n\n  // Dispatch the action\n  yield put(action)\n}\n\n/**\n * Function to set-up listeners for the Media Manager events.\n * Contains the logic for how a webRTC event should be parsed\n *    before being sent elsewhere. Split into a stand-alone\n *    function in order to be re-usable.\n * @method setListeners\n * @param  {Object}   manager The Media Manager.\n * @param  {Function} emit    Function that receives the parsed events.\n * @param  {Any}      [END='END'] The \"end of lifetime\" symbol.\n * @return {Function} The unsubscribe function.\n */\nexport function setListeners (manager, emit, END = 'END') {\n  const newMedia = id => {\n    const media = manager.get(id)\n    /**\n     * When a new media has been added,\n     * update redux state's webrtc.media array by adding in the new media object\n     * (List of tracks will just be a list of track ids).\n     */\n    emit({\n      media,\n      action: mediaActions.newMedia(id, {\n        local: media.getState().isLocal,\n        tracks: media.getTracks().map(track => track.id)\n      })\n    })\n  }\n\n  const removedMedia = id => {\n    /**\n     * When a media has been removed,\n     * update redux state's webrtc.media array\n     * by removing the media with the specified media id.\n     */\n    emit({\n      action: mediaActions.removedMedia(id)\n    })\n  }\n\n  manager.on('media:new', newMedia)\n  manager.on('media:removed', removedMedia)\n\n  const unsubscribe = () => {\n    manager.off('media:new', newMedia)\n    manager.off('media:removed', removedMedia)\n  }\n  return unsubscribe\n}\n","// Webrtc plugin.\nimport { sessionActions } from '../interface/actions'\n\n// Libraries.\nimport { put, takeEvery } from 'redux-saga/effects'\nimport { eventChannel } from 'redux-saga'\n\n/**\n * Sets up event listeners for a Session's events.\n * The events are turned into actions and dispatched\n *    to be handled by redux elsewhere.\n * @method watchSessionEvents\n * @param  {Object} session The Session object.\n * @param  {Object} webRTC The webRTC stack.\n */\nexport default function * watchSessionEvents (session, webRTC) {\n  /**\n   * Create an event channel between the Session and redux-saga.\n   * This \"forces\" the Session events into a redux-saga context.\n   */\n  const sessionChannel = eventChannel(emit => {\n    return setListeners(session, emit)\n  })\n  // sessionChannel will emit the Session's events as actions, so dispatch\n  //    them to be handled by sagas.\n  // TODO: If the event is \"Session gone\", should close/unsubscribe the channel.\n  yield takeEvery(sessionChannel, put)\n}\n\n/**\n * Function to set-up listeners for a Session object's events.\n * Contains the logic for how a webRTC event should be parsed\n *    before being sent elsewhere. Split into a stand-alone\n *    function in order to be re-usable.\n * @method setListeners\n * @param  {Object}   session A Session object.\n * @param  {Function} emit  Function that receives the parsed events.\n * @param  {Any}      [END='END'] The \"end of lifetime\" symbol.\n * @return {Function} The unsubscribe function.\n */\nexport function setListeners (session, emit, END = 'END') {\n  // Session received a new track.\n  const newTrack = ({ local, trackId }) => {\n    /**\n     * When a new track has been added,\n     * update redux state's webrtc.session.localTracks/remoteTracks array\n     * with the new trackId.\n     * ('local' boolean will determine whether to update localTracks or remoteTracks)\n     */\n    emit(\n      sessionActions.sessionNewTrack(session.id, {\n        local,\n        trackId\n      })\n    )\n  }\n\n  const trackRemoved = ({ local, trackId }) => {\n    emit(\n      sessionActions.sessionTrackRemoved(session.id, {\n        local,\n        trackId\n      })\n    )\n  }\n\n  const trackEnded = ({ local, trackId }) => {\n    /**\n     * When a track has ended,\n     * update redux state's webrtc.session.localTracks/remoteTracks array\n     * by removing the specified trackId.\n     * ('local' boolean will determine whether to update localTracks or remoteTracks)\n     */\n    emit(\n      sessionActions.sessionTrackEnded(session.id, {\n        local,\n        trackId\n      })\n    )\n  }\n\n  const trackReplaced = ({ oldTrackId, trackId }) => {\n    emit(\n      sessionActions.sessionTrackReplaced(session.id, {\n        oldTrackId,\n        trackId\n      })\n    )\n  }\n\n  // Generic \"something changed\" handler.\n  // TODO: Either use this for other events or remove it.\n  // eslint-disable-next-line no-unused-vars\n  const onChange = () => {\n    const state = session.getState()\n\n    emit(\n      sessionActions.sessionChange(session.id, {\n        id: state.id,\n        localTracks: state.localTracks.map(track => track.id),\n        remoteTracks: state.remoteTracks.map(track => track.id)\n      })\n    )\n  }\n\n  session.on('new:track', newTrack)\n  session.on('track:removed', trackRemoved)\n  session.on('track:ended', trackEnded)\n  session.on('track:replaced', trackReplaced)\n\n  const unsubscribe = () => {\n    session.off('new:track', newTrack)\n    session.off('track:removed', trackRemoved)\n    session.off('track:ended', trackEnded)\n    session.off('track:replaced', trackReplaced)\n  }\n  return unsubscribe\n}\n","// Webrtc plugin.\nimport { sessionActions } from '../interface/actions'\nimport * as actionTypes from '../interface/actionTypes'\nimport watchSessionEvents from './session'\n\n// Libraries.\nimport { fork, put, take } from 'redux-saga/effects'\nimport { eventChannel } from 'redux-saga'\n\n/**\n * Sets up event listeners for Session Manager Events.\n * The events are turned into actions and dispatched\n *    to be handled by redux elsewhere.\n * @method watchSessionManagerEvents\n * @param  {Object} manager The webRTC Session Manager.\n * @param  {Object} webRTC The webRTC stack.\n */\nexport default function * watchSessionManagerEvents (manager, webRTC) {\n  /**\n   * Create an event channel between the Session Manager and redux-saga.\n   * This pushes its events into the redux-saga context.\n   */\n  const managerChannel = eventChannel(emit => {\n    return setListeners(manager, emit)\n  })\n\n  while (true) {\n    const { session, action } = yield take(managerChannel)\n\n    // If it is a new Session, watch for its events.\n    if (action.type === actionTypes.SESSION_ADDED) {\n      yield fork(watchSessionEvents, session, webRTC)\n    }\n\n    // Dispatch the action directly.\n    yield put(action)\n  }\n}\n\n/**\n * Sets up listeners for the Session Manager events.\n * Contains logic for how specific webRTC events should be\n *    parsed before being sent elsewhere. Split into a\n *    stand-alone function in order to be re-usable.\n * @method setListeners\n * @param  {Object}   manager The Session Manager.\n * @param  {Function} emit    Function that receives the parsed events.\n * @param  {Any}      [END='END'] The \"end of lifetime\" symbol.\n * @return {Function} The unsubscribe function.\n */\nexport function setListeners (manager, emit, END = 'END') {\n  // Handle new Session.\n  const sessionAdded = id => {\n    const session = manager.get(id)\n    const state = session.getState()\n    delete state.id\n\n    emit({\n      session: session,\n      action: sessionActions.sessionAdded(id, state)\n    })\n  }\n\n  // Handle Sessions ending.\n  const sessionRemoved = id => {\n    emit({\n      action: sessionActions.sessionRemoved(id)\n    })\n  }\n\n  manager.on('session:new', sessionAdded)\n  manager.on('session:removed', sessionRemoved)\n  const unsubscribe = () => {\n    manager.off('session:new', sessionAdded)\n    manager.off('session:removed', sessionRemoved)\n  }\n  return unsubscribe\n}\n","// Libraries.\nimport { put, takeEvery } from 'redux-saga/effects'\nimport { eventChannel, END } from 'redux-saga'\n\n/**\n * Sets up event listeners for a Track's events.\n * The events are turned into actions and dispatched\n *    to be handled by redux elsewhere.\n * @method watchTrackEvents\n * @param  {Object} track A Track object.\n * @param  {Object} webRTC The webRTC stack.\n */\nexport default function * watchTrackEvents (track, webRTC) {\n  /**\n   * Create an event channel between the Track and redux-saga.\n   * This \"forces\" the Track events into a redux-saga context.\n   */\n  const trackChannel = eventChannel(emit => {\n    return setListeners(track, emit, END)\n  })\n  yield takeEvery(trackChannel, put)\n}\n\n/**\n * Function to set-up listeners for a Track object's events.\n * Contains the logic for how a webRTC event should be parsed\n *    before being sent elsewhere. Split into a stand-alone\n *    function in order to be re-usable.\n * @method setListeners\n * @param  {Object}   track A Track object.\n * @param  {Function} emit  Function that receives the parsed events.\n * @param  {Any}      [END='END'] The \"end of lifetime\" symbol.\n * @return {Function} The unsubscribe function.\n */\nexport function setListeners (track, emit, END = 'END') {\n  // Track ended\n  const trackEnded = trackData => {\n    /**\n     * When the track ends, its channel should be ended (via `END`).\n     * The trackManager channel will handle updating state for this event.\n     */\n    emit(END)\n  }\n\n  track.on('ended', trackEnded)\n\n  const unsubscribe = () => {\n    track.off('ended', trackEnded)\n  }\n  return unsubscribe\n}\n","// Call plugin.\nimport { trackActions } from '../interface/actions'\nimport * as actionTypes from '../interface/actionTypes'\nimport watchTrackEvents from './track'\n\n// Libraries.\nimport { put, fork, takeEvery } from 'redux-saga/effects'\nimport { eventChannel } from 'redux-saga'\n\n/**\n * Sets up event listeners for Track Manager Events.\n * The events are turned into actions and dispatched\n *    to be handled by redux elsewhere.\n * @method watchTrackManagerEvents\n * @param  {Object} manager The webRTC Track Manager.\n */\nexport default function * watchTrackManagerEvents (manager) {\n  /**\n   * Create an event channel between the Track Manager and redux-saga.\n   * This pushes its events into the redux-saga context.\n   * */\n  const managerChannel = eventChannel(emit => {\n    return setListeners(manager, emit)\n  })\n\n  // https://github.com/redux-saga/redux-saga/issues/684\n  // See user \"kuy\"'s second comment.\n  // Using takeEvery to handle actions.\n  // That way they are handled in a forked process and other actions don't get dropped.\n  yield takeEvery(managerChannel, trackManagerEventsHandler)\n}\n\nfunction * trackManagerEventsHandler ({ track, action }) {\n  // If it is a new Track, watch for its events.\n  if (action.type === actionTypes.TRACK_ADDED) {\n    yield fork(watchTrackEvents, track)\n  }\n\n  // Dispatch the action\n  yield put(action)\n}\n\n/**\n * Sets up listeners for the Track Manager events.\n * Contains logic for how specific webRTC events should be\n *    parsed before being sent elsewhere. Splut into a\n *    stand-alone function in order to be re-usable.\n * @method setListeners\n * @param  {Object}   manager The Track Manager.\n * @param  {Function} emit    Function that receives the parsed events.\n * @param  {Any}      [END='END'] The \"end of lifetime\" symbol.\n * @return {Function} The unsubscribe function.\n */\nexport function setListeners (manager, emit, END = 'END') {\n  // Handle new Tracks.\n  const trackAdded = id => {\n    const track = manager.get(id)\n    const state = track.getState()\n    delete state.id\n\n    /**\n     * When a new track is added,\n     * update redux state's webrtc.tracks array by adding track's state into it.\n     */\n    emit({\n      track,\n      action: trackActions.trackAdded(id, state)\n    })\n  }\n\n  // Handle Tracks ending.\n  const trackRemoved = id => {\n    /**\n     * When a track has ended,\n     * update redux state's webrtc.tracks array\n     * by specifying which track to remove by providing a track id.\n     */\n    emit({\n      action: trackActions.trackRemoved(id)\n    })\n  }\n\n  manager.on('add', trackAdded)\n  manager.on('remove', trackRemoved)\n  const unsubscribe = () => {\n    manager.off('add', trackAdded)\n    manager.off('remove', trackRemoved)\n  }\n  return unsubscribe\n}\n","// Webrtc plugin.\nimport pluginInterface from './interface'\nimport events from './interface/events'\nimport watchManagers from './channels'\nimport * as sagas from './sagas'\nimport { miscActions } from './interface/actions'\n\n// Other plugins.\nimport { mapEvents } from '../events/interface/actions'\nimport { getLogManager } from '../logs'\n\n// Helpers.\nimport { autoRestart } from '../common/utils'\n\n// Libraries.\nimport initialize from 'kandy-webrtc'\nimport { values } from 'lodash/fp'\nimport { call, fork, put } from 'redux-saga/effects'\n\nconst log = getLogManager().getLogger('WEBRTC')\n\nexport function initializeStack () {\n  return initialize()\n}\n\nexport default function webRtcPlugin () {\n  // Initialize the webRTC.\n  const webRTC = initialize()\n\n  function * init ({ webRTC }) {\n    yield put(mapEvents(events))\n\n    // Wrap the webrtc sagas in a function that provides them with the webRTC stack.\n    const wrappedSagas = values(sagas).map(saga => {\n      return autoRestart(() => saga(webRTC.managers))\n    })\n\n    // Run all of the sagas.\n    for (let saga of wrappedSagas) {\n      yield fork(saga)\n    }\n\n    // Watch for events from the webRTC stack.\n    // TODO: Don't also pass in the entire stack.\n    yield fork(watchManagers, webRTC.managers, webRTC)\n\n    // Use the webRTC stack to check the browser details.\n    const details = yield call([webRTC, 'getBrowserDetails'])\n    log.info(`Browser details: ${details.browser}, version ${details.version}.`)\n    yield put(miscActions.setBrowserDetails(details))\n  }\n\n  return {\n    name: pluginInterface.name,\n    api: pluginInterface.api,\n    reducer: pluginInterface.reducer,\n    init,\n    shared: {\n      webRTC\n    }\n  }\n}\n","const prefix = '@@KANDY/WEBRTC/'\n\n/**\n * Device action types.\n */\nexport const DEVICES_CHANGE = prefix + 'DEVICES/CHANGE'\n\n/**\n * Track action types.\n */\nconst trackPrefix = prefix + 'TRACK/'\n\nexport const TRACK_ADDED = trackPrefix + 'ADDED'\nexport const TRACK_REMOVED = trackPrefix + 'REMOVED'\n\nexport const RENDER_TRACKS = trackPrefix + 'RENDER'\nexport const RENDER_TRACKS_FINISH = trackPrefix + 'RENDER_FINISH'\n\nexport const REMOVE_TRACKS = trackPrefix + 'REMOVE'\nexport const REMOVE_TRACKS_FINISH = trackPrefix + 'REMOVE_FINISH'\n\nexport const MUTE_TRACKS = trackPrefix + 'MUTE'\nexport const MUTE_TRACKS_FINISH = trackPrefix + 'MUTE_FINISH'\nexport const UNMUTE_TRACKS = trackPrefix + 'UNMUTE'\nexport const UNMUTE_TRACKS_FINISH = trackPrefix + 'UNMUTE_FINISH'\n\n/**\n * Session action types.\n */\nconst sessionPrefix = prefix + 'SESSION/'\n\nexport const SESSION_ADDED = sessionPrefix + 'ADDED'\nexport const SESSION_REMOVED = sessionPrefix + 'REMOVED'\n\nexport const SESSION_NEW_TRACK = sessionPrefix + 'NEW_TRACK'\nexport const SESSION_TRACK_REMOVED = sessionPrefix + 'TRACK_REMOVED'\nexport const SESSION_TRACK_ENDED = sessionPrefix + 'TRACK_ENDED'\nexport const SESSION_CHANGE = sessionPrefix + 'CHANGE'\nexport const SESSION_TRACK_REPLACED = sessionPrefix + 'TRACK_REPLACED'\n\n/**\n * Media action types.\n */\nconst mediaPrefix = prefix + 'MEDIA/'\n\nexport const MEDIA_NEW = mediaPrefix + 'NEW'\nexport const MEDIA_REMOVED = mediaPrefix + 'REMOVED'\nexport const MEDIA_CHANGE = mediaPrefix + 'CHANGE'\n\nexport const MEDIA_NEW_TRACK = mediaPrefix + 'NEW_TRACK'\nexport const MEDIA_TRACK_REMOVED = mediaPrefix + 'TRACK_REMOVED'\nexport const MEDIA_TRACK_ENDED = mediaPrefix + 'TRACK_ENDED'\n\n/**\n * Misc. action types.\n */\nexport const SET_BROWSER_DETAILS = prefix + 'SET_BROWSER_DETAILS'\n","// Webrtc plugin.\nimport * as actionTypes from '../actionTypes'\n\nexport function devicesChanged (devices) {\n  return {\n    type: actionTypes.DEVICES_CHANGE,\n    payload: devices\n  }\n}\n","import * as deviceActionsImport from './devices'\nimport * as trackActionsImport from './tracks'\nimport * as sessionActionsImport from './sessions'\nimport * as mediaActionsImport from './media'\nimport * as miscActionsImport from './misc'\n\n// Apparently the following doesn't work:\n//      export * as newName from './place';\n// So import everything from each file, then re-export.\nexport const deviceActions = deviceActionsImport\nexport const trackActions = trackActionsImport\nexport const sessionActions = sessionActionsImport\nexport const mediaActions = mediaActionsImport\nexport const miscActions = miscActionsImport\n","// Webrtc plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { isEmpty } from 'lodash/fp'\n\nfunction mediaActionHelper (type, id, payload = {}, meta = {}) {\n  const action = {\n    type,\n    payload: {\n      ...payload,\n      id\n    }\n  }\n\n  // Only have meta and error properties on the action if they're needed.\n  if (!isEmpty(meta)) {\n    action.meta = meta\n  }\n  if (payload.error) {\n    action.error = true\n  }\n  return action\n}\n\nexport function newMedia (id, params) {\n  return mediaActionHelper(actionTypes.MEDIA_NEW, id, params)\n}\n\nexport function removedMedia (id, params) {\n  return mediaActionHelper(actionTypes.MEDIA_REMOVED, id, params)\n}\n\nexport function mediaNewTrack (id, params) {\n  return mediaActionHelper(actionTypes.MEDIA_NEW_TRACK, id, params)\n}\n\nexport function mediaTrackRemoved (id, params) {\n  return mediaActionHelper(actionTypes.MEDIA_TRACK_REMOVED, id, params)\n}\n\nexport function mediaTrackEnded (id, params) {\n  return mediaActionHelper(actionTypes.MEDIA_TRACK_ENDED, id, params)\n}\n","// Webrtc plugin.\nimport * as actionTypes from '../actionTypes'\n\n/**\n * Action creator\n * @method setBrowserDetails\n * @param  {Object} details\n * @param  {string} details.browser\n * @param  {number} details.version\n * @return {Object} A Flux-Standard-action.\n */\nexport function setBrowserDetails (details) {\n  return {\n    type: actionTypes.SET_BROWSER_DETAILS,\n    payload: details\n  }\n}\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { isEmpty } from 'lodash/fp'\n\nfunction sessionActionHelper (type, id, payload = {}, meta = {}) {\n  const action = {\n    type,\n    payload: {\n      ...payload,\n      id\n    }\n  }\n\n  // Only have meta and error properties on the action if they're needed.\n  if (!isEmpty(meta)) {\n    action.meta = meta\n  }\n  if (payload.error) {\n    action.error = true\n  }\n  return action\n}\n\nexport function sessionAdded (id, params) {\n  return sessionActionHelper(actionTypes.SESSION_ADDED, id, params)\n}\n\nexport function sessionRemoved (id, params) {\n  return sessionActionHelper(actionTypes.SESSION_REMOVED, id, params)\n}\n\nexport function sessionNewTrack (id, params) {\n  return sessionActionHelper(actionTypes.SESSION_NEW_TRACK, id, params)\n}\n\nexport function sessionTrackRemoved (id, params) {\n  return sessionActionHelper(actionTypes.SESSION_TRACK_REMOVED, id, params)\n}\n\nexport function sessionTrackEnded (id, params) {\n  return sessionActionHelper(actionTypes.SESSION_TRACK_ENDED, id, params)\n}\n\nexport function sessionChange (id, params) {\n  return sessionActionHelper(actionTypes.SESSION_CHANGE, id, params)\n}\n\nexport function sessionTrackReplaced (id, params) {\n  return sessionActionHelper(actionTypes.SESSION_TRACK_REPLACED, id, params)\n}\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\nfunction trackManagerHelper (type, trackId, payload = {}, meta = {}) {\n  return {\n    type,\n    payload: {\n      ...payload,\n      trackId\n    },\n    meta\n  }\n}\n\nexport function trackAdded (trackId, params) {\n  return trackManagerHelper(actionTypes.TRACK_ADDED, trackId, params)\n}\n\nexport function trackRemoved (trackId, params) {\n  return trackManagerHelper(actionTypes.TRACK_REMOVED, trackId, params)\n}\n\nfunction trackHelper (type, payload = {}, meta = {}) {\n  return {\n    type,\n    payload,\n    meta\n  }\n}\n\nexport function muteTracks (trackIds) {\n  return trackHelper(actionTypes.MUTE_TRACKS, trackIds)\n}\n\nexport function muteTracksFinish (trackIds) {\n  return trackHelper(actionTypes.MUTE_TRACKS_FINISH, trackIds)\n}\n\nexport function unmuteTracks (trackIds) {\n  return trackHelper(actionTypes.UNMUTE_TRACKS, trackIds)\n}\n\nexport function unmuteTracksFinish (trackIds) {\n  return trackHelper(actionTypes.UNMUTE_TRACKS_FINISH, trackIds)\n}\n\nexport function renderTracks (trackIds, params) {\n  return trackHelper(actionTypes.RENDER_TRACKS, {\n    trackIds,\n    ...params\n  })\n}\n\nexport function renderTracksFinish (trackIds, params) {\n  return trackHelper(actionTypes.RENDER_TRACKS_FINISH, {\n    trackIds,\n    ...params\n  })\n}\n\nexport function removeTracks (trackIds, params) {\n  return trackHelper(actionTypes.REMOVE_TRACKS, {\n    trackIds,\n    ...params\n  })\n}\n\nexport function removeTracksFinish (trackIds, params) {\n  return trackHelper(actionTypes.REMOVE_TRACKS_FINISH, {\n    trackIds,\n    ...params\n  })\n}\n","// Webrtc plugin.\nimport { getBrowserDetails } from '../selectors'\n\n// Namespaced APIs.\nimport mediaAPI from './media'\n\nimport { getLogManager, API_LOG_TAG } from '../../../logs'\n\nconst log = getLogManager().getLogger('WEBRTC')\n\n/**\n * Public API for the webRTC plugin.\n * @method api\n * @return {Object}\n */\nexport default function api (context) {\n  return {\n    media: mediaAPI(context),\n\n    /**\n     * Retrieve information about the browser being used.\n     *\n     * Browser information being defined indicates that the browser supports\n     *    basic webRTC scenarios.\n     * @public\n     * @memberof api\n     * @method getBrowserDetails\n     * @return {Object} Object containing `browser` and `version` information.\n     * @example\n     * const details = client.getBrowserDetails()\n     *\n     * log(`Browser in use: ${details.browser}, version ${details.version}.`)\n     */\n    getBrowserDetails () {\n      log.debug(API_LOG_TAG + 'getBrowserDetails')\n      return getBrowserDetails(context.getState())\n    }\n  }\n}\n","// Webrtc plugin.\nimport { trackActions } from '../actions'\nimport { getDevices, getMediaById, getTrackById } from '../selectors'\n\nimport { getLogManager, API_LOG_TAG } from '../../../logs'\nconst log = getLogManager().getLogger('MEDIA')\n\n/**\n * Media related APIs.\n * @method mediaAPI\n * @param  {Function} dispatch Redux dispatch.\n * @param  {Function} getState Redux getState.\n * @return {Object}\n */\nexport default function mediaAPI ({ dispatch, getState }) {\n  return {\n    /**\n     * Retrieves the available media devices for use.\n     *\n     * The {@link media.event:devices:change devices:change} event will be\n     *    emitted when the available media devices have changed.\n     *\n     * @public\n     * @static\n     * @memberof media\n     * @method getDevices\n     * @return {Object} The lists of camera, microphone, and speaker devices.\n     */\n    getDevices () {\n      log.debug(API_LOG_TAG + 'media.getDevices')\n      return getDevices(getState())\n    },\n\n    /**\n     * Retrieves an available Media object with a specific Media ID.\n     * @public\n     * @static\n     * @memberof media\n     * @method getById\n     * @param  {string} mediaId The ID of the Media to retrieve.\n     * @return {MediaObject} A Media object.\n     */\n    getById (mediaId) {\n      log.debug(API_LOG_TAG + 'media.getById: ', mediaId)\n      return getMediaById(getState(), mediaId)\n    },\n\n    /**\n     * Retrieve an available Track object with a specific Track ID.\n     * @public\n     * @static\n     * @memberof media\n     * @method getTrackById\n     * @param  {string} trackId The ID of the Track to retrieve.\n     * @return {TrackObject} A Track object.\n     */\n    getTrackById (trackId) {\n      log.debug(API_LOG_TAG + 'media.getByTrackId: ', trackId)\n      return getTrackById(getState(), trackId)\n    },\n\n    /**\n     * Render Media Tracks in a container.\n     *\n     * The container is specified by providing a CSS selector string that\n     *    corresponds to the HTMLElement to act as the container.\n     * @public\n     * @static\n     * @memberof media\n     * @method renderTracks\n     * @param  {Array<string>} trackIds List of Track IDs to be rendered.\n     * @param  {string} cssSelector A CSS selector string that uniquely\n     *    identifies an element. Ensure that special characters are properly\n     *    escaped.\n     * @param  {Object} [options] Additional options for rendering the tracks.\n     * @param  {string} [options.speakerId] The speaker's Device ID to use for audio tracks.\n     * @example\n     * // When a Call receives a new track, render it.\n     * client.on('call:newTrack', function (params) {\n     *    const track = client.media.getTrackById(params.trackId)\n     *    const container = params.local ? localContainer : remoteContainer\n     *\n     *    // Render the Call's new track when it first becomes available.\n     *    client.media.renderTracks([ track.id ], container)\n     * })\n     */\n    renderTracks (trackIds, cssSelector, options = {}) {\n      log.debug(API_LOG_TAG + 'media.renderTracks: ', trackIds, cssSelector, options)\n      dispatch(\n        trackActions.renderTracks(trackIds, {\n          selector: cssSelector,\n          ...options\n        })\n      )\n    },\n\n    /**\n     * Remove Media Tracks from a container.\n     *\n     * The container is specified by providing a CSS selector string that\n     *    corresponds to the HTMLElement to act as the container.\n     * @public\n     * @static\n     * @memberof media\n     * @method removeTracks\n     * @param  {Array<string>} trackIds List of Track IDs to stop being rendered.\n     * @param  {string} cssSelector A CSS selector string that uniquely\n     *    identifies an element. Ensure that special characters are properly\n     *    escaped.\n     */\n    removeTracks (trackIds, cssSelector) {\n      log.debug(API_LOG_TAG + 'media.removeTracks: ', trackIds, cssSelector)\n      dispatch(trackActions.removeTracks(trackIds, { selector: cssSelector }))\n    },\n\n    /**\n     * Mutes the specified Tracks at their media source.\n     *\n     * Prevents media from being received for the Tracks. Audio Tracks will\n     *    become silent and video Tracks will be a black frame.\n     *\n     * If a local Track being sent in a Call is muted, the Track will be\n     *    noticeably muted for the remote user. If a remote Track received in a\n     *    call is muted, the result will only be noticeable locally.\n     *\n     * The SDK will emit a {@link media.event:media:muted media:muted} event\n     *    when a Track has been muted.\n     * @public\n     * @static\n     * @memberof media\n     * @method muteTracks\n     * @param  {Array<string>} trackIds List of Track IDs.\n     */\n    muteTracks (trackIds) {\n      log.debug(API_LOG_TAG + 'media.muteTracks: ', trackIds)\n      dispatch(trackActions.muteTracks(trackIds))\n    },\n\n    /**\n     * Unmutes the specified Tracks.\n     *\n     * Media will resume as normal for the Tracks.\n     *\n     * The SDK will emit a {@link media.event:media:unmuted media:unmuted} event\n     *    when a Track has been unmuted.\n     * @public\n     * @static\n     * @memberof media\n     * @method unmuteTracks\n     * @param  {Array<string>} trackIds List of Track IDs.\n     */\n    unmuteTracks (trackIds) {\n      log.debug(API_LOG_TAG + 'media.unmuteTracks: ', trackIds)\n      dispatch(trackActions.unmuteTracks(trackIds))\n    }\n  }\n}\n","/**\n * The media devices available for use have changed.\n *\n * Information about the available media devices can be retrieved using the\n *    {@link media.getDevices} API.\n *\n * @public\n * @memberof media\n * @event devices:change\n * @example\n * // Listen for changes to available media devices.\n * client.on('devices:change', function () {\n *    // Retrieve the latest media device lists.\n *    const devices = client.media.getDevices()\n * })\n */\nexport const DEVICES_CHANGED = 'devices:change'\n\n/**\n * The specified Tracks have been muted.\n *\n * A Track can be muted using the {@link media.muteTracks} API.\n * @public\n * @memberof media\n * @event media:muted\n * @param {Object} params\n * @param {Array<string>} params.tracks The list of Tracks that were muted.\n */\nexport const TRACKS_MUTED = 'media:muted'\n\n/**\n * The specified Tracks have been unmuted.\n *\n * A Track can be unmuted using the {@link media.unmuteTracks}\n *    API.\n * @public\n * @memberof media\n * @event media:unmuted\n * @param {Object} params\n * @param {Array<string>} params.tracks The list of Tracks that were unmuted.\n */\nexport const TRACKS_UNMUTED = 'media:unmuted'\n","import * as eventTypes from '../eventTypes'\nimport * as actionTypes from '../actionTypes'\n\nconst events = {}\n\n// Media devices have changed.\nevents[actionTypes.DEVICES_CHANGE] = action => {\n  return {\n    type: eventTypes.DEVICES_CHANGED\n  }\n}\n\nexport default events\n","import deviceEvents from './devices'\nimport trackEvents from './tracks'\n\nexport default {\n  ...deviceEvents,\n  ...trackEvents\n}\n","import * as eventTypes from '../eventTypes'\nimport * as actionTypes from '../actionTypes'\n\nconst events = {}\n\nevents[actionTypes.MUTE_TRACKS_FINISH] = action => {\n  return {\n    type: eventTypes.TRACKS_MUTED,\n    args: { tracks: action.payload }\n  }\n}\n\nevents[actionTypes.UNMUTE_TRACKS_FINISH] = action => {\n  return {\n    type: eventTypes.TRACKS_UNMUTED,\n    args: { tracks: action.payload }\n  }\n}\n\nexport default events\n","import api from './api'\nimport reducer from './reducers'\n\nexport default {\n  name: 'webrtc',\n  api,\n  reducer\n}\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { handleActions } from 'redux-actions'\n\n/**\n * The devices substate keeps tracks the of the media devices available for use.\n */\nconst reducers = {}\n\n// Replace old devices with newly checked devices.\nreducers[actionTypes.SET_BROWSER_DETAILS] = {\n  next (state, action) {\n    return action.payload\n  }\n}\n\nconst reducer = handleActions(reducers, {})\nexport default reducer\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { handleActions } from 'redux-actions'\n\n/**\n * The devices substate keeps tracks the of the media devices available for use.\n */\nconst reducers = {}\n\n// Replace old devices with newly checked devices.\nreducers[actionTypes.DEVICES_CHANGE] = {\n  next (state, action) {\n    return action.payload\n  }\n}\n\n// The initial state of the reducer.\nconst defaultState = {\n  camera: [],\n  microphone: [],\n  speaker: []\n}\n\nconst reducer = handleActions(reducers, defaultState)\nexport default reducer\n","import devices from './devices'\nimport media from './media'\nimport tracks from './tracks'\nimport sessions from './sessions'\nimport browser from './browser'\n\n/**\n * Webrtc plugin top-level reducer.\n * @method reducer\n * @param  {Object} [state={}]\n * @param  {Object} action\n * @return {Object}\n */\nexport default function (state = {}, action) {\n  return {\n    devices: devices(state.devices, action),\n    tracks: tracks(state.tracks, action),\n    sessions: sessions(state.sessions, action),\n    media: media(state.media, action),\n    browser: browser(state.browser, action)\n  }\n}\n","// Webrtc plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { combineActions, handleActions } from 'redux-actions'\nimport { concat, remove } from 'lodash/fp'\n\n// Top-tier reducers: Handles the whole state.\nconst reducers = {}\n\n// Add the new media object to state.\nreducers[actionTypes.MEDIA_NEW] = {\n  next (state, action) {\n    return concat(state, {\n      ...action.payload\n    })\n  }\n}\n\n// Remove the media object from state.\nreducers[actionTypes.MEDIA_REMOVED] = {\n  next (state, action) {\n    const removeMedia = media => media.id === action.payload.id\n    return remove(removeMedia)(state)\n  }\n}\n\n// Media-tier reducers: Handles only a specific portion of the substate.\nconst mediaReducers = {}\n\nmediaReducers[actionTypes.MEDIA_NEW_TRACK] = {\n  next (state, action) {\n    return {\n      ...state,\n      tracks: concat(state.tracks, [action.payload.trackId])\n    }\n  }\n}\n\n// Remove specified track from media state.\nmediaReducers[actionTypes.MEDIA_TRACK_REMOVED] = {\n  next (state, action) {\n    const removeTrack = trackId => trackId === action.payload.trackId\n    return {\n      ...state,\n      tracks: remove(removeTrack, state.tracks)\n    }\n  }\n}\n\n// Remove specified track from media state.\nmediaReducers[actionTypes.MEDIA_TRACK_ENDED] = {\n  next (state, action) {\n    const removeTrack = trackId => trackId === action.payload.trackId\n    return {\n      ...state,\n      tracks: remove(removeTrack, state.tracks)\n    }\n  }\n}\nconst mediaReducer = handleActions(mediaReducers, {})\n\nconst specificMediaActions = combineActions(\n  actionTypes.MEDIA_NEW_TRACK,\n  actionTypes.MEDIA_TRACK_REMOVED,\n  actionTypes.MEDIA_TRACK_ENDED\n)\n\nreducers[specificMediaActions] = (state, action) => {\n  return state.map(media => {\n    if (media.id === action.payload.id) {\n      return mediaReducer(media, action)\n    } else {\n      return media\n    }\n  })\n}\n\n/*\n * Combine all of top-tier reducers into a single reducer,\n *      each with a default state of an empty array.\n */\nconst reducer = handleActions(reducers, [])\nexport default reducer\n","// Webrtc plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { combineActions, handleActions } from 'redux-actions'\nimport { concat, remove } from 'lodash/fp'\n\nconst reducers = {}\n\nreducers[actionTypes.SESSION_ADDED] = {\n  next (state, action) {\n    return concat(state, action.payload)\n  }\n}\n\nreducers[actionTypes.SESSION_REMOVED] = {\n  next (state, action) {\n    const removeSession = session => session.id === action.payload.id\n    return remove(removeSession)(state)\n  }\n}\n\nconst sessionReducers = {}\n\nsessionReducers[actionTypes.SESSION_NEW_TRACK] = {\n  next (state, action) {\n    if (action.payload.local) {\n      return {\n        ...state,\n        localTracks: concat(state.localTracks, [action.payload.trackId])\n      }\n    } else {\n      return {\n        ...state,\n        remoteTracks: concat(state.remoteTracks, [action.payload.trackId])\n      }\n    }\n  }\n}\n\nsessionReducers[actionTypes.SESSION_TRACK_REMOVED] = {\n  next (state, action) {\n    const removeTrack = trackId => trackId === action.payload.trackId\n    if (action.payload.local) {\n      return {\n        ...state,\n        localTracks: remove(removeTrack, state.localTracks)\n      }\n    } else {\n      return {\n        ...state,\n        remoteTracks: remove(removeTrack, state.remoteTracks)\n      }\n    }\n  }\n}\n\nsessionReducers[actionTypes.SESSION_TRACK_ENDED] = {\n  next (state, action) {\n    const removeTrack = trackId => trackId === action.payload.trackId\n    if (action.payload.local) {\n      return {\n        ...state,\n        localTracks: remove(removeTrack, state.localTracks)\n      }\n    } else {\n      return {\n        ...state,\n        remoteTracks: remove(removeTrack, state.remoteTracks)\n      }\n    }\n  }\n}\n\nsessionReducers[actionTypes.SESSION_TRACK_REPLACED] = {\n  next (state, action) {\n    // Remove old track id if it still exists\n    const removeTrack = trackId => trackId === action.payload.oldTrackId\n    const newLocalTracks = remove(removeTrack, state.localTracks)\n    // Add new track id if it doesn't exist\n    if (newLocalTracks.indexOf(action.payload.trackId) === -1) {\n      newLocalTracks.push(action.payload.trackId)\n    }\n    return {\n      ...state,\n      localTracks: newLocalTracks\n    }\n  }\n}\n\nconst sessionReducer = handleActions(sessionReducers, {})\n\nconst specificSessionActions = combineActions(\n  actionTypes.SESSION_NEW_TRACK,\n  actionTypes.SESSION_TRACK_REMOVED,\n  actionTypes.SESSION_TRACK_ENDED,\n  actionTypes.SESSION_TRACK_REPLACED\n)\n\nreducers[specificSessionActions] = (state, action) => {\n  return state.map(session => {\n    if (session.id === action.payload.id) {\n      return sessionReducer(session, action)\n    } else {\n      return session\n    }\n  })\n}\n\n/*\n * Combine all of top-tier reducers into a single reducer,\n *      each with a default state of an empty array.\n */\nconst reducer = handleActions(reducers, [])\nexport default reducer\n","// Webrtc plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { handleActions } from 'redux-actions'\nimport { concat, remove } from 'lodash/fp'\n\nconst reducers = {}\n\n// Add the new Track to state.\nreducers[actionTypes.TRACK_ADDED] = {\n  next (state, action) {\n    return concat(state, action.payload)\n  }\n}\n\n// Remove the ended Track from state.\nreducers[actionTypes.TRACK_REMOVED] = {\n  next (state, action) {\n    const removeTrack = track => track.trackId === action.payload.trackId\n    return remove(removeTrack)(state)\n  }\n}\n\n// Store the selector used for rendering the track.\nreducers[actionTypes.RENDER_TRACKS_FINISH] = {\n  next (state, action) {\n    return state.map(track => {\n      if (action.payload.trackIds.includes(track.trackId)) {\n        return {\n          ...track,\n          containers: concat(track.containers, action.payload.selector)\n        }\n      } else {\n        return track\n      }\n    })\n  }\n}\n\n// Remove the selector used for rendering the track.\nreducers[actionTypes.REMOVE_TRACKS_FINISH] = {\n  next (state, action) {\n    // TODO: Only remove one container (instead of all that match)?\n    const removeContainer = container => container === action.payload.selector\n    return state.map(track => {\n      if (action.payload.trackIds.includes(track.trackId)) {\n        return {\n          ...track,\n          containers: remove(removeContainer)(track.containers)\n        }\n      } else {\n        return track\n      }\n    })\n  }\n}\n\n// TODO: Update this on an action from the track channel?\nreducers[actionTypes.MUTE_TRACKS_FINISH] = {\n  next (state, action) {\n    return state.map(track => {\n      if (action.payload.includes(track.trackId)) {\n        return {\n          ...track,\n          muted: true\n        }\n      } else {\n        return track\n      }\n    })\n  }\n}\n\nreducers[actionTypes.UNMUTE_TRACKS_FINISH] = {\n  next (state, action) {\n    return state.map(track => {\n      if (action.payload.includes(track.trackId)) {\n        return {\n          ...track,\n          muted: false\n        }\n      } else {\n        return track\n      }\n    })\n  }\n}\n\n/*\n * Combine all of top-tier reducers into a single reducer,\n *      each with a default state of an empty array.\n */\nconst reducer = handleActions(reducers, [])\nexport default reducer\n","// Call plugin.\nimport { getCallById } from '../../call/interfaceNew/selectors'\n\n/**\n * Retrieves media devices available on the system.\n * @method getDevices\n * @param  {Object} state Redux state.\n * @return {Object}\n */\nexport function getDevices (state) {\n  return state.webrtc.devices\n}\n\n/**\n * Session selectors.\n */\nexport function getSessions (state) {\n  return state.webrtc.sessions\n}\n\nexport function getSessionById (state, sessionId) {\n  return getSessions(state).find(session => session.id === sessionId)\n}\n\n/**\n * Track selectors.\n */\nexport function getTracks (state) {\n  return state.webrtc.tracks\n}\n\nexport function getTrackById (state, trackId) {\n  return getTracks(state).find(track => track.trackId === trackId)\n}\n\n/**\n * Media selectors.\n * Handles retrieving data from the `state.webrtc.media` substate.\n */\n\n/**\n * Get the list of all media this session.\n * @method getMedia\n * @param  {Object} state Redux state.\n * @return {Array} A list of all media objects.\n */\nexport function getMedia (state) {\n  return state.webrtc.media\n}\n\n/**\n * Get a specific media object.\n * @method getMediaById\n * @param  {Object} state Redux state.\n * @param  {string} mediaId The media to retrieve.\n * @return {Object} A media object.\n */\nexport function getMediaById (state, mediaId) {\n  return getMedia(state).find(media => media.id === mediaId)\n}\n\n/**\n * Get all media objects associated with a specific call.\n * @method getMediaByCallId\n * @param  {Object} state Redux state.\n * @param  {string} callId The call to retrieve media objects from.\n * @return {Array} A list of media objects.\n */\nexport function getMediaByCallId (state, callId) {\n  const call = getCallById(state, callId)\n  if (call) {\n    const mediaIds = call.localMedia.concat(call.remoteMedia)\n    return mediaIds.map(mediaId => getMediaById(state, mediaId))\n  } else {\n    return []\n  }\n}\n\n/**\n * Retrieves information about the browser.\n * @method getBrowserDetails\n * @param  {Object} state Redux state.\n * @return {Object}\n */\nexport function getBrowserDetails (state) {\n  return state.webrtc.browser\n}\n","// Webrtc plugin.\nimport * as mediaSagas from './media'\nimport * as actionTypes from '../interface/actionTypes'\n\n// Libraries.\nimport { takeEvery } from 'redux-saga/effects'\n\n/**\n * Track operations.\n */\n\n/**\n * Handle rendering Track objects.\n * @method renderTracks\n * @param  {Object} webRTC The webRTC stack.\n */\nexport function * renderTracks (webRTC) {\n  yield takeEvery(actionTypes.RENDER_TRACKS, mediaSagas.renderTracks, webRTC)\n}\n\n/**\n * Handle removing Track objects.\n * @method removeTracks\n * @param  {Object} webRTC The webRTC stack.\n */\nexport function * removeTracks (webRTC) {\n  yield takeEvery(actionTypes.REMOVE_TRACKS, mediaSagas.removeTracks, webRTC)\n}\n\n/**\n * Handle muting tracks.\n * @method muteTracks\n * @param  {Object} webRTC The webRTC stack.\n */\nexport function * muteTracks (webRTC) {\n  yield takeEvery(actionTypes.MUTE_TRACKS, mediaSagas.muteTracks, webRTC)\n}\n\n/**\n * Handle unmuting tracks.\n * @method unmuteTracks\n * @param  {Object} webRTC The webRTC stack.\n */\nexport function * unmuteTracks (webRTC) {\n  yield takeEvery(actionTypes.UNMUTE_TRACKS, mediaSagas.unmuteTracks, webRTC)\n}\n","// Call plugin.\nimport { trackActions } from '../interface/actions'\n\n// Libraries.\nimport { call, put, all } from 'redux-saga/effects'\nimport { isUndefined } from 'lodash/fp'\n\n/**\n * Render Tracks in a specified container.\n * @method renderTracks\n * @param  {Object} action A \"render tracks\" action.\n */\nexport function * renderTracks (webRTC, action) {\n  const { trackIds, selector, speakerId } = action.payload\n\n  // Get the tracks that are to be rendered.\n  const tracks = yield call([webRTC.track, 'getTracks'], trackIds)\n  const filteredTracks = tracks.filter(track => !isUndefined(track))\n\n  // Render the tracks.\n  yield all(filteredTracks.map(track => call([track, 'renderIn'], selector, speakerId)))\n\n  // Report operation done.\n  yield put(\n    trackActions.renderTracksFinish(filteredTracks.map(track => track.id), {\n      selector\n    })\n  )\n}\n\n/**\n * Stop Tracks from being rendered in a specified container.\n * @method removeTracks\n * @param  {Object} action A \"remove tracks\" action.\n */\nexport function * removeTracks (webRTC, action) {\n  const { trackIds, selector } = action.payload\n\n  // Get the tracks that are to be removed.\n  const allTracks = yield call([webRTC.track, 'getTracks'])\n  const tracks = allTracks.filter(track => trackIds.includes(track.id))\n\n  // Remove the tracks.\n  yield all(tracks.map(track => call([track, 'removeFrom'], selector)))\n\n  // Report operation done.\n  yield put(\n    trackActions.removeTracksFinish(tracks.map(track => track.id), {\n      selector\n    })\n  )\n}\n\n/**\n * Mute certain tracks.\n * @method muteTracks\n * @param  {Object} action\n * @param  {Array} action.payload A list of track IDs.\n */\nexport function * muteTracks (webRTC, action) {\n  // Get the tracks that are to be muted.\n  const allTracks = yield call([webRTC.track, 'getTracks'])\n  const tracks = allTracks.filter(track => action.payload.includes(track.id))\n\n  // Mute the tracks.\n  yield all(tracks.map(track => call([track, 'mute'])))\n\n  // Report operation done.\n  yield put(trackActions.muteTracksFinish(tracks.map(track => track.id)))\n}\n\n/**\n * Unmute certain tracks.\n * @method unmuteTracks\n * @param  {Object} action\n * @param  {Array} action.payload A list of track IDs.\n */\nexport function * unmuteTracks (webRTC, action) {\n  // Get the tracks that are to be unmuted.\n  const allTracks = yield call([webRTC.track, 'getTracks'])\n  const tracks = allTracks.filter(track => action.payload.includes(track.id))\n\n  // Unmute the tracks.\n  yield all(tracks.map(track => call([track, 'unmute'])))\n\n  // Report operation done.\n  yield put(trackActions.unmuteTracksFinish(tracks.map(track => track.id)))\n}\n","/**\n * Constants relating to the Peer model.\n */\nexport const PEER = {\n  TRICKLE_ICE: {\n    FULL: 'FULL',\n    HALF: 'HALF',\n    NONE: 'NONE'\n  },\n  // Defined by the RTCPeerConnection.iceGatheringState spec.\n  ICE_GATHERING_STATE: {\n    NEW: 'new',\n    GATHERING: 'gathering',\n    COMPLETE: 'complete'\n  },\n  ENDPOINT: {\n    LOCAL: 'local',\n    REMOTE: 'remote'\n  },\n  SDP_SEMANTICS: {\n    PLAN_B: 'plan-b',\n    UNIFIED_PLAN: 'unified-plan'\n  }\n}\n\n/**\n * SDP constants for media direction.\n * @type {Object}\n */\nexport const MEDIA_DIR = {\n  INACTIVE: 'inactive',\n  SEND_ONLY: 'sendonly',\n  RECV_ONLY: 'recvonly',\n  SEND_RECV: 'sendrecv'\n}\n","// Models.\nimport Track from '../models/track'\nimport Media from '../models/media'\nimport Peer from '../models/peer'\n\n// Managers.\nimport MediaManager from '../managers/mediaManager'\nimport PeerManager from '../managers/peerManager'\nimport SessionManager from '../managers/sessionManager'\nimport DeviceManager from '../managers/deviceManager'\nimport TrackManager from '../managers/trackManager'\n\n// SDP helpers.\nimport sdpPipeline from '../sdpUtils/pipeline'\nimport * as sdpHandlers from '../sdpUtils/handlers'\n\nimport log from 'loglevel'\nimport adapter from 'webrtc-adapter/out/adapter_no_edge'\n\nexport default function initialize () {\n  const browserDetails = adapter.browserDetails\n  if (browserDetails.version) {\n    log.debug(`Browser details: ${browserDetails.browser}, version ${browserDetails.version}.`)\n  } else {\n    log.debug('Browser details: Not supported by webRTC adapter.')\n  }\n\n  const deviceManager = new DeviceManager()\n  const trackManager = new TrackManager()\n  const mediaManager = new MediaManager({ trackManager })\n  const peerManager = new PeerManager({ trackManager })\n  const sessionManager = new SessionManager({\n    peerManager,\n    mediaManager,\n    trackManager\n  })\n\n  return {\n    models: {\n      Track,\n      Media,\n      Peer\n    },\n    // TODO: Make naming consistent.\n    managers: {\n      devices: deviceManager,\n      media: mediaManager,\n      peerManager: peerManager,\n      sessionManager,\n      track: trackManager\n    },\n    sdp: {\n      pipeline: sdpPipeline,\n      handlers: sdpHandlers\n    },\n    getBrowserDetails: () => {\n      return browserDetails\n    }\n  }\n}\n","// Libraries.\nimport log from 'loglevel'\nimport EventEmitter from 'eventemitter3'\n\n/*\n * A conversion from MediaDeviceInfo.kind values to their more common terms.\n * See: https://developer.mozilla.org/en-US/docs/Web/API/MediaDeviceInfo/kind\n * @enum {String}\n */\nexport const WEBRTC_DEVICE_KINDS = {\n  audioinput: 'microphone',\n  videoinput: 'camera',\n  audiooutput: 'speaker'\n}\n\n/**\n * Manager for connected devices.\n * Keeps an up-to-date list of all devices.\n * @class DeviceManager\n */\nexport default function DeviceManager () {\n  // Internal variables.\n  const emitter = new EventEmitter()\n  // Store each device type separately, so that `deviceId` is unique\n  //    per kind (there is a `default` deviceId per kind).\n  let microphone = []\n  let camera = []\n  let speaker = []\n\n  // Check devices on initialization.\n  checkDevices().then(() => {\n    // Emit an initial event to notify that devices are available.\n    emitter.emit('change')\n  })\n\n  // Check devices whenever they change.\n  let recentDeviceChange = false\n  navigator.mediaDevices.addEventListener('devicechange', () => {\n    log.info('Media device change detected.')\n    // A physical device change results in one event per\n    // device \"kind\". Group the events together.\n    if (!recentDeviceChange) {\n      recentDeviceChange = true\n      setTimeout(() => {\n        recentDeviceChange = false\n        checkDevices().then(() => {\n          // Emit an event to notify of the change.\n          emitter.emit('change')\n        })\n      }, 50)\n    }\n  })\n\n  /**\n   * Updates the stored device lists with the latest devices.\n   * @method checkDevices\n   * @return {Promise}\n   */\n  function checkDevices () {\n    log.info('Checking media devices.')\n    return new Promise((resolve, reject) => {\n      navigator.mediaDevices\n        .enumerateDevices()\n        .then(devices => {\n          // Clear the stored devices, to prevent duplicates.\n          microphone = []\n          camera = []\n          speaker = []\n          devices.forEach(device => {\n            const kind = WEBRTC_DEVICE_KINDS[device.kind]\n            switch (kind) {\n              case 'microphone':\n                microphone.push(device)\n                break\n              case 'camera':\n                camera.push(device)\n                break\n              case 'speaker':\n                speaker.push(device)\n                break\n            }\n          })\n          resolve(get())\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Retrieves the stored device lists.\n   * @method get\n   * @return {Object}\n   */\n  function get () {\n    return {\n      microphone,\n      camera,\n      speaker\n    }\n  }\n\n  function on (...args) {\n    return emitter.on(...args)\n  }\n\n  function once (...args) {\n    return emitter.once(...args)\n  }\n\n  function off (...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    checkDevices,\n    get,\n    on,\n    once,\n    off\n  }\n}\n","// Models that this manager directly manages.\nimport Media from '../models/media'\n\n// Libraries.\nimport log from 'loglevel'\nimport EventEmitter from 'eventemitter3'\n\n/**\n * Manager for Media objects.\n * Allows the creation and retrieval of media objects.\n * @class MediaManager\n */\nexport default function MediaManager (managers) {\n  // Internal variables.\n  const trackManager = managers.trackManager\n  const medias = new Map()\n  const emitter = new EventEmitter()\n\n  /**\n   * Retrieve a snapshot of all Media objects' current state.\n   * @method getState\n   * @return {Array}\n   */\n  function getState () {\n    return getAll().map(id => get(id).getState())\n  }\n\n  /**\n   * Workaround to get Firefox to behave similarly to Chrome regarding device permission prompts.\n   * @method browserContraintsWorkaround\n   * @param  {MediaStreamConstraints}  constraints\n   * @return {Object}  media contraints\n   */\n\n  function browserContraintsWorkaround (constraints) {\n    /**\n     * Firefox workaround.\n     *\n     * Issue Summary: Browser behaviour for prompting the user for device\n     *    permissions is not consistent for consecutive gUM calls. The following\n     *    workaround makes it consistent if the less-specific constraint is\n     *    provided.\n     *\n     * Context: The `deviceId` constraint format can be either a string or an\n     *    object. The object format allows precise control over how the browser\n     *    should try to get the track. It can be specified to fail if it can't\n     *    fulfill the constraint (exact), or whether the constraint is \"best\n     *    effort\" (ideal). When the string format is given, it follows the\n     *    \"ideal\" behaviour.\n     * See: https://developer.mozilla.org/en-US/docs/Web/API/ConstrainDOMString\n     *\n     *  - When the \"ideal\" behaviour is followed and the user has not given\n     *      permission (and not disallowed), the browswer will prompt the user\n     *      for permission.\n     *  - [Issue] When the \"ideal\" behaviour is followed and the user has given\n     *      permission previously, the browser will not prompt the user for\n     *      permission.\n     *\n     * Problem: When gUM is called for a different device (ideal behaviour) than\n     *    permission was granted for previously, the browser will not prompt the\n     *    user to give permission for the (new) device. This results in gUM\n     *    using the original device for the new track.\n     *\n     * This happens on Firefox because the prompt for media permissions is\n     *    specific to a single device. For Chrome, the prompt is generic to any\n     *    device.\n     * If permissions are always allowed (\"remember my decision\" on Firefox or\n     *    default on Chrome), this issue wouldn't be seen.\n     *\n     * Workaround: When the behaviour (idea / exact) isn't specified, default\n     *    to exact (instead of letting the browser default to ideal; as per the\n     *    specification).\n     *\n     * This ensures that the browser always prompts the user to give permissions\n     *    for the device (if not already granted). It is also more in-line with\n     *    what might be expected when you ask for a certain device (ie. don't\n     *    return a different device unless it was specified that it's okay).\n     */\n    for (const kind in constraints) {\n      if (\n        constraints[kind] &&\n        typeof constraints[kind] === 'object' &&\n        typeof constraints[kind].deviceId === 'string'\n      ) {\n        // Don't allow a \"bare\" value be provided for deviceId. Change it to use\n        //    \"exact\".\n        const id = constraints[kind].deviceId\n        constraints[kind].deviceId = { exact: id }\n      }\n    }\n    return constraints\n  }\n\n  /**\n   * Wraps native mediaStream, adds tracks to trackManager and Media, and sets up event handlers on a given media.\n   * @method setupMedia\n   * @param {MediaStream} mediaStream Creating a Media object with it.\n   * @return {Media}\n   */\n\n  function setupMedia (mediaStream) {\n    const media = new Media(mediaStream, true)\n    log.debug(`Creating Media with ID: ${media.id}.`)\n\n    // Only add tracks to a Media objects using the `addTrack` method.\n    mediaStream.getTracks().forEach(nativeTrack => {\n      const wrappedTrack = trackManager.add(nativeTrack, mediaStream)\n      media.addTrack(wrappedTrack)\n    })\n\n    media.once('media:stopped', mediaId => {\n      remove(mediaId)\n    })\n\n    media.on('track:removed', trackId => {\n      if (media.tracks.size === 0) {\n        remove(media.id)\n      }\n    })\n\n    media.on('track:ended', ({ mediaId, trackId }) => {\n      if (media.getTracks().length === 0) {\n        remove(mediaId)\n      }\n    })\n\n    return media\n  }\n\n  /**\n   * Create a new local Media object.\n   * Use the provided constraints to get user media as the base MediaStream.\n   * @method createLocal\n   * @param  {MediaStreamConstraints}  constraints\n   * @return {Promise}\n   */\n  function createLocal (constraints) {\n    const constraintsWorkaround = browserContraintsWorkaround(constraints)\n\n    // Get user media, ...\n    return new Promise((resolve, reject) => {\n      // TODO: Proper error checking.\n      // TODO: Use the WebAPI directly here? Probably not.\n      navigator.mediaDevices\n        .getUserMedia(constraintsWorkaround)\n        .then(mediaStream => {\n          const media = setupMedia(mediaStream)\n\n          medias.set(media.id, media)\n          // TODO: Better event. Include metadata?\n          emitter.emit('media:new', media.id)\n\n          resolve(media)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Creates a new local Screen Media object.\n   * Use the provided constraints to get user media as the base MediaStream.\n   * @method createLocalScreen\n   * @param {MediaStreamConstraints} constraints\n   * @return {promise}\n   */\n\n  function createLocalScreen (constraints) {\n    const constraintsWorkaround = browserContraintsWorkaround(constraints)\n\n    return new Promise((resolve, reject) => {\n      navigator.mediaDevices\n        .getDisplayMedia(constraintsWorkaround)\n        .then(mediaStream => {\n          const media = setupMedia(mediaStream)\n\n          medias.set(media.id, media)\n          // TODO: Better event. Include metadata?\n          emitter.emit('media:new', media.id)\n\n          resolve(media)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Create a new remote Media object.\n   * Use provided stream/tracks as the base media objects.\n   * @method createRemote\n   * @param  {MediaStream} mediaStream Native MediaStream object.\n   * @param  {Tracks[]} tracks Array of Track objects.\n   * @return {Media}\n   */\n  function createRemote (stream, tracks = []) {\n    const media = new Media(stream, false)\n\n    tracks.forEach(track => {\n      media.addTrack(track)\n    })\n\n    media.once('media:stopped', mediaId => {\n      remove(mediaId)\n    })\n\n    media.on('track:removed', trackId => {\n      if (media.tracks.size === 0) {\n        remove(media.id)\n      }\n    })\n\n    media.on('track:ended', ({ mediaId, trackId }) => {\n      if (media.getTracks().length === 0) {\n        remove(mediaId)\n      }\n    })\n\n    medias.set(media.id, media)\n    // TODO: Better event. Include metadata?\n    emitter.emit('media:new', media.id)\n    return media\n  }\n\n  /**\n   * Removes a Media object from the medias array.\n   * @private\n   * @method remove\n   * @param {String} mediaId\n   */\n  function remove (mediaId) {\n    const media = get(mediaId)\n    if (media) {\n      medias.delete(mediaId)\n      emitter.emit('media:removed', mediaId)\n    }\n  }\n\n  /**\n   * Retrieve an existing Media object.\n   * @method get\n   * @param  {String} mediaId ID of the desired Media object.\n   * @return {Media}\n   */\n  function get (mediaId) {\n    const media = medias.get(mediaId)\n    if (!media) {\n      log.debug(`No media found with ID: ${mediaId}.`)\n    }\n    return media\n  }\n\n  /**\n   * Retrieve a list of all existing Media object's IDs.\n   * @method getAll\n   * @return {Array} List of Media IDs.\n   */\n  function getAll () {\n    return Array.from(medias.keys())\n  }\n\n  /**\n   * Finds the Media object that contains the specified Track.\n   * @method findTrack\n   * @param  {string}  trackId The ID of the Track to find.\n   * @return {string} The ID of the Media object that contains the Track.\n   */\n  function findTrack (trackId) {\n    // Search through all Media objects for the one that has the desired track.\n    const allMedia = Array.from(medias.values())\n    const media = allMedia.find(media => media.getTrack(trackId))\n    if (media) {\n      log.debug(`Found Media (${media.id}) with Track ${trackId}.`)\n      return media.id\n    } else {\n      log.debug(`Found no Media with Track ${trackId}.`)\n    }\n  }\n\n  function on (...args) {\n    return emitter.on(...args)\n  }\n\n  function once (...args) {\n    return emitter.once(...args)\n  }\n\n  function off (...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    // Getter APIs.\n    get,\n    getAll,\n    getState,\n    findTrack,\n    // Create APIs.\n    createLocal,\n    createLocalScreen,\n    createRemote,\n    // Event APIs.\n    on,\n    once,\n    off\n  }\n}\n","import Peer from '../models/peer'\n\n// Libraries.\nimport log from 'loglevel'\nimport uuidV4 from 'uuid/v4'\nimport EventEmitter from 'eventemitter3'\n\n/**\n * Manager for Peer objects.\n * Allows the creation and retrieval of peer objects.\n * @method PeerManager\n */\nexport default function PeerManager (managers) {\n  // Internal variables.\n  const trackManager = managers.trackManager\n  const peers = new Map()\n  const emitter = new EventEmitter()\n\n  /**\n   * Retrieve a snapshot of all Peer objects' current state.\n   * @method getState\n   * @return {Array}\n   */\n  function getState () {\n    return getAll().map(id => get(id).getState())\n  }\n\n  /**\n   * Create a new Peer using the provided configs.\n   * @method create\n   * @param  {Object} [config={}]\n   * @return {Peer}\n   */\n  function create (config = {}) {\n    const peer = new Peer(uuidV4(), config, trackManager)\n    peer.once('peer:closed', id => peers.delete(id))\n    peers.set(peer.id, peer)\n    emitter.emit('peer:new', peer.id)\n    return peer\n  }\n\n  /**\n   * Retrieves an existing Peer object.\n   * @method get\n   * @param  {String} id ID of the desired Peer object.\n   * @return {Peer}\n   */\n  function get (id) {\n    const peer = peers.get(id)\n    if (!peer) {\n      log.debug(`No Peer found with ID: ${id}.`)\n    }\n    return peer\n  }\n\n  /**\n   * Retrieve a list of all existing Peer object's IDs.\n   * @method getAll\n   * @return {Array} List of Peer IDs.\n   */\n  function getAll () {\n    return Array.from(peers.keys())\n  }\n\n  function on (...args) {\n    return emitter.on(...args)\n  }\n\n  function once (...args) {\n    return emitter.once(...args)\n  }\n\n  function off (...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    getState,\n    get,\n    getAll,\n    create,\n    // Event APIs.\n    on,\n    once,\n    off\n  }\n}\n","import Session from '../models/session'\n\n// Libraries.\nimport uuidV4 from 'uuid/v4'\nimport log from 'loglevel'\nimport EventEmitter from 'eventemitter3'\n\n/**\n * Manager for Session objects.\n * Allows for creation and retrieval of session objects.\n * @method SessionManager\n */\nexport default function SessionManager (managers) {\n  // Internal variables.\n  const sessions = new Map()\n  const emitter = new EventEmitter()\n\n  /**\n   * Create a new Session object.\n   * @method create\n   * @param {Object} [config]\n   * @param {Object} [config.peer] Configs for the Session's Peer object.\n   * @return {Session}\n   */\n  function create (config = {}) {\n    const session = new Session(uuidV4(), managers, config)\n    session.once('session:ended', id => {\n      sessions.delete(id)\n      emitter.emit('session:removed', id)\n    })\n    sessions.set(session.id, session)\n    emitter.emit('session:new', session.id)\n    return session\n  }\n\n  /**\n   * Retrieve an existing Session object.\n   * @method get\n   * @param  {String} sessionId ID of the desired Session object.\n   * @return {Session}\n   */\n  function get (sessionId) {\n    const session = sessions.get(sessionId)\n    if (!session) {\n      log.debug(`No session found with ID: ${sessionId}.`)\n    }\n    return session\n  }\n\n  /**\n   * Retrieve a list of all existing Sessions.\n   * @method getAll\n   * @return {Array} List of Media IDs.\n   */\n  function getAll () {\n    return Array.from(sessions.values())\n  }\n\n  function on (...args) {\n    return emitter.on(...args)\n  }\n\n  function once (...args) {\n    return emitter.once(...args)\n  }\n\n  function off (...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    create,\n    get,\n    getAll,\n    on,\n    once,\n    off\n  }\n}\n","import Track from '../models/track'\n\n// Libraries.\nimport EventEmitter from 'eventemitter3'\n\n/**\n * Manager / store for Track objects.\n * @method TrackManager\n */\nexport default function TrackManager () {\n  /**\n   * The Track objects being managed.\n   * @type {Map}\n   */\n  const tracks = new Map()\n  const emitter = new EventEmitter()\n\n  /**\n   * Retrieve a Track object.\n   * @method get\n   * @param  {string} trackId\n   * @return {Track}\n   */\n  function get (trackId) {\n    return tracks.get(trackId)\n  }\n\n  /**\n   * Retrieve a list of Track objects.\n   * If no tracks are specified, will return all tracks.\n   * @method getTracks\n   * @param  {Array} [trackIds] List of tracks to retrieve.\n   * @return {Array}\n   */\n  function getTracks (trackIds) {\n    if (trackIds) {\n      return trackIds.map(trackId => tracks.get(trackId))\n    } else {\n      return Array.from(tracks.values())\n    }\n  }\n\n  /**\n   * Wraps a MediaStreamTrack into a Track object and adds\n   *    it to the manager.\n   * @method add\n   * @param  {MediaStreamTrack} track A native track object.\n   * @param  {MediaStream} stream\n   * @return {Track} The added/wrapped Track object.\n   */\n  function add (track, stream) {\n    const targetTrack = tracks.get(track.id)\n\n    // Chrome issue: track.stream is outdated and needs to be updated to newStream.\n    // targetTrack.stream.active is false & targetTrack.stream.getTracks() gives us an empty array.\n    // stream.active is true & stream.getTracks() gives us the correct array of tracks.\n    // Set/update the new stream as the track's stream\n    if (targetTrack && !targetTrack.getStream().active && stream.active) {\n      // The track was previously registered and is being re-added with new stream\n      targetTrack.setStream(stream)\n      return targetTrack\n    } else if (targetTrack) {\n      // This track is already registered.\n      return targetTrack\n    } else {\n      // Wrap the track as a Track object.\n      const wrappedTrack = new Track(track, stream)\n      tracks.set(track.id, wrappedTrack)\n\n      // Remove the track from the manager when it ends.\n      wrappedTrack.once('ended', remove)\n\n      emitter.emit('add', wrappedTrack.id)\n      return wrappedTrack\n    }\n  }\n\n  /**\n   * Remove a Track from the manager.\n   * @method remove\n   * @param  {string} trackId\n   * @return {Boolean} Whether the Track existed (and hence removed).\n   */\n  function remove (trackId) {\n    const track = get(trackId)\n    if (track) {\n      tracks.delete(trackId)\n      // Clean up any listeners.\n      track.off('ended', remove)\n      emitter.emit('remove', trackId)\n    }\n\n    return Boolean(track)\n  }\n\n  function on (...args) {\n    return emitter.on(...args)\n  }\n\n  function once (...args) {\n    return emitter.once(...args)\n  }\n\n  function off (...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    get,\n    getTracks,\n    add,\n    remove,\n    on,\n    once,\n    off\n  }\n}\n","// Libraries.\nimport EventEmitter from 'eventemitter3'\nimport log from 'loglevel'\n\n/**\n * Object to represent a \"media\" object.\n * Wraps a MediaStream object.\n * @class Media\n * TODO: Rename to Stream? Would be more straight-forward since Tracks can be\n *    managed directly (with trackManager), instead of through a \"Media\" object.\n */\nexport default function Media (nativeStream, isLocal) {\n  // Internal variables.\n  const id = nativeStream.id\n  const stream = nativeStream\n  const emitter = new EventEmitter()\n\n  /**\n   * Mapping of the IDs of this Media object's tracks to the Track object.\n   * @type {Map}\n   */\n  const tracks = new Map()\n\n  stream.onremovetrack = event => {\n    tracks.delete(event.track.id)\n    emitter.emit('track:removed', event.track.id)\n  }\n\n  /**\n   * Retrieve a snapshot of the Media object's current state.\n   * @method getState\n   * @return {Object}\n   */\n  function getState () {\n    return {\n      id: id,\n      tracks: Array.from(tracks.values()).map(track => track.getState()),\n      isLocal: isLocal\n    }\n  }\n\n  /**\n   * Add a track to this Media object.\n   * @method addTrack\n   * @param {Track} track The Track object to add to the Media object.\n   */\n  function addTrack (track) {\n    if (tracks.has(track.id)) {\n      log.debug(`Track (${track.id}) is already in Media (${id}).`)\n      return\n    }\n\n    // Add the native MediaStreamTrack to the MediaStream.\n    stream.addTrack(track.track)\n    // Add the Track to the Media object.\n    tracks.set(track.id, track)\n\n    /**\n     * When a track ends, remove it from the Media object then clean it up.\n     */\n    track.on('ended', () => {\n      const removedTrack = removeTrack(track.id)\n      // Might be from old already deleted media which has no tracks anymore.\n      if (removedTrack) {\n        removedTrack.cleanup()\n        emitter.emit('track:ended', {\n          mediaId: id,\n          trackId: removedTrack.id\n        })\n      }\n    })\n    // TODO: Emit event or return result?\n    emitter.emit('track:new', {\n      mediaId: id,\n      trackId: track.id\n    })\n  }\n\n  /**\n   * Remove a track from the Media object.\n   * @private\n   * @method removeTrack\n   * @param  {string} trackId The Track to remove.\n   */\n  function removeTrack (trackId) {\n    const track = getTrack(trackId)\n    if (track) {\n      tracks.delete(trackId)\n      return track\n    }\n  }\n\n  /**\n   * Render all tracks of this Media object inside the specified element.\n   * @method renderIn\n   * @param  {HTMLElement} element The DOM element to be rendered in.\n   * @param  {String} [speakerId] The device ID to be used for audio output.\n   */\n  function renderIn (element, speakerId) {\n    getTracks().forEach(track => {\n      track.renderIn(element, speakerId)\n    })\n  }\n\n  /**\n   * Stop rendering all tracks of this Media object from the specified element.\n   * @method removeFrom\n   * @param  {HTMLElement} element The DOM element to be removed from.\n   */\n  function removeFrom (element) {\n    getTracks().forEach(track => {\n      track.removeFrom(element)\n    })\n  }\n\n  /**\n   * Moves the rendered Media object to only the specified element.\n   * @method moveTo\n   * @param  {HTMLElement} element The DOM element to be move to.\n   */\n  function moveTo (element) {\n    getTracks().forEach(track => {\n      track.moveTo(element)\n    })\n  }\n\n  /**\n   * Stop all Tracks within this Media object.\n   * @method stop\n   */\n  function stop () {\n    getTracks().forEach(track => {\n      track.stop()\n    })\n    emitter.emit('media:stopped', this.id)\n  }\n\n  /**\n   * Clean-up the Media object by stopping all Tracks and removing any rendered media.\n   * @method cleanup\n   */\n  function cleanup () {\n    getTracks().forEach(track => {\n      track.cleanup()\n    })\n    emitter.emit('media:stopped', this.id)\n  }\n\n  /**\n   * Retrieve the list of Track object this this Media object manages.\n   * @method getTracks\n   * @return {Array} The list of Track objects.\n   */\n  function getTracks () {\n    return Array.from(tracks.values())\n  }\n\n  /**\n   * Retrieve a specific Track object from within the Media object.\n   * @method getTrack\n   * @param  {String} trackId ID of the Track to retrieve.\n   * @return {Track}\n   */\n  function getTrack (trackId) {\n    return tracks.get(trackId)\n  }\n\n  function on (...args) {\n    return emitter.on(...args)\n  }\n\n  function once (...args) {\n    return emitter.once(...args)\n  }\n\n  function off (...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    id,\n    tracks,\n    isLocal,\n    // Getter APIs.\n    getState,\n    getTracks,\n    getTrack,\n    // Create APIs.\n    addTrack,\n    // Render APIs.\n    renderIn,\n    removeFrom,\n    moveTo,\n    // Cleanup APIs.\n    stop,\n    cleanup,\n    // Event APIs.\n    on,\n    once,\n    off\n  }\n}\n","// Helpers.\nimport { PEER } from '../constants'\n\n// SDP Helpers.\nimport { runPipeline } from '../sdpUtils/pipeline'\nimport { removeTrickleIce, removeBundling, changeMediaDirection, preventDtlsRoleChange } from '../sdpUtils/handlers'\nimport { isUnifiedPlan } from '../sdpUtils/sdpSemantics'\nimport { mergeValues } from '../utils'\nimport { setTransceiverDirection } from '../sdpUtils/transceiverUtils'\n\n// Libraries.\nimport log from 'loglevel'\nimport EventEmitter from 'eventemitter3'\nimport Timer from 'timer-machine'\n\n/**\n * Configuration object for a Peer.\n * @typedef {Object} PeerConfig\n * @property {Object} [rtcConfig] Configuration for the native RTCPeerConnection.\n * @property {String} [trickleIceMode=FULL] The initial mode the Peer will use when receiving ICE candidates.\n * @property {Number} [iceTimeout=10000] Duration (in ms) that the Peer should wait for ICE candidate collection.\n * @property {Function} [halfTrickleThreshold] Function that determines whether the threshold has been met when in HALF trickle mode.\n */\nconst defaultConfig = {\n  rtcConfig: {\n    sdpSemantics: PEER.SDP_SEMANTICS.PLAN_B\n  },\n  trickleIceMode: PEER.TRICKLE_ICE.FULL,\n  removeBundling: true,\n  iceTimeout: 10000,\n  halfTrickleThreshold: isPassedHalfTrickleThreshold\n}\n\n/**\n * Default function for determining whether the HALF trickle ICE threshold has\n *    been met, to start trickling ICE candidates.\n * Defines the threshold as one relay candidate being gathered.\n * @method isPassedHalfTrickleThreshold\n * @param  {String}             sdp          The local SDP of the Peer.\n * @param  {RTCIceCandidate}    iceCandidate The native candidate object that triggered this check.\n * @param  {Number}             time         The amount of time (ms) since ICE collection began.\n * @return {Boolean} Whether the \"half trickle\" threshold has been passed.\n */\nfunction isPassedHalfTrickleThreshold ({ sdp, iceCandidate, time }) {\n  const passedHalf = iceCandidate.candidate.indexOf('relay') !== -1\n  log.debug(`Peer's half trickle threshold ${!passedHalf ? 'not ' : ''}reached.`)\n  return passedHalf\n}\n\n/**\n * Wrapper object for a native RTCPeerConnection object.\n * Ref: https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection\n * @method Peer\n * TODO: Should this be renamed to PeerConnection or Connection? Just so its clearer?\n */\nexport default function Peer (id, config = {}, trackManager) {\n  // Internal variables.\n  config = mergeValues(defaultConfig, config)\n\n  const peerId = id\n  log.info(`Creating peer connection with ID: ${peerId}.`, config)\n  const peerConnection = new RTCPeerConnection(config.rtcConfig)\n  const iceTimer = Timer.get(`ice-${peerId}`)\n  const emitter = new EventEmitter()\n\n  /**\n   * The DTLS role selected for this PeerConnection. Set after the initial\n   *    negotiation is completed.\n   * @type {string}\n   */\n  let dtlsRole\n\n  // Bubble up the RTCPeerConnection events.\n  const events = ['oniceconnectionstatechange', 'onsignalingstatechange', 'onnegotiationneeded']\n\n  /**\n   * Intercept the PeerConnection onicecandidate event.\n   * Handle the candidate as defined by the current trickle ICE mode config.\n   * Trickle ICE scenarios:\n   *   - FULL: Trickle.\n   *   - HALF, pre-half: Wait for \"half\" or null candidate.\n   *   - HALF, post-half: Trickle.\n   *   - NONE: Wait for null candidate.\n   */\n  peerConnection.onicecandidate = event => {\n    log.debug(\n      `ICE candidate received (trickling?: ${config.trickleIceMode === PEER.TRICKLE_ICE.FULL}): `,\n      event.candidate\n    )\n\n    if (config.trickleIceMode === PEER.TRICKLE_ICE.FULL) {\n      // If trickling is enabled, emit an event for every ICE candidate. The\n      //    Peer is already ready for negotiation at this point.\n      if (event.candidate) {\n        // Only trickle non-null (ie. actual) candidates.\n        emitter.emit('onicecandidate', event)\n      }\n    } else if (event.candidate === null) {\n      // If we received the last candidate (null), then gathering is done and\n      //    Peer is ready for negotiation (no matter the scenario).\n      log.debug('ICE collection process complete; ready for negotiation.')\n      emitter.emit('onnegotiationready')\n    } else if (config.trickleIceMode === PEER.TRICKLE_ICE.HALF) {\n      // For half trickle, only start trickling after a certain threshold.\n      //    Peer will be considered ready for negotiation after that point.\n      const haveHalf = config.halfTrickleThreshold({\n        sdp: peerConnection.localDescription.sdp,\n        iceCandidate: event.candidate,\n        time: iceTimer.timeFromStart()\n      })\n\n      if (haveHalf) {\n        log.debug('Half ICE collection process complete; ready for negotiation.')\n        config.trickleIceMode = PEER.TRICKLE_ICE.FULL\n        emitter.emit('onnegotiationready')\n      }\n    }\n  }\n\n  /**\n   * Intercept the PeerConnection onicegatheringstatechange event.\n   * Time how long ICE collection takes and handles scenarios when it takes\n   *    too long.\n   * TODO: Figure out how we should do events. Makes events simpler/better,\n   *    with proper formats.\n   */\n  peerConnection.onicegatheringstatechange = event => {\n    const gatheringState = event.target.iceGatheringState\n    log.debug(`Peer's iceGatheringState changed to ${gatheringState}.`)\n\n    if (gatheringState === PEER.ICE_GATHERING_STATE.GATHERING) {\n      iceTimer.start()\n      // TODO: Handle \"ICE collection taking too long\" scenario.\n    } else if (gatheringState === PEER.ICE_GATHERING_STATE.COMPLETE) {\n      log.debug(`Peer took ${iceTimer.timeFromStart()}ms to collect ICE candidates.`)\n      iceTimer.stop()\n    }\n    // Bubble the event up.\n    emitter.emit('onicegatheringstatechange', event)\n  }\n\n  // TODO: Is this how we want business logic to listen for PeerConnection events?\n  events.forEach(eventType => {\n    peerConnection[eventType] = event => {\n      log.debug(`Peer ${eventType} event.`, event)\n      // TODO: Should this be eventType or event.type?\n      emitter.emit(eventType, event)\n    }\n  })\n\n  /**\n   * Intercept the PeerConnection ontrack event.\n   * Check whether the track is from a new MediaStream or not.\n   * TODO: Figure out how we should do events. Makes events simpler/better,\n   *    with proper formats.\n   */\n  peerConnection.ontrack = event => {\n    /**\n     * transceiver: The RTCRtpTransceiver for this remote track. (Available in unified-plan)\n     * receiver: The RTCRtpReceiver for this remote track.\n     * track: The remote MediaStreamTrack.\n     * streams: Array of MediaStreams the track is in.\n     */\n    // event object contains transceiver which already has track attached to its receiver\n    const { track: nativeTrack, streams } = event\n\n    // When remote side adds track on a previously unused transceiver sender via `replaceTrack`,\n    //  a stream is not associated with it so we get no stream here.\n    // So we create our own stream here.\n    // In the future, support will be available for `sender.setStreams` on the remote side\n    //  so this is a temporary workaround.\n    let targetStream\n    if (streams.length === 0) {\n      targetStream = new MediaStream([nativeTrack])\n    } else {\n      targetStream = streams[0]\n    }\n\n    // Convert the native MediaStreamTrack into a Track object.\n    const track = trackManager.add(nativeTrack, targetStream)\n\n    log.debug(`Peer (${peerId}) received track (${track.id}).`)\n    emitter.emit('ontrack', track)\n  }\n\n  /**\n   * @method getLocalTracks\n   * @return {Array} List of active Track objects added to the Peer locally.\n   */\n  function getLocalTracks () {\n    // Return the list of Tracks from active senders.\n    return (\n      peerConnection\n        .getSenders()\n        /**\n         * Remove any Senders that do not have an associated track.\n         * We only want to retrieve Senders that do have tracks, because those are\n         *    the local tracks that have been added to the Peer.\n         * Senders without tracks are part of a Transceiver where the Receiver has\n         *    a remote track, but no local track has been added to it. We don't\n         *    care about this for the \"get local tracks\" operation.\n         */\n        .filter(sender => Boolean(sender.track))\n        .map(sender => trackManager.get(sender.track.id))\n        .filter(track => {\n          // Make sure the trackManager has the track and that its active.\n          // It's possble that Peer has the sender but not the actual track yet.\n          return track && track.getState().state === 'live' && track.getStream().active\n        })\n    )\n  }\n\n  /**\n   * @method getRemoteTracks\n   * @return {Array} List of active Track objects the Peer has received remotely.\n   */\n  function getRemoteTracks () {\n    // Return the list of Tracks from active receivers.\n    return (\n      peerConnection\n        .getReceivers()\n        /**\n         * Remove any Receivers that do not have an associated track.\n         * We only want to retrieve Receivers that do have tracks, because those are\n         *    the remote tracks that have been added to the Peer.\n         * Receivers without tracks are part of a Transceiver where the Sender has\n         *    a local track, but no remote track has been added to it. We don't\n         *    care about this for the \"get remote tracks\" operation.\n         */\n        .filter(receiver => Boolean(receiver.track))\n        .map(receiver => trackManager.get(receiver.track.id))\n        .filter(track => {\n          // Make sure the trackManager has the track and that its active.\n          // It's possble that Peer has the receiver but not the actual track yet.\n          return track && track.getState().state === 'live' && track.getStream().active\n        })\n    )\n  }\n\n  /**\n   * Retrieve a snapshot of the Peer object's current state.\n   * @method getState\n   * @return {Object}\n   */\n  function getState () {\n    return {\n      id: peerId,\n      config: config,\n      localDesc: getLocalDescription(),\n      signalingState: peerConnection.signalingState,\n      localTracks: getLocalTracks(),\n      remoteTracks: getRemoteTracks()\n    }\n  }\n\n  /**\n   * Creates an SDP offer.\n   * @method createOffer\n   * @param  {RTCOfferOptions} [options={}] Options used to customize the offer.\n   * @param  {Object} [options.mediaDirections] Directions to use for media.\n   * @param  {string} [options.mediaDirections.audio]\n   * @param  {string} [options.mediaDirections.video]\n   * @return {Promise} Resolves with the offer.\n   */\n  function createOffer (options = {}) {\n    // If using unified-plan, remove options.mediaDirections.\n    // This is because directions are now set in transceivers.\n    if (isUnifiedPlan(config.rtcConfig.sdpSemantics)) {\n      delete options.mediaDirections\n    }\n\n    return new Promise((resolve, reject) => {\n      peerConnection\n        .createOffer(options)\n        .then(offer => {\n          const sdpHandlers = []\n          if (config.trickleIceMode === PEER.TRICKLE_ICE.NONE) {\n            // Modify the offer to claim the Peer doesn't suport trickle ICE.\n            sdpHandlers.push(removeTrickleIce)\n          }\n          if (config.removeBundling) {\n            // Modify the offer to remove media bundling\n            sdpHandlers.push(removeBundling)\n          }\n          if (options.mediaDirections) {\n            // Modify the offer to set media directions as desired.\n            sdpHandlers.push(changeMediaDirection(options.mediaDirections))\n          }\n          if (sdpHandlers.length > 0) {\n            // Run the SDP pipeline with only these handlers.\n            offer.sdp = runPipeline(sdpHandlers, offer.sdp, {\n              type: offer.type,\n              endpoint: PEER.ENDPOINT.LOCAL\n            })\n          }\n          resolve(offer)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Creates an SDP answer, given that a remote offer has been set.\n   * @method createOffer\n   * @param  {RTCAnswerOptions} [options={}] Options used to customize the answer.\n   * @param  {Object} [options.mediaDirections] Directions to use for media.\n   * @param  {string} [options.mediaDirections.audio]\n   * @param  {string} [options.mediaDirections.video]\n   * @return {Promise} Resolves with the answer.\n   */\n  function createAnswer (options = {}) {\n    // If using unified-plan, remove options.mediaDirections.\n    // This is because directions are now set in transceivers.\n    if (isUnifiedPlan(config.rtcConfig.sdpSemantics)) {\n      delete options.mediaDirections\n    }\n\n    return new Promise((resolve, reject) => {\n      peerConnection\n        .createAnswer(options)\n        .then(answer => {\n          const sdpHandlers = []\n\n          /*\n           * Always include the `preventDtlsRoleChange` handler. This ensures\n           *    that the SDP's DTLS role does not change during a renegotiation.\n           */\n          sdpHandlers.push(preventDtlsRoleChange)\n\n          if (config.trickleIceMode === PEER.TRICKLE_ICE.NONE) {\n            // Modify the answer to claim the Peer doesn't suport trickle ICE.\n            sdpHandlers.push(removeTrickleIce)\n          }\n          if (config.removeBundling) {\n            // Modify the offer to remove media bundling\n            sdpHandlers.push(removeBundling)\n          }\n          if (options.mediaDirections) {\n            // Modify the answer to set media directions as desired.\n            sdpHandlers.push(changeMediaDirection(options.mediaDirections))\n          }\n          if (sdpHandlers.length > 0) {\n            // Run the SDP pipeline with only these handlers.\n            answer.sdp = runPipeline(sdpHandlers, answer.sdp, {\n              type: answer.type,\n              endpoint: PEER.ENDPOINT.LOCAL,\n              dtlsRole: dtlsRole\n            })\n          }\n          resolve(answer)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * The SDP for the local end of the connection.\n   * @method getLocalDescription\n   */\n  function getLocalDescription () {\n    const localDesc = peerConnection.localDescription\n    if (localDesc && localDesc.sdp && localDesc.type) {\n      return localDesc\n    } else {\n      return undefined\n    }\n  }\n\n  /**\n   * The SDP for the remote end of the connection.\n   * @method getRemoteDescription\n   */\n  function getRemoteDescription () {\n    const remoteDesc = peerConnection.remoteDescription\n    if (remoteDesc && remoteDesc.sdp && remoteDesc.type) {\n      return remoteDesc\n    } else {\n      return undefined\n    }\n  }\n\n  /**\n   * Sets an SDP as the local description of the connection.\n   * The returned Promise will resolve when the Peer is ready for negotiation,\n   *    taking into account the Peer's `trickleIceMode` configuration.\n   * @method setLocalDescription\n   * @param  {RTCSessionDescription} sessionDesc\n   * @return {Promise}\n   */\n  function setLocalDescription (sessionDesc) {\n    // TODO: SDP pipeline here.\n    log.info(`Setting local description ${sessionDesc.type}:`, sessionDesc.sdp)\n\n    /**\n     * Scenario: A local answer SDP is being applied to the Peer, but it does\n     *    not have a selected DTLS role yet. This should occur during initial\n     *    negotiation, before responding with this Peer's answer.\n     * Set the local Peer's DTLS role depending on what role was generated. This\n     *    role will be kept throughout all renegotiations.\n     */\n    if (!dtlsRole && sessionDesc.type === 'answer') {\n      const localRole = sessionDesc.sdp.match(/a=setup:(\\w*?)[\\r\\n]/)[1]\n      log.debug(`Selecting DTLS role ${localRole} for Peer.`)\n      dtlsRole = localRole\n    }\n\n    return new Promise((resolve, reject) => {\n      // We always want to wait for the PeerConnection to be ready for\n      //    negotiation before resolving setLocalDescription.\n      // Each trickle ICE option (FULL/HALF/NONE) emits \"negotiation ready\" event once.\n      emitter.once('onnegotiationready', () => {\n        if (iceTimer.isStarted()) {\n          // In a HALF trickle scenario, the Peer will be ready for negotiation\n          //    before ICE collection has completed. Log that timing.\n          log.debug(`Peer took ${iceTimer.timeFromStart()}ms to collect ICE candidates before negotiation.`)\n        }\n        resolve()\n      })\n\n      peerConnection\n        .setLocalDescription(sessionDesc)\n        .then(() => {\n          if (config.trickleIceMode === PEER.TRICKLE_ICE.FULL) {\n            // Trickling ICE candidates means that we can begin negotiation immediately.\n            log.debug('Local description set; ready for negotiation (full trickleICE).')\n            emitter.emit('onnegotiationready')\n          } else {\n            // ICE candidates aren't always gathered (only initially and when something\n            //  changes), but we rely on \"gathering complete\" to know when the Peer is\n            //  ready for negotiation. Give the Peer some time to start gathering\n            //  before deciding if we need to wait for gathering to complete or not.\n            // The timeout is needed because of a bug in Chrome:\n            //    https://bugs.chromium.org/p/webrtc/issues/detail?id=1873\n            // Known issue: If candidate collection takes less time than this timeout,\n            //  the logged message will be incorrect, but will functionality still work.\n            setTimeout(() => {\n              if (peerConnection.iceGatheringState === 'complete') {\n                // Gathering is \"complete\", so we are ready for negotiation.\n                log.debug(`Local description set, ICE candidate collection not needed; ready for negotiation.`)\n                emitter.emit('onnegotiationready')\n              } else {\n                log.debug(`Local description set, waiting for ICE collection process (${config.trickleIceMode}).`)\n                // TODO: Handle this scenario properly.\n                // If ICE collection never finishes, we need to time it out at some point.\n                setTimeout(() => emitter.emit('onnegotiationready'), 3000)\n              }\n            }, 25)\n          }\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Sets an SDP as the remote description of the connection.\n   * @method setRemoteDescription\n   * @param  {RTCSessionDescription} sessionDesc\n   */\n  function setRemoteDescription (sessionDesc) {\n    /**\n     * Scenario: A remote answer SDP is being applied to the Peer, but it does\n     *    not have a selected DTLS role yet. This should occur only when the\n     *    initial negotiation is being completed.\n     * Set the local Peer's DTLS role depending on what the remote Peer\n     *    selected. This role will be kept throughout all renegotiations.\n     */\n    if (!dtlsRole && sessionDesc.type === 'answer') {\n      const remoteRole = sessionDesc.sdp.match(/a=setup:(\\w*?)[\\r\\n]/)[1]\n      const localRole = remoteRole === 'active' ? 'passive' : 'active'\n      log.debug(`Selecting DTLS role ${localRole} for Peer. Remote Peer selected ${remoteRole} DTLS role.`)\n      dtlsRole = localRole\n    }\n\n    // TODO: SDP pipeline here.\n    // TODO: Update `config.trickleIceMode` to either NONE or FULL (from HALF)\n    //    depending on remote support, since HALF is only needed for initial.\n    log.info(`Setting remote description ${sessionDesc.type}:`, sessionDesc.sdp)\n    return peerConnection.setRemoteDescription(sessionDesc)\n  }\n\n  /**\n   * Finds a specific transceiver depending on the options passed in\n   * @method findTransceiver\n   * @param {Object} [options] Only one of these options will be taken. They are ordered by priority.\n   * @param {string} [options.trackId] The transceiver with the specific sender.track.id.\n   * @return {Object} The transceiver that was found (undefined if not found).\n   */\n  function findTransceiver (options) {\n    const transceivers = peerConnection.getTransceivers()\n    if (options.trackId) {\n      return transceivers.find(\n        transceiver => transceiver.sender.track && transceiver.sender.track.id === options.trackId\n      )\n    }\n  }\n\n  /**\n   * Replaces a specified transceiver's sender.track.\n   * @method replaceTrack\n   * @param {Object} newTrack The MediaStreamTrack we want to place into the sender.\n   * @param {Object} options Options for specifying which transceiver's sender should be replaced. They are ordered by priority.\n   * @param {Array} [options.trackId] The track id whose transceivers we want to set the direction of.\n   * @return {Object} A Promise object which is fulfilled once the track has been replaced\n   */\n  function replaceTrack (newTrack, options) {\n    return new Promise((resolve, reject) => {\n      let sender\n      if (isUnifiedPlan(config.rtcConfig.sdpSemantics)) {\n        const targetTransceiver = findTransceiver(options)\n        sender = targetTransceiver ? targetTransceiver.sender : undefined\n      } else {\n        sender = peerConnection.getSenders().find(sender => sender.track.id === options.trackId)\n      }\n\n      if (sender) {\n        sender\n          .replaceTrack(newTrack)\n          .then(resolve)\n          .catch(reject)\n      } else {\n        reject(new Error(`Sender for track ${options.trackId} not found.`))\n      }\n    })\n  }\n\n  /**\n   * Finds a transceiver that can be reused.\n   * A transceiver can be reused if it satisfies the following conditions:\n   *   - it does not have a track on its sender\n   *   - it has the same kind (audio or video) as what we specified\n   *   - it has been used before (if it has not been used then we are not \"reusing\" it)\n   * @method findReusableTransceiver\n   * @param {string} kind The kind of transceiver to find (audio or video)\n   * @returns {Object} Transceiver object that matches kind, has no sender track, and has currentDirection. Otherwise undefined.\n   */\n  function findReusableTransceiver (kind) {\n    if (isUnifiedPlan(config.rtcConfig.sdpSemantics)) {\n      const transceivers = peerConnection.getTransceivers()\n      return transceivers.find(\n        transceiver =>\n          transceiver.sender.track == null &&\n          transceiver.receiver &&\n          transceiver.receiver.track &&\n          transceiver.receiver.track.kind === kind &&\n          transceiver.currentDirection // If this has been set, then transceiver has been used before.\n      )\n    } else {\n      log.info(`Transceivers are only available in unified-plan.`)\n    }\n  }\n\n  /**\n   * Add a Track to the connection.\n   * @method addTrack\n   * @param  {Track} track A Track object.\n   * @return {RTCRtpSender}\n   */\n  function addTrack (track) {\n    // Ensure the track wasn't already added to the Peer.\n    if (getLocalTracks().findIndex(localTrack => localTrack.id === track.id) > -1) {\n      log.debug(`Track (${track.id}) already added to Peer (${peerId}).`)\n      return\n    }\n\n    let sender\n    try {\n      sender = peerConnection.addTrack(track.track, track.getStream())\n    } catch (err) {\n      // TODO: Better error handling.\n      log.debug(err.message)\n    }\n    // TODO: What to return here? Probably shouldn't expose the rtpSender itself.\n    return sender\n  }\n\n  /**\n   * Add an ICE candidate to the connection.\n   * @method addIceCandidate\n   * @param  {RTCIceCandidate} candidate A native candidate object.\n   * @return {Promise} Resolves when the candidate is successfully added.\n   */\n  function addIceCandidate (candidate) {\n    return new Promise((resolve, reject) => {\n      if (peerConnection.remoteDescription.type && peerConnection.remoteDescription.sdp) {\n        peerConnection\n          .addIceCandidate(candidate)\n          .then(resolve)\n          .catch(reject)\n      } else {\n        log.debug(`Peer ${peerId} cannot set remote ICE candidate without a remote description.`)\n        // TODO: Better error.\n        reject(new Error(`Peer ${peerId} cannot set remote ICE candidate without a remote description.`))\n      }\n    })\n  }\n\n  /**\n   * Clean the Peer by closing the RTCPeerConnection.\n   * @method close\n   */\n  function close () {\n    peerConnection.close()\n    emitter.emit('peer:closed', peerId)\n  }\n\n  /**\n   * Remove a Track from the connection.\n   * @method removeTrack\n   * @param  {string} trackId An id for a Track object.\n   */\n  function removeTrack (trackId) {\n    const track = getLocalTracks().find(track => track.id === trackId)\n    if (!track) {\n      log.debug(`Invalid track ID ${trackId}; cannot remove track.`)\n      return\n    } else if (peerConnection.signalingState === ' closed') {\n      log.debug(`Peer ${peerId} is closed; cannot remove track.`)\n      return\n    }\n\n    // Get the RtpSender for the Track we want to remove.\n    const sender = peerConnection\n      .getSenders()\n      .filter(sender => sender.track !== null)\n      .find(sender => sender.track.id === trackId)\n    peerConnection.removeTrack(sender)\n  }\n\n  /**\n   * Event handler when tone is played.\n   * @private\n   * @method handleToneChangeEvent\n   * @param  {event} event\n   */\n  function handleToneChangeEvent (event) {\n    if (event.tone !== '') {\n      log.debug('Tone played: ' + event.tone)\n    } else {\n      log.debug('All tones have played.')\n    }\n  }\n\n  /**\n   * Helper function to sendDTMF tones .\n   * @private\n   * @method insertDTMF\n   * @param {sender} object\n   * @param {string} tone\n   * @param {number} duration\n   * @param {number} intertoneGap\n   * @param {Function} callback\n   */\n  function insertDTMF (sender, tone, duration, intertoneGap, callback) {\n    if (sender.dtmf) {\n      const dtmfSender = sender.dtmf\n      if (callback) {\n        dtmfSender.ontonechange = callback\n      } else {\n        dtmfSender.ontonechange = handleToneChangeEvent\n      }\n      try {\n        dtmfSender.insertDTMF(tone, duration, intertoneGap)\n        return true\n      } catch (err) {\n        log.debug(err.message)\n        return false\n      }\n    } else {\n      log.debug('The sender requires DTMF which is not support by this browser.')\n      return false\n    }\n  }\n\n  /**\n   * Send DTMF tones.\n   * @method sendDTMF\n   * @param {Object} DTMFOptions The DTMF options.\n   * @param {string} DTMFOptions.tone DTMF tone to send. Valid values are [0,1,2,3,4,5,6,7,8,9,#].\n   * @param {number} DTMFOptions.duration=100 The amount of time, in milliseconds, that each DTMF tone should last.\n   * @param {number} DTMFOptions.intertoneGap=70 The length of time, in milliseconds, to wait between tones.\n   * @param {Object} [sendOptions] The send options.\n   * @param {func} [sendOptions.callback] Optional callback for tone event .\n   * @param {string} [sendOptions.trackId] The trackId of the sender to use.\n   * @return {Boolean} Whether the DTMF tones were inserted\n   */\n  function sendDTMF ({ tone, duration = 100, intertoneGap = 70 }, { callback, trackId }) {\n    if (!peerConnection.getSenders) {\n      log.debug('RTCPeerConnection method getSenders() is required which is not support by this browser.')\n      return false\n    }\n    const senders = peerConnection.getSenders()\n    // Use the trackId if it was provided\n    if (trackId) {\n      let sender = senders.find(sender => sender.track.id === trackId)\n      if (!sender) {\n        log.debug('No sender with that trackId')\n        return false\n      }\n      insertDTMF(sender, tone, duration, intertoneGap, callback)\n      return true\n    } else {\n      let result\n      for (let i = 0; i < senders.length; i++) {\n        result = insertDTMF(senders[i], tone, duration, intertoneGap, callback)\n        if (result) {\n          return true\n        }\n      }\n      log.debug('No appropriate senders were found')\n      return false\n    }\n  }\n\n  /**\n   * Retrieve RTCStatsReport for a sender or the peerConnection.\n   * @method getStats\n   * @param {string} [TrackId] Return stats for peerConnection if trackId is not provided\n   * @return {Promise} Resolves with the RTCStatsReport\n   */\n  function getStats (trackId) {\n    // If no trackId is supplied, get the stats from the RTCPeerConnection. Otherwise, find an RTCSender\n    // associated with the trackId and get the stats from it.\n\n    // Use the trackId if it was provided\n    if (trackId) {\n      return new Promise((resolve, reject) => {\n        const senders = peerConnection.getSenders()\n        // search for a sender associated with the trackId\n        const sender = senders.find(sender => sender.track.id === trackId)\n        if (sender) {\n          sender\n            .getStats()\n            .then(resolve)\n            .catch(reject)\n        } else {\n          const errMsg = `Cannot find sender with trackId: ${trackId}`\n          log.debug(errMsg)\n          reject(new Error(errMsg))\n        }\n      })\n    } else {\n      // get the stats associated with the peerConnection if no trackId is supplied\n      return peerConnection.getStats()\n    }\n  }\n\n  /**\n   * Sets the direction of transceivers.\n   * @method setTransceiversDirection\n   * @param {string} targetDirection The desired direction to set the transceivers to.\n   * @param {Object} [options] Options for specifying which transceivers should be affected. They are ordered by priority.\n   * @param {Array} [options.trackIds] The optional list of track ids whose transceivers we want to set the direction of.\n   * @return {Object} An object containing an `error` flag and  an array `failures` of transceivers whose directions weren't changed.\n   */\n  function setTransceiversDirection (targetDirection, options = {}) {\n    if (isUnifiedPlan(config.rtcConfig.sdpSemantics)) {\n      let transceivers = peerConnection.getTransceivers()\n\n      if (options.trackIds) {\n        transceivers = transceivers.filter(transceiver => options.trackIds.includes(transceiver.sender.track.id))\n      }\n\n      const failures = []\n      transceivers.forEach(transceiver => {\n        if (!setTransceiverDirection(transceiver, targetDirection)) {\n          failures.push(transceiver)\n        }\n      })\n      return {\n        error: failures.length !== 0,\n        failures\n      }\n    } else {\n      log.info(`Transceiver direction modification is only available in unified-plan.`)\n      return {\n        error: true\n      }\n    }\n  }\n\n  /**\n   * Gets the current dtls role of the peer.\n   * @returns {string} The dtls role of this peer.\n   */\n  function getDtlsRole () {\n    return dtlsRole\n  }\n\n  /**\n   * Sets the current dtls role of the peer.\n   * @param {string} targetRole The dtls role we want to use.\n   */\n  function setDtlsRole (targetRole) {\n    dtlsRole = targetRole\n  }\n\n  function on (...args) {\n    return emitter.on(...args)\n  }\n\n  function once (...args) {\n    return emitter.once(...args)\n  }\n\n  function off (...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    id: peerId,\n    // Getter APIs.\n    get localTracks () {\n      return getLocalTracks()\n    },\n    get remoteTracks () {\n      return getRemoteTracks()\n    },\n    get localDescription () {\n      return getLocalDescription()\n    },\n    get remoteDescription () {\n      return getRemoteDescription()\n    },\n    getState,\n    findTransceiver,\n    findReusableTransceiver,\n    // Negotiation APIs.\n    createOffer,\n    createAnswer,\n    setLocalDescription,\n    setRemoteDescription,\n    setTransceiversDirection,\n    getDtlsRole,\n    setDtlsRole,\n    // Media APIs.\n    addTrack,\n    removeTrack,\n    replaceTrack,\n    // Other APIs.\n    addIceCandidate,\n    close,\n    sendDTMF,\n    getStats,\n    // Event APIs.\n    on,\n    once,\n    off,\n    // The native PeerConnection was accessible before, so it was used when it\n    //    probably shouldn't have been.\n    // TODO: Find a better solution.\n    peerConnection\n  }\n}\n","// Helpers.\nimport { PEER } from '../constants'\n\n// SDP Helpers.\nimport sdpPipeline from '../sdpUtils/pipeline'\nimport { isUnifiedPlan } from '../sdpUtils/sdpSemantics'\nimport { getSdpSessionId } from '../sdpUtils/extractors'\n\n// Libraries.\nimport log from 'loglevel'\nimport EventEmitter from 'eventemitter3'\nimport sdpTransform from 'sdp-transform'\n\n/**\n * Object to represent a webRTC Session for a single peer.\n * \"Session\" being an abstraction of a webRTC connection between another peer.\n * Performs logic for initializing and connecting a peer connection.\n * Manages media added to / received from the peer connection.\n * @method Session\n */\nexport default function Session (id, managers, config = {}) {\n  // Internal variables.\n  const sessionId = id\n  let peerId\n  const peerManager = managers.peerManager\n  const mediaManager = managers.mediaManager\n  const trackManager = managers.trackManager\n  const emitter = new EventEmitter()\n\n  // This structure is used to remember the dtls role of a peer relative to some remote sdp.\n  // key: the remote sdp's session id (o= line).\n  // value: the dtls role that the current peer's local sdp has.\n  // This is needed because a remote SDP with the same sessionId as a previous one may reappear later on\n  //  (music-unhold scenario) and the roles will be expected to be the same.\n  const dtlsRoleRecord = new Map()\n\n  // The latest remote description successfully set, even if the Peer has\n  //    been recreated since it was set.\n  let latestRemoteDescription\n\n  // Create and initialize the peer\n  let peer = peerManager.create(config.peer)\n  if (peer) {\n    // The id of the created peer\n    peerId = peer.id\n    setupPeerEventHandlers(peer)\n  } else {\n    throw new Error(`Peer creation error in Session ${sessionId}.`)\n  }\n\n  /**\n   * Records the peer's dtlsRole if it hasn't been recorded yet and associates it with a remote sdp's sessionId.\n   * @method recordNewDtlsRole\n   */\n  function recordNewDtlsRole () {\n    const remoteSdpSessionId = getSdpSessionId(peer.remoteDescription.sdp)\n    if (!dtlsRoleRecord.get(remoteSdpSessionId)) {\n      dtlsRoleRecord.set(remoteSdpSessionId, peer.getDtlsRole())\n    }\n  }\n\n  /**\n   * @property {Array} getLocalTracks List of active Track objects the Session has added locally.\n   */\n  function getLocalTracks () {\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      return peer.localTracks\n    } else {\n      return []\n    }\n  }\n\n  /**\n   * @property {Array} getRemoteTracks List of active Track objects the Session has received remotely.\n   */\n  function getRemoteTracks () {\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      return peer.remoteTracks\n    } else {\n      return []\n    }\n  }\n\n  /**\n   * Retrieve a snapshot of the Session object's current state.\n   * @method getState\n   * @return {Object}\n   */\n  function getState () {\n    return {\n      id: sessionId,\n      localTracks: getLocalTracks(),\n      remoteTracks: getRemoteTracks()\n    }\n  }\n\n  /**\n   * Setup a warm PeerConnection.\n   * @method warmup\n   */\n  function warmup () {}\n\n  /**\n   * Add Track objects to the Session.\n   * @method addTracks\n   * @param  {Array} tracks List of Track objects.\n   */\n  function addTracks (tracks) {\n    const peer = peerManager.get(peerId)\n    // TODO: Better error handling?\n    if (peer) {\n      const addTrackOrReuseTransceiverPromises = tracks.map(track => {\n        return new Promise((resolve, reject) => {\n          // We try to find a reusable transceiver that we can attach the track to achieve the following:\n          // - Avoid transceiver pollution and needing to create a brand new transceiver to attach the track to.\n          // - Allow re-adding of the same track type that has been previously removed.\n          //   (This is so that we can still have re-adding of tracks when using the \"basic\" media API which imposes a 1-audio & 1-video limit)\n          const reusableTransceiver = peer.findReusableTransceiver(track.track.kind)\n\n          // If we can find a reusable transceiver, reuse it.\n          if (isUnifiedPlan(config.peer.rtcConfig.sdpSemantics) && reusableTransceiver) {\n            // Current limitations of transceiver reuse method:\n            // - We cannot attach the track's associated stream to the sender (lack of `sender.setStreams` support atm)\n            // So the local transceiver's sender track & remote transceiver's receiver track must have been used before so that it already has a stream attached to the sender.\n            // If the local transceiver's sender has not been used before, we should ideally be able to do the following:\n            // transceiver.sender.setStreams([<someStream>]) <- Not yet supported\n            // transceiver.sender.replaceTrack(<someTrack>)\n            // However, because of lack of support for `setStreams`, if we just tried to do `replaceTrack` on a transceiver that has not been used before,\n            //  the sender will not have a stream and the SDP generated will have no associated stream which can cuase issues such as not triggering events on the local stream during renegotiation.\n            // Once `setStreams` is supported, we can use the transceiver reuse method above even on transceivers that have not been used to send data before.\n            reusableTransceiver.sender\n              .replaceTrack(track.track)\n              .then(() => {\n                reusableTransceiver.direction = reusableTransceiver.direction === 'recvonly' ? 'sendrecv' : 'sendonly'\n                resolve(\n                  `Track (${track.track.kind} : ${track.id}) reused transceiver (mid: ${reusableTransceiver.mid}).`\n                )\n              })\n              .catch(err => {\n                log.error(err)\n                reject(err)\n              })\n          } else {\n            // To get around the current limitation described above, we use peerConnection's `addTrack` when we can't find a reusable transceiver.\n            // `addTrack` does one of the following when called:\n            // - Create a new transceiver and attaches the track and stream to the sender\n            // - Find and use an existing transceiver that has never been used to send data before and attach the track and stream to the sender.\n            peer.addTrack(track)\n            resolve(`Added track (${track.track.kind} : ${track.id}).`)\n          }\n        }).then(message => {\n          // Set event emitters and handlers\n          log.info(message)\n\n          // Indicate that the Session has a new Track.\n          emitter.emit('new:track', {\n            local: true,\n            trackId: track.id\n          })\n\n          const media = mediaManager.get(track.getStream().id)\n          if (media) {\n            media.on('track:removed', trackId => {\n              emitter.emit('track:removed', {\n                local: true,\n                trackId: trackId\n              })\n            })\n          }\n\n          track.once('ended', () => {\n            // If the PeerConnection is closed, we don't need to worry about\n            //    removing the track (and it would throw an error anyway).\n            if (peer.peerConnection.signalingState !== 'closed') {\n              peer.removeTrack(track.id)\n              emitter.emit('track:ended', {\n                local: true,\n                trackId: track.id\n              })\n            }\n          })\n        })\n      })\n\n      return Promise.all(addTrackOrReuseTransceiverPromises)\n    }\n  }\n\n  /**\n   * Creates a local SDP offer.\n   * @method createOffer\n   * @param  {Object} [options] Options for configuring the SDP.\n   * @param  {Object} [options.mediaDirections] Directions to use for media.\n   * @param  {Array}  [options.sdpHandlers] SDP handlers for modifying the local offer.\n   * @return {Promise} Resolves with the offer.\n   */\n  function createOffer (options = {}) {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      // If using unified-plan, remove options.mediaDirections.\n      // This is because directions are now set in transceivers.\n      if (isUnifiedPlan(config.peer.rtcConfig.sdpSemantics)) {\n        if (options.mediaDirections) {\n          const audioTransceiverTargetDir = options.mediaDirections.audio\n          const videoTransceiverTargetDir = options.mediaDirections.video\n\n          if (audioTransceiverTargetDir) {\n            const result = peer.setTransceiversDirection(audioTransceiverTargetDir, {\n              trackIds: peer.localTracks.filter(track => track.track.kind === 'audio').map(track => track.id)\n            })\n            if (result.error) {\n              log.info(`Failed to process the following transceivers: ${result.failures}`)\n            }\n          }\n          if (videoTransceiverTargetDir) {\n            const result = peer.setTransceiversDirection(videoTransceiverTargetDir, {\n              trackIds: peer.localTracks.filter(track => track.track.kind === 'video').map(track => track.id)\n            })\n            if (result.error) {\n              log.info(`Failed to process the following transceivers: ${result.failures}`)\n            }\n          }\n          delete options.mediaDirections\n        }\n      }\n\n      peer\n        .createOffer(options)\n        .then(offer => {\n          if (options.sdpHandlers || sdpPipeline.getHandlers().length) {\n            log.debug('Modifying local offer with SDP pipeline.')\n            offer.sdp = sdpPipeline.run(options.sdpHandlers, offer.sdp, {\n              type: offer.type,\n              endpoint: PEER.ENDPOINT.LOCAL\n            })\n          }\n\n          resolve(offer)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Sets a local SDP.\n   * @method setLocalDescription\n   * @param  {Object} description The description containing the SDP to set as the local description.\n   * @return {Promise} Resolves with the description.\n   */\n  function setLocalDescription (description) {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      peer\n        .setLocalDescription(description)\n        .then(() => {\n          // Record the peer's dtls role if setting a local answer.\n          if (description.type === 'answer') {\n            recordNewDtlsRole()\n          }\n\n          // Resolve with the _current_ local description, which may be\n          //    different than the provided description due trickle ICE config.\n          resolve(peer.localDescription)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Generates (and sets) a local SDP offer.\n   * @method generateOffer\n   * @param  {Object} [options] Options for configuring the SDP.\n   * @param  {Object} [options.mediaDirections] Directions to use for media.\n   * @param  {Array}  [options.sdpHandlers] SDP handlers for modifying the local offer.\n   * @return {Promise} Resolves with the offer.\n   */\n  function generateOffer (options = {}) {\n    // Backwards compatibility: Create the offer and set it as one operation.\n    return new Promise((resolve, reject) => {\n      createOffer(options)\n        .then(setLocalDescription)\n        .then(resolve)\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Replaces a specified transceiver's sender.track.\n   * @method replaceTrack\n   * @param {Object} newTrack The MediaStreamTrack we want to place into the sender.\n   * @param {Object} options Options for specifying which transceiver's sender should be replaced. They are ordered by priority.\n   * @param {String} [options.trackId] The transceiver with the specific sender.track.id.\n   * @param {String} [options.mid] The transceiver with the specific media id.\n   * @return {Object} A Promise object which is fulfilled once the track has been replaced\n   */\n  function replaceTrack (newTrack, options) {\n    const peer = peerManager.get(peerId)\n    return peer\n      .replaceTrack(newTrack, options)\n      .then(() => {\n        emitter.emit('track:replaced', {\n          oldTrackId: options.trackId,\n          trackId: newTrack.id\n        })\n      })\n      .catch(err => err)\n  }\n\n  /**\n   * Sets the direction of transceivers.\n   * @method setTransceiversDirection\n   * @param {String} targetDirection The desired direction to set the transceivers to.\n   * @param {Object} [options] Options for specifying which transceivers should be affected.\n   *  trackIds option has priority\n   * @param {Array} [options.trackIds] The optional list of track ids whose transceivers we want to set the direction of.\n   * @return {Object} An object containing an `error` flag and  an array `failures` of transceiver \"mid\"s whose directions weren't changed.\n   */\n  function setTransceiversDirection (targetDirection, options = {}) {\n    if (isUnifiedPlan(config.peer.rtcConfig.sdpSemantics)) {\n      const peer = peerManager.get(peerId)\n      return peer.setTransceiversDirection(targetDirection, options)\n    } else {\n      log.info(`Transceiver direction modification is only available in unified-plan.`)\n      return { error: true }\n    }\n  }\n\n  /**\n   * This function is used to figure out if our local tracks are being sent to the other side.\n   * This is meant to be called after a remote sdp is processed so that:\n   *  a. Transceivers are up-to-date.\n   *  b. The latestRemoteDescription is really the latest one.\n   * @method getLocalTracksIsSendingStatus\n   * @return {TracksIsSendingStatuses}\n   */\n  function getLocalTracksIsSendingStatus () {\n    /**\n     * An object with flags indicating whether a track is sending data or not where:\n     *  key: <string> track ID\n     *  value: <boolean> isSending.\n     * @typedef {Object} TracksIsSendingStatuses\n     */\n    const tracksIsSending = {}\n\n    /**\n     * For Unified-plan, we consider a track to being sent if\n     *  currentDirection is NOT `inactive` and NOT `recvonly`.\n     * IE: Tracks are being sent if\n     *  currentDirection is `sendrecv` or `sendonly` (both contain `send`).\n     */\n    if (isUnifiedPlan(config.peer.rtcConfig.sdpSemantics)) {\n      const transceivers = peer.peerConnection\n        .getTransceivers()\n        // Only check transceivers that have tracks.\n        .filter(transceiver => Boolean(transceiver.sender && transceiver.sender.track))\n\n      transceivers.forEach(transceiver => {\n        if (transceiver.sender.track && transceiver.currentDirection) {\n          tracksIsSending[transceiver.sender.track.id] = transceiver.currentDirection.includes('send')\n        } else {\n          // If `currentDirection` doesn't exist yet then use `direction`.\n          // This is because if the remote sdp didn't have a certain kind of media and we add that new kind of media,\n          //  the transceiver will have `currentDirection` as null.\n          tracksIsSending[transceiver.sender.track.id] = transceiver.direction.includes('send')\n        }\n      })\n    } else {\n      /**\n       * For Plan-B, we check the remote sdp and consider a track be sent if\n       *  direction is NOT `inactive` and NOT `sendonly`.\n       * IE: Tracks are being sent if\n       *  direction is `sendrecv` or `recvonly` (both contain `recv`).\n       */\n      const sdpObj = sdpTransform.parse(latestRemoteDescription.sdp)\n\n      /**\n       * Get the direction of each kind of media.\n       * For plan-b, there are is only 1 m-line for audio and 1 m-line for video.\n       * This means that tracks of the same kind will share the same direction.\n       */\n      const directions = {}\n      sdpObj.media.forEach(media => {\n        const { type, direction } = media\n        directions[type] = direction\n      })\n      peer.localTracks.forEach(track => {\n        const nativeTrack = track.track\n        // If the track's kind isn't on the latest remote sdp, that means it may be supported\n        //  (since it doesn't explicitly have direction of `inactive`).\n        if (directions[nativeTrack.kind] === undefined) {\n          tracksIsSending[nativeTrack.id] = true\n        } else {\n          tracksIsSending[nativeTrack.id] = directions[nativeTrack.kind].includes('recv')\n        }\n      })\n    }\n    return tracksIsSending\n  }\n  /**\n   * Processes (and sets) a remote SDP offer.\n   * @method processOffer\n   * @param  {RTCSessionDescription} offer\n   * @param  {Object} [options] Options for configuring the SDP.\n   * @param  {Array}  [options.sdpHandlers] SDP handlers for modifying the remote offer.\n   * @return {Promise}\n   */\n  function processOffer (offer, options = {}) {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      if (options.sdpHandlers || sdpPipeline.getHandlers().length) {\n        log.debug('Modifying remote offer with SDP pipeline.')\n        offer.sdp = sdpPipeline.run(options.sdpHandlers, offer.sdp, {\n          type: offer.type,\n          endpoint: PEER.ENDPOINT.REMOTE\n        })\n      }\n\n      peer\n        .setRemoteDescription(offer)\n        .then(() => {\n          // Set the offer as the latest remote description.\n          latestRemoteDescription = offer\n          resolve()\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Creates a local SDP answer.\n   * @method createAnswer\n   * @param  {Object} [options] Options for configuring the SDP.\n   * @param  {Object} [options.mediaDirections] Directions to use for media.\n   * @param  {Array}  [options.sdpHandlers] SDP handlers for modifying the local answer.\n   * @return {Promise} Resolves with the answer.\n   */\n  function createAnswer (options = {}) {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      // If using unified-plan, remove options.mediaDirections.\n      // This is because directions are now set in transceivers.\n      if (isUnifiedPlan(config.peer.rtcConfig.sdpSemantics)) {\n        if (options.mediaDirections) {\n          const audioTransceiverTargetDir = options.mediaDirections.audio\n          const videoTransceiverTargetDir = options.mediaDirections.video\n\n          if (audioTransceiverTargetDir) {\n            const result = peer.setTransceiversDirection(audioTransceiverTargetDir, {\n              trackIds: peer.localTracks.filter(track => track.track.kind === 'audio').map(track => track.id)\n            })\n            if (result.error) {\n              log.info(`Failed to process the following transceivers: ${result.failures}`)\n            }\n          }\n          if (videoTransceiverTargetDir) {\n            const result = peer.setTransceiversDirection(videoTransceiverTargetDir, {\n              trackIds: peer.localTracks.filter(track => track.track.kind === 'video').map(track => track.id)\n            })\n            if (result.error) {\n              log.info(`Failed to process the following transceivers: ${result.failures}`)\n            }\n          }\n          delete options.mediaDirections\n        }\n      }\n\n      // Set the dtlsRole here if the following are true:\n      // - It previously existed for this specific remote sdp.\n      // - It hasn't been set on a recreated peer yet.\n      const remoteSdpSessionId = getSdpSessionId(peer.remoteDescription.sdp)\n      const previousDtlsRole = dtlsRoleRecord.get(remoteSdpSessionId)\n      if (!peer.getDtlsRole() && previousDtlsRole) {\n        peer.setDtlsRole(previousDtlsRole)\n      }\n\n      peer\n        .createAnswer(options)\n        .then(answer => {\n          if (options.sdpHandlers || sdpPipeline.getHandlers().length) {\n            log.debug('Modifying local answer with SDP pipeline.')\n            answer.sdp = sdpPipeline.run(options.sdpHandlers, answer.sdp, {\n              type: answer.type,\n              endpoint: PEER.ENDPOINT.LOCAL\n            })\n          }\n          resolve(answer)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Generates (and sets) a local SDP answer.\n   * @method generateAnswer\n   * @param  {Object} [options] Options for configuring the SDP.\n   * @param  {Object} [options.mediaDirections] Directions to use for media.\n   * @param  {Array}  [options.sdpHandlers] SDP handlers for modifying the local answer.\n   * @return {Promise} Resolves with the answer.\n   */\n  function generateAnswer (options = {}) {\n    // For backwards compatibility: Should use other APIs directly.\n    return new Promise((resolve, reject) => {\n      createAnswer(options)\n        .then(setLocalDescription)\n        .then(resolve)\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Processes (and sets) a remote SDP answer.\n   * @method processAnswer\n   * @param  {RTCSessionDescription} answer\n   * @param  {Object} [options] Options for configuring the SDP.\n   * @param  {Array}  [options.sdpHandlers] SDP handlers for modifying the remote answer.\n   * @return {Promise}\n   */\n  function processAnswer (answer, options = {}) {\n    if (options.sdpHandlers || sdpPipeline.getHandlers().length) {\n      log.debug('Modifying remote answer with SDP pipeline.')\n      answer.sdp = sdpPipeline.run(options.sdpHandlers, answer.sdp, {\n        type: answer.type,\n        endpoint: PEER.ENDPOINT.REMOTE\n      })\n    }\n\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      peer\n        .setRemoteDescription(answer)\n        .then(() => {\n          // Record the peer's dtls role.\n          recordNewDtlsRole()\n\n          // Set the answer as the latest remote description.\n          latestRemoteDescription = answer\n\n          resolve()\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Add an ICE candidate from the remote endpoint.\n   * @method addIceCandidate\n   * @param  {RTCIceCandidate} candidate\n   * @param  {Object} [options]\n   * @param  {string} [options.label] The Peer to perform the operation on.\n   * @return {Promise}\n   */\n  function addIceCandidate (candidate, options = {}) {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      peer\n        .addIceCandidate(candidate)\n        .then(resolve)\n        .catch(reject)\n    })\n  }\n\n  /**\n   * End the Session.\n   * @method end\n   */\n  function end () {\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      peer.close()\n    }\n    emitter.emit('session:ended', sessionId)\n  }\n\n  /**\n   * Removes specified Track objects from the Session.\n   * @method removeTrack\n   * @param  {Array} trackIds List of IDs of Track objects to remove.\n   */\n  function removeTracks (trackIds) {\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      trackIds.forEach(trackId => {\n        if (getLocalTracks().findIndex(track => track.id === trackId) > -1) {\n          peer.removeTrack(trackId)\n        }\n      })\n    }\n  }\n\n  /**\n   * Send DTMF tones on specified Track object from the Session.\n   * @method sendDTMF\n   * @param {Object} options The DTMF options.\n   * @param {string} options.tone DTMF tone to send. Valid values are [0,1,2,3,4,5,6,7,8,9,#].\n   * @param {number} [options.duration=100] The amount of time, in milliseconds, that each DTMF tone should last.\n   * @param {number} [options.intertoneGap=70] The length of time, in milliseconds, to wait between tones.\n   * @param {Object} [sendOptions] The send options.\n   * @param {func} [sendOptions.callback] Optional callback for tone event .\n   * @param {string} [sendOptions.trackId] The trackId of the sender to use.\n   * @return {boolean} The success or fail indicator\n   */\n  function sendDTMF (DTMFOptions, sendOptions = {}) {\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      return peer.sendDTMF(DTMFOptions, sendOptions)\n    } else {\n      return false\n    }\n  }\n\n  /**\n   * Retrieve RTCStatsReport from a sender.\n   * @method getStats\n   * @param  {string} trackId The track id associated with a sender.\n   * @return {Promise}\n   */\n  function getStats (trackId) {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n        return\n      }\n      peer\n        .getStats(trackId)\n        .then(resolve)\n        .catch(reject)\n    })\n  }\n\n  function on (...args) {\n    return emitter.on(...args)\n  }\n\n  function once (...args) {\n    return emitter.once(...args)\n  }\n\n  function off (...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * Sets up event handlers on a given peer.\n   * @method setupPeerEventHandlers\n   * @param {PeerConnection} targetPeer The peer to set event handlers on.\n   */\n  function setupPeerEventHandlers (targetPeer) {\n    // TODO: Use `uniqueLabel` when setting event listeners (and bubbling events).\n    // When the peer gets an ICE candidate, emit it as\n    //  a message to be sent to the other end.\n    targetPeer.on('onicecandidate', event => {\n      emitter.emit('onicecandidate', {\n        candidate: event.candidate\n      })\n    })\n\n    // Handle when the Peer receives a new remote track.\n    targetPeer.on('ontrack', track => {\n      let media = mediaManager.get(track.getStream().id)\n      if (media) {\n        // Add the new Track to its Media object.\n        media.addTrack(track)\n      } else {\n        // Create a new Media object using the Track.\n        media = mediaManager.createRemote(track.getStream(), [track])\n      }\n\n      media.on('track:removed', trackId => {\n        // This is used as a workaround for an issue that was noticed on Chrome 76 plan-b\n        //  (it may have already been happening in previous versions):\n        //  - the remote audio track's `ended` event does not fire when remote sdp comes in with `inactive` media (hold).\n        //  - the remote audio track's `ended` event fires when sdp comes in with `sendrecv` media (unhold).\n        // Only do manual remote track cleanup when plan-b.\n        // Doing so for unified-plan will make the new track in `ontrack` event come in an `ended` state.\n        if (!isUnifiedPlan(config.peer.rtcConfig.sdpSemantics)) {\n          const trackToCleanup = trackManager.get(trackId)\n          if (trackToCleanup) {\n            trackToCleanup.cleanup()\n            log.info(`Cleaning up track ${trackId}.`)\n          } else {\n            log.info(`Track ${trackId} not found.`)\n          }\n        }\n\n        emitter.emit('track:removed', {\n          local: false,\n          trackId: trackId\n        })\n      })\n\n      track.once('ended', () => {\n        emitter.emit('track:ended', {\n          local: false,\n          trackId: track.id\n        })\n      })\n\n      // Indicate that the Session has a new Track.\n      emitter.emit('new:track', {\n        local: false,\n        trackId: track.id\n      })\n    })\n  }\n\n  /**\n   * Creates a new peer and replaces the current peer being used by this session.\n   *     This will close the previous Peer, stopping any media being sent/received on it.\n   * @method recreatePeer\n   */\n  function recreatePeer () {\n    const oldPeer = peer\n    const newPeer = peerManager.create(config.peer)\n    if (newPeer) {\n      // The id of the created peer\n      peerId = newPeer.id\n      peer = newPeer\n\n      // Copy tracks\n      oldPeer.localTracks.forEach(oldLocalTrack => {\n        newPeer.addTrack(oldLocalTrack)\n      })\n\n      // Set event handlers\n      setupPeerEventHandlers(newPeer)\n\n      // Close the old peer\n      oldPeer.close()\n    } else {\n      throw new Error(`Peer creation error in Session ${sessionId}.`)\n    }\n  }\n\n  function getPeer () {\n    return peer\n  }\n\n  function getRemoteDescription () {\n    return peer.remoteDescription\n  }\n\n  function getLatestRemoteDesc () {\n    return latestRemoteDescription\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    id: sessionId,\n    config,\n    // Getter APIs.\n    get peer () {\n      return getPeer()\n    },\n    getState,\n    get localTracks () {\n      return getLocalTracks()\n    },\n    get remoteTracks () {\n      return getRemoteTracks()\n    },\n    warmup,\n    addTracks,\n    removeTracks,\n    replaceTrack,\n    setTransceiversDirection,\n    // Negotiation APIs.\n    createOffer,\n    createAnswer,\n    setLocalDescription,\n    getRemoteDescription,\n    getLatestRemoteDesc,\n    generateOffer,\n    processOffer,\n    generateAnswer,\n    processAnswer,\n    getLocalTracksIsSendingStatus,\n    // Other APIs.\n    recreatePeer,\n    addIceCandidate,\n    end,\n    sendDTMF,\n    getStats,\n    // Event APIs.\n    on,\n    once,\n    off\n  }\n}\n","// Libraries.\nimport log from 'loglevel'\nimport EventEmitter from 'eventemitter3'\nimport { makeSafeForCSS } from '../utils'\n\n/**\n * Wrapper object for a native MediaStreamTrack object.\n * Ref: https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack\n * @method Track\n */\nexport default function Track (mediaTrack, mediaStream) {\n  // Internal variables.\n  const id = mediaTrack.id\n  const track = mediaTrack\n  let stream = mediaStream\n  const containers = []\n  let constraints = {}\n  const emitter = new EventEmitter()\n\n  /**\n   * When a track ends, the Track itself doesn't do anything about it.\n   * It \"bubbles\" the event up to be handled at a higher level.\n   */\n  track.onended = event => {\n    log.debug('Event emitted: ', event)\n    emitter.emit('ended', track.id)\n  }\n\n  function setStream (newStream) {\n    stream = newStream\n  }\n  function getStream () {\n    return stream\n  }\n\n  /**\n   * Retrieve a snapshot of the Track object's current state.\n   * @method getState\n   * @return {Object}\n   */\n  function getState () {\n    return {\n      id,\n      streamId: stream.id,\n      kind: track.kind,\n      label: track.label,\n      muted: !track.enabled,\n      disabled: track.muted,\n      state: track.readyState,\n      containers: containers.map(element => element.id)\n    }\n  }\n\n  /**\n   * Renders this Track as a subelement of the specified element.\n   * @method renderIn\n   * @param  {HTMLElement|String} container The DOM element to be rendered in,\n   *    or a unique CSS selector for the DOM element.\n   * @param  {String} [speakerId] The device ID to be used for audio output.\n   */\n  function renderIn (container, speakerId) {\n    let element\n    // If a string was provided, use it as a CSS selector to find the element.\n    if (typeof container === 'string') {\n      log.debug(`Track ${id} rendering in element using selector: ${container}`)\n\n      element = document.querySelector(container)\n      if (!element) {\n        log.error(`Unable to get container with selector: ${container}.`)\n        return false\n      }\n    } else {\n      log.debug(`Track ${id} rendering in provided HTMLElement.`)\n\n      element = container\n    }\n\n    // TODO: Proper error checking.\n\n    if (containers.indexOf(element) > -1) {\n      // Already rendered in element.\n      log.debug(`Track ${id} already rendered in element.`, element)\n      return\n    }\n\n    containers.push(element)\n\n    let type = track.kind\n    let renderer = document.createElement(type)\n\n    // Make id safe for css (Firefox ids come wrapped in curly braces)\n    // This makes it easier to do other manipulation on the rendering side\n    // as we don't need to escape curly braces when doing element.querySelector (See removeFrom).\n    renderer.id = `${type}-${makeSafeForCSS(id)}`\n    renderer.style.height = '100%'\n    renderer.style.width = '100%'\n\n    try {\n      renderer.srcObject = stream\n    } catch (error) {\n      log.debug('srcObject property not supported; reverting to createObjectURL.')\n      // TODO: AdapterJS handles this, we should remove this.\n      renderer.src = window.URL.createObjectURL(stream)\n    }\n\n    renderer.autoplay = 'true'\n\n    if (type === 'video') {\n      renderer.muted = 'true'\n      // Needed for Android.\n      renderer.play().catch(err => log.error(`video tag (#${renderer.id}) - play() - ${err}`))\n    }\n\n    // Set speaker if it was provided and it's supported.\n    if (speakerId && typeof renderer.setSinkId !== 'undefined') {\n      // TODO: Better then/catch handling.\n      renderer\n        .setSinkId(speakerId)\n        .then(() => {\n          log.debug('Set to use speaker: ', speakerId)\n        })\n        .catch(error => {\n          log.debug('Could not set speaker to use. ' + speakerId, error)\n        })\n    }\n\n    element.appendChild(renderer)\n\n    // TODO: Emit event to notify of changes?\n    return true\n  }\n\n  /**\n   * Stop rendering this Track from the specified element.\n   * @method removeFrom\n   * @param  {HTMLElement} container The DOM element to be removed from, or\n   *     a unique CSS selector for the DOM element.\n   */\n  function removeFrom (container) {\n    let element\n    // If a string was provided, use it as a CSS selector to find the element.\n    if (typeof container === 'string') {\n      log.debug(`Track ${id} removing from element using selector: ${container}`)\n\n      element = document.querySelector(container)\n      if (!element) {\n        log.error(`Unable to get container with selector: ${container}.`)\n        return false\n      }\n    } else {\n      log.debug(`Track ${id} removing from provided HTMLElement.`)\n\n      element = container\n    }\n\n    let index = containers.indexOf(element)\n    if (index === -1) {\n      // Not rendered in element.\n      log.debug(`Track ${id} not rendered in element.`, element)\n      return\n    }\n    containers.splice(index, 1)\n\n    // TODO: This id may not be unique.\n    // Make id safe for css (Firefox ids come wrapped in curly braces)\n    // This makes it easier to do other manipulation on the rendering side\n    // as we don't need to escape curly braces when doing element.querySelector.\n    let rendererId = `${track.kind}-${makeSafeForCSS(id)}`\n    const renderer = element.querySelector(`#${rendererId}`)\n\n    if (renderer.srcObject) {\n      renderer.srcObject = null\n    } else if (renderer.src) {\n      renderer.src = null\n    }\n    element.removeChild(renderer)\n\n    // TODO: Emit event to notify of changes?\n    return true\n  }\n\n  /**\n   * Moves the rendered track to only the specified element.\n   * @method moveTo\n   * @param  {HTMLElement} element The DOM element to be moved to.\n   */\n  function moveTo (element) {\n    // Iterate over the array backwards since `removeFrom` changes the length\n    //    of the array. This ensures that indexes aren't skipped.\n    for (let i = containers.length; i > 0; i--) {\n      removeFrom(containers[i - 1])\n    }\n    renderIn(element)\n  }\n\n  /**\n   * Clean-up the Track by removing it wherever it is rendered and stopping the\n   *    track itself.\n   * @method cleanup\n   */\n  function cleanup () {\n    // Iterate over the array backwards since `removeFrom` changes the length\n    //    of the array. This ensures that indexes aren't skipped.\n    for (let i = containers.length; i > 0; i--) {\n      removeFrom(containers[i - 1])\n    }\n    // Stop the track if it isn't already stopped.\n    if (track.readyState === 'live') {\n      stop()\n    }\n  }\n\n  /**\n   * Set this Track to be disabled and disallow the Track to render the source stream.\n   * @method mute\n   */\n  function mute () {\n    track.enabled = false\n  }\n\n  /**\n   * Set this Track to be enabled and allow the Track to render the source stream.\n   * @method unmute\n   */\n  function unmute () {\n    track.enabled = true\n  }\n\n  /**\n   * Calls native stop() function to deassociate the source and the track.\n   * @method stop\n   */\n  function stop () {\n    track.stop()\n    /**\n     * Treat stopping the track the same as it being ended.\n     * Noramlly, onended is not triggered when `stop` is called, only when it is\n     *    \"remotely ended\".\n     */\n    track.onended()\n  }\n\n  /**\n   * Gets the currently set constraints for the track.\n   * @method getConstraints\n   * @return {Object}\n   */\n  function getConstraints () {\n    return constraints\n  }\n\n  /**\n   * Set the values for constrainable properties of the track.\n   * @method applyConstraints\n   * @param  {Object} constraints The list of constrainable properties.\n   */\n  function setConstraints (constr) {\n    constraints = constr\n  }\n\n  /**\n   * Retrieves the list of containers where the Track is rendered.\n   * @method getContainers\n   * @return {Array} List of HTMLElements.\n   */\n  function getContainers () {\n    return containers\n  }\n\n  function on (...args) {\n    return emitter.on(...args)\n  }\n\n  function once (...args) {\n    return emitter.once(...args)\n  }\n\n  function off (...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    id,\n    // Track APIs.\n    getState,\n    renderIn,\n    removeFrom,\n    moveTo,\n    cleanup,\n    mute,\n    unmute,\n    stop,\n    getConstraints,\n    setConstraints,\n    getContainers,\n    // Event APIs.\n    on,\n    off,\n    once,\n    // The native track and stream was accessible before, so it was\n    //    used when it probably shouldn't have been.\n    // TODO: Find a better solution.\n    track,\n    setStream,\n    getStream\n  }\n}\n","/**\n * Extracts the session ID from the SDP.\n * Session ID is located in the o= line.\n * Ref: https://tools.ietf.org/html/rfc4566#section-5.2\n * @method getSdpSessionId\n * @param  {string} sdp A valid SDP string.\n * @return {string} The SDP's session ID.\n */\nexport function getSdpSessionId (sdp) {\n  const oLine = sdp.match(/o=.*/gm)\n\n  if (oLine && oLine[0]) {\n    return oLine[0].split(' ')[1]\n  }\n}\n","// Libraries.\nimport log from 'loglevel'\n\n// Constants.\nimport { MEDIA_DIR } from '../constants'\n\n/**\n * SDP handler to remove the trickle ICE option from media groups.\n * Modifies the SDP so it claims to not support trickle ICE.\n * @method removeTrickleIce\n * @param  {Object} sdp\n * @param  {Object} info\n * @param  {String} info.type\n * @param  {String} info.endpoint\n * @param  {Object} originalSdp\n * @return {Object}\n */\nexport function removeTrickleIce (sdp, info, originalSdp) {\n  sdp.media.forEach(media => {\n    if (media.iceOptions === 'trickle') {\n      log.debug(`Removing trickle ICE option from ${media.type} media.`)\n      delete media.iceOptions\n    }\n  })\n\n  return sdp\n}\n\n/**\n * SDP handler to delete the bundle groupings line from the SDP.\n * PeerConnections do not have an option to completely disable bundling, so\n *    manually removing the line from the SDP is needed to prevent bundling.\n * @method removeBundling\n * @param  {Object}     sdp           The session description.\n * @param  {Object}     info          Information about the session description.\n * @param  {RTCSdpType} info.type     The session description's type.\n * @param  {String}     info.endpoint Which end of the connection created the SDP.\n * @param  {Object}     originalSdp   The original SDP before any modifications.\n * @return {Object}\n */\nexport function removeBundling (sdp, info, originalSdp) {\n  if (sdp.groups) {\n    delete sdp.groups\n  }\n\n  return sdp\n}\n\n/**\n * Currying function to create an SDP handler.\n * The SDP handler modifies the SDP to change the direction of media.\n * @method changeMediaDirection\n * @param  {Object} mediaDirections\n * @param  {string} [audio] Direction to set for audio.\n * @param  {string} [video] Direction to set for video.\n * @return {Function} SDP handler.\n */\nexport function changeMediaDirection ({ audio, video }) {\n  function isValid (direction) {\n    return Object.values(MEDIA_DIR).includes(direction)\n  }\n\n  /**\n   * SDP handler to change the direction of media a-lines.\n   */\n  return (sdp, info, originalSdp) => {\n    sdp.media.forEach(media => {\n      if (media.type === 'audio' && isValid(audio)) {\n        media.direction = audio\n      } else if (media.type === 'video' && isValid(video)) {\n        media.direction = video\n      }\n    })\n    return sdp\n  }\n}\n\n/**\n * SDP handler to modify the DTLS role of a locally generated answer SDP.\n *\n * The point of this SDP handler is to avoid a DTLS role conflict during a\n *    renegotiation. A role conflict occurs when DTLS roles have been selected\n *    during initial negotiation, but during renegotiation, the answerer selects\n *    the opposite role than previously used.\n *\n * This handler only needs to be used when the Peer is generating an answer SDP.\n *    That is the only point when a conflicting role can be chosen.\n *\n * This handler prevents the role changing by comparing the SDP's role with the\n *    role that the Peer previously selected. If they conflict, the Peer's\n *    previous role is used.\n *\n * Related stories: KAA-1426, KAA-1562.\n * References: https://groups.google.com/forum/#!topic/discuss-webrtc/gsw3OEAwNKo\n * @method preventDtlsRoleChange\n * @param  {Object}     newSdp          The session description.\n * @param  {Object}     info            Information about the session description.\n * @param  {RTCSdpType} info.type       The session description's type.\n * @param  {string}     info.endpoint   Which end of the connection created the SDP.\n * @param  {string}     [info.dtlsRole] The previously select DTLS role of the Peer.\n * @param  {Object}     originalSdp     The sdp in its initial state.\n * @return {Object}                     The modified SDP.\n */\nexport function preventDtlsRoleChange (newSdp, info, originalSdp) {\n  /**\n   * This SDP handler only affects local answer SDPs.\n   *  - Only local because we are trying to prevent role conflict issues caused\n   *        by the answerer choosing the \"wrong\" role during a renegotiation.\n   *  - Only answer because offers are always actpass.\n   */\n  if (info.endpoint === 'local' && info.type === 'answer') {\n    for (let mLine of newSdp.media) {\n      /**\n       * If the generated DTLS role is different than what the Peer expects,\n       *    replace it. The Peer expects the DTLS role to stay the same\n       *    throughout renegotiations.\n       */\n      if (mLine.setup && info.dtlsRole && mLine.setup !== info.dtlsRole) {\n        log.debug(`Changing DTLS role from ${mLine.setup} to ${info.dtlsRole}.`)\n        mLine.setup = info.dtlsRole\n      }\n    }\n  }\n  return newSdp\n}\n","// Libraries.\nimport log from 'loglevel'\nimport sdpTransform from 'sdp-transform'\nimport { cloneDeep, isArray, isFunction } from 'lodash/fp'\n\n/**\n * Basic SDP pipeline runner.\n * Does not include any default handlers.\n * @method sdpPipeline\n * @param  {Array}      handlers       List of functions that transform the SDP.\n * @param  {String}     sdp            The session description.\n * @param  {RTCSdpType} info           Information about the session description.\n * @param  {RTCSdpType} info.type      The session description's type.\n * @param  {String}     info.endpoint  Which end of the connection created the SDP.\n * @param  {Boolean}    info.isInitiator Whether this session initiated the connection or not.\n * @return {String}     The modified session description.\n\n */\nexport function runPipeline (handlers, sdp, info) {\n  let objectSdp = sdpTransform.parse(sdp)\n\n  const originalSdp = Object.freeze(objectSdp)\n  let newSdp = cloneDeep(originalSdp)\n\n  if (isArray(handlers)) {\n    handlers.forEach(handler => {\n      if (isFunction(handler)) {\n        newSdp = handler(newSdp, info, originalSdp)\n      } else {\n        log.error(`SDP handler not a function; skipping.`)\n      }\n    })\n  }\n\n  return sdpTransform.write(newSdp)\n}\n\n/**\n * Create an instance of the SDP pipeline.\n * Allows for persistent SDP handlers to be set and implictly used.\n * @method createPipeline\n * @return {Object} An SDP pipeline.\n */\nfunction createPipeline () {\n  /**\n   * SDP handlers that should be included with every pipeline run.\n   * @type {Array}\n   */\n  let defaultHandlers = []\n\n  /**\n   * Use the pipeline to process an SDP.\n   * @method run\n   * @param  {Array}      handlers      List of functions that transform the SDP.\n   * @param  {String}     sdp           The session description.\n   * @param  {RTCSdpType} info          Information about the session description.\n   * @param  {RTCSdpType} info.type     The session description's type.\n   * @param  {String}     info.endpoint Which end of the connection created the SDP.\n   * @return {String}     The modified session description.\n   */\n  function run (handlers = [], sdp, info) {\n    return runPipeline(handlers.concat(defaultHandlers), sdp, info)\n  }\n\n  /**\n   * Set the SDP handlers that should be included with every pipeline run.\n   * @method setHandlers\n   * @param  {Array} handlers List of SDP handler functions.\n   */\n  function setHandlers (handlers) {\n    if (isArray(handlers)) {\n      defaultHandlers = defaultHandlers.concat(handlers)\n    }\n  }\n\n  /**\n   * Get the SDP handlers that are included with every pipeline run.\n   * @method getHandlers\n   * @return {Array} List of SDP handler functions.\n   */\n  function getHandlers () {\n    return defaultHandlers\n  }\n\n  return {\n    run,\n    setHandlers,\n    getHandlers\n  }\n}\n\n// Export an instance of the pipeline to be used by everything.\nexport default createPipeline()\n","import { PEER } from '../constants'\nimport { values } from 'lodash/fp'\n\n/**\n * Checks whether the current sdp semantics is unified-plan\n * @method isUnifiedPlan\n * @param {String} sdpSemantics The current sdp semantics being used\n * @return {Boolean}\n */\nexport function isUnifiedPlan (sdpSemantics) {\n  return sdpSemantics === PEER.SDP_SEMANTICS.UNIFIED_PLAN\n}\n\n/**\n * Generates a list of sdp semantics.\n * @method getSdpSemanticsList\n * @return {Array}\n */\nexport function getSdpSemanticsList () {\n  return values(PEER.SDP_SEMANTICS)\n}\n","import { MEDIA_DIR } from '../constants'\nimport log from 'loglevel'\nimport { values, includes } from 'lodash/fp'\n\n/**\n * Sets a transceiver's direction.\n * Checks that the desired direction is a valid one.\n * @method setTransceiverDirection\n * @param {Object} transceiver The transceiver that we want to modify.\n * @param {String} targetDirection The desired direction we want to change to.\n * @return {Boolean} Indicator on whether the transceiver direction was successfully changed.\n */\nexport function setTransceiverDirection (transceiver, targetDirection) {\n  if (!includes(targetDirection, values(MEDIA_DIR))) {\n    log.info(`Invalid direction \"${targetDirection}\"`)\n    return false\n  }\n\n  // Only in Safari:\n  //  - has transceiver.setDirection\n  //  - transceiver.direction is readOnly\n  if (transceiver.setDirection) {\n    transceiver.setDirection(targetDirection)\n  } else {\n    transceiver.direction = targetDirection\n  }\n  return true\n}\n","import { mergeAllWith, isArray } from 'lodash/fp'\n\n// TODO: This function was copied from Kandy, we should eventually create a common project that\n// can contain all of these utils that are useful in multiple packages.\n\n/**\n * Deeply merges the values of multiple objects. Objects on the left receive the values from objects on their right.\n * Unlike lodash's default merge behavior this doesn't merge arrays.\n *\n * @name mergeValues\n * @param {...Object} objects - Objects to merge\n * @return {Object} A new object containing the merged values.\n */\nexport function mergeValues (...objects) {\n  return mergeAllWith((leftValue, rightValue) => {\n    // Overwrite the default behavior of lodash's merge for arrays and simply\n    // clobber what's on the left so we don't end up with merged arrays.\n    if (isArray(leftValue)) {\n      return rightValue\n    }\n  }, objects)\n}\n\nexport function makeSafeForCSS (name) {\n  if (!name) {\n    return name\n  } else {\n    return name.replace(/[^a-z0-9]/g, '')\n  }\n}\n"],"sourceRoot":""}